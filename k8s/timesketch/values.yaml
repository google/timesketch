## Timesketch Helm Chart
## Please use this Helm chart for deploying Timesketch to a Kubernetes environment.
##
## Timesketch Docker image parameters
##
image:
  ## @param repository
  ##
  repository: us-docker.pkg.dev/osdfir-registry/timesketch/timesketch
  ## @param pullPolicy
  ##
  pullPolicy: IfNotPresent
  ## @param tag Overrides the image tag whose default is the chart appVersion.
  ##
  tag: latest
  ## @ param imagePullSecrets
  ## e.g.
  ## imagePullSecrets:
  ##   - myRegistryKeySecretName
  ##
  imagePullSecrets: []
## @param nameOverride
##
nameOverride: ""
## @param fullnameOverride
##
fullnameOverride: ""
## Timesketch service account parameters
##
serviceAccount:
  ## @param create Specifies whether a service account should be created
  ##
  create: true
  ## @param annotations Annotations to add to the service account
  ##
  annotations: {}
  ## @param name The name of the service account to use.
  ## If not set and create is true, a name is generated using the fullname template
  ##
  name: "timesketch"
## Timesketch persistence storage parameters
##
persistence:
  ## @param persistence.name
  ##
  name: timesketchvolume
  ## @param persistence.size
  ##
  size: 1T
  ## @param persistence.storageClass PVC Storage Class for Timesketch volume
  ## If default, storageClassName: <storageClass>, which enables GCP Filestore
  ## If set to "-", storageClassName: "", which disables dynamic provisioning
  ## If undefined or set to null, no storageClassName spec is
  ##   set, choosing the default provisioner.  (gp2 on AWS, standard on
  ##   GKE, AWS & OpenStack)
  ## ref https://kubernetes.io/docs/concepts/storage/dynamic-provisioning/#using-dynamic-provisioning
  ## 
  storageClass: standard-rwx
  ## @param persistence.accessModes PVC Access Mode for Timesketch volume
  ## Access mode may need to be updated based on the StorageClass
  ## ref https://kubernetes.io/docs/concepts/storage/persistent-volumes/#access-modes
  ## 
  accessModes:
    - ReadWriteMany
  ## @param mountPath
  ##
  mountPath: /mnt/timesketchvolume
## Timesketch ingress parameters
##
ingress:
  ## @param ingress.enabled
  ##
  enabled: false
  ## @param ingress.domain
  ##
  domain: ""
  ## @param ingress.className
  ##
  className: "gce"
  ## @param
  ##
  gcp:
    ## @param ingress.gcp.managedCertificates
    ##
    managedCertificates: false
    ## @param ingress.gcp.staticIPName
    ##
    staticIPName: ""
## Timesketch service parameters
##
service:
  ## @param type
  ##
  type: ClusterIP
  ## @param port
  ##
  port: 5000
## Timesketch frontend configuration
##
frontend:
  ## Frontend resource requests and limits
  ## @param frontend.resources.requests.cpu The requested cpu for the frontend container
  ## @param frontend.resources.requests.memory The requested memory for the frontend container
  ## @param frontend.resources.limits.cpu The resources cpu limits for the frontend container
  ## @param frontend.resources.limits.memory The resources memory limits for the frontend container
  ##
  resources:
    requests:
      cpu: 2000m
      memory: 4000Mi
    limits:
      cpu: 8000m
      memory: 16000Mi
## Timesketch worker configuration
##
worker:
  ## Frontend resource requests and limits
  ## @param worker.resources.requests.cpu The requested cpu for the worker container
  ## @param worker.resources.requests.memory The requested memory for the worker container
  ## @param worker.resources.limits.cpu The resources cpu limits for the worker container
  ## @param worker.resources.limits.memory The resources memory limits for the worker container
  ##
  resources:
    requests:
      cpu: 2000m
      memory: 4000Mi
    limits:
      cpu: 8000m
      memory: 16000Mi
## @param podAnnotations
##
podAnnotations: {}
## @param podSecurityContext
## e.g.
## fsgroup: 2000
##
podSecurityContext: {}
## @param SecurityContext
## e.g.
## capabilities
##   drop:
##   - ALL
## readOnlyRootFilesystem: true
## runAsNonRoot: true
## runAsUser: 1000
securityContext: {}
## @param nodeSelector
##
nodeSelector: {}
## @param tolerations
##
tolerations: []
## @param affinity
##
affinity: {}
## @section Third Party Configuration
## This section contains all the main configuration for third party dependencies
## Timesketch requires to run.
##
## Open Search Configuration
##
opensearch:
  ## @param enabled is whether to enable the Opensearch Helm deployment 
  ##
  enabled: true
  ## @param config.opensearch.yml
  ##
  config:
    opensearch.yml: |
      plugins:
        security:
          allow_unsafe_democertificates: false
  ## @param extraEnvs
  ##
  extraEnvs:
    - name: DISABLE_INSTALL_DEMO_CONFIG
      value: "true"
    - name: DISABLE_SECURITY_PLUGIN
      value: "true"
  ## @param replicas
  ##
  replicas: 3
  ## @param sysctlInit.enabled
  ##
  sysctlInit:
    enabled: true
  ## @param opensearchJavaOpts
  ## 
  opensearchJavaOpts: "-Xms32g -Xmx32g"
  ## @param httpPort
  ##
  httpPort: 9200
  ## @param persistence.size
  ##
  persistence:
    size: 1Ti
  ## Opensearch resource requests
  ## @param opensearch.resources.requests.cpu The requested cpu for the Redis master containers
  ## @param opensearch.resources.requests.memory The requested memory for the Redis master containers 
  ##
  resources:
    requests:
      cpu: 8000m
      memory: 32Gi
## Redis Configuration
##
redis:
  ## @param enabled
  ##
  enabled: true
  ## @param sentinel.enabled
  ##
  sentinel:
    enabled: false
  ## Master Redis Service configuration
  ##
  master:
    ## @param count
    ##
    count: 1
    ## @param persistence.size
    ##
    persistence:
      size: 8Gi
    ## Redis master resource requests and limits
    ## @param redis.master.resources.requests.cpu The requested cpu for the Redis master containers
    ## @param redis.master.resources.requests.memory The requested memory for the Redis master containers 
    ## @param redis.master.resources.limits.cpu The resources cpu limits for the Redis master containers
    ## @param redis.master.resources.limits.memory The resources memory limits for the Redis master containers
    ##
    resources:
      requests:
        cpu: 4000m
        memory: 8Gi
      limits:
        cpu: 8000m
        memory: 16Gi
  replica:
    ## @param replicaCount
    ##
    replicaCount: 1
    ## @param persistence.size
    ##
    persistence:
      size: 8Gi
    ## Redis Replica resource requests and limits
    ## @param redis.replica.resources.requests.cpu The requested cpu for the Redis replica containers
    ## @param redis.replica.resources.requests.memory The requested memory for the Redis replica containers 
    ## @param redis.replica.resources.limits.cpu The resources cpu limits for the Redis replica containers
    ## @param redis.replica.resources.limits.memory The resources memory limits for the Redis replica containers
    ##
    resources:
      requests:
        cpu: 4000m
        memory: 8Gi
      limits:
        cpu: 8000m
        memory: 16Gi 
## Postgres Configuration
##
postgresql:
  ## @param enabled
  ##
  enabled: true
  ## PostgreSQL Authentication parameters
  ##
  auth:
    ## @param auth.username 
    ##
    username: "postgres"
    ## @param auth.postgresPassword Password for the "postgres" admin user. Ignored if `auth.existingSecret` is provided
    ##
    database: "timesketch"
  ## PostgreSQL Primary parameters
  ##
  primary:
    ## PostgreSQL Primary persistence configuration
    ##
    persistence:
      ## @param primary.persistence.size
      ##
      size: 8Gi
    ## PostgreSQL Primary resource requests and limits
    ## @param postgresql.primary.resources.requests.cpu The requested cpu for the PostgreSQL Primary containers
    ## @param postgresql.primary.resources.requests.memory The requested memory for the PostgreSQL Primary containers
    ## @param postgresql.primary.resources.limits The resources limits for the PostgreSQL Primary containers
    ##
    resources:
      requests:
        cpu: 250m
        memory: 256Mi
      limits: {}
  ## PostgreSQL read only replica parameters (only used when `architecture` is set to `replication`)
  ## 
  readReplicas:
    ## @param readReplicas.replicaCount Number of PostgreSQL read only replicas
    ##
    replicaCount: 1
    ## PostgreSQL read only resource requests and limits
    ## @param postgresql.readReplicas.resources.requests.cpu The requested cpu for the PostgreSQL read only containers
    ## @param postgresql.readReplicas.resources.requests.memory The requested memory for the PostgreSQL read only containers
    ## @param postgresql.readReplicas.resources.limits The resources limits for the PostgreSQL read only containers
    ##
    resources:
      requests:
        cpu: 250m
        memory: 256Mi
      limits: {}