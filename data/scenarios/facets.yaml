# ------------------------------------------------------------------------
#                       -- Facets --
# ------------------------------------------------------------------------
#
# Facets are mini investigations that focus on strategically and specifically
# selected sets of investigative questions.
#
# This is a config file to define facets.
#
# Each facet consists of the following fields:
#
#                       -- metadata --
#       display_name        Simple string that contains the display name that
#                           be used in an UI to describe the question.
#
#       description         Further description of the facet, what the
#                           facet attempts to answer, whether it will
#                           require further manual analysis, etc.
#
#       ttp                 Tactics, Techniques and Procedures (TTP). An
#                           optional list of ttps. For example MITRE ATT&CK(r)
#                           based ttps.
#
#       questions           List of investigative questions that will help
#                           the analyst to come to an conclusion for the facet.
#
# ------------------------------------------------------------------------
attacker_maintain_access:
  display_name: Attacker maintained access?
  description: Are there any signs of an attacker moving from the computer to another host? (Lateral Movement)
  questions:
    - user_logged_in_win
    - user_downloaded_file

interference_with_protective_measures:
  display_name: Interference with protective measures?
  description: Are there any signs of an attacker trying to maintain their access? (Persistence)
  questions:
    - user_logged_in_win

exfiltrate_over_phyiscal_medium:
  display_name: Exfiltration Over Physical Medium
  description: Adversaries may attempt to exfiltrate data via a physical medium, such as a removable drive. In certain circumstances, such as an air-gapped network compromise, exfiltration could occur via a physical medium or device introduced by a user. Such media could be an external hard drive, USB drive, cellular phone, MP3 player, or other removable storage and processing device. The physical medium or device could be used as the final exfiltration point or to hop between otherwise disconnected systems.
  ttps: 
    - attack.T1052
    - attack.exfiltration
  questions:
    - win_usb_device_attached
    - usb_write_events

windows_system_information:
  display_name: Windows System information
  description: Show various system information relevant for the investigation.
  questions:
    - windows_timezone_settings
    - windows_users
    - windows_version

windows_wlan_history:
  display_name: WLAN history of a Windows system
  description: Based on Windows Event logs
  questions:
    - windows_wlan_history

create_account:
  display_name: Create account
  description: Adversaries may create an account to maintain access to victim systems. With a sufficient level of access, creating such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.
  ttps:
    - attack.T1136
    - attack.persistence
  questions:
    - windows_local_account_created

modify_account:
  display_name: Modify a user
  description: Adversaries may manipulate accounts to maintain access to victim systems.
  ttps:
    - attack.T1098
    - attack.persistence
    - attack.account_manipulation
  questions:
    - windows_rest_user_password

bruteforce_password_guessing:
  display_name: Brute Force Password Guessing
  description: Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts.
  ttps:
    - attack.T1110.001
    - attack.brute_force
  questions:
    - windows_failed_logons
    - windows_successful_logon