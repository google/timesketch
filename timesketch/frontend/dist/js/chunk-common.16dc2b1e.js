(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-common"],{0:function(t,e,s){t.exports=s("56d7")},"0509":function(t,e,s){},"05a2":function(t,e,s){"use strict";s.r(e),e["default"]={name:"filterChip",filter:function(t){return"label"===t.type?"__ts_star"===t.value?"Starred":"__ts_comment"===t.value?"Commented":t.value:t.field+":"+t.value}}},"09ff":function(t,e,s){"use strict";s.r(e);s("6b54");e["default"]={name:"formatTimestamp",filter:function(t){var e=parseInt(t).toString().length;return 13===e||(15===e||16===e?t/=1e3:10===e&&(t*=1e6)),t}}},"114f":function(t,e,s){},"11f2":function(t,e,s){},2555:function(t,e,s){"use strict";s("11f2")},"2d27":function(t,e,s){"use strict";s.r(e);s("7f7f"),s("ac6a");var i=s("2b0e"),a=s("75a6");a.keys().forEach((function(t){var e=a(t),s=e.default.name;i["default"].component(s,e.default||e)}))},"3d1d":function(t,e,s){"use strict";s.r(e),e["default"]={name:"compactBytes",filter:function(t){t||(t=0);var e=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.min(Math.floor(Math.log(t)/Math.log(1e3)),e.length-1),i=1*(t/Math.pow(1e3,s)).toFixed(2);return i+e[s]}}},"4ce9":function(t,e,s){},"4fb9":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("f751"),s("097d");var i=s("2b0e"),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},n=[],r={name:"app",created:function(){var t=document.body;localStorage.theme||(localStorage.theme="light"),t.dataset.theme=localStorage.theme}},o=r,c=(s("60bc"),s("2877")),l=Object(c["a"])(o,a,n,!1,null,null,null),u=l.exports,d=s("289d"),h=s("f13c"),m=s.n(h),p=s("8e5f"),f=s.n(p),v=s("8c4f"),g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ts-navbar-main",{scopedSlots:t._u([{key:"center",fn:function(){return[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery,expression:"searchQuery"}],staticClass:"ts-home-input",attrs:{type:"text",placeholder:"Search for investigations",autofocus:""},domProps:{value:t.searchQuery},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)},input:function(e){e.target.composing||(t.searchQuery=e.target.value)}}})]},proxy:!0}])}),s("section",{staticClass:"section",staticStyle:{"margin-top":"20px","margin-bottom":"20px"}},[s("div",{staticClass:"container"},[s("button",{staticClass:"button is-success",on:{click:function(e){t.showSketchCreateModal=!t.showSketchCreateModal}}},[t._m(0),s("strong",[t._v("New investigation")])])])]),s("b-modal",{attrs:{active:t.showSketchCreateModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showSketchCreateModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Create new sketch")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("ts-create-sketch-form")],1)])])]),t.newSearchQuery?s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"card"},[t._m(1),s("div",{staticClass:"card-content"},[s("ts-sketch-list",{attrs:{scope:"search","search-query":t.newSearchQuery}}),s("hr"),s("button",{staticClass:"button is-info",on:{click:function(e){t.newSearchQuery=""}}},[t._v("Back")])],1)])])]):t._e(),t.newSearchQuery?t._e():s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"card"},[t._m(2),s("div",{staticClass:"card-content"},[s("ts-sketch-list",{attrs:{scope:"recent"}})],1)])]),s("br")]),t.newSearchQuery?t._e():s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"card"},[t._m(3),s("div",{staticClass:"card-content"},[s("ts-sketch-list",{attrs:{scope:"user"}})],1)])])]),t.newSearchQuery?t._e():s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"card"},[t._m(4),s("div",{staticClass:"card-content"},[s("ts-sketch-list",{attrs:{scope:"shared"}})],1)])])]),t.newSearchQuery?t._e():s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"card"},[t._m(5),s("div",{staticClass:"card-content"},[s("ts-sketch-list",{attrs:{scope:"archived"}})],1)])])]),s("br")],1)},_=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-plus-circle"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("div",{staticClass:"card-header-title"},[t._v("\n            Search results\n          ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("div",{staticClass:"card-header-title"},[t._v("\n            My recent activity\n          ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("div",{staticClass:"card-header-title"},[t._v("\n            My investigations\n          ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("div",{staticClass:"card-header-title"},[t._v("\n            Shared with me\n          ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("div",{staticClass:"card-header-title"},[t._v("\n            Archived\n          ")])])}],y=(s("386d"),s("7f7f"),s("6762"),s("2fdb"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.sketches.length?t._e():s("div",[t._v("\n    No "+t._s(t.scope)+" investigations found\n  ")]),s("ul",{staticClass:"content-list"},t._l(t.sketches,(function(e){return s("li",{key:e.id,staticClass:"list-item",staticStyle:{padding:"20px"}},[s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-8"},[s("router-link",{attrs:{to:{name:"SketchOverview",params:{sketchId:e.id}}}},[s("strong",[t._v(t._s(e.name))])]),s("div",{staticClass:"description"},[t._v(t._s(e.description))])],1),s("div",{staticClass:"column"},[s("strong",{staticStyle:{color:"var(--default-font-color)"}},[t._v("Created by:")]),t._v(" "+t._s(e.user)+"\n          "),s("div",{staticStyle:{"font-size":"0.9em"}},[t._v(t._s(t._f("moment")(e.created_at,"YYYY-MM-DD")))])]),s("div",{staticClass:"column",staticStyle:{"text-align":"right"}},[s("span",{staticClass:"button is-small is-rounded is-light",staticStyle:{"border-radius":"20px","margin-top":"10px"}},["archived"===e.status?s("span",[t._v("\n              Archived\n            ")]):e.last_activity?s("span",[t._v("\n              Active "+t._s(t.$moment.utc(e.last_activity).local().fromNow())+"\n            ")]):e.last_activity?t._e():s("span",[t._v("\n              No activity yet\n            ")])]),s("div")])])])})),0),s("br"),t.numSketches>t.perPage?s("b-pagination",{staticClass:"is-right",attrs:{total:t.numSketches,simple:!0,"per-page":t.perPage,size:"is-small"},on:{change:t.paginate},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1)}),b=[],C=s("bc3a"),k=s.n(C),S=s("aced"),w=s("2c4e"),x=k.a.create({baseURL:"/api/v1",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}}),T=k.a.create({baseURL:"/api/v1",responseType:"blob",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}});x.interceptors.response.use((function(t){return t}),(function(t){return"The CSRF token has expired"===t.response.data.message?w["a"].open({message:t.response.data.message,type:"is-white",position:"is-top",actionText:"Refresh",indefinite:!0,onAction:function(){location.reload()}}):S["a"].open(t.response.data.message),Promise.reject(t)}));var E={getSketchList:function(t,e,s){var i={params:{scope:t,page:e,search_query:s}};return x.get("/sketches/",i)},getSketch:function(t){return x.get("/sketches/"+t+"/")},createSketch:function(t){return x.post("/sketches/",t)},deleteSketch:function(t){return x.delete("/sketches/"+t+"/")},archiveSketch:function(t){var e={action:"archive"};return x.post("/sketches/"+t+"/archive/",e)},unArchiveSketch:function(t){var e={action:"unarchive"};return x.post("/sketches/"+t+"/archive/",e)},exportSketch:function(t){var e={action:"export"};return T.post("/sketches/"+t+"/archive/",e)},getSketchTimeline:function(t,e){return x.get("/sketches/"+t+"/timelines/"+e+"/")},getSketchTimelineAnalysis:function(t,e){return x.get("/sketches/"+t+"/timelines/"+e+"/analysis/")},saveSketchTimeline:function(t,e,s,i,a){var n={name:s,description:i,color:a};return x.post("/sketches/"+t+/timelines/+e+"/",n)},saveSketchSummary:function(t,e,s){var i={name:e,description:s};return x.post("/sketches/"+t+"/",i)},deleteSketchTimeline:function(t,e){return x.delete("/sketches/"+t+/timelines/+e+"/")},getEvent:function(t,e,s){var i={params:{searchindex_id:e,event_id:s}};return x.get("/sketches/"+t+"/event/",i)},saveEventAnnotation:function(t,e,s,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n={annotation:s,annotation_type:e,events:i,remove:a};return x.post("/sketches/"+t+"/event/annotate/",n)},getStoryList:function(t){return x.get("sketches/"+t+"/stories/")},getStory:function(t,e){return x.get("/sketches/"+t+"/stories/"+e+"/")},createStory:function(t,e,s){var i={title:t,content:e};return x.post("/sketches/"+s+/stories/,i)},updateStory:function(t,e,s,i){var a={title:t,content:e};return x.post("/sketches/"+s+/stories/+i+"/",a)},deleteStory:function(t,e){return x.delete("/sketches/"+t+/stories/+e+"/")},getView:function(t,e){return x.get("/sketches/"+t+"/views/"+e+"/")},createView:function(t,e,s,i){var a={name:e,query:s,filter:i,dsl:""};return x.post("/sketches/"+t+/views/,a)},updateView:function(t,e,s,i){var a={query:s,filter:i};return x.post("/sketches/"+t+/views/+e+"/",a)},deleteView:function(t,e){return x.delete("/sketches/"+t+"/views/"+e+"/")},search:function(t,e){return x.post("/sketches/"+t+"/explore/",e)},exportSearchResult:function(t,e){return T.post("/sketches/"+t+"/explore/",e)},getAggregations:function(t){return x.get("/sketches/"+t+"/aggregation/")},getAggregationGroups:function(t){return x.get("/sketches/"+t+"/aggregation/group/")},runAggregator:function(t,e){return x.post("/sketches/"+t+"/aggregation/explore/",e)},runAggregatorGroup:function(t,e){return x.get("/sketches/"+t+"/aggregation/group/"+e+"/")},saveAggregation:function(t,e,s,i){var a={name:s,description:e.description,agg_type:e.name,chart_type:i["supported_charts"],parameters:i};return x.post("/sketches/"+t+"/aggregation/",a)},countSketchEvents:function(t){return x.get("/sketches/"+t+"/count/")},uploadTimeline:function(t,e){return x.post("/upload/",t,e)},getSessions:function(t,e){return x.get("/sketches/"+t+"/explore/sessions/"+e+"/")},getUsers:function(){return x.get("/users/")},getGroups:function(){return x.get("/groups/")},editCollaborators:function(t,e,s,i,a,n){var r={public:e,users:s,groups:i,remove_users:a,remove_groups:n};return x.post("/sketches/"+t+/collaborators/,r)},getAnalyzers:function(t){return x.get("/sketches/"+t+"/analyzer/")},runAnalyzers:function(t,e,s){var i={timeline_ids:e,analyzer_names:s};return x.post("/sketches/"+t+/analyzer/,i)},getAnalyzerSession:function(t,e){return x.get("/sketches/"+t+"/analyzer/sessions/"+e+"/")},getActiveAnalyzerSessions:function(t){return x.get("/sketches/"+t+"/analyzer/sessions/active/")},getLoggedInUser:function(){return x.get("/users/me/")},generateGraphFromPlugin:function(t,e,s,i){var a={plugin:e,config:{filter:{indices:s}},refresh:i};return x.post("/sketches/"+t+/graph/,a)},getGraphPluginList:function(){return x.get("/graphs/")},saveGraph:function(t,e,s){var i={name:e,elements:s};return x.post("/sketches/"+t+/graphs/,i)},getSavedGraphList:function(t){return x.get("/sketches/"+t+/graphs/)},getSavedGraph:function(t,e){var s={params:{format:"cytoscape"}};return x.get("/sketches/"+t+/graphs/+e+"/",s)}},$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ul",{staticClass:"content-list"},t._l(t.meta.stories,(function(e){return s("li",{key:e.id,staticStyle:{padding:"10px","border-bottom":"none"}},[s("div",[s("router-link",{attrs:{to:{name:"SketchStoryContent",params:{sketchId:t.sketch.id,storyId:e.id}}}},[s("strong",[t._v(t._s(e.title))])]),s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{"margin-top":"10px"}},[s("p",{staticClass:"control"},[t.controls?s("button",{staticClass:"button is-small is-rounded is-danger",on:{click:function(s){return t.remove(e)}}},[t._m(0,!0),s("span",[t._v("Remove")])]):t._e()])]),s("br"),s("span",{staticClass:"is-size-7"},[t._v("Last activity "+t._s(t._f("moment")(e.updated_at,"YYYY-MM-DD HH:mm")))])],1)])})),0)])},D=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-trash"})])}],A={props:["controls"],data:function(){return{stories:[]}},methods:{remove:function(t){var e=this;E.deleteStory(this.sketch.id,t.id).then((function(t){e.$store.dispatch("updateSketch",e.sketch.id)})).catch((function(t){console.error(t)}))}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}}},O=A,F=Object(c["a"])(O,$,D,!1,null,"10f28821",null),N=F.exports,P={components:{StoryList:N},props:["scope","searchQuery"],data:function(){return{sketches:[],numSketches:0,currentPage:1,perPage:10}},methods:{getSketches:function(){var t=this;E.getSketchList(this.scope,this.currentPage,this.searchQuery).then((function(e){t.sketches=e.data.objects,t.numSketches=e.data.meta.total_items})).catch((function(t){console.error(t)}))},paginate:function(){this.getSketches()}},created:function(){this.getSketches()},watch:{searchQuery:function(){"search"===this.scope&&this.getSketches()}}},j=P,M=(s("747d"),Object(c["a"])(j,y,b,!1,null,"be699246",null)),L=M.exports,I=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm(e)}}},[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Name")]),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Name your sketch",autofocus:""},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}})])]),s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Description (optional)")]),s("div",{staticClass:"control"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.description,expression:"form.description"}],staticClass:"textarea",attrs:{placeholder:"Describe your sketch"},domProps:{value:t.form.description},on:{input:function(e){e.target.composing||t.$set(t.form,"description",e.target.value)}}})])]),t._m(0)])},z=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save"}})])])}],R={data:function(){return{form:{name:"",description:""}}},methods:{clearFormData:function(){this.form.name="",this.form.description=""},submitForm:function(){var t=this,e={name:this.form.name,description:this.form.description};E.createSketch(e).then((function(e){var s=e.data.objects[0].id;t.clearFormData(),t.$router.push({name:"SketchOverview",params:{sketchId:s}})})).catch((function(t){}))}}},Q=R,G=Object(c["a"])(Q,I,z,!1,null,null,null),V=G.exports,q=s("f7e3"),U={components:{TsNavbarMain:q["default"],TsSketchList:L,TsCreateSketchForm:V},data:function(){return{showSketchCreateModal:!1,allSketches:[],mySketches:[],myArchivedSketches:[],sharedSketches:[],loading:!0,isFullPage:!0,loadingComponent:null,searchQuery:"",newSearchQuery:""}},computed:{filteredList:function(){var t=this;return this.allSketches.filter((function(e){return e.name.toLowerCase().includes(t.search.toLowerCase())}))}},methods:{loadingOpen:function(){this.loading=!0,this.loadingComponent=this.$buefy.loading.open({container:this.isFullPage?null:this.$refs.element.$el})},loadingClose:function(){this.loading=!1,this.loadingComponent.close()},search:function(){this.newSearchQuery=this.searchQuery}},created:function(){this.$store.dispatch("resetState"),document.title="Timesketch"}},Y=U,H=Object(c["a"])(Y,g,_,!1,null,null,null),J=H.exports,B=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.sketch.status?s("router-view"):t._e()},W=[],Z={props:["sketchId"],created:function(){this.$store.dispatch("updateSketch",this.sketchId)},computed:{sketch:function(){return this.$store.state.sketch}},watch:{sketch:function(t){"archived"===t.status[0].status&&this.$router.push({name:"SketchOverview",params:{sketchId:this.sketch.id}}),document.title=this.sketch.name}}},K=Z,X=Object(c["a"])(K,B,W,!1,null,null,null),tt=X.exports,et=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.sketch.status?s("div",[s("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}],null,!1,4238446144)}),t.isArchived?s("div",{staticClass:"task-container columns is-multiline",staticStyle:{"margin-top":"50px"}},[s("div",{staticClass:"card column is-half is-offset-one-quarter has-text-centered",staticStyle:{"min-height":"300px","padding-top":"90px"}},[s("h4",{staticClass:"title is-4"},[t._v(t._s(t.sketch.name))]),s("p",[t._v("This sketch has been archived")]),s("div",{staticClass:"buttons is-centered",staticStyle:{"margin-top":"30px"}},[s("button",{staticClass:"button is-success is-outlined",on:{click:function(e){return t.unArchiveSketch()}}},[t._v("Unarchive")]),s("button",{staticClass:"button is-link is-outlined",on:{click:function(e){return t.exportSketch()}}},[t._v("Export")])])])]):t._e(),t.isArchived?t._e():s("div",[s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"overview"}},[t._l(t.meta.sketch_labels,(function(e){return s("span",{key:e,staticStyle:{"margin-right":"10px",color:"var(--default-font-color)","font-size":"0.7em"}},[t._v(t._s(e))])})),t.meta.collaborators?s("b-tooltip",{attrs:{label:t.shareTooltip,position:"is-bottom",type:"is-white"}},[t.meta.permissions.write?s("a",{staticClass:"button is-info",staticStyle:{"margin-right":"10px"},on:{click:function(e){t.showShareModal=!t.showShareModal}}},[s("span",{staticClass:"icon is-small"},[t.meta.permissions.public?s("i",{staticClass:"fas fa-globe"}):t.meta.collaborators.users.length||t.meta.collaborators.groups.length?s("i",{staticClass:"fas fa-users"}):t.meta.permissions.public?t._e():s("i",{staticClass:"fas fa-lock"})]),s("span",[t._v("Share")])]):t._e()]):t._e(),t.meta.permissions.write?s("b-dropdown",{attrs:{"aria-role":"list","append-to-body":"",position:"is-bottom-left"},scopedSlots:t._u([{key:"trigger",fn:function(e){var i=e.active;return s("a",{staticClass:"button ts-dropdown-button",staticStyle:{background:"transparent",border:"none"}},[s("span",{staticClass:"icon is-small"},[s("i",{class:i?"fas fa-angle-up":"fas fa-angle-down"})]),s("span",[t._v("More")])])}}],null,!1,3531563132)},[t.meta.permissions.delete?s("b-dropdown-item",{attrs:{"aria-role":"listitem"}},[s("a",{staticClass:"dropdown-item",on:{click:function(e){t.showDeleteSketchModal=!t.showDeleteSketchModal}}},[s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-trash"})]),s("span",[t._v("Delete")])])]):t._e(),t.meta.permissions.delete?s("b-dropdown-item",{attrs:{"aria-role":"listitem"}},[s("a",{staticClass:"dropdown-item",on:{click:t.archiveSketch}},[s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-archive"})]),s("span",[t._v("Archive")])])]):t._e(),t.meta.permissions.read?s("b-dropdown-item",{attrs:{"aria-role":"listitem"}},[s("a",{staticClass:"dropdown-item",on:{click:function(e){return t.exportSketch()}}},[s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-file-export"})]),s("span",[t._v("Export")])])]):t._e()],1):t._e()],2)],1)]),s("b-modal",{attrs:{active:t.showShareModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showShareModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Share sketch")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("ts-share-form",{on:{closeShareModal:t.closeShareModal}})],1)])])]),s("b-modal",{attrs:{active:t.showUploadTimelineModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showUploadTimelineModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Upload new timeline")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("p",[t._v("\n              Supported formats are Plaso storage file, JSONL, or a CSV file.\n              If you are uploading a CSV or JSONL file make sure to read the "),s("a",{attrs:{href:"https://github.com/google/timesketch/blob/master/docs/Users-Guide.md#adding-timelines",rel:"noreferrer",target:"_blank"}},[t._v("documentation")]),t._v(" to learn what columns are needed.\n            ")]),s("ts-upload-timeline-form",{on:{toggleModal:function(e){t.showUploadTimelineModal=!t.showUploadTimelineModal}}})],1)])])]),s("b-modal",{attrs:{active:t.showDeleteSketchModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showDeleteSketchModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Delete sketch")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("p",[t._v("Are you sure you want to delete this sketch?")]),s("div",{staticClass:"field is-grouped"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-danger",on:{click:t.deleteSketch}},[s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-trash"})]),s("span",[t._v("Delete")])])]),s("p",{staticClass:"control"},[s("button",{staticClass:"button",on:{click:function(e){t.showDeleteSketchModal=!t.showDeleteSketchModal}}},[s("span",[t._v("I changed my mind, keep the sketch!")])])])])])])])]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"tile is-ancestor"},[s("div",{staticClass:"tile is-8 is-parent"},[s("div",{staticClass:"tile is-child tile-box"},[s("div",{staticClass:"card-content"},[s("ts-sketch-summary",{attrs:{sketch:t.sketch}}),s("br"),s("b-field",{attrs:{grouped:"","group-multiline":""}},[t._l(t.sortedUserList(),(function(e){return s("div",{key:e.name,staticClass:"control"},[s("b-tag",{attrs:{attached:"",size:"is-medium"}},[t._v(t._s(e))])],1)})),t._l(t.sortedGroupList(),(function(e){return s("div",{key:e.name,staticClass:"control"},[s("b-tag",{attrs:{attached:"",size:"is-medium"}},[t._v(t._s(e))])],1)}))],2)],1)])]),s("div",{staticClass:"tile is-parent"},[s("div",{staticClass:"tile is-child tile-box"},[t._m(0),s("div",{staticStyle:{padding:"1.25em"}},[t._v("\n                Creator: "+t._s(t.sketch.user.username)+"\n              ")])])])])])]),t.sketch.active_timelines.length?s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"tile-box"},[s("div",{staticStyle:{padding:"1.25em"}},[s("ts-sketch-metrics",{attrs:{timelines:t.sketch.active_timelines,views:t.meta.views,stories:t.meta.stories,count:t.count}})],1)])])]):t._e(),t.sketch.timelines&&t.sketch.timelines.length&&t.sketch.timelines.length?s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"tile is-ancestor"},[s("div",{staticClass:"tile is-vertical is-12"},[s("div",{staticClass:"tile"},[s("div",{staticClass:"tile is-parent is-vertical"},[t.sketch.timelines&&t.sketch.timelines.length&&t.sketch.timelines.length?s("div",{staticClass:"tile is-child tile-box"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Timelines")]),s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{padding:"0.75rem"}},[t.meta.permissions.write?s("p",{staticClass:"control"},[s("button",{staticClass:"button is-success is-rounded is-small",on:{click:function(e){t.showUploadTimelineModal=!t.showUploadTimelineModal}}},[t._m(1),s("span",[t._v("Upload timeline")])])]):t._e(),s("p",{staticClass:"control"},[s("router-link",{staticClass:"button is-rounded is-small",attrs:{to:{name:"SketchManageTimelines"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-cog"})]),s("span",[t._v("Manage")])])],1)])]),s("div",{staticStyle:{padding:"1.25em"}},[s("ts-timeline-list",{attrs:{timelines:t.sketch.timelines,controls:!1,"is-compact":!0}}),t.sketch.timelines.length>9?s("ul",{staticClass:"content-list"},[s("li",{staticStyle:{padding:"10px"}},[s("router-link",{attrs:{to:{name:"SketchManageTimelines"}}},[s("span",[t._v("There are "+t._s(t.sketch.timelines.length-10)+" more timelines in this sketch. "),s("span",{staticStyle:{"text-decoration":"underline"}},[t._v("Click here to see them all")])])])],1)]):t._e()],1)]):t._e(),t.meta.stories.length?s("div",{staticClass:"tile is-child tile-box"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Stories")]),s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{padding:"0.75rem"}},[s("p",{staticClass:"control"},[s("router-link",{staticClass:"button is-rounded is-small is-success",attrs:{to:{name:"SketchStoryOverview"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-plus-circle"})]),s("span",[t._v("Create story")])])],1)])]),s("div",{staticStyle:{padding:"1.25em"}},[t.meta.stories.length?t._e():s("span",[t._v("No stories")]),s("ts-sketch-story-list",{attrs:{controls:!1}})],1)]):t._e()]),s("div",{staticClass:"tile is-parent is-vertical"},[t.meta.views.length||t.sketch.graphs.length?t._e():s("div",{staticClass:"tile is-child tile-box"},[t._m(2),s("div",{staticStyle:{padding:"1.25em"}},[s("p",[t._v("\n                      Welcome to your new investigation.\n                      You get started by navigating to the "),s("router-link",{staticStyle:{"text-decoration":"underline"},attrs:{to:{name:"SketchExplore"}}},[t._v("explore page")]),t._v(" where you can navigate your timelines, use search queries,\n                      apply filters, view timeline data and save your search discoveries as new saved searches.\n                    ")],1),s("br"),s("router-link",{staticClass:"button is-success",attrs:{to:{name:"SketchExplore"}}},[s("span",[t._v("Begin to explore your data")]),s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-chevron-circle-right"})])])],1)]),t.meta.views.length?s("div",{staticClass:"tile is-child tile-box"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Saved searches")]),s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{padding:"0.75rem"}},[t.meta.views.length?s("p",{staticClass:"control"},[s("router-link",{staticClass:"button is-rounded is-small",attrs:{to:{name:"SketchManageViews"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-cog"})]),s("span",[t._v("Manage")])])],1):t._e()])]),s("div",{staticStyle:{padding:"1.25em"}},[t.meta.views.length?t._e():s("span",[t._v("No saved searches")]),s("ts-saved-view-list",{attrs:{views:t.meta.views}})],1)]):t._e(),t.sketch.graphs.length?s("div",{staticClass:"tile is-child tile-box"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Saved graphs")]),s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{padding:"0.75rem"}},[s("p",{staticClass:"control"},[s("router-link",{staticClass:"button is-rounded is-small is-success",attrs:{to:{name:"SketchGraphOverview"}}},[s("span",[t._v("Explore all graphs")]),s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-chevron-circle-right"})])])],1)])]),s("div",{staticStyle:{padding:"1.25em"}},[s("ts-graph-list")],1)]):t._e()])])])])])]):t._e(),t.sketch.timelines.length?t._e():s("ts-sketch-timelines-manage",{attrs:{"hide-navigation":!0}})],1)],1):t._e()},st=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Metadata")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-upload"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Get started!")]),s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{padding:"0.75rem"}})])}],it=(s("55dd"),s("75fc")),at=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("h4",{staticClass:"title is-4",attrs:{contenteditable:t.meta.permissions.write},domProps:{textContent:t._s(t.sketch.name)},on:{blur:t.onEditTitle,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.onEditTitle(e))}}}),s("p",{staticStyle:{"max-width":"75ch"},attrs:{contenteditable:t.meta.permissions.write},domProps:{textContent:t._s(t.sketch.description)},on:{blur:t.onEditDescription,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.onEditDescription(e))}}})])},nt=[],rt={computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{onEditTitle:function(t){this.sketch.name=t.target.innerText,this.saveSketchSummary()},onEditDescription:function(t){this.sketch.description=t.target.innerText,this.saveSketchSummary()},saveSketchSummary:function(){E.saveSketchSummary(this.sketch.id,this.sketch.name,this.sketch.description).then((function(t){})).catch((function(t){console.error(t)}))}}},ot=rt,ct=Object(c["a"])(ot,at,nt,!1,null,null,null),lt=ct.exports,ut=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("nav",{staticClass:"level"},[s("div",{staticClass:"level-item has-text-centered"},[s("div",[s("p",{staticClass:"heading"},[t._v("Timelines")]),s("p",{staticClass:"title"},[t._v(t._s(t.timelines&&t.timelines.length?t.timelines.length:0))])])]),s("div",{staticClass:"level-item has-text-centered"},[s("div",[s("p",{staticClass:"heading"},[t._v("Views")]),s("p",{staticClass:"title"},[t._v(t._s(t.views&&t.views.length?t.views.length:0))])])]),s("div",{staticClass:"level-item has-text-centered"},[s("div",[s("p",{staticClass:"heading"},[t._v("Stories")]),s("p",{staticClass:"title"},[t._v(t._s(t.views&&t.stories.length?t.stories.length:0))])])]),s("div",{staticClass:"level-item has-text-centered"},[s("div",[s("p",{staticClass:"heading"},[t._v("Events")]),s("p",{staticClass:"title"},[t._v(t._s(t._f("compactNumber")(t.count)))])])])])},dt=[],ht={props:["timelines","views","stories","count"]},mt=ht,pt=Object(c["a"])(mt,ut,dt,!1,null,null,null),ft=pt.exports,vt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",{staticClass:"content-list"},t._l(t.timelineList,(function(e){return s("li",{key:e.id,staticStyle:{padding:"10px"}},[s("ts-timeline-list-item",{attrs:{timeline:e,controls:t.controls,"is-compact":t.isCompact},on:{remove:function(s){return t.remove(e)},save:function(s){return t.save(e)}}})],1)})),0)},gt=[],_t=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("b-modal",{attrs:{active:t.showInfoModal,width:1024,scroll:"keep"},on:{"update:active":function(e){t.showInfoModal=e}}},[s("div",{staticClass:"modal-background"}),s("div",{staticClass:"modal-content"},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Detailed information for "+t._s(t.timeline.name))])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("ul",[s("li",[t._v("Elasticsearch index: "+t._s(t.timeline.searchindex.index_name))]),t.meta.stats_per_timeline[t.timeline.id]?s("li",[t._v("Number of events: "+t._s(t._f("compactNumber")(t.meta.stats_per_timeline[t.timeline.id]["count"]))+" ("+t._s(t.meta.stats_per_timeline[t.timeline.id]["count"])+")")]):t._e(),s("li",[t._v("Added by: "+t._s(t.timeline.user.username))]),s("li",[t._v("Added: "+t._s(t._f("moment")(t.timeline.created_at,"YYYY-MM-DD HH:mm")))]),"ready"===t.timelineStatus&&""!==t.timeline.searchindex.description&&t.timeline.searchindex.description!==t.timeline.name?s("li",[t._v("Import errors: "),s("b",[t._v(t._s(t.timeline.searchindex.description))])]):t._e()]),"fail"===t.timelineStatus?s("span",[s("h5",{staticStyle:{color:"red"}},[t._v("Error detail")]),s("pre",[t._v(t._s(t.timeline.description))])]):t._e()])])])]),s("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){t.showInfoModal=!t.showInfoModal}}})]),t.controls?s("b-modal",{attrs:{active:t.showEditModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showEditModal=e}}},[s("div",{staticClass:"modal-background"}),s("div",{staticClass:"modal-content"},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Rename timeline")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.saveTimeline(e)}}},[s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.timeline.name,expression:"timeline.name"}],staticClass:"input",attrs:{type:"text",required:"",autofocus:""},domProps:{value:t.timeline.name},on:{input:function(e){e.target.composing||t.$set(t.timeline,"name",e.target.value)}}})])]),s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save"}})])])])])])])]),s("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){t.showEditModal=!t.showEditModal}}})]):t._e(),"processing"===t.timelineStatus?s("div",{staticClass:"ts-timeline-color-box is-pulled-left blink",staticStyle:{"background-color":"#f5f5f5"}}):"fail"===t.timelineStatus?s("div",{staticClass:"ts-timeline-color-box is-pulled-left",staticStyle:{"background-color":"#f5f5f5"},on:{click:function(e){t.showInfoModal=!t.showInfoModal}}}):"ready"===t.timelineStatus&&t.controls?s("div",{staticClass:"dropdown is-pulled-left",class:{"is-active":t.colorPickerActive}},[s("div",{staticClass:"dropdown-trigger"},[s("div",{staticClass:"ts-timeline-color-box",style:t.timelineColorStyle,on:{click:function(e){t.colorPickerActive=!t.colorPickerActive}}})]),s("div",{staticClass:"dropdown-menu",attrs:{id:"dropdown-menu",role:"menu"}},[s("div",{staticClass:"dropdown-content",staticStyle:{padding:"0"}},[s("div",{staticClass:"dropdown-item",staticStyle:{padding:"0"}},[s("color-picker",{on:{input:t.updateColor},model:{value:t.initialColor,callback:function(e){t.initialColor=e},expression:"initialColor"}})],1)])])]):"ready"===t.timelineStatus?s("div",{staticClass:"ts-timeline-color-box is-pulled-left",style:t.timelineColorStyle,on:{click:function(e){t.colorPickerActive=!t.colorPickerActive}}}):s("div",{staticClass:"ts-timeline-color-box is-pulled-left",staticStyle:{"background-color":"#f5f5f5"}}),t.controls?t._e():s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{"margin-top":"10px"}},[s("span",{staticClass:"is-size-7"},[t._v(t._s(t._f("moment")(t.timeline.updated_at,"YYYY-MM-DD HH:mm")))])]),t.controls?s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{"margin-top":"10px"}},[t.isCompact?t._e():s("p",{staticClass:"control"},[s("button",{staticClass:"button is-rounded is-small is-outlined",on:{click:function(e){t.showInfoModal=!t.showInfoModal}}},[t._m(0),s("span",[t._v("Info")])])]),t.meta.permissions.write&&"ready"===t.timelineStatus&&t.controls?s("p",{staticClass:"control"},[s("button",{staticClass:"button is-rounded is-small is-outlined",on:{click:function(e){t.showEditModal=!t.showEditModal}}},[t._m(1),s("span",[t._v("Rename")])])]):t._e(),"ready"===t.timelineStatus&&t.controls?s("p",{staticClass:"control"},[s("button",{staticClass:"button is-small is-rounded is-outlined",on:{click:function(e){t.showAnalysisHistory=!t.showAnalysisHistory}}},[t._m(2),s("span",[t._v("Analysis History")])])]):t._e(),t.meta.permissions.write&&t.controls?s("p",{staticClass:"control"},[s("button",{staticClass:"button is-small is-rounded is-danger",on:{click:function(e){return t.remove(t.timeline)}}},[t._m(3),s("span",[t._v("Remove")])])]):t._e()]):t._e(),"ready"===t.timelineStatus?s("router-link",{attrs:{to:{name:"SketchExplore",query:{timeline:t.timeline.id}}}},[s("strong",[t._v(t._s(t.timeline.name))])]):t._e(),"ready"!==t.timelineStatus?s("strong",[t._v(t._s(t.timeline.name))]):t._e(),s("br"),"ready"===t.timelineStatus?s("span",{staticClass:"is-size-7"},[s("span",{staticClass:"is-small",attrs:{title:t.meta.stats_per_timeline[t.timeline.id]["count"]+" events in index"}},[t._v(t._s(t._f("compactNumber")(t.meta.stats_per_timeline[t.timeline.id]["count"]))+" events")])]):"fail"===t.timelineStatus?s("span",{staticClass:"is-size-7"},[t._v("\n    ERROR: "),s("span",{staticStyle:{cursor:"pointer","text-decoration":"underline"},on:{click:function(e){t.showInfoModal=!t.showInfoModal}}},[t._v("Click here for details")])]):"processing"===t.timelineStatus?s("span",{staticClass:"is-size-7"},[t._v("\n    Indexing in progress...\n  ")]):s("span",{staticClass:"is-size-7"},[t._v("\n    Unknown status: "+t._s(t.timelineStatus)+"\n  ")]),t.showAnalysisHistory?s("div",[s("ts-analyzer-history",{attrs:{timeline:t.timeline},on:{closeHistory:function(e){t.showAnalysisHistory=!1}}})],1):t._e()],1)},yt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-info-circle"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-edit"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-history"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-trash"})])}],bt=(s("f559"),s("c345")),Ct=s("2ef0"),kt=s.n(Ct),St=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card card-accent-background",staticStyle:{"margin-top":"15px"}},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("\n      "+t._s(t.messageTitle)+" ["),t._l(t.timelines,(function(e){return s("span",{key:e},[t._v(t._s(e))])})),t._v("]\n    ")],2),s("span",{staticClass:"card-header-icon",attrs:{"aria-label":"close"}},[s("span",{staticClass:"delete",on:{click:function(e){return t.$emit("closeDetail")}}})])]),s("div",{staticClass:"card-content"},[s("table",{staticClass:"table is-fullwidth"},[t._m(0),s("tbody",t._l(t.tableData,(function(e,i){return s("tr",{key:i},[s("td",[s("div",{class:{pending:"PENDING"===e.status,done:"DONE"===e.status,started:"STARTED"===e.status,error:"ERROR"===e.status},staticStyle:{width:"10px",height:"10px","border-radius":"100%","margin-top":"6px","margin-left":"3px"}})]),s("td",[t._v(t._s(e.analyzer))]),s("td",[t._v(t._s(e.result))]),s("td",[t._v(t._s(e.timeline.name))])])})),0)])])])},wt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("th"),s("th",[t._v("Analyzer")]),s("th",[t._v("Result")]),s("th",[t._v("Timeline")])])}],xt=(s("5df3"),s("4f7f"),s("ac6a"),{props:["session"],data:function(){return{analysisSession:{},analyses:[],autoRefresh:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},totalAnalyzers:function(){return this.analyses.length},finishedAnalyzers:function(){var t=0;return this.analyses.forEach((function(e){"DONE"!==e.status[0].status&&"ERROR"!==e.status[0].status||(t+=1)})),t},timelines:function(){var t=new Set;return this.analyses.forEach((function(e){t.add(e.timeline.name)})),t},tableData:function(){var t=[];return this.analyses.forEach((function(e){var s={};s.status=e.status[0].status,s.analyzer=e.analyzer_name,s.result=e.result,s.timeline=e.timeline,t.push(s)})),t},messageTitle:function(){return this.finishedAnalyzers+"/"+this.totalAnalyzers+" analyzers done"}},methods:{fetchData:function(){var t=this;E.getAnalyzerSession(this.sketch.id,this.session.id).then((function(e){t.analysisSession=e.data.objects[0],t.analyses=e.data.objects[0].analyses,t.autoRefresh=!0})).catch((function(t){}))}},beforeDestroy:function(){clearInterval(this.t),this.t=!1},created:function(){this.analysisSession=this.session,this.analyses=this.session.analyses,this.autoRefresh=!0},watch:{autoRefresh:function(t){t&&!this.t?this.t=setInterval(function(){this.fetchData(),this.finishedAnalyzers===this.totalAnalyzers&&(this.autoRefresh=!1)}.bind(this),5e3):(clearInterval(this.t),this.t=!1)}}}),Tt=xt,Et=(s("f484"),Object(c["a"])(Tt,St,wt,!1,null,"449f6045",null)),$t=Et.exports,Dt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card card-accent-background",staticStyle:{"margin-top":"15px"}},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("\n      Analysis history\n    ")]),s("span",{staticClass:"card-header-icon",attrs:{"aria-label":"close"}},[s("span",{staticClass:"delete",on:{click:function(e){return t.$emit("closeHistory")}}})])]),s("div",{staticClass:"card-content"},[t.analyses?s("b-table",{attrs:{data:t.analyses,"current-page":t.currentPage,"per-page":t.perPage,paginated:"","pagination-simple":"","pagination-position":"bottom","default-sort-direction":"desc","sort-icon":"arrow-down","sort-icon-size":"is-small","icon-pack":"fas","icon-prev":"chevron-left","icon-next":"chevron-right","default-sort":"created_at"},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}},[s("b-table-column",{attrs:{field:"created_at",label:"Date",width:"150",sortable:"","custom-sort":"dateSort"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("moment")(new Date(e.row.created_at),"YYYY-MM-DD HH:mm"))+"\n      ")]}}],null,!1,2703642433)}),s("b-table-column",{attrs:{field:"name",label:"Analyzer"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.analyzer_name)+"\n      ")]}}],null,!1,2798663795)}),s("b-table-column",{attrs:{field:"result",label:"Result"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.result)+"\n      ")]}}],null,!1,656249812)}),s("b-table-column",{attrs:{field:"status",label:"Status",width:"40"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.status[0].status)+"\n      ")]}}],null,!1,3012980133)})],1):t._e(),t.analyses?t._e():s("span",[t._v("No analysis available.")])],1)])},At=[],Ot={props:["timeline"],data:function(){return{analyses:[],currentPage:1,perPage:5}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{dateSort:function(t,e,s){return t[s]-e[s]}},created:function(){var t=this;E.getSketchTimelineAnalysis(this.sketch.id,this.timeline.id).then((function(e){t.analyses=e.data.objects[0]})).catch((function(t){}))}},Ft=Ot,Nt=Object(c["a"])(Ft,Dt,At,!1,null,null,null),Pt=Nt.exports,jt={components:{"color-picker":bt["Chrome"],TsAnalyzerSessionDetail:$t,TsAnalyzerHistory:Pt},props:["timeline","controls","isCompact"],data:function(){return{checkedDataTypes:[],initialColor:{},newColor:"",newTimelineName:"",colorPickerActive:!1,showInfoModal:!1,showEditModal:!1,analysisSessionId:!1,showAnalysisDetail:!1,showAnalysisHistory:!1,timelineStatus:null,autoRefresh:!1,isOpen:!1,isDarkTheme:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},timelineColorStyle:function(){var t=this.newColor||this.timeline.color;return t.startsWith("#")||(t="#"+t),this.isDarkTheme?{"background-color":t,filter:"grayscale(25%)",color:"#333"}:{"background-color":t}}},methods:{remove:function(t){this.$emit("remove",t)},updateColor:kt.a.debounce((function(t){this.newColor=t.hex,this.newColor.startsWith("#")&&(this.newColor=this.newColor.substring(1)),i["default"].set(this.timeline,"color",this.newColor),this.$emit("save",this.timeline)}),300),saveTimeline:function(){this.showEditModal=!1,this.$emit("save",this.timeline)},fetchData:function(){var t=this;E.getSketchTimeline(this.sketch.id,this.timeline.id).then((function(e){t.timelineStatus=e.data.objects[0].status[0].status,"ready"!==t.timelineStatus&&(t.autoRefresh=!0),t.$store.dispatch("updateSketch",t.$store.state.sketch.id)})).catch((function(t){}))},openFilteredTimeline:function(t,e){if(0===e.length)return!1;for(var s="",i=0;i<e.length;i++){var a=e[i];0!=i&&(s+=" OR "),s+='data_type:"'+a+'"'}this.$router.push({name:"SketchExplore",query:{index:t,q:s}})},toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme}},mounted:function(){var t=this;window.addEventListener("click",(function(e){t.$el.contains(e.target)||(t.colorPickerActive=!1)}))},created:function(){this.isDarkTheme="dark"===localStorage.theme,Xn.$on("isDarkTheme",this.toggleTheme),this.initialColor={hex:this.timeline.color},this.timelineStatus=this.timeline.status[0].status,"ready"!==this.timelineStatus&&(this.autoRefresh=!0)},beforeDestroy:function(){clearInterval(this.t),this.t=!1},watch:{autoRefresh:function(t){t&&!this.t?this.t=setInterval(function(){this.fetchData(),"ready"===this.timelineStatus&&(this.autoRefresh=!1)}.bind(this),5e3):(clearInterval(this.t),this.t=!1)}}},Mt=jt,Lt=(s("c1e9"),Object(c["a"])(Mt,_t,yt,!1,null,"67d4981a",null)),It=Lt.exports,zt={components:{TsTimelineListItem:It},props:["timelines","controls","isCompact"],computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},timelineList:function(){return this.isCompact&&this.timelines.length>9?this.timelines.reverse().slice(0,10):this.timelines.reverse()}},methods:{remove:function(t){var e=this;E.deleteSketchTimeline(this.sketch.id,t.id).then((function(t){e.$store.dispatch("updateSketch",e.sketch.id)})).catch((function(t){console.error(t)}))},save:function(t){var e=this;E.saveSketchTimeline(this.sketch.id,t.id,t.name,t.description,t.color).then((function(t){e.$store.dispatch("updateSketch",e.sketch.id)})).catch((function(t){console.error(t)}))}}},Rt=zt,Qt=Object(c["a"])(Rt,vt,gt,!1,null,null,null),Gt=Qt.exports,Vt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ul",{staticClass:"content-list"},t._l(t.views,(function(e,i){return s("li",{key:e.id,staticStyle:{padding:"10px","border-bottom":"none"}},[s("router-link",{attrs:{to:{name:"SketchExplore",query:{view:e.id}}}},[s("strong",[t._v(t._s(e.name))])]),s("br"),t.controls?t._e():s("span",{staticClass:"is-size-7"},[t._v("\n        Created "+t._s(t._f("moment")(e.created_at,"YYYY-MM-DD HH:mm"))+" "),e.user?s("span",[t._v(" by "+t._s(e.user))]):t._e(),e.description?s("span",[t._v(" ("+t._s(e.description)+")")]):t._e()]),t.controls?s("span",{staticClass:"is-size-7"},[s("b",[t._v("Query:")]),t._v(" "+t._s(e.query)+"\n      ")]):t._e(),t.controls?s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{"margin-top":"-15px"}},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-small is-rounded is-danger",on:{click:function(s){return t.remove(e,i)}}},[t._m(0,!0),s("span",[t._v("Remove")])])])]):t._e()],1)})),0)])},qt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-trash"})])}],Ut={props:["views","controls"],computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{remove:function(t,e){i["default"].delete(this.views,e),E.deleteView(this.sketch.id,t.id).then((function(t){})).catch((function(t){console.error(t)}))}}},Yt=Ut,Ht=Object(c["a"])(Yt,Vt,qt,!1,null,null,null),Jt=Ht.exports,Bt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm(e)}}},[s("div",{staticClass:"field"},[s("div",{staticClass:"file has-name"},[s("label",{staticClass:"file-label"},[s("input",{staticClass:"file-input",attrs:{type:"file",name:"resume"},on:{change:function(e){return t.setFileName(e.target.files)}}}),t._m(0),t.fileName?s("span",{staticClass:"file-name"},[t.fileName?t._e():s("span",[t._v("No file selected")]),t._v("\n          "+t._s(t.fileName)+"\n        ")]):t._e()])])]),t.fileName?s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Name")]),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Name your timeline (optional)"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}})])]):t._e(),t.fileName&&0===t.percentCompleted?s("div",{staticClass:"field"},[t._m(1)]):t._e()]),s("br"),0!==t.percentCompleted?s("b-progress",{attrs:{value:t.percentCompleted,"show-value":"",format:"percent",type:"is-info",size:"is-medium"}},[100===t.percentCompleted?s("span",[t._v("Waiting for request to finish..")]):t._e()]):t._e()],1)},Wt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"file-cta"},[s("span",{staticClass:"file-icon"},[s("i",{staticClass:"fas fa-upload"})]),s("span",{staticClass:"file-label"},[t._v("\n            Choose a fileâ€¦\n          ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control"},[s("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Upload"}})])}],Zt=(s("28a5"),{data:function(){return{form:{name:"",file:""},fileName:"",percentCompleted:0}},methods:{clearFormData:function(){this.form.name="",this.form.file="",this.fileName=""},submitForm:function(){var t=this,e=new FormData;e.append("file",this.form.file),e.append("name",this.form.name),e.append("sketch_id",this.$store.state.sketch.id);var s={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){this.percentCompleted=Math.round(100*t.loaded/t.total)}.bind(this)};E.uploadTimeline(e,s).then((function(e){t.$store.dispatch("updateSketch",t.$store.state.sketch.id),t.$emit("toggleModal"),t.clearFormData(),t.percentCompleted=0})).catch((function(t){}))},setFileName:function(t){var e=t[0].name;this.form.file=t[0],this.form.name=e.split(".").slice(0,-1).join("."),this.fileName=e}}}),Kt=Zt,Xt=Object(c["a"])(Kt,Bt,Wt,!1,null,null,null),te=Xt.exports,ee=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.hideNavigation?t._e():s("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}],null,!1,4238446144)}),t.hideNavigation?t._e():s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"timelines"}})],1)]),t.meta.permissions.write?s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card",staticStyle:{"min-height":"160px"}},[t._m(0),s("div",{staticClass:"card-content"},[s("b-message",[s("p",[t._v("\n              Upload a new timeline or choose an existing one from the list below. You can upload either a Plaso storage file, JSONL, or a CSV file.\n              "),s("br"),t._v("\n              If you are uploading a CSV or JSONL file make sure to read the "),s("a",{attrs:{href:"https://github.com/google/timesketch/blob/master/docs/Users-Guide.md#adding-timelines",rel:"noreferrer",target:"_blank"}},[t._v("documentation")]),t._v(" to learn what columns are needed.\n            ")]),s("br"),s("ts-upload-timeline-form")],1)],1)])])]):t._e(),t.sketch.timelines.length?s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card",staticStyle:{"min-height":"160px"}},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Active Timelines")]),s("p",{staticClass:"is-pulled-right",staticStyle:{padding:"0.75rem","font-weight":"bold",color:"#777777"}},[t._v(t._s(t._f("compactNumber")(t.count))+" events")])]),s("div",{staticClass:"card-content"},[s("ts-timeline-list",{attrs:{timelines:t.sketch.timelines,controls:!0}})],1)])])]):t._e()],1)},se=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Upload timeline")])])}],ie={components:{TsTimelineList:Gt,TsUploadTimelineForm:te},props:["hideNavigation"],computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},count:function(){return this.$store.state.count}}},ae=ie,ne=Object(c["a"])(ae,ee,se,!1,null,null,null),re=ne.exports,oe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{on:{submit:function(t){t.preventDefault()}}},[s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("b-radio",{attrs:{type:"is-info",name:"name","native-value":"false"},model:{value:t.isPublic,callback:function(e){t.isPublic=e},expression:"isPublic"}},[s("i",{staticClass:"fa fa-lock",staticStyle:{"margin-left":"10px","margin-right":"5px"}}),t._v("\n        Private - Only you and selected users/groups can access this sketch\n      ")]),s("br"),s("b-radio",{attrs:{type:"is-info",name:"name","native-value":"true"},model:{value:t.isPublic,callback:function(e){t.isPublic=e},expression:"isPublic"}},[s("i",{staticClass:"fa fa-globe",staticStyle:{"margin-left":"10px","margin-right":"5px"}}),t._v("\n        Public -  All users of the system can access this sketch\n      ")]),s("hr"),t.currentUsers.length||t.currentGroups.length?s("div",[t._v("\n        Who has access\n        "),s("br"),s("br"),s("table",{staticClass:"table is-hoverable"},[t._l(t.currentUsers,(function(e,i){return s("tr",[s("td",[t._v(t._s(e))]),s("td",{staticStyle:{cursor:"pointer"},attrs:{width:"10px"},on:{click:function(s){return t.removeUser(e,i)}}},[s("i",{staticClass:"fa fa-trash"})])])})),t._l(t.currentGroups,(function(e,i){return s("tr",[s("td",[t._v(t._s(e))]),s("td",{staticStyle:{cursor:"pointer"},attrs:{width:"10px"},on:{click:function(s){return t.removeGroup(e,i)}}},[s("i",{staticClass:"fa fa-trash"})])])}))],2),s("br"),s("br")]):t._e(),t.usersToRemove.length||t.groupsToRemove.length?s("b-notification",{attrs:{type:"is-warning",role:"alert",closable:!1}},[t._v("\n        You have made changes that you need to save\n      ")]):t._e(),s("b-field",{attrs:{label:"Share with user"}},[s("b-autocomplete",{attrs:{"clear-on-select":"",data:t.filteredUserArray,placeholder:"Username ..",icon:"magnify"},on:{select:t.addUser},model:{value:t.userNameInput,callback:function(e){t.userNameInput=e},expression:"userNameInput"}},[s("template",{slot:"empty"},[t._v("No user found")])],2)],1)],1)]),s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("b-field",{attrs:{label:"Share with group"}},[s("b-autocomplete",{attrs:{"clear-on-select":"","open-on-focus":"",data:t.filteredGroupArray,placeholder:"Group name ..",icon:"magnify"},on:{select:t.addGroup},model:{value:t.groupNameInput,callback:function(e){t.groupNameInput=e},expression:"groupNameInput"}},[s("template",{slot:"empty"},[t._v("No group found")])],2)],1)],1)]),t.usersToAdd.length||t.groupsToAdd.length?s("div",[s("br"),s("strong",[t._v("Users/Groups to add")]),s("br"),s("br"),s("b-field",{attrs:{grouped:"","group-multiline":""}},[t._l(t.usersToAdd,(function(e,i){return s("div",{key:e.name,staticClass:"control"},[s("b-tag",{attrs:{attached:"",closable:"","aria-close-label":"Close tag",size:"is-medium"},on:{close:function(e){return t.usersToAdd.splice(i,1)}}},[t._v(t._s(e))])],1)})),t._l(t.groupsToAdd,(function(e,i){return s("div",{key:e.name,staticClass:"control"},[s("b-tag",{attrs:{attached:"",closable:"","aria-close-label":"Close tag",size:"is-medium"},on:{close:function(e){return t.groupsToAdd.splice(i,1)}}},[t._v(t._s(e))])],1)}))],2)],1):t._e(),s("br"),s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("button",{staticClass:"button is-info",on:{click:t.submitForm}},[t._v("Save changes")])])])])},ce=[],le=(s("6b54"),{data:function(){return{isPublic:!1,systemUsers:[],systemGroups:[],usersToAdd:[],groupsToAdd:[],usersToRemove:[],groupsToRemove:[],userNameInput:"",groupNameInput:""}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},currentUsers:function(){var t=this;return this.meta.collaborators.users.filter((function(e){return!t.usersToRemove.includes(e)}))},currentGroups:function(){var t=this;return this.meta.collaborators.groups.filter((function(e){return!t.groupsToRemove.includes(e)}))},filteredUserArray:function(){var t=this;return this.systemUsers.filter((function(e){return e.toString().toLowerCase().indexOf(t.userNameInput.toLowerCase())>=0}))},filteredGroupArray:function(){var t=this;return this.systemGroups.filter((function(e){return e.toString().toLowerCase().indexOf(t.groupNameInput.toLowerCase())>=0}))}},methods:{addUser:function(t){t&&(this.usersToAdd.includes(t)||this.usersToAdd.push(t))},addGroup:function(t){this.groupsToAdd.includes(t)||this.groupsToAdd.push(t)},removeUser:function(t,e){this.usersToRemove.push(t)},removeGroup:function(t,e){this.groupsToRemove.push(t)},submitForm:function(){E.editCollaborators(this.sketch.id,this.isPublic,this.usersToAdd,this.groupsToAdd,this.usersToRemove,this.groupsToRemove).then((function(t){})).catch((function(t){})),this.$emit("closeShareModal")}},mounted:function(){var t=this;this.meta.permissions.public&&(this.isPublic=!0),E.getUsers().then((function(e){e.data.objects[0].forEach((function(e){t.systemUsers.push(e.username)}))})).catch((function(t){})),E.getGroups().then((function(e){e.data.objects[0].forEach((function(e){t.systemGroups.push(e.name)}))})).catch((function(t){}))}}),ue=le,de=Object(c["a"])(ue,oe,ce,!1,null,null,null),he=de.exports,me=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",["{}"===this.spec&&!0===this.showChart?s("div",[t._m(0),t._v(" Loading..")]):t._e(),t.isTruncated&&t.showChart?s("p",[t._v("Warning: only retrieved 100 sessions for each session type.")]):t._e(),s("ts-vega-lite-chart",{attrs:{vegaSpec:t.spec},on:{viewCreated:t.registerClickListener}}),s("div",{staticClass:"field"},[s("button",{staticClass:"button",attrs:{disabled:t.indices.length>1},on:{click:t.toggleChart}},[t._v(t._s(t.message))])]),t.showChart?s("div",{staticClass:"field"},[this.showTimeRange?t._e():s("p",[t._v("\n             Showing sessions within the last year of the timeline by default. "),s("u",[s("em",{on:{click:t.toggleTimeRange}},[t._v("Choose a different timeframe.")])])]),this.showTimeRange?s("div",{staticClass:"control"},[t._m(1),s("input",{staticClass:"input",attrs:{type:"text",name:"start_time_range_input",placeholder:"mm/dd/yyyy"},on:{change:t.updateTimeRange}}),t._m(2),s("input",{staticClass:"input",attrs:{type:"text",name:"end_time_range_input",placeholder:"mm/dd/yyyy"},on:{change:t.updateTimeRange}})]):t._e(),s("p",[t._v(t._s(t.timeRangeMessage))])]):t._e(),t.showChart?s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Type of Session:")]),s("div",{staticClass:"control"},[s("div",{staticClass:"select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedType,expression:"selectedType"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedType=e.target.multiple?s:s[0]},t.selectSessionType]}},[s("option",{attrs:{disabled:"",value:""}},[t._v("Please select one")]),t._l(t.sessionTypes,(function(e){return s("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])}))],2)])])]):t._e(),t.selectedSessions.length>0?s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Session ID:")]),s("div",{staticClass:"control"},[s("div",{staticClass:"select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedID,expression:"selectedID"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedID=e.target.multiple?s:s[0]},t.selectSessionID]}},[s("option",{attrs:{disabled:"",value:""}},[t._v("Please select one")]),t._l(t.selectedSessions,(function(e){return s("option",{key:e.session_type+e.session_id,domProps:{value:e.session_id}},[t._v(t._s(e.session_id))])}))],2)])])]):t._e()],1)},pe=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-circle-notch fa-pulse"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"label"},[s("em",[t._v("Start date:")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"label"},[s("em",[t._v("End date:")])])}],fe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:t.vegaId}})},ve=[],ge=s("7ad3"),_e={props:["vegaSpec"],data:function(){return{vegaId:"vega-"+this._uid}},watch:{vegaSpec:function(t,e){Object(ge["a"])("#"+this.vegaId,JSON.parse(this.vegaSpec),{actions:!1})}}},ye=_e,be=Object(c["a"])(ye,fe,ve,!1,null,null,null),Ce=be.exports,ke={components:{TsVegaLiteChart:Ce},data:function(){return{processedSessions:[],message:"Show Session Chart",showChart:!1,showTimeRange:!1,selectedSessions:[],spec:"{}",sessionTypes:["all"],barSize:0,smallest_timestamp:0,selectedType:"",selectedID:"",sessions:[],startTimeRange:null,endTimeRange:null,timeRangeMessage:"",isTruncated:!1}},computed:{sketch:function(){return this.$store.state.sketch},indices:function(){return this.$store.state.currentQueryFilter.indices}},methods:{registerClickListener:function(t){var e=this.$store,s=this.sketch.id;t.addEventListener("click",(function(t,i){var a=i.datum.session_type,n=i.datum.session_id;if(void 0!=a&&void 0!=n){var r="session_id."+a+":"+n;e.dispatch("updateCurrentQueryString",r),e.dispatch("search",s)}}))},toggleChart:function(){var t=this;this.showChart=!this.showChart,this.showChart?(this.message="Hide Session Chart",0==this.sessions.length?E.getSessions(this.sketch.id,this.indices[0]).then((function(e){t.sessions=e.data,t.sessionTypes=t.sessionTypes.concat(Object(it["a"])(new Set(t.sessions.map((function(t){return t.session_type}))))),t.getVegaSpec()})).catch((function(t){})):this.getVegaSpec()):(this.message="Show Session Chart",this.selectedSessions=[],this.spec="{}",this.selectedType="",this.selectedID="",this.showTimeRange=!1,this.startTimeRange=Date.now()-31556952e3,this.endTimeRange=Date.now(),this.timeRangeMessage="")},toggleTimeRange:function(){this.showTimeRange=!this.showTimeRange},updateTimeRange:function(t){var e=/\d{1,2}\/\d{1,2}\/\d{4}/;e.test(t.target.value)?(this.timeRangeMessage="",this.selectedSessions=[],this.selectedType="",this.selectedID="","start_time_range_input"===t.target.name?this.startTimeRange=new Date(t.target.value).getTime():this.endTimeRange=new Date(t.target.value).getTime(),this.getVegaSpec()):this.timeRangeMessage="Please enter a valid date."},selectSessionType:function(t){var e=this;this.selectedID="";var s=JSON.parse(this.spec);"all"===this.selectedType?(this.selectedSessions=[],s["data"]["values"]=this.processedSessions):(this.selectedSessions=this.processedSessions.filter((function(t){return t["session_type"]===e.selectedType})),s["data"]["values"]=this.selectedSessions),s["vconcat"][1]["selection"]["brush"]["init"]["x"]=[this.smallest_timestamp,this.smallest_timestamp+50*this.barSize],this.spec=JSON.stringify(s)},selectSessionID:function(t){for(var e="",s=[],i=JSON.parse(JSON.stringify(this.selectedSessions)),a=0;a<i.length;a++){var n=i[a];this.selectedType===n.session_type&&this.selectedID===n.session_id?(n["selected"]=!0,e="session_id."+n["session_type"]+":"+n["session_id"],s=[n["start_timestamp"]-5*this.barSize,n["end_timestamp"]+5*this.barSize]):n["selected"]=!1}var r=JSON.parse(this.spec);r["data"]["values"]=i,r["vconcat"][1]["selection"]["brush"]["init"]["x"]=s,this.spec=JSON.stringify(r),this.$store.dispatch("updateCurrentQueryString",e),this.$store.dispatch("search",this.sketch.id)},getProcessedSessions:function(){var t=this,e=31556952e3,s=JSON.parse(JSON.stringify(this.sessions));if(this.isTruncated=s.pop()["truncated"],s.length>0){var i=s[0].end_timestamp,a=s[0].start_timestamp;if(null==this.endTimeRange){for(var n=1;n<s.length;n++)s[n].end_timestamp>i&&(i=s[n].end_timestamp);this.endTimeRange=i,this.startTimeRange=this.endTimeRange-e,s=s.filter((function(e){return e.start_timestamp>=t.startTimeRange&&e.start_timestamp<=t.endTimeRange})),a=s[0].start_timestamp;for(n=1;n<s.length;n++)s[n].start_timestamp<a&&(a=s[n].start_timestamp)}else{s=s.filter((function(e){return e.start_timestamp>=t.startTimeRange&&e.start_timestamp<=t.endTimeRange})),a=s[0].start_timestamp,i=s[0].end_timestamp;for(n=1;n<s.length;n++)s[n].start_timestamp<a&&(a=s[n].start_timestamp),s[n].end_timestamp>i&&(i=s[n].end_timestamp)}var r=i-a;this.barSize=Math.round(r/1e3),this.smallest_timestamp=a;for(n=0;n<s.length;n++){var o=s[n],c=o.start_timestamp+this.barSize;o.end_timestamp<c&&(o.end_timestamp=c)}}this.processedSessions=s},getVegaSpec:function(){var t=900,e=400;this.getProcessedSessions(),void 0!==this.processedSessions&&0!=this.processedSessions.length||(this.timeRangeMessage="There are no sessions in this time range.");var s={$schema:"https://vega.github.io/schema/vega-lite/v3.json",data:{values:this.processedSessions},vconcat:[{width:t,height:e,padding:5,mark:"bar",encoding:{y:{field:"session_type",type:"ordinal",axis:{title:"Session Type"}},x:{field:"start_timestamp",type:"temporal",timeUnit:"yearmonthdatehoursminutesseconds",axis:{title:"Timestamp",tickCount:5},scale:{domain:{selection:"brush"}}},x2:{field:"end_timestamp",type:"temporal",timeUnit:"yearmonthdatehoursminutesseconds",axis:{title:"End Timestamp"}},color:{field:"session_id",type:"nominal",scale:{scheme:"tableau20"},legend:!1},opacity:{condition:[{test:"datum.selected == true",value:1},{test:"datum.selected == false",value:.2}],value:.8}}},{width:t,height:e/4,padding:5,selection:{brush:{type:"interval",encodings:["x"],init:{x:[this.smallest_timestamp,this.smallest_timestamp+50*this.barSize]}}},mark:{type:"bar",x2Offset:t/100,clip:!0},encoding:{y:{field:"session_type",type:"ordinal",axis:{title:"Session Type"}},x:{field:"start_timestamp",type:"temporal",axis:{title:"Timestamp",tickCount:5}},x2:{field:"end_timestamp",type:"temporal",axis:{title:"End Timestamp"}},color:{field:"session_id",type:"nominal",scale:{scheme:"tableau20"},legend:!1},opacity:{condition:[{test:"datum.selected == true",value:1},{test:"datum.selected == false",value:.2}],value:.8}}}]};this.spec=JSON.stringify(s)}}},Se=ke,we=Object(c["a"])(Se,me,pe,!1,null,null,null),xe=we.exports,Te=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",t._l(t.graphs,(function(e){return s("router-link",{key:e.id,attrs:{to:{name:"SketchGraphExplore",query:{graph:e.id}}}},[s("ul",{staticClass:"content-list"},[s("li",{staticStyle:{padding:"10px","border-bottom":"none",cursor:"pointer"}},[s("strong",{staticStyle:{color:"var(--default-font-color)"}},[t._v(t._s(e.name))]),s("br"),s("span",[t._v("Created: "+t._s(t._f("moment")(e.created_at,"YYYY-MM-DD HH:mm")))])])])])})),1)},Ee=[],$e={data:function(){return{graphs:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},created:function(){var t=this;E.getSavedGraphList(this.sketch.id).then((function(e){var s=e.data["objects"][0];void 0!==s&&(t.graphs=e.data["objects"][0])})).catch((function(t){console.error(t)}))}},De=$e,Ae=Object(c["a"])(De,Te,Ee,!1,null,"115a6c63",null),Oe=Ae.exports,Fe={components:{SessionChart:xe,TsSketchMetrics:ft,TsSketchSummary:lt,TsTimelineList:Gt,TsSavedViewList:Jt,TsUploadTimelineForm:te,TsSketchStoryList:N,TsSketchTimelinesManage:re,TsShareForm:he,TsGraphList:Oe},data:function(){return{showUploadTimelineModal:!1,showDeleteSketchModal:!1,showShareModal:!1,isFullPage:!0,loadingComponent:null,isArchived:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},count:function(){return this.$store.state.count},shareTooltip:function(){var t="",e="Shared with ";return this.meta.collaborators.users.length&&(t=e+this.meta.collaborators.users.length+" users",this.meta.collaborators.groups.length&&(t=t+" and "+this.meta.collaborators.groups.length+" groups")),!t&&this.meta.collaborators.groups.length&&(t=e+this.meta.collaborators.groups.length+" groups"),t}},methods:{deleteSketch:function(){var t=this;E.deleteSketch(this.sketch.id).then((function(e){t.$router.push({name:"Home"})})).catch((function(t){console.error(t)}))},archiveSketch:function(){var t=this;this.isArchived=!0,E.archiveSketch(this.sketch.id).then((function(e){t.$store.dispatch("updateSketch",t.sketch.id),t.$router.push({name:"SketchOverview",params:{sketchId:t.sketch.id}})})).catch((function(t){console.error(t)}))},unArchiveSketch:function(){var t=this;this.isArchived=!1,E.unArchiveSketch(this.sketch.id).then((function(e){t.$store.dispatch("updateSketch",t.sketch.id),t.$router.push({name:"SketchOverview",params:{sketchId:t.sketch.id}})})).catch((function(t){console.error(t)}))},exportSketch:function(){var t=this;this.loadingOpen(),E.exportSketch(this.sketch.id).then((function(e){var s=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a"),a="sketch-"+t.sketch.id+"-export.zip";i.href=s,i.setAttribute("download",a),document.body.appendChild(i),i.click(),t.loadingClose()})).catch((function(e){console.error(e),t.loadingClose()}))},sortedUserList:function(){var t=Object(it["a"])(this.$store.state.meta.collaborators.users);return t.sort()},sortedGroupList:function(){var t=Object(it["a"])(this.$store.state.meta.collaborators.groups);return t.sort()},closeShareModal:function(){this.showShareModal=!1,this.$buefy.snackbar.open({duration:3500,message:"Sharing settings have been saved",type:"is-white",position:"is-top",queue:!1}),this.$store.dispatch("updateSketch",this.sketch.id)},loadingOpen:function(){this.loadingComponent=this.$buefy.loading.open({container:this.isFullPage?null:this.$refs.element.$el})},loadingClose:function(){this.loadingComponent.close()}},created:function(){"archived"===this.sketch.status[0].status&&(this.isArchived=!0)}},Ne=Fe,Pe=(s("d147"),Object(c["a"])(Ne,et,st,!1,null,null,null)),je=Pe.exports,Me=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("router-view")},Le=[],Ie={},ze=Object(c["a"])(Ie,Me,Le,!1,null,null,null),Re=ze.exports,Qe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:""}})],1)]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card",staticStyle:{"min-height":"160px"}},[t._m(0),s("div",{staticClass:"card-content"},[s("ts-view-list",{attrs:{views:t.meta.views,controls:!0}})],1)])])])],1)},Ge=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Manage Saved Views")])])}],Ve={components:{TsViewList:Jt},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}}},qe=Ve,Ue=Object(c["a"])(qe,Qe,Ge,!1,null,null,null),Ye=Ue.exports,He=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"aggregate"}})],1)]),s("ts-sketch-explore-aggregation",{on:{newAggregation:function(e){return t.addAggregation(e)}}}),s("br"),s("br"),t.allAggregations.length?s("section",{staticClass:"section"},[t._m(0)]):t._e(),t._l(t.allAggregations,(function(t){return s("section",{key:t.id,staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-aggregation-compact",{attrs:{aggregation:t,"card-header":!0}})],1)])}))],2)},Je=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container is-fluid"},[s("span",{staticClass:"title is-5"},[t._v("Saved aggregations")])])}],Be=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("b-modal",{attrs:{active:t.showSaveModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showSaveModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Save aggregation")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.save()}}},[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Name")]),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.aggregationName,expression:"aggregationName"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Name your aggregation",autofocus:""},domProps:{value:t.aggregationName},on:{input:function(e){e.target.composing||(t.aggregationName=e.target.value)}}})])]),s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save"}})])])])])])])]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[t._m(0),s("div",{staticClass:"card-content"},[s("label",{staticClass:"label"},[t._v("Optional: Select timelines")]),s("ts-timeline-list-dropdown",{on:{selectedTimelines:function(e){t.selectedTimelines=e}}}),s("br"),s("ts-sketch-explore-aggregator-list-dropdown",{on:{setActiveAggregator:t.updateAggregatorFormFields}}),s("br"),s("ts-dynamic-form",{key:t.selectedAggregator.name,ref:"vegaChart",attrs:{schema:t.schema},on:{formSubmitted:t.getVegaSpec},model:{value:t.formData,callback:function(e){t.formData=e},expression:"formData"}})],1)])])]),s("section",{directives:[{name:"show",rawName:"v-show",value:t.showChart&&0!==Object.keys(t.vegaSpec).length,expression:"showChart && Object.keys(vegaSpec).length !== 0"}],staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("span",{staticClass:"card-header-title"},[t._v("\n            "+t._s(t.selectedAggregator.display_name)+"\n          ")]),s("span",{staticClass:"card-header-icon"},[s("a",{staticClass:"button is-rounded is-small",on:{click:function(e){t.showSaveModal=!t.showSaveModal}}},[t._m(1),s("span",[t._v("Save")])])])]),s("div",{staticClass:"card-content"},[s("ts-table-chart",{directives:[{name:"show",rawName:"v-show",value:"table"===t.chartType,expression:"chartType === 'table'"}],attrs:{"table-data":t.chartData}}),s("ts-vega-lite-chart",{directives:[{name:"show",rawName:"v-show",value:"table"!==t.chartType,expression:"chartType !== 'table'"}],attrs:{vegaSpec:t.vegaSpec}})],1)])])])],1)},We=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("span",{staticClass:"card-header-title"},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-chart-bar"})]),s("span",{staticStyle:{"margin-left":"10px"}},[t._v("New Aggregation")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-save"})])}],Ze=(s("456d"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.schema.length?s("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm(e)},keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()}}},[t._l(t.schema,(function(e,i){return s(e.type,t._b({key:i,tag:"component",attrs:{value:t.formData[e.name],display:e.display},on:{input:function(s){return t.updateForm(e.name,s)}}},"component",e,!1))})),t._m(0)],2):t._e()}),Ke=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control"},[s("input",{staticClass:"button is-info",attrs:{type:"submit",value:"Run"}})])}],Xe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.display?s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v(t._s(t.label))]),s("input",{staticClass:"input",staticStyle:{"max-width":"400px"},attrs:{type:"text",name:t.name,placeholder:t.placeholder},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}})]):t._e()},ts=[],es={props:["placeholder","label","name","value","display"]},ss=es,is=Object(c["a"])(ss,Xe,ts,!1,null,null,null),as=is.exports,ns=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.display?s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v(t._s(t.label))]),s("div",{staticClass:"control"},[s("div",{staticClass:"select"},[s("select",{domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}},[s("option",{attrs:{disabled:"",value:""}},[t._v("Please select one")]),t._l(t.options,(function(e){return s("option",{key:e},[t._v(t._s(e))])}))],2)])])]):t._e()},rs=[],os={props:["options","label","value","display"]},cs=os,ls=Object(c["a"])(cs,ns,rs,!1,null,null,null),us=ls.exports,ds=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.display?s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v(t._s(t.label))]),s("b-datetimepicker",{attrs:{placeholder:"Optional: Select a date...","datetime-formatter":t.dateFormatter,editable:""}})],1):t._e()},hs=[],ms=(s("a481"),{props:["placeholder","label","name","value","display"],methods:{dateFormatter:function(t){var e=t.toISOString().replace(".000Z","");return this.$emit("input",e),e}}}),ps=ms,fs=Object(c["a"])(ps,ds,hs,!1,null,null,null),vs=fs.exports,gs={components:{TsDynamicFormTextInput:as,TsDynamicFormSelectInput:us,TsDynamicFormDatetimeInput:vs},props:["schema","value"],data:function(){return{formData:this.value||{}}},methods:{updateForm:function(t,e){this.$set(this.formData,t,e),this.$emit("input",this.formData)},submitForm:function(){this.$emit("formSubmitted")}}},_s=gs,ys=Object(c["a"])(_s,Ze,Ke,!1,null,null,null),bs=ys.exports,Cs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Choose an aggregator")]),s("div",{staticClass:"control"},[s("div",{staticClass:"select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selected=e.target.multiple?s:s[0]},function(e){return t.setActiveAggregator()}]}},[s("option",{attrs:{disabled:"",value:""}},[t._v("Please select one")]),t._l(t.meta.aggregators,(function(e,i){return s("option",{key:e.id,domProps:{value:i}},[t._v("\n          "+t._s(e.display_name)+"\n        ")])}))],2)])])])},ks=[],Ss={props:["isRounded","title"],data:function(){return{selected:"",selectedChart:""}},computed:{meta:function(){return this.$store.state.meta}},methods:{setActiveAggregator:function(){var t=JSON.parse(JSON.stringify(this.meta.aggregators[this.selected]));t.name=this.selected,this.$emit("setActiveAggregator",t)}}},ws=Ss,xs=Object(c["a"])(ws,Cs,ks,!1,null,null,null),Ts=xs.exports,Es=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.tableData.length?s("div",[s("b-table",{attrs:{data:t.tableData,columns:t.getColumns(),paginated:!0,"pagination-simple":!0,"per-page":10,hoverable:!0,"icon-pack":"fas","pagination-size":"is-small"}})],1):t._e()},$s=[],Ds={props:["tableData"],methods:{getColumns:function(){var t=[],e=this.tableData[0];return Object.keys(e).forEach((function(e){t.push({field:e,label:e,sortable:!0})})),t}}},As=Ds,Os=Object(c["a"])(As,Es,$s,!1,null,null,null),Fs=Os.exports,Ns=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("b-dropdown",{attrs:{"aria-role":"list"},scopedSlots:t._u([{key:"trigger",fn:function(e){var i=e.active;return[s("b-button",{attrs:{label:t.label,"icon-right":i?"chevron-up":"chevron-down"}})]}}])},[s("b-dropdown-item",{attrs:{"aria-role":"menu-item",focusable:!1,custom:"",paddingless:""}},[s("b-table",{attrs:{data:t.timelines,columns:t.timelineColumns,"checked-rows":t.selected,checkable:""},on:{"update:checkedRows":function(e){t.selected=e},"update:checked-rows":function(e){t.selected=e}}})],1)],1)],1)},Ps=[],js={props:[],data:function(){return{selected:[],timelineColumns:[{field:"name"}]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},timelines:function(){var t=[];return this.sketch.timelines.forEach((function(e){t.push({id:e.id,name:e.name})})),t},label:function(){var t="Select individual timelines";return this.selected.length&&(t="Selected timelines ("+this.selected.length+"/"+this.timelines.length+")"),t}},watch:{selected:function(t){this.$emit("selectedTimelines",t.map((function(t){return t.id})))}}},Ms=js,Ls=Object(c["a"])(Ms,Ns,Ps,!1,null,null,null),Is=Ls.exports,zs={components:{TsDynamicForm:bs,TsVegaLiteChart:Ce,TsSketchExploreAggregatorListDropdown:Ts,TsTableChart:Fs,TsTimelineListDropdown:Is},data:function(){return{schema:{},formData:{},vegaSpec:{},selectedAggregator:"",showChart:!1,showSaveModal:!1,aggregationName:"",chartType:"",chartData:{},selectedTimelines:[]}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{updateAggregatorFormFields:function(t){this.showChart=!1;var e={};this.schema=t.form_fields,this.schema.forEach((function(t){e[t.name]=t.default_value})),this.formData=e,this.selectedAggregator=t},getVegaSpec:function(){var t=this;this.showChart=!0,this.formData["index"]=this.selectedTimelines;var e={aggregator_name:this.selectedAggregator.name,aggregator_parameters:this.formData};E.runAggregator(this.sketch.id,e).then((function(e){var s=e.data.meta.vega_spec;s.config.view.width=t.$refs.vegaChart.$el.offsetWidth,s.config.autosize={type:"fit",contains:"padding"},t.vegaSpec=JSON.stringify(s),t.chartType=e.data.meta.chart_type,t.chartData=s.datasets[Object.keys(s.datasets)[0]]})).catch((function(t){}))},save:function(){var t=this;this.showSaveModal=!1,E.saveAggregation(this.sketch.id,this.selectedAggregator,this.aggregationName,this.formData).then((function(e){var s=e.data.objects[0];t.$emit("newAggregation",s),t.aggregationName=""})).catch((function(t){}))}}},Rs=zs,Qs=Object(c["a"])(Rs,Be,We,!1,null,null,null),Gs=Qs.exports,Vs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("span",{staticClass:"card-header-title"},[t._v("\n      "+t._s(t.aggregation.name)+"\n      "),t.aggParameters.start_time&&t.aggParameters.end_time?s("span",{staticStyle:{"margin-left":"15px","font-weight":"normal"}},[t._v("["+t._s(t.aggParameters.start_time)+" â†’ "+t._s(t.aggParameters.end_time)+"]")]):t._e(),t._l(t.timelines,(function(t){return s("ts-timeline-chip",{key:t.id,staticStyle:{"margin-left":"10px"},attrs:{timeline:t}})}))],2)]),s("div",{ref:"vegaChart",staticClass:"card-content"},["table"===t.chartType?s("ts-table-chart",{attrs:{"table-data":t.chartData}}):t._e(),"table"!==t.chartType?s("ts-vega-lite-chart",{attrs:{vegaSpec:t.vegaSpec}}):t._e()],1)])},qs=[],Us=(s("7514"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tag is-medium has-text-left",staticStyle:{"background-color":"#f5f5f5","padding-left":"5px"}},[s("div",{staticStyle:{width:"20px",height:"20px","border-radius":"6px","margin-right":"10px"},style:t.timelineColorStyle}),s("div",{staticStyle:{"font-weight":"normal"}},[t._v(t._s(t.timeline.name))])])}),Ys=[],Hs={props:["timeline"],computed:{timelineColorStyle:function(){var t=this.timeline.color;return t.startsWith("#")||(t="#"+t),{"background-color":t}}}},Js=Hs,Bs=Object(c["a"])(Js,Us,Ys,!1,null,null,null),Ws=Bs.exports,Zs={props:["aggregation","cardHeader"],components:{TsVegaLiteChart:Ce,TsTableChart:Fs,TsTimelineChip:Ws},data:function(){return{vegaSpec:{},title:"",chartType:"",chartData:{}}},computed:{sketch:function(){return this.$store.state.sketch},aggParameters:function(){return JSON.parse(this.aggregation.parameters)},timelines:function(){var t=this,e=[];return this.aggParameters.index&&Array.isArray(this.aggParameters.index)&&this.aggParameters.index.forEach((function(s){var i=t.sketch.active_timelines.find((function(t){return t.id===s}));e.push(i)})),e}},methods:{getVegaSpec:function(){var t=this,e={aggregator_name:this.aggregation.agg_type,aggregator_parameters:this.aggregation.parameters};E.runAggregator(this.sketch.id,e).then((function(e){var s=e.data.meta.vega_spec;s.config.view.width=t.$refs.vegaChart.offsetWidth-50,s.config.autosize={type:"fit",contains:"padding"},t.vegaSpec=JSON.stringify(s),t.title=e.data.meta.vega_chart_title,t.chartType=e.data.meta.chart_type,t.chartData=s.datasets[Object.keys(s.datasets)[0]]})).catch((function(t){}))}},mounted:function(){this.getVegaSpec()}},Ks=Zs,Xs=Object(c["a"])(Ks,Vs,qs,!1,null,null,null),ti=Xs.exports,ei={components:{TsSketchExploreAggregation:Gs,TsAggregationCompact:ti},data:function(){return{aggregations:[],aggregationGroups:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},allAggregations:function(){var t=function(){for(var t,e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return(t=[]).concat.apply(t,Object(it["a"])(s.filter(Array.isArray)))};return t(this.aggregations,this.aggregationGroups).slice().reverse()}},methods:{addAggregation:function(t){this.aggregations.push(t)}},created:function(){var t=this;E.getAggregations(this.sketch.id).then((function(e){t.aggregations=e.data.objects[0]})).catch((function(t){console.error(t)})),E.getAggregationGroups(this.sketch.id).then((function(e){t.aggregationGroups=e.data.objects})).catch((function(t){console.error(t)}))}},si=ei,ii=Object(c["a"])(si,He,Je,!1,null,null,null),ai=ii.exports,ni=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"explore"}})],1)]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header",staticStyle:{cursor:"pointer"},on:{click:function(e){t.showSearch=!t.showSearch}}},[t._m(0),s("span",{staticClass:"card-header-icon"},[s("span",{staticClass:"icon"},[t.showSearch?t._e():s("i",{staticClass:"fas fa-angle-down",attrs:{"aria-hidden":"true"}}),t.showSearch?s("i",{staticClass:"fas fa-angle-up",attrs:{"aria-hidden":"true"}}):t._e()])])]),t.showSearch?s("div",{staticClass:"card-content"},[s("div",{staticClass:"field has-addons"},[s("div",{staticClass:"control"},[s("ts-view-list-dropdown",{attrs:{"current-query-string":t.currentQueryString,"current-query-filter":t.currentQueryFilter,"view-from-url":t.params.viewId,"sketch-id":t.sketchId},on:{setActiveView:t.searchView,clearSearch:t.clearSearch}})],1),s("div",{staticClass:"control",staticStyle:{width:"100%"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currentQueryString,expression:"currentQueryString"}],staticClass:"ts-search-input",attrs:{type:"text",placeholder:"Search",autofocus:"",required:""},domProps:{value:t.currentQueryString},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)},input:function(e){e.target.composing||(t.currentQueryString=e.target.value)}}})])]),s("div",{staticClass:"field is-grouped"},[s("p",{staticClass:"control"},[s("b-dropdown",{ref:"NewTimeFilter",attrs:{"trap-focus":"","append-to-body":"","aria-role":"menu"}},[s("a",{staticClass:"button is-text",staticStyle:{"text-decoration":"none"},attrs:{slot:"trigger",role:"button"},slot:"trigger"},[s("span",[t._v("+ Time filter")])]),s("b-dropdown-item",{staticStyle:{"min-width":"500px",padding:"30px"},attrs:{custom:"",focusable:!1}},[s("strong",[t._v("Create time filter")]),s("br"),s("br"),s("ts-explore-filter-time",{on:{addChip:t.addChip,hideDropdown:t.hideDropdown}})],1)],1)],1),s("p",{staticClass:"control"},[s("b-dropdown",{attrs:{"trap-focus":"","append-to-body":"","aria-role":"menu"}},[s("a",{staticClass:"button is-text",staticStyle:{"text-decoration":"none"},attrs:{slot:"trigger",role:"button"},slot:"trigger"},[s("span",[t._v("+ Add label filter")])]),s("div",{staticClass:"modal-card",staticStyle:{width:"300px",color:"var(--font-color-dark)"}},[s("section",{staticClass:"modal-card-body"},[s("b-dropdown-item",{attrs:{custom:"",focusable:!1}},[s("div",{staticClass:"field"},[s("b-checkbox",{attrs:{type:"is-info","native-value":"__ts_star"},model:{value:t.selectedLabels,callback:function(e){t.selectedLabels=e},expression:"selectedLabels"}},[s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-star",staticStyle:{color:"#ffe300","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"silver"}})]),t._v("Show starred events\n                        ")])],1),s("div",{staticClass:"field"},[s("b-checkbox",{attrs:{type:"is-info","native-value":"__ts_comment"},model:{value:t.selectedLabels,callback:function(e){t.selectedLabels=e},expression:"selectedLabels"}},[s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-comment"})]),t._v("Show events with comments\n                        ")])],1),t.meta.filter_labels.length?s("hr"):t._e(),t._l(t.meta.filter_labels,(function(e){return s("div",{key:e,staticClass:"level",staticStyle:{"margin-bottom":"5px"}},[s("div",{staticClass:"level-left"},[s("div",{staticClass:"field"},[s("b-checkbox",{attrs:{type:"is-info","native-value":e},model:{value:t.selectedLabels,callback:function(e){t.selectedLabels=e},expression:"selectedLabels"}},[t._v("\n                              "+t._s(e)+"\n                            ")])],1)])])}))],2)],1),s("section",{staticClass:"modal-card-foot"},[s("b-dropdown-item",[s("button",{staticClass:"button is-info",on:{click:function(e){return t.updateLabelChips()}}},[t._v("Apply")])])],1)])])],1)]),s("div",{staticClass:"tags",staticStyle:{"margin-bottom":"-5px"}},t._l(t.timeFilterChips,(function(e,i){return s("span",{key:i+e.value},[s("b-dropdown",{ref:"TimeFilters",refInFor:!0,attrs:{"trap-focus":"","append-to-body":"","aria-role":"menu"}},[s("span",{staticClass:"is-small is-outlined",attrs:{slot:"trigger",role:"button"},slot:"trigger"},[s("div",{staticClass:"tags",staticStyle:{"margin-bottom":"5px","margin-right":"7px"}},[s("span",{staticClass:"tag",class:{"chip-disabled":!1===e.active},staticStyle:{cursor:"pointer"}},[s("span",{on:{click:function(s){return s.stopPropagation(),t.toggleChip(e)}}},[i>0?s("span",{staticClass:"chip-operator-label"},[t._v("OR")]):t._e(),s("span",{staticClass:"icon",staticStyle:{"margin-right":"7px"}},[s("i",{staticClass:"fas fa-clock"})]),s("span",[t._v(t._s(e.value.split(",")[0]))]),"datetime_range"===e.type&&e.value.split(",")[0]!==e.value.split(",")[1]?s("span",[t._v(" â†’ "+t._s(e.value.split(",")[1]))]):t._e()]),s("span",{staticClass:"fa-stack fa-lg",staticStyle:{"margin-left":"5px",width:"20px"}},[s("i",{staticClass:"fas fa-circle fa-stack-1x can-change-background",staticStyle:{transform:"scale(1.1)"}}),s("i",{staticClass:"fas fa-edit fa-stack-1x fa-inverse",staticStyle:{transform:"scale(0.7)"}})]),s("button",{staticClass:"delete is-small",staticStyle:{"margin-left":"5px"},on:{click:function(e){return t.removeChip(i)}}})])])]),s("b-dropdown-item",{staticStyle:{"min-width":"500px",padding:"30px"},attrs:{custom:"",focusable:!1}},[s("strong",[t._v("Update time filter")]),s("br"),s("br"),s("ts-explore-filter-time",{attrs:{selectedChip:e},on:{updateChip:function(s){return t.updateChip(s,e)},hideDropdown:t.hideDropdown}})],1)],1)],1)})),0),s("div",{staticClass:"tags"},t._l(t.filterChips,(function(e,i){return s("span",{key:i+e.value},["label"===e.type?s("span",{staticClass:"tag is-light",class:{"chip-disabled":!1===e.active},staticStyle:{"margin-right":"7px",cursor:"pointer"},on:{click:function(s){return t.toggleChip(e,i)}}},[i>0||t.timeFilterChips.length?s("span",{staticClass:"chip-operator-label"},[t._v("AND")]):t._e(),"__ts_star"===e.value?s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"7px"}},[s("i",{staticClass:"fas fa-star",staticStyle:{color:"#ffe300","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"silver"}})]):"__ts_comment"===e.value?s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"7px"}},[s("i",{staticClass:"fas fa-comment"})]):"label"===e.type?s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"7px"}},[s("i",{staticClass:"fas fa-tag"})]):t._e(),s("span",{staticStyle:{"margin-right":"7px"}},[t._v(t._s(t._f("filterChip")(e)))]),s("button",{staticClass:"delete is-small",staticStyle:{"margin-left":"7px"},on:{click:function(s){return t.removeChip(e)}}})]):t._e(),"term"===e.type?s("span",{staticClass:"tag is-light",class:{"chip-disabled":!1===e.active,"is-danger":"must_not"===e.operator},staticStyle:{"margin-right":"7px",cursor:"pointer"},on:{click:function(s){return t.toggleChip(e,i)}}},[i>0||t.timeFilterChips.length?s("span",{staticClass:"chip-operator-label"},[t._v("AND")]):t._e(),"must_not"===e.operator?s("span",{staticClass:"chip-operator-label",staticStyle:{"font-weight":"bold"}},[t._v("NOT")]):t._e(),s("span",{staticStyle:{"margin-right":"7px"}},[t._v(t._s(t._f("filterChip")(e)))]),s("button",{staticClass:"delete is-small",staticStyle:{"margin-left":"7px"},on:{click:function(s){return t.removeChip(e)}}})]):t._e()])})),0),t.sketch.active_timelines?s("ts-explore-timeline-picker",{attrs:{"active-timelines":t.sketch.active_timelines,"current-query-filter":t.currentQueryFilter,"count-per-index":t.eventList.meta.count_per_index,"count-per-timeline":t.eventList.meta.count_per_timeline},on:{updateSelectedTimelines:function(e){return t.updateSelectedTimelines(e)}}}):t._e()],1):t._e()])])]),s("section",{directives:[{name:"show",rawName:"v-show",value:t.contextEvent,expression:"contextEvent"}],staticClass:"section",attrs:{id:"context"}},[s("div",{staticClass:"container is-fluid"},[s("b-message",{attrs:{type:"is-warning","aria-close-label":"Close message"}},[s("strong",[t._v("Context query")]),s("br"),s("br"),s("div",{staticClass:"buttons"},[s("button",{staticClass:"button",on:{click:t.removeContext}},[t._v("â† Go back to original query")]),s("button",{staticClass:"button",on:{click:t.scrollToContextEvent}},[t._v("Help me find my event")])])])],1)]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content"},[s("nav",{staticClass:"level"},[s("div",{staticClass:"level-left"},[s("div",{staticClass:"level-item"},[t.toEvent&&!t.searchInProgress?s("span",[t._v(t._s(t.fromEvent)+"-"+t._s(t.toEvent)+" of "+t._s(t.totalHits)+" events ("+t._s(t.totalTime)+"s)")]):t._e()]),s("div",{staticClass:"level-item"},[t.toEvent||t.searchInProgress?t._e():s("span",[t._v(t._s(t.totalHits)+" events ("+t._s(t.totalTime)+"s)")]),t.searchInProgress?s("div",[t._m(1),t._v(" Searching..")]):t._e()]),t.numSelectedEvents?s("div",{staticClass:"level-item",staticStyle:{"margin-right":"50px"}},[s("button",{staticClass:"button is-small is-outlined",staticStyle:{"border-radius":"4px"},on:{click:t.toggleStar}},[t._m(2),s("span",[t._v("Toggle star ("+t._s(t.numSelectedEvents)+")")])])]):t._e()]),s("div",{staticClass:"level-right"},[s("div",{staticClass:"level-item"},[t.eventList.objects.length?s("div",[s("b-pagination",{attrs:{total:t.totalHitsForPagination,"per-page":t.currentQueryFilter.size,current:t.currentPage,simple:!0,size:"is-small","icon-pack":"fas","icon-prev":"chevron-left","icon-next":"chevron-right"},on:{change:function(e){return t.paginate(e)},"update:current":function(e){t.currentPage=e}}})],1):t._e()]),s("div",{staticClass:"level-item"},[t.eventList.objects.length?s("div",{staticClass:"select is-small"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.currentQueryFilter.size,expression:"currentQueryFilter.size"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.currentQueryFilter,"size",e.target.multiple?s:s[0])},t.search]}},[s("option",{domProps:{value:t.currentQueryFilter.size}},[t._v(t._s(t.currentQueryFilter.size))]),s("option",{attrs:{value:"10"}},[t._v("10")]),s("option",{attrs:{value:"20"}},[t._v("20")]),s("option",{attrs:{value:"40"}},[t._v("40")]),s("option",{attrs:{value:"80"}},[t._v("80")]),s("option",{attrs:{value:"100"}},[t._v("100")]),s("option",{attrs:{value:"200"}},[t._v("200")]),s("option",{attrs:{value:"500"}},[t._v("500")])])]):t._e()]),s("div",{staticClass:"level-item"},[t.eventList.objects.length?s("button",{staticClass:"button is-small",staticStyle:{"border-radius":"4px"},on:{click:t.changeSortOrder}},[t._v("\n                  "+t._s(t.currentQueryFilter.order)+"\n                ")]):t._e()]),s("div",{staticClass:"level-item"},[t.eventList.objects.length?s("div",[s("b-dropdown",{attrs:{position:"is-bottom-left","aria-role":"menu","trap-focus":"","append-to-body":"","can-close":!0}},[s("button",{staticClass:"button is-outlined is-small",staticStyle:{"border-radius":"4px"},attrs:{slot:"trigger"},slot:"trigger"},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-table"})]),s("span",[t._v("Customize columns")])]),s("b-dropdown-item",{attrs:{"aria-role":"menu-item",focusable:!1,custom:""}},[s("div",{class:{tsdropdown:t.expandFieldDropdown},staticStyle:{width:"300px"}},[t.meta.mappings?s("multiselect",{staticStyle:{display:"block"},attrs:{options:t.meta.mappings,value:t.selectedFieldsProxy,multiple:!0,searchable:!0,"close-on-select":!1,label:"field","track-by":"field",placeholder:"Add more columns ..."},on:{open:function(e){t.expandFieldDropdown=!0},close:function(e){t.expandFieldDropdown=!1},input:t.updateSelectedFields}}):t._e()],1)]),s("b-dropdown-item",{attrs:{"aria-role":"menu-item",focusable:!1,custom:""}},[t.selectedFields.length?s("span",[s("br"),s("strong",[t._v("Selected columns")]),s("br"),s("br")]):t._e(),s("div",{staticClass:"tags"},t._l(t.selectedFields,(function(e,i){return s("span",{key:i},[s("span",{staticClass:"tag is-light is-rounded",staticStyle:{"margin-right":"7px"}},[s("span",{staticStyle:{"margin-right":"7px"}},[t._v(t._s(e.field))]),s("button",{staticClass:"delete is-small",staticStyle:{"margin-left":"7px"},on:{click:function(e){return t.removeField(i)}}})])])})),0),s("hr"),s("b-switch",{attrs:{type:"is-info"},model:{value:t.displayOptions.showTags,callback:function(e){t.$set(t.displayOptions,"showTags",e)},expression:"displayOptions.showTags"}},[s("span",[t._v("Show tags")])]),s("br"),s("b-switch",{attrs:{type:"is-info"},model:{value:t.displayOptions.showEmojis,callback:function(e){t.$set(t.displayOptions,"showEmojis",e)},expression:"displayOptions.showEmojis"}},[s("span",[t._v("Show emojis")])]),s("br"),s("b-switch",{attrs:{type:"is-info"},model:{value:t.displayOptions.showMillis,callback:function(e){t.$set(t.displayOptions,"showMillis",e)},expression:"displayOptions.showMillis"}},[s("span",[t._v("Show microseconds")])])],1)],1)],1):t._e()]),s("div",{staticClass:"level-item"},[t.eventList.objects.length?s("button",{staticClass:"button is-small",staticStyle:{"border-radius":"4px"},on:{click:t.exportSearchResult}},[t._m(3),s("span",[t._v("Export to CSV")])]):t._e()])])]),t.totalHits>0?s("div",{staticStyle:{"margin-top":"20px"}}):t._e(),t.eventList.objects.length?s("ts-sketch-explore-event-list",{attrs:{"event-list":t.eventList.objects,order:t.currentQueryFilter.order,"selected-fields":t.selectedFields,"display-options":t.displayOptions},on:{addChip:function(e){return t.addChip(e)},addLabel:function(e){return t.updateLabelList(e)},searchContext:function(e){return t.searchContext(e)}}}):t._e(),t.eventList.objects.length?s("div",{staticStyle:{float:"right"}},[s("b-pagination",{attrs:{total:t.totalHitsForPagination,"per-page":t.currentQueryFilter.size,current:t.currentPage,simple:!0,size:"is-small","icon-pack":"fas","icon-prev":"chevron-left","icon-next":"chevron-right"},on:{change:function(e){return t.paginate(e)},"update:current":function(e){t.currentPage=e}}})],1):t._e(),s("br")],1)]),s("br")])])],1)},ri=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"card-header-title"},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-search"})]),s("span",{staticStyle:{"margin-left":"10px"}},[t._v("Search")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-circle-notch fa-pulse"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-star"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-file-export"})])}],oi=(s("20d6"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("b-modal",{attrs:{active:t.showCreateViewModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showCreateViewModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Save search")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("ts-create-view-form",{attrs:{sketchId:t.sketchId,currentQueryString:t.currentQueryString,currentQueryFilter:t.currentQueryFilter},on:{setActiveView:function(e){return t.setActiveView(e)}}})],1)])])]),s("b-dropdown",{ref:"dropdown",attrs:{animation:"none","aria-role":"menu",position:t.position,"append-to-body":!t.isSimple},scopedSlots:t._u([{key:"trigger",fn:function(e){var i=e.active;return s("a",{staticClass:"button",class:{"is-rounded":t.isSimple,"ts-search-dropdown":!t.isSimple}},[t.isSimple?t._e():s("b-icon",{staticStyle:{"margin-right":"7px","font-size":"0.6em"},attrs:{icon:"save"}}),t.activeView?s("span",{staticStyle:{"margin-right":"7px"}},[t._v(t._s(t.isSimple?"+ Saved search":t.activeView.name))]):t._e(),t.isSimple?s("span",[t._v("+ Saved search")]):t._e(),s("b-icon",{staticStyle:{"font-size":"0.6em"},attrs:{icon:i?"chevron-up":"chevron-down"}})],1)}}])},[s("div",{staticClass:"modal-card",staticStyle:{width:"500px",color:"var(--font-color-dark)"}},[s("section",{staticClass:"modal-card-body"},[t.isSimple?t._e():s("div",[s("p",[t._v("\n                Save search query and filters that you want to use again.\n              ")]),s("hr")]),t.meta.views.length?s("div",t._l(t.meta.views,(function(e){return s("b-dropdown-item",{key:e.id,on:{click:function(s){return t.setActiveView(e)}}},[s("span",[t._v(t._s(e.name))])])})),1):t._e()])]),t.isSimple?t._e():s("div",{staticClass:"level footer"},[s("div",{staticClass:"level-left"},[s("div",{staticClass:"level-item"},[t.activeView?s("button",{staticClass:"button is-text",staticStyle:{color:"var(--font-color-dark)","text-decoration":"none"},on:{click:t.clearSearch}},[t._v("Clear")]):t._e()])]),s("div",{staticClass:"level-right"},[s("div",{staticClass:"level-item"},[t.activeView?s("button",{staticClass:"button level-item",staticStyle:{"border-radius":"5px"},attrs:{disabled:!t.currentQueryString},on:{click:t.updateView}},[t._v("Save changes")]):t._e()]),s("div",{staticClass:"level-item"},[s("button",{staticClass:"button is-info level-item",staticStyle:{"border-radius":"5px"},attrs:{disabled:!t.currentQueryString},on:{click:t.saveView}},[s("b-icon",{attrs:{icon:"save",size:"is-small"}}),s("span",[t._v(t._s(t.activeView?"Save as new":"Save current search"))])],1)])])])])],1)}),ci=[],li=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm(e)}}},[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Name")]),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.viewName,expression:"viewName"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Name your view",autofocus:""},domProps:{value:t.viewName},on:{input:function(e){e.target.composing||(t.viewName=e.target.value)}}})])]),t._m(0)])},ui=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save"}})])])}],di={props:["sketchId","currentQueryString","currentQueryFilter"],data:function(){return{viewName:""}},methods:{clearFormData:function(){this.viewName=""},submitForm:function(){var t=this;E.createView(this.sketchId,this.viewName,this.currentQueryString,this.currentQueryFilter).then((function(e){var s=e.data.objects[0];t.$emit("setActiveView",s),t.$store.state.meta.views.push(s),t.clearFormData(),t.$router.push({name:"SketchExplore",query:{view:s.id}})})).catch((function(t){}))}}},hi=di,mi=Object(c["a"])(hi,li,ui,!1,null,null,null),pi=mi.exports,fi={components:{TsCreateViewForm:pi},props:["currentQueryString","currentQueryFilter","isSimple","isLast","sketchId"],data:function(){return{activeView:null,showCreateViewModal:!1,position:"is-bottom-right"}},methods:{setActiveView:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.showCreateViewModal=!1,this.activeView=t,e&&this.$emit("setActiveView",t)},clearSearch:function(){this.$emit("clearSearch"),this.activeView=null,this.$refs.dropdown.toggle()},saveView:function(){this.showCreateViewModal=!0,this.$refs.dropdown.toggle()},updateView:function(){var t=this;this.activeView&&(this.$refs.dropdown.toggle(),this.activeView.query=this.currentQueryString,this.activeView.filter=JSON.stringify(this.currentQueryFilter),E.updateView(this.sketchId,this.activeView.id,this.currentQueryString,this.currentQueryFilter).then((function(e){t.$buefy.toast.open("Saved search has been updated")})).catch((function(t){})))}},computed:{meta:function(){return this.$store.state.meta}},created:function(){this.isLast&&(this.position="is-top-right");var t=this.$route.query.view;if(t){var e=this.meta.views.filter((function(e){return e.id===parseInt(t)}));this.setActiveView(e[0],!1)}}},vi=fi,gi=(s("7c44"),Object(c["a"])(vi,oi,ci,!1,null,"2dfc6746",null)),_i=gi.exports,yi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",{staticClass:"table is-fullwidth"},[s("thead",[s("th",{attrs:{width:t.datetimeWidth}},[t._v("Datetime (UTC)")]),s("th",{attrs:{width:"1"}},[s("span",{staticClass:"control"},[s("input",{attrs:{type:"checkbox"},on:{click:t.toggleSelectAll}})])]),t._l(t.selectedFields,(function(e,i){return s("th",{key:i},[t._v(t._s(t._f("capitalize")(e.field)))])})),s("th",{attrs:{width:"150"}},[t._v("Timeline name")])],2),t._l(t.eventList,(function(e,i){return s("ts-sketch-explore-event-list-row",{key:i,attrs:{event:e,prevEvent:t.eventList[i-1],order:t.order,"selected-fields":t.selectedFields,"display-options":t.displayOptions,"display-controls":!0,id:e._id},on:{addChip:function(e){return t.$emit("addChip",e)},addLabel:function(e){return t.$emit("addLabel",e)},searchContext:function(e){return t.$emit("searchContext",e)}}})}))],2)},bi=[],Ci=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tbody",[t.deltaDays>0?s("tr",[s("td",{staticStyle:{padding:"0"},attrs:{colspan:"5"}},[s("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color"}),s("div",{staticClass:"ts-time-bubble ts-time-bubble-color"},[s("h5",[s("b",[t._v(t._s(t._f("compactNumber")(t.deltaDays)))]),s("br"),t._v("days")])]),s("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color"})])]):t._e(),s("tr",[s("td",{style:t.timelineColor},[t._v("\n        "+t._s(t._f("moment")(t._f("formatTimestamp")(t.event._source.timestamp),"utc",t.datetimeFormat))+"\n      ")]),s("td",[s("div",{staticClass:"field is-grouped"},[t.displayControls?s("span",{staticClass:"control"},[s("input",{attrs:{type:"checkbox"},domProps:{checked:t.isSelected},on:{click:t.toggleSelect}})]):t._e(),s("span",{staticClass:"icon control",staticStyle:{"margin-right":"3px",cursor:"pointer"},on:{click:t.toggleStar}},[t.isStarred?s("i",{staticClass:"fas fa-star",staticStyle:{color:"#ffe300","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"#d1d1d1"},attrs:{title:"Unstar the event"}}):t._e(),t.isStarred?t._e():s("i",{staticClass:"fas fa-star",staticStyle:{color:"#d3d3d3"},attrs:{title:"Star the event"}})]),t.displayControls?s("span",{staticClass:"icon control",staticStyle:{"margin-right":"3px",cursor:"pointer"},on:{click:t.searchContext}},[s("i",{staticClass:"fas fa-search",staticStyle:{color:"#d3d3d3"},attrs:{title:"Search +/- 5min"}})]):t._e(),s("span",{staticClass:"icon control"},[s("b-dropdown",{ref:"labelDropdown",attrs:{"aria-role":"list","append-to-body":""}},[s("i",{staticClass:"fas fa-tag",staticStyle:{color:"#d3d3d3"},attrs:{slot:"trigger",title:"Labels"},slot:"trigger"}),s("div",{staticClass:"modal-card",staticStyle:{width:"300px",color:"var(--font-color-dark)"}},[s("section",{staticClass:"modal-card-body"},[s("b-dropdown-item",{attrs:{custom:"",focusable:!1}},[t.filteredLabelsToAdd.length?s("span",[s("b",[t._v("Label as:")]),s("br"),s("br"),t._l(t.filteredLabelsToAdd,(function(e){return s("div",{key:e,staticClass:"level",staticStyle:{"margin-bottom":"5px"}},[s("div",{staticClass:"level-left"},[s("div",{staticClass:"field"},[s("b-checkbox",{attrs:{type:"is-info","native-value":e},model:{value:t.selectedLabels,callback:function(e){t.selectedLabels=e},expression:"selectedLabels"}},[t._v("\n                                "+t._s(e)+"\n                              ")])],1)])])})),s("hr")],2):t._e(),t.event._source.label.length?s("span",[s("i",{staticClass:"fas fa-trash",staticStyle:{"margin-right":"7px"}}),s("b",[t._v("Remove:")]),s("br"),s("br"),t._l(t.event._source.label,(function(e){return s("div",{key:e,staticClass:"level",staticStyle:{"margin-bottom":"5px"}},[s("div",{staticClass:"level-left"},[s("div",{staticClass:"field"},[s("b-checkbox",{attrs:{type:"is-danger","native-value":e},model:{value:t.labelsToRemove,callback:function(e){t.labelsToRemove=e},expression:"labelsToRemove"}},[t._v("\n                                "+t._s(e)+"\n                              ")])],1)])])})),s("hr")],2):t._e(),s("div",{staticClass:"field is-grouped"},[s("p",{staticClass:"control is-expanded"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.labelToAdd,expression:"labelToAdd"}],staticClass:"input",attrs:{placeholder:"Create new"},domProps:{value:t.labelToAdd},on:{input:function(e){e.target.composing||(t.labelToAdd=e.target.value)}}})]),s("p",{staticClass:"control"},[s("button",{staticClass:"button",on:{click:function(e){return t.addLabels(t.labelToAdd)}}},[t._v("Save")])])])])],1),s("section",{staticClass:"modal-card-foot"},[s("b-dropdown-item",[t.selectedLabels.length||t.labelsToRemove.length?s("button",{staticClass:"button is-info",attrs:{disabled:null!==t.labelToAdd&&""!==t.labelToAdd},on:{click:function(e){return t.addLabels()}}},[t._v("Apply")]):t._e()])],1)])])],1)])]),t._l(t.selectedFields,(function(e,i){return s("td",{key:i,staticStyle:{cursor:"pointer","max-width":"50ch"},style:t.fieldColumnColor,on:{click:function(e){t.showDetail=!t.showDetail}}},[s("span",{class:{"ts-event-field-container":1===t.selectedFields.length}},[s("span",{class:{"ts-event-field-ellipsis":1===t.selectedFields.length}},[0===i?s("span",[t._l(t.event._source.__ts_emojis,(function(e){return t.displayOptions.showEmojis?s("span",{key:e,attrs:{title:t.meta.emojis[e]},domProps:{innerHTML:t._s(e)}},[t._v(t._s(e))]):t._e()})),s("span",{staticStyle:{"margin-left":"10px"}}),t._l(t.event._source.tag,(function(e){return t.displayOptions.showTags?s("span",{key:e,staticClass:"tag is-small is-light",staticStyle:{"margin-right":"5px",border:"1px solid #d1d1d1"}},[t._v(t._s(e))]):t._e()})),t._l(t.filteredLabels,(function(e){return t.displayOptions.showTags?s("span",{key:e,staticClass:"tag is-small is-light",staticStyle:{"margin-right":"5px",border:"1px solid #d1d1d1"}},[t._v(t._s(e))]):t._e()}))],2):t._e(),s("span",{staticStyle:{"word-break":"break-word"},attrs:{title:t.event._source[e.field]}},[t._v("\n              "+t._s(t.event._source[e.field])+"\n            ")])])])])})),s("td",{staticClass:"ts-timeline-name-column ts-timeline-name-column-color"},[s("span",{attrs:{title:t.timelineName}},[t._v("\n          "+t._s(t.timelineName)+"\n        ")])])],2),t.comments.length?s("tr",[s("td",{attrs:{colspan:"5"}},[s("div",{staticStyle:{"max-width":"600px",border:"1px solid #f5f5f5","border-radius":"4px",padding:"10px","margin-bottom":"20px"}},t._l(t.comments,(function(e){return s("article",{key:e.created_at,staticClass:"media"},[s("div",{staticClass:"media-content"},[s("div",{staticClass:"content"},[s("p",[t._v("\n                  "+t._s(e.user.username)+" "),s("small",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t._f("moment")(e.created_at,"ll")))]),s("br"),t._v("\n                  "+t._s(e.comment)+"\n                ")])])])])})),0)])]):t._e(),s("tr",[s("td",{staticStyle:{padding:"0"},attrs:{colspan:"5"}},[t.showDetail?s("div",{staticStyle:{"padding-top":"20px","padding-bottom":"20px"}},[s("div",{staticClass:"field",staticStyle:{"max-width":"50%"}},[s("p",{staticClass:"control"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"textarea",attrs:{required:"",autofocus:"",rows:"1",placeholder:"Add a comment ..."},domProps:{value:t.comment},on:{input:function(e){e.target.composing||(t.comment=e.target.value)}}})])]),s("div",{staticClass:"field"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button",on:{click:function(e){return t.postComment(t.comment)}}},[t._v("Post comment")])])]),s("ts-sketch-explore-event-list-row-detail",{attrs:{event:t.event},on:{addChip:function(e){return t.$emit("addChip",e)}}})],1):t._e()])])])},ki=[],Si=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",{staticClass:"table is-bordered",staticStyle:{width:"100%","table-layout":"fixed"}},[s("tbody",t._l(t.fullEventFiltered,(function(e,i){return s("tr",{key:i},[s("td",{staticStyle:{width:"40px"}},[s("span",{staticClass:"icon is-small",staticStyle:{cursor:"pointer"},attrs:{title:"Apply 'Include' filter"},on:{click:function(s){return t.addFilter(i,e,"must")}}},[s("i",{staticClass:"fas fa-search-plus"})])]),s("td",{staticStyle:{width:"40px"}},[s("span",{staticClass:"icon is-small",staticStyle:{cursor:"pointer"},attrs:{title:"Apply 'Exclude' filter"},on:{click:function(s){return t.addFilter(i,e,"must_not")}}},[s("i",{staticClass:"fas fa-search-minus"})])]),s("td",{staticStyle:{"white-space":"pre-wrap","word-wrap":"break-word",width:"150px"}},[t._v(t._s(i))]),s("td",[s("span",{staticStyle:{"white-space":"pre-wrap","word-wrap":"break-word"}},[t._v(t._s(e))])])])})),0)])},wi=[],xi={props:["event"],data:function(){return{fullEvent:{}}},computed:{sketch:function(){return this.$store.state.sketch},fullEventFiltered:function(){var t=this;return Object.getOwnPropertyNames(this.fullEvent).forEach((function(e){e.startsWith("__ts")&&delete t.fullEvent[e]})),this.fullEvent}},methods:{getEvent:function(){var t=this,e=this.event._index,s=this.event._id;E.getEvent(this.sketch.id,e,s).then((function(e){t.fullEvent=e.data.objects})).catch((function(t){}))},addFilter:function(t,e,s){var i={field:t,value:e,type:"term",operator:s,active:!0};this.$emit("addChip",i)}},created:function(){this.getEvent()}},Ti=xi,Ei=Object(c["a"])(Ti,Si,wi,!1,null,null,null),$i=Ei.exports,Di={components:{TsSketchExploreEventListRowDetail:$i},props:["event","prevEvent","order","selectedFields","isRemoteSelected","displayOptions","displayControls"],data:function(){return{showDetail:!1,isStarred:!1,isSelected:!1,isDarkTheme:!1,comment:"",comments:[],labelToAdd:null,selectedLabels:[],labelsToRemove:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},timelineColor:function(){var t=this.timeline.color;return t.startsWith("#")||(t="#"+t),this.isDarkTheme?{"background-color":t,filter:"grayscale(25%)",color:"#333"}:{"background-color":t}},fieldColumnColor:function(){var t="#f5f5f5",e="#333";return this.isDarkTheme&&(t="#494949",e="#fafafa"),this.isStarred&&(t="#fff4b3",e="#333"),this.isSelected&&(t="#c3ecff",e="#333"),this.isDarkTheme,{"background-color":t,color:e}},datetimeFormat:function(){return this.displayOptions.showMillis?"YYYY-MM-DDTHH:mm:ss.SSSSSS":"YYYY-MM-DDTHH:mm:ss"},timelineName:function(){return this.timeline.name},deltaDays:function(){if(!this.prevEvent)return 0;var t=this.$options.filters.formatTimestamp(this.event._source.timestamp),e=this.$options.filters.formatTimestamp(this.prevEvent._source.timestamp),s=Math.floor(t/1e3),i=Math.floor(e/1e3),a=Math.floor(s-i);"desc"===this.order&&(a=Math.floor(i-s));var n=a/60/60/24;return Math.floor(n)},eventDataSparse:function(){var t={};return t["_index"]=this.event._index,t["_id"]=this.event._id,t["_type"]=this.event._type,t["isSelected"]=this.isSelected,t},filteredLabels:function(){return this.event._source.label.filter((function(t){return!t.startsWith("__")}))},filteredLabelsToAdd:function(){var t=this;return this.meta.filter_labels.filter((function(e){return-1===t.event._source.label.indexOf(e)}))},filteredLabelsToRemove:function(){var t=this;return this.meta.filter_labels.filter((function(e){return-1!==t.event._source.label.indexOf(e)}))}},methods:{toggleStar:function(){this.isStarred=!this.isStarred,E.saveEventAnnotation(this.sketch.id,"label","__ts_star",this.event).then((function(t){})).catch((function(t){console.error(t)}))},toggleStarOnSelect:function(){this.isSelected&&(this.isStarred=!this.isStarred)},postComment:function(t){var e=this;E.saveEventAnnotation(this.sketch.id,"comment",t,[this.event]).then((function(t){e.comments.push(t.data.objects[0][0]),e.comment=""})).catch((function(t){}))},addLabels:function(t){var e=this;void 0===t&&(t=this.selectedLabels),Array.isArray(t)||(t=[t]),t.forEach((function(t){-1===e.event._source.label.indexOf(t)&&(e.event._source.label.push(t),E.saveEventAnnotation(e.sketch.id,"label",t,[e.event]).then((function(s){e.$emit("addLabel",t)})).catch((function(s){S["a"].open("Error adding label"),e.event._source.label=e.event._source.label.filter((function(e){return e!==t}))})))})),this.labelsToRemove.length&&(this.labelsToRemove.forEach((function(t){E.saveEventAnnotation(e.sketch.id,"label",t,[e.event],!0).then((function(t){})).catch((function(t){})),e.event._source.label=e.event._source.label.filter((function(e){return e!==t}))})),this.labelsToRemove=[]),this.selectedLabels=[],this.labelToAdd=null,this.$refs.labelDropdown.toggle()},searchContext:function(){this.$emit("searchContext",this.event)},selectEvent:function(){this.isSelected=!0,Xn.$emit("eventSelected",this.eventDataSparse)},unSelectEvent:function(){this.isSelected=!1,Xn.$emit("eventSelected",this.eventDataSparse)},toggleSelect:function(){this.isSelected?this.unSelectEvent():this.selectEvent()},toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme}},beforeDestroy:function(){Xn.$off("selectEvent",this.selectEvent),Xn.$off("clearSelectedEvents",this.unSelectEvent),Xn.$off("toggleStar",this.toggleStarOnSelect)},created:function(){var t=this;Xn.$on("selectEvent",this.selectEvent),Xn.$on("clearSelectedEvents",this.unSelectEvent),Xn.$on("toggleStar",this.toggleStarOnSelect),Xn.$on("isDarkTheme",this.toggleTheme);var e=this.meta.indices_metadata[this.event._index].is_legacy;if(this.timeline=e?this.sketch.active_timelines.filter((function(e){return e.searchindex.index_name===t.event._index}))[0]:this.sketch.active_timelines.filter((function(e){return e.id===t.event._source.__ts_timeline_id}))[0],this.isDarkTheme="dark"===localStorage.theme,this.event._source.label.indexOf("__ts_star")>-1&&(this.isStarred=!0),this.event._source.label.indexOf("__ts_comment")>-1){var s=this.event._index,i=this.event._id;E.getEvent(this.sketch.id,s,i).then((function(e){t.comments=e.data.meta.comments})).catch((function(t){}))}}},Ai=Di,Oi=(s("af74"),Object(c["a"])(Ai,Ci,ki,!1,null,"b8a5e44c",null)),Fi=Oi.exports,Ni={components:{TsSketchExploreEventListRow:Fi},props:["eventList","order","selectedFields","displayOptions"],data:function(){return{selectAll:!1}},methods:{toggleSelectAll:function(){this.selectAll?(Xn.$emit("clearSelectedEvents"),this.selectAll=!1):(Xn.$emit("selectEvent"),this.selectAll=!0)}},computed:{datetimeWidth:function(){return this.displayOptions.showMillis?"220":"165"}}},Pi=Ni,ji=(s("e8e7"),Object(c["a"])(Pi,yi,bi,!1,null,"1d49b668",null)),Mi=ji.exports,Li=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._l(t.activeTimelines,(function(e){return s("span",{key:e.id,staticClass:"tag is-medium has-text-left",staticStyle:{cursor:"pointer","margin-right":"7px","margin-bottom":"7px"},style:t.timelineColor(e),on:{click:function(s){return t.toggleTimeline(e)}}},[t._v("\n    "+t._s(e.name)+" "),s("span",{staticClass:"tag is-small",staticStyle:{"margin-left":"10px","margin-right":"-7px","background-color":"rgba(255,255,255,0.5)","min-width":"50px"}},[t.timelineIsEnabled(e)&&t.countPerTimeline?s("span",[t._v(t._s(t._f("compactNumber")(t.getCount(e))))]):t._e()])])})),t.activeTimelines.length>3?s("div",{staticStyle:{"margin-top":"7px"}},[s("span",{staticStyle:{"text-decoration":"underline",cursor:"pointer","margin-right":"10px"},on:{click:t.enableAllTimelines}},[t._v("Enable all")]),s("span",{staticStyle:{"text-decoration":"underline",cursor:"pointer"},on:{click:t.disableAllTimelines}},[t._v("Disable all")])]):t._e()],2)},Ii=[],zi={props:["activeTimelines","currentQueryFilter","countPerIndex","countPerTimeline"],data:function(){return{isDarkTheme:!1,selectedTimelines:[],timelineCount:{}}},methods:{timelineColor:function(t){this.isDarkTheme="dark"===localStorage.theme;var e=t.color,s="none",i="100%";return e.startsWith("#")||(e="#"+e),this.selectedTimelines.includes(t)||(e="#d2d2d2",s="line-through",i="50%"),this.isDarkTheme?{"background-color":e,"text-decoration":s,opacity:i,filter:"grayscale(25%)",color:"#333333"}:{"background-color":e,"text-decoration":s,opacity:i}},toggleTimeline:function(t){var e=this.selectedTimelines.slice(),s=e.indexOf(t);-1===s?e.push(t):e.splice(s,1),this.selectedTimelines=e,this.$emit("updateSelectedTimelines",this.selectedTimelines)},enableAllTimelines:function(){this.selectedTimelines=this.activeTimelines,this.$emit("updateSelectedTimelines",this.selectedTimelines)},disableAllTimelines:function(){this.selectedTimelines=[],this.$emit("updateSelectedTimelines",this.selectedTimelines)},timelineIsEnabled:function(t){return this.selectedTimelines.includes(t)},toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme},getCount:function(t){var e=this.countPerTimeline[t.id];return void 0===e&&(e=this.countPerIndex[t.searchindex.index_name]),e},syncSelectedTimelines:function(){var t=this,e=[];this.currentQueryFilter.indices.forEach((function(s){if("string"===typeof s){var i=t.activeTimelines.find((function(t){return t.searchindex.index_name===s}));e.push(i)}else if("number"===typeof s){var a=t.activeTimelines.find((function(t){return t.id===s}));e.push(a)}})),this.selectedTimelines=e}},created:function(){Xn.$on("isDarkTheme",this.toggleTheme),Xn.$on("clearSearch",this.enableAllTimelines),this.currentQueryFilter.indices.includes("_all")?this.selectedTimelines=this.activeTimelines:this.syncSelectedTimelines()},watch:{"currentQueryFilter.indices":function(t){this.syncSelectedTimelines()},deep:!0}},Ri=zi,Qi=Object(c["a"])(Ri,Li,Ii,!1,null,null,null),Gi=Qi.exports,Vi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"field is-horizontal"},[s("div",{staticClass:"field-body",staticStyle:{display:"flex","align-items":"center"}},[s("b-radio",{attrs:{"native-value":"interval",type:"is-info"},on:{input:function(e){return t.formatDateTime()}},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}}),s("div",{staticClass:"field",staticStyle:{"margin-left":"5px"}},[s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.offsetStart,expression:"offsetStart",modifiers:{trim:!0}}],ref:"offsetStartInput",staticClass:"input",attrs:{type:"text",disabled:!t.isSelected("interval"),placeholder:t.getPlaceholder("interval")},domProps:{value:t.offsetStart},on:{change:function(e){t.offsetStart&&t.formatDateTime()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit()},input:function(e){e.target.composing||(t.offsetStart=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]),s("div",[t._v("-")]),s("div",{staticClass:"field",staticStyle:{margin:"0px"}},[s("p",{staticClass:"control",staticStyle:{width:"40px","margin-left":"2px"}},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.offsetMinus,expression:"offsetMinus",modifiers:{trim:!0}}],ref:"offsetMinusInput",staticClass:"input",staticStyle:{width:"90%"},attrs:{type:"text",disabled:!t.isSelected("interval")},domProps:{value:t.offsetMinus},on:{change:function(e){t.offsetMinus&&t.formatDateTime()},keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit()},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"]))return null;t.offsetMinus++},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"]))return null;t.offsetMinus--}],input:function(e){e.target.composing||(t.offsetMinus=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]),s("div",[t._v("+")]),s("div",{staticClass:"field",staticStyle:{margin:"0px"}},[s("p",{staticClass:"control",staticStyle:{width:"40px","margin-left":"2px"}},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.offsetPlus,expression:"offsetPlus",modifiers:{trim:!0}}],ref:"offsetPlusInput",staticClass:"input",staticStyle:{width:"90%"},attrs:{type:"text",disabled:!t.isSelected("interval")},domProps:{value:t.offsetPlus},on:{change:function(e){t.offsetPlus&&t.formatDateTime()},keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit()},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"]))return null;t.offsetPlus++},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"]))return null;t.offsetPlus--}],input:function(e){e.target.composing||(t.offsetPlus=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]),s("div"),s("div",{staticClass:"field",staticStyle:{"margin-right":"5px"}},[s("p",{staticClass:"control"},[s("span",{staticClass:"select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedInterval,expression:"selectedInterval"}],attrs:{disabled:!t.isSelected("interval")},on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedInterval=e.target.multiple?s:s[0]},function(e){t.offsetStart&&t.formatDateTime()}]}},t._l(t.intervals,(function(e){return s("option",{key:e.value,domProps:{value:e.value}},[t._v(t._s(e.text))])})),0)])])])],1)]),s("div",{staticClass:"field is-horizontal"},[s("div",{staticClass:"field-body",staticStyle:{display:"flex","align-items":"center"}},[s("b-radio",{attrs:{"native-value":"range",type:"is-info"},on:{input:function(e){return t.formatDateTime()}},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}}),s("div",{staticClass:"field",staticStyle:{margin:"5px"}},[s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.startDateTime,expression:"startDateTime",modifiers:{trim:!0}}],ref:"startInput",staticClass:"input",attrs:{type:"text",disabled:!t.isSelected("range"),placeholder:t.getPlaceholder("range")},domProps:{value:t.startDateTime},on:{change:function(e){t.startDateTime&&t.formatDateTime()},keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.endDateTime?t.submit():t.formatDateTime(t.skipCheck=!0)&&t.jumpTo("endInput")},input:function(e){e.target.composing||(t.startDateTime=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]),s("div",[t._v("â†’")]),s("div",{staticClass:"field",staticStyle:{margin:"5px"}},[s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.endDateTime,expression:"endDateTime",modifiers:{trim:!0}}],ref:"endInput",staticClass:"input",attrs:{type:"text",disabled:!t.isSelected("range"),placeholder:t.getPlaceholder("range")},domProps:{value:t.endDateTime},on:{change:function(e){t.endDateTime&&t.formatDateTime()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit()},input:function(e){e.target.composing||(t.endDateTime=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])])],1)]),s("div",{staticClass:"field is-horizontal"},[s("div",{staticClass:"field is-grouped"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-success",attrs:{disabled:!t.ready},on:{click:t.submit}},[t._v(t._s(t.selectedChip?"Update":"Create"))])])])])])},qi=[],Ui=(s("8e6e"),s("4917"),s("bd86"));function Yi(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function Hi(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Yi(Object(s),!0).forEach((function(e){Object(Ui["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Yi(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var Ji={props:["selectedChip"],data:function(){return{startDateTime:"",endDateTime:"",chip:"",radio:"interval",offsetStart:"",offsetMinus:5,offsetPlus:5,intervals:[{text:"Second",value:"s"},{text:"Minute",value:"m"},{text:"Hour",value:"h"},{text:"Day",value:"d"}],selectedInterval:"m",ready:!1,now:this.$moment.utc().format("YYYY-MM-DD[T]hh:mm:ss")}},created:function(){if(this.selectedChip)if(this.chip=Hi({},this.selectedChip),"datetime_range"===this.chip.type){this.radio="range";var t=this.chip.value.split(",");this.startDateTime=t[0],this.endDateTime=t[1]}else{this.radio="interval";var e=this.chip.value.split(" ");this.offsetStart=e[0],this.offsetMinus=e[1].match(/\d+/)[0],this.offsetPlus=e[2].match(/\d+/)[0],this.selectedInterval=e[1].match(/[a-zA-Z]+/)[0],this.formatDateTime()}},methods:{hasAllInputs:function(){if(this.isSelected("interval")){if(this.offsetStart&&this.offsetMinus&&this.offsetPlus)return!0}else if(this.isSelected("range")&&this.startDateTime&&this.endDateTime)return!0;return!1},getPlaceholder:function(t){return this.radio==t?this.now:""},getOffsetDateTime:function(){return"".concat(this.offsetStart," -").concat(this.offsetMinus).concat(this.selectedInterval," +").concat(this.offsetPlus).concat(this.selectedInterval)},formatDateTime:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.ready=!1,!t&&!this.hasAllInputs())return!1;var e=this.isSelected("interval")?this.getOffsetDateTime():this.startDateTime,s="YYYY-MM-DDTHH:mm:ss",i=this.endDateTime,a=/^(.+?)[ ]?(-|\+|\+-|-\+)(\d+)(y|d|h|m|s|M|Q|w|ms)[ ]*(?:(-|\+|\+-|-\+)(\d+)(y|d|h|m|s|M|Q|w|ms))?$/,n=a.exec(e);if(null!=n){var r=this.$moment.utc(n[1]);if(!r.isValid())return!1;this.startDateTime=r.format(s),this.endDateTime=r.format(s),n=n.slice(2);while(n.length){var o=n[0],c=n[1],l=n[2]||"m";n=n.slice(3),"-"===o?this.startDateTime=r.clone().subtract(c,l).format(s):"+"===o?this.endDateTime=r.clone().add(c,l).format(s):"-+"!==o&&"+-"!==o||(this.startDateTime=r.clone().subtract(c,l).format(s),this.endDateTime=r.clone().add(c,l).format(s))}return this.ready=!0,!0}i||(i=e);var u=this.$moment.utc(e),d=this.$moment.utc(i);return u.hour()||u.minute()||u.second()||d.hour()||d.minute()||d.second()||(s="YYYY-MM-DD"),u.isValid()&&(this.startDateTime=u.format(s)),d.isValid()&&(this.endDateTime=d.format(s)),!(!u.isValid()||!d.isValid())&&(this.ready=!0,!0)},submit:function(){if(this.startDateTime&&this.endDateTime&&this.formatDateTime()){if(this.startDateTime>this.endDateTime){var t=[this.endDateTime,this.startDateTime];this.startDateTime=t[0],this.endDateTime=t[1]}var e="",s="";"interval"==this.radio?(e="datetime_interval",s=this.getOffsetDateTime()):(e="datetime_range",s=this.startDateTime+","+this.endDateTime),this.chip?(this.chip["type"]=e,this.chip["value"]=s,this.$emit("updateChip",this.chip)):(this.chip={field:"",type:e,value:s,operator:"must",active:!0},this.$emit("addChip",this.chip),this.resetInterface()),this.$emit("hideDropdown")}},resetInterface:function(){Object.assign(this.$data,this.$options.data.apply(this))},isSelected:function(t){return this.radio===t},jumpTo:function(t){this.$refs[t].focus()}}},Bi=Ji,Wi=Object(c["a"])(Bi,Vi,qi,!1,null,null,null),Zi=Wi.exports,Ki=function(){return{from:0,terminate_after:40,size:40,indices:[],order:"asc",chips:[]}},Xi=function(){return{meta:{count_per_index:{}},objects:[]}},ta={components:{TsSketchExploreAggregation:Gs,TsViewListDropdown:_i,TsSketchExploreEventList:Mi,TsExploreTimelinePicker:Gi,TsExploreFilterTime:Zi,TsExploreSessionChart:xe},props:["sketchId"],data:function(){return{params:{},showCreateViewModal:!1,showFilterCard:!0,showSearch:!0,searchInProgress:!1,currentPage:1,contextEvent:!1,originalContext:!1,isFullPage:!0,loadingComponent:null,eventList:{meta:{},objects:[]},currentQueryString:"",currentQueryFilter:Ki(),selectedFields:[{field:"message",type:"text"}],selectedFieldsProxy:[],expandFieldDropdown:!1,selectedEvents:{},displayOptions:{showTags:!0,showEmojis:!0,showMillis:!1},selectedLabels:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},totalHits:function(){return this.eventList.meta.es_total_count||0},totalHitsForPagination:function(){var t=this.eventList.meta.es_total_count||0;return t>9999&&(t=1e4),t},totalTime:function(){return this.eventList.meta.es_time/1e3||0},fromEvent:function(){return this.currentQueryFilter.from||1},toEvent:function(){if(!(this.totalHits<this.currentQueryFilter.size))return parseInt(this.currentQueryFilter.from)+parseInt(this.currentQueryFilter.size)},numSelectedEvents:function(){return Object.keys(this.selectedEvents).length},filterChips:function(){return this.currentQueryFilter.chips.filter((function(t){return"label"===t.type||"term"===t.type}))},timeFilterChips:function(){return this.currentQueryFilter.chips.filter((function(t){return t.type.startsWith("datetime")}))}},methods:{hideDropdown:function(){this.$refs["NewTimeFilter"].isActive=!1},search:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.searchInProgress=!0,this.currentQueryString){this.contextEvent&&this.$scrollTo("#context",200,{offset:-300}),this.selectedEvents={},this.eventList=Xi(),s&&(this.currentQueryFilter.from=0,this.currentPage=1),this.currentQueryFilter.fields=this.selectedFields;var i={query:this.currentQueryString,filter:this.currentQueryFilter};e&&Xn.$emit("newSearch"),E.search(this.sketchId,i).then((function(e){t.eventList.objects=e.data.objects,t.eventList.meta=e.data.meta,t.searchInProgress=!1})).catch((function(t){}))}},exportSearchResult:function(){var t=this;this.loadingOpen();var e={query:this.currentQueryString,filter:this.currentQueryFilter,file_name:"export.zip"};E.exportSearchResult(this.sketchId,e).then((function(e){var s=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a"),a="export.zip";i.href=s,i.setAttribute("download",a),document.body.appendChild(i),i.click(),t.loadingClose()})).catch((function(e){console.error(e),t.loadingClose()}))},searchView:function(t){var e=this;this.selectedEvents={},t!==parseInt(t,10)&&"string"!==typeof t&&(t=t.id,this.$router.push({name:"SketchExplore",query:{view:t}})),E.getView(this.sketchId,t).then((function(t){var s=t.data.objects[0];if(e.currentQueryString=s.query_string,e.currentQueryFilter=JSON.parse(s.query_filter),e.currentQueryFilter.fields&&e.currentQueryFilter.fields.length||(e.currentQueryFilter.fields=[{field:"message",type:"text"}]),e.selectedFields=e.currentQueryFilter.fields,"_all"===e.currentQueryFilter.indices[0]){var i=[];e.sketch.active_timelines.forEach((function(t){var s=e.meta.indices_metadata[t.searchindex.index_name].is_legacy;s?i.push(t.searchindex.index_name):i.push(t.id)})),e.currentQueryFilter.indices=i}var a=e.currentQueryFilter.chips;if(a)for(var n=0;n<a.length;n++)"label"===a[n].type&&e.selectedLabels.push(a[n].value);e.contextEvent=!1,e.search(!1)})).catch((function(t){}))},searchContext:function(t){var e=300,s=500;if(this.contextEvent=t,!this.originalContext){var i=JSON.parse(JSON.stringify(this.currentQueryString)),a=JSON.parse(JSON.stringify(this.currentQueryFilter));this.originalContext={queryString:i,queryFilter:a}}var n="YYYY-MM-DDTHH:mm:ss",r=this.$moment.utc(this.contextEvent._source.datetime),o=r.clone().subtract(e,"s").format(n),c=r.clone().add(e,"s").format(n),l={field:"",value:o+","+r.format(n),type:"datetime_range",operator:"must",active:!0},u={field:"",value:r.format(n)+","+c,type:"datetime_range",operator:"must",active:!0};this.currentQueryString="* OR _id:"+this.contextEvent._id,this.currentQueryFilter.chips=[l,u];var d=this.meta.indices_metadata[this.contextEvent._index].is_legacy;this.currentQueryFilter.indices=d?[this.contextEvent._index]:[this.contextEvent._source.__ts_timeline_id],this.currentQueryFilter.size=s,this.search()},removeContext:function(){this.contextEvent=!1,this.currentQueryString=JSON.parse(JSON.stringify(this.originalContext.queryString)),this.currentQueryFilter=JSON.parse(JSON.stringify(this.originalContext.queryFilter)),this.search()},scrollToContextEvent:function(){this.$scrollTo("#"+this.contextEvent._id,200,{offset:-300})},updateSelectedTimelines:function(t){var e=this,s=[];t.forEach((function(t){var i=e.meta.indices_metadata[t.searchindex.index_name].is_legacy;i?s.push(t.searchindex.index_name):s.push(t.id)})),this.currentQueryFilter.indices=s,this.search()},clearSearch:function(){this.currentQueryString="",this.currentQueryFilter=Ki(),this.currentQueryFilter.indices="_all",this.eventList=Xi(),this.$router.replace({query:null})},toggleChip:function(t){void 0===t.active&&(t.active=!0),t.active=!t.active,this.search()},removeChip:function(t){var e=this.currentQueryFilter.chips.findIndex((function(e){return e.value===t.value}));this.currentQueryFilter.chips.splice(e,1),"label"===t.type&&(this.selectedLabels=this.selectedLabels.filter((function(e){return e!==t.value}))),this.search()},updateChip:function(t,e){var s=this.currentQueryFilter.chips.findIndex((function(t){return t.value===e.value&&t.type==e.type}));this.currentQueryFilter.chips.splice(s,1,t),this.search()},addChip:function(t){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.push(t),this.search()},toggleLabelChip:function(t){var e={field:"",value:t,type:"label",operator:"must",active:!0},s=this.currentQueryFilter.chips;if(s)for(var i=0;i<s.length;i++)if(s[i].value===t)return void this.removeChip(i);this.addChip(e)},updateLabelChips:function(){var t=this;this.currentQueryFilter.chips=this.currentQueryFilter.chips.filter((function(t){return"label"!==t.type})),this.selectedLabels.forEach((function(e){var s={field:"",value:e,type:"label",operator:"must",active:!0};t.addChip(s)}))},updateLabelList:function(t){-1===this.meta.filter_labels.indexOf(t)&&this.meta.filter_labels.push(t)},paginate:function(t){this.currentQueryFilter.from=t*this.currentQueryFilter.size-this.currentQueryFilter.size,this.search(!0,!1)},updateSelectedFields:function(t){var e=this;t.forEach((function(t){!e.selectedFields.filter((function(e){return e.field===t.field})).length>0&&e.search()})),t.forEach((function(t){e.selectedFields.push(t)})),this.selectedFieldsProxy=[]},removeField:function(t){this.selectedFields.splice(t,1)},updateSelectedEvents:function(t){var e=t._index+":"+t._id;t.isSelected?this.$set(this.selectedEvents,e,t):this.$delete(this.selectedEvents,e)},toggleStar:function(){var t=this,e=[];Object.keys(this.selectedEvents).forEach((function(s,i){e.push(t.selectedEvents[s])})),E.saveEventAnnotation(this.sketch.id,"label","__ts_star",e).then((function(t){})).catch((function(t){})),Xn.$emit("toggleStar",this.selectedEvents)},changeSortOrder:function(){"asc"===this.currentQueryFilter.order?this.currentQueryFilter.order="desc":this.currentQueryFilter.order="asc",this.search()},loadingOpen:function(){this.loadingComponent=this.$buefy.loading.open({container:this.isFullPage?null:this.$refs.element.$el})},loadingClose:function(){this.loadingComponent.close()}},watch:{numEvents:function(t){this.currentQueryFilter.size=t,this.search()}},mounted:function(){var t=this;Xn.$on("eventSelected",(function(e){t.updateSelectedEvents(e)})),Xn.$on("clearSelectedEvents",(function(){t.selectedEvents={}}))},created:function(){var t=this,e=!1;if(this.params={viewId:this.$route.query.view,indexName:this.$route.query.timeline,resultLimit:this.$route.query.limit,queryString:this.$route.query.q},this.params.viewId)this.searchView(this.params.viewId);else{if(this.params.queryString&&(this.currentQueryString=this.params.queryString,e=!0),this.params.indexName){this.params.queryString||(this.currentQueryString="*");var s=this.sketch.active_timelines.find((function(e){return e.id===parseInt(t.params.indexName,10)})),i=this.meta.indices_metadata[s.searchindex.index_name].is_legacy;this.currentQueryFilter.indices=i?[s.searchindex.index_name]:[s.id],e=!0}this.currentQueryString||(this.currentQueryString="*",e=!0),e&&(this.currentQueryFilter.indices.length||(this.currentQueryFilter.indices=["_all"]),this.search())}}},ea=ta,sa=(s("2555"),Object(c["a"])(ea,ni,ri,!1,null,null,null)),ia=sa.exports,aa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("router-view")},na=[],ra={},oa=Object(c["a"])(ra,aa,na,!1,null,null,null),ca=oa.exports,la=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"graph"}})],1)]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content"},[t.sketch.graphs.length?s("div",[s("span",{staticClass:"title is-6 is-uppercase"},[t._v("Saved graphs")]),s("ts-graph-list"),s("br"),s("br")],1):t._e(),s("span",{staticClass:"title is-6 is-uppercase"},[t._v("Graph plugins")]),s("ts-graph-plugin-list")],1)])])])],1)},ua=[],da=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",t._l(t.graphs,(function(e){return s("router-link",{key:e.name,attrs:{to:{name:"SketchGraphExplore",query:{plugin:e.name}}}},[s("ul",{staticClass:"content-list"},[s("li",{staticStyle:{padding:"10px","border-bottom":"none",cursor:"pointer"}},[s("strong",{staticStyle:{color:"var(--default-font-color)"}},[t._v(t._s(e.display_name))]),s("br"),s("span",[t._v(t._s(e.description))])])])])})),1)},ha=[],ma={data:function(){return{graphs:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},created:function(){var t=this;E.getGraphPluginList().then((function(e){t.graphs=e.data})).catch((function(t){console.error(t)}))}},pa=ma,fa=Object(c["a"])(pa,da,ha,!1,null,"6e39d730",null),va=fa.exports,ga={props:["sketchId"],components:{TsGraphList:Oe,TsGraphPluginList:va},computed:{sketch:function(){return this.$store.state.sketch}}},_a=ga,ya=Object(c["a"])(_a,la,ua,!1,null,null,null),ba=ya.exports,Ca=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"graph"}})],1)]),s("ts-graph")],1)},ka=[],Sa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("section",{staticClass:"section"},[s("div",{ref:"graphContainer",staticClass:"container is-fluid",staticStyle:{height:"75vh"}},[s("div",{staticClass:"card",staticStyle:{height:"100%"}},[s("header",{staticClass:"card-header",staticStyle:{"border-bottom":"0"}},[t.currentGraph?s("div",[s("b-dropdown",{attrs:{"aria-role":"list","append-to-body":""},scopedSlots:t._u([{key:"trigger",fn:function(e){var i=e.active;return s("a",{staticClass:"button ts-search-dropdown",staticStyle:{"background-color":"transparent"}},[s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"10px","margin-top":"2px","font-size":"0.6em"}},[s("i",{staticClass:"fas fa-project-diagram"})]),t.currentGraph?s("div",{staticStyle:{"margin-right":"7px"}},[s("strong",[t._v(t._s(t.currentGraph))])]):t._e(),s("b-icon",{staticStyle:{"font-size":"0.6em"},attrs:{icon:i?"chevron-up":"chevron-down"}})],1)}}],null,!1,943072131)},[t._l(t.graphs,(function(e){return s("b-dropdown-item",{key:e.name,on:{click:function(s){return t.buildGraph(e)}}},[s("router-link",{attrs:{to:{name:"SketchGraphExplore",query:{plugin:e.name}}}},[t._v(t._s(e.display_name))])],1)})),t._l(t.savedGraphs,(function(e){return s("b-dropdown-item",{key:e.id,on:{click:function(s){return t.buildSavedGraph(e)}}},[s("router-link",{attrs:{to:{name:"SketchGraphExplore",query:{graph:e.id}}}},[t._v(t._s(e.name))])],1)}))],2)],1):t._e(),t.currentGraph?s("input",{directives:[{name:"model",rawName:"v-model",value:t.filterString,expression:"filterString"}],staticClass:"ts-search-input",staticStyle:{"border-radius":"0",padding:"25px"},attrs:{placeholder:"Filter nodes and edges"},domProps:{value:t.filterString},on:{keyup:t.filterGraphByInput,input:function(e){e.target.composing||(t.filterString=e.target.value)}}}):t._e(),t.currentGraph?s("span",{staticClass:"card-header-icon"},[s("b-dropdown",{attrs:{position:"is-bottom-left","aria-role":"menu","trap-focus":"","append-to-body":""}},[s("button",{staticClass:"button is-outlined is-rounded is-small",attrs:{slot:"trigger",disabled:!t.currentGraph},slot:"trigger"},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-cog"})]),s("span",[t._v("Settings")])]),s("div",{staticClass:"modal-card",staticStyle:{width:"500px",color:"var(--font-color-dark)"}},[s("section",{staticClass:"modal-card-body"},[s("b-dropdown-item",{attrs:{"aria-role":"menu-item",focusable:!1,custom:""}},[s("b-field",{attrs:{label:"Transparency for unselected elements"}},[s("b-slider",{staticClass:"is-rounded",attrs:{type:"is-info","custom-formatter":function(t){return t+"%"}},on:{input:t.changeOpacity},model:{value:t.fadeOpacity,callback:function(e){t.fadeOpacity=e},expression:"fadeOpacity"}})],1),s("b-field",{attrs:{label:"Layout type"}},t._l(t.layouts,(function(e){return s("b-radio",{key:e,attrs:{"native-value":e,type:"is-info",disabled:!t.hasGraphCache},on:{input:function(e){return t.buildGraph({name:t.currentGraph})}},model:{value:t.layoutName,callback:function(e){t.layoutName=e},expression:"layoutName"}},[s("span",[t._v(t._s(e))])])})),1),s("b-field",{attrs:{label:"Edge style"}},t._l(t.edgeStyles,(function(e){return s("b-radio",{key:e,attrs:{"native-value":e,type:"is-info",disabled:!t.hasGraphCache},on:{input:function(e){return t.buildGraph({name:t.currentGraph})}},model:{value:t.edgeStyle,callback:function(e){t.edgeStyle=e},expression:"edgeStyle"}},[s("span",[t._v(t._s(e))])])})),1)],1)],1)])]),s("b-dropdown",{ref:"saveDropdown",attrs:{position:"is-bottom-left","aria-role":"menu","trap-focus":"","append-to-body":"",disabled:!t.edgeQuery}},[s("button",{staticClass:"button is-outlined is-rounded is-small",attrs:{slot:"trigger"},slot:"trigger"},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-save"})]),s("span",[t._v("Save selection")])]),s("div",{staticClass:"modal-card",staticStyle:{width:"300px",color:"var(--font-color-dark)"}},[s("section",{staticClass:"modal-card-body"},[s("b-dropdown-item",{attrs:{"aria-role":"menu-item",focusable:!1,custom:""}},[s("strong",[t._v("Save selected graph")]),s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Name")]),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.saveAsName,expression:"saveAsName"}],staticClass:"input",attrs:{type:"text",placeholder:"Graph name",required:""},domProps:{value:t.saveAsName},on:{input:function(e){e.target.composing||(t.saveAsName=e.target.value)}}})])]),s("button",{staticClass:"button is-small",on:{click:t.saveSelection}},[t._v("Save")])])],1)])]),s("button",{staticClass:"button is-outlined is-rounded is-small",staticStyle:{"margin-left":"7px"},attrs:{disabled:!t.hasGraphCache},on:{click:function(e){return t.buildGraph({name:t.currentGraph},!0)}}},[t._m(0),s("span",[t._v("Refresh cache")])]),s("button",{staticClass:"button is-outlined is-rounded is-small",staticStyle:{"margin-left":"7px"},on:{click:function(e){return t.cy.fit()}}},[t._m(1),s("span",[t._v("Fit to canvas")])])],1):t._e()]),s("div",{staticClass:"card-content"},[s("b-loading",{attrs:{"is-full-page":!1,"can-cancel":!1},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[s("div",{staticClass:"lds-ripple"},[s("div"),s("div")]),s("div",{staticStyle:{position:"absolute","margin-top":"120px"}},[t._v("Generating graph: "),s("b",[t._v(t._s(t.currentGraph))])])]),!t.elements.length&&t.showGraph&&t.currentGraph?s("div",{staticClass:"no-data"},[t._v("Empty graph")]):t._e(),t.elements.length&&t.showGraph?s("cytoscape",{ref:"cyRef",attrs:{config:t.config,preConfig:t.preConfig,afterCreated:t.afterCreated},on:{select:function(e){return t.filterGraphBySelection(e)},unselect:function(e){return t.unSelectAllElements(e)},tap:function(e){return t.unSelectAllElements(e)}}},t._l(t.elements,(function(t){return s("cy-element",{key:t.data.id,attrs:{definition:t}})})),1):t._e(),t.hasGraphCache?s("span",[s("span",[s("i",[t._v("Generated "+t._s(t.$moment.utc(t.currentGraphCache.updated_at).local().fromNow()))])]),s("a",{staticClass:"is-small",staticStyle:{"text-decoration":"underline","margin-left":"15px"},on:{click:function(e){return t.buildGraph({name:t.currentGraph},!0)}}},[s("span",[t._v("Refresh")])])]):t._e()],1)])])]),t.edgeQuery?s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[t._m(2),s("div",{staticClass:"card-content"},[t.edgeQuery?s("ts-event-list-compact",{attrs:{"query-dsl":t.edgeQuery}}):t._e()],1)])])]):t._e()])},wa=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-sync-alt"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-eye"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("span",{staticClass:"card-header-title"},[t._v("Events for selected edges")])])}],xa=(s("96cf"),s("3b8d")),Ta=s("7618"),Ea=s("6882"),$a=s.n(Ea),Da=s("b17d"),Aa=s.n(Da),Oa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",{staticClass:"table is-fullwidth"},[s("thead",[s("th",{attrs:{width:"220"}}),s("th",{attrs:{width:"1"}}),t._l(t.selectedFields,(function(e,i){return s("th",{key:i},[t._v(t._s(e.field))])})),s("th",{attrs:{width:"150"}},[t._v("Timeline name")])],2),t._l(t.eventList.objects,(function(e,i){return s("ts-sketch-explore-event-list-row",{key:i,attrs:{event:e,prevEvent:t.eventList.objects[i-1],"selected-fields":t.selectedFields,"display-options":t.displayOptions,"display-controls":!1}})}))],2)},Fa=[],Na={components:{TsSketchExploreEventListRow:Fi},props:["view","queryString","queryDsl","queryFilter"],data:function(){return{eventList:[],selectedFields:[],displayOptions:{showTags:!0,showEmojis:!0}}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{search:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(s).length||(s={},this.selectedFields=[{field:"message",type:"text"}]);var i={filter:s};"object"===Object(Ta["a"])(t)?i["dsl"]=t:i["query"]=t,E.search(this.sketch.id,i).then((function(t){e.eventList=t.data})).catch((function(t){}))},searchView:function(t){var e=this;E.getView(this.sketch.id,t).then((function(t){var s=t.data.objects[0],i=s.query_string,a=JSON.parse(s.query_filter);a.fields&&a.fields.length||(a.fields=[{field:"message",type:"text"}]),e.selectedFields=a.fields,e.search(i,a)})).catch((function(t){}))}},created:function(){this.view&&this.searchView(this.view.id),this.queryDsl&&this.search(this.queryDsl),this.queryString&&this.search(this.queryString)},watch:{queryString:function(t){this.search(t)},queryDsl:function(t){this.search(t)}}},Pa=Na,ja=Object(c["a"])(Pa,Oa,Fa,!1,null,null,null),Ma=ja.exports,La={components:{SessionChart:xe,TsEventListCompact:Ma},data:function(){return{showGraph:!0,isLoading:!1,filterString:"",graphs:{},savedGraphs:[],currentGraph:"",currentGraphCache:{},selectedGraphs:[],fadeOpacity:7,elements:[],edgeQuery:"",maxEvents:500,saveAsName:"",layouts:["spread","dagre","circle","concentric","breadthfirst"],layoutName:"spread",edgeStyles:["bezier","taxi"],edgeStyle:"bezier",config:{style:[{selector:"node",style:{shape:"roundrectangle",width:"label",height:"label","compound-sizing-wrt-labels":"include","text-halign":"center","text-valign":"center",color:"#FFFFFF","font-size":"10","font-weight":"bold","text-outline-width":"0px",padding:"7px","background-color":"gray","text-outline-color":"gray","text-wrap":"wrap","text-max-width":"12em",label:"data(label)"}},{selector:"node:selected",style:{"overlay-color":"black","overlay-opacity":"0.3","overlay-padding":"7px"}},{selector:"node[type = 'user']",style:{"background-color":"#FF756E","text-outline-color":"#FF756E"}},{selector:"node[type = 'computer']",style:{"background-color":"#6992f3","text-outline-color":"#ffffff"}},{selector:"node[type = 'file']",style:{"background-color":"#82b578","text-outline-color":"#2b2b2b"}},{selector:"node[type = 'winservice']",style:{"background-color":"#9d8f35","text-outline-color":"#2b2b2b"}},{selector:"edge",style:{width:1,"curve-style":"bezier","control-point-step-size":70,"target-arrow-shape":"triangle","font-size":11,"text-rotation":"autorotate","text-outline-width":3,"text-outline-color":"#FFFFFF",label:"data(label)"}},{selector:"edge:selected",style:{width:2,"line-color":"#333333","source-arrow-color":"#333333","target-arrow-color":"#333333"}},{selector:".faded",style:{opacity:.07,color:"#333333"}}],layout:{name:"",animate:!1,prelayout:!1,spacingFactor:2},minZoom:.1,maxZoom:1.5,zoomingEnabled:!0,userZoomingEnabled:!0,panningEnabled:!0,userPanningEnabled:!0,boxSelectionEnabled:!0,selectionType:"single",touchTapThreshold:8,desktopTapThreshold:4,autolock:!1,autoungrabify:!1,autounselectify:!1,headless:!1,styleEnabled:!0,hideEdgesOnViewport:!1,hideLabelsOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.2,pixelRatio:"auto"}}},computed:{sketch:function(){return this.$store.state.sketch},hasGraphCache:function(){return 0!==Object.keys(this.currentGraphCache).length}},methods:{buildGraph:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.config.layout.name=this.layoutName;var i=this.config.style.filter((function(t){return"edge"===t.selector}));i[0].style["curve-style"]=this.edgeStyle,"object"===Object(Ta["a"])(t)?this.currentGraph=t.name:this.currentGraph=t,this.showGraph=!1,this.elements=[],this.loadingTimeout=setTimeout((function(){e.elements.length||(e.isLoading=!0)}),600),this.edgeQuery="";var a=[];this.sketch.timelines.forEach((function(t){a.push(t.searchindex.index_name)})),E.generateGraphFromPlugin(this.sketch.id,this.currentGraph,a,s).then((function(t){var s,i,a=t.data["objects"][0],n=JSON.parse(a.graph_elements),r=[];"elements"in n?(s=n["elements"]["nodes"],i=n["elements"]["edges"]):(s=n["nodes"],i=n["edges"]),s.forEach((function(t){r.push({data:t.data,group:"nodes"})})),i.forEach((function(t){r.push({data:t.data,group:"edges"})})),delete a.graph_elements,e.currentGraphCache=a,e.elements=r,clearTimeout(e.loadingTimeout),e.showGraph=!0,e.isLoading=!1})).catch((function(t){console.error(t)}))},buildSavedGraph:function(t){var e=this;this.config.layout.name="preset",this.currentGraph=t.name,this.currentGraphCache={},this.showGraph=!1,this.elements=[],this.loadingTimeout=setTimeout((function(){e.elements.length||(e.isLoading=!0)}),600),this.edgeQuery="";var s="";s="object"===Object(Ta["a"])(t)?t.id:t,E.getSavedGraph(this.sketch.id,s).then((function(t){e.currentGraph=t.data["objects"][0].name;var s=JSON.parse(t.data["objects"][0].graph_elements),i=s.filter((function(t){return"nodes"===t.group})),a=s.filter((function(t){return"edges"===t.group})),n=[];i.forEach((function(t){t.selected=!1,n.push(t)})),a.forEach((function(t){t.selected=!1,n.push(t)})),clearTimeout(e.loadingTimeout),e.elements=n,e.showGraph=!0,e.isLoading=!1})).catch((function(t){console.error(t)}))},buildNeighborhood:function(t){var e=this.cy.collection();return e=e.add(t.filter("node").neighborhood()),e=e.add(t.filter("edge").connectedNodes()),e=e.add(t),e},showNeighborhood:function(t){var e=this.buildNeighborhood(t);if(0!==t.length){this.cy.elements().addClass("faded"),e.removeClass("faded");var s={query:{bool:{should:[]}},size:this.maxEvents};e.forEach((function(t){"edges"===t.group()&&Object.keys(t.data().events).forEach((function(e){var i={bool:{must:[{ids:{values:t.data().events[e]}},{term:{_index:{value:e}}}]}};s.query.bool.should.push(i)}))})),this.edgeQuery=s}else this.cy.elements().removeClass("faded")},saveSelection:function(){var t=this,e=this.cy.filter(":selected"),s=this.buildNeighborhood(e),i=s.jsons();this.$refs.saveDropdown.toggle(),this.showGraph=!1,this.elements=i,this.currentGraph=this.saveAsName,this.showGraph=!0,E.saveGraph(this.sketch.id,this.saveAsName,i).then((function(e){var s=e.data["objects"][0];t.savedGraphs.push(s)})),this.saveAsName=""},filterGraphBySelection:function(t){var e=this.cy.filter(":selected");this.showNeighborhood(e)},filterGraphByInput:function(){var t=this;this.cy.elements().unselect();var e=this.cy.elements().filter((function(e){return e.data("label").toLowerCase().includes(t.filterString)}));this.showNeighborhood(e)},unSelectAllElements:function(t){this.cy.elements().removeClass("faded"),this.edgeQuery=null},changeOpacity:function(){this.cy&&this.cy.style().selector(".faded").style({opacity:this.fadeOpacity/100}).update()},resizeCanvas:function(){var t=this.$refs.graphContainer.clientHeight-100,e=this.$refs.graphContainer.clientWidth-100,s=document.getElementById("cytoscape-div");s.style.minHeight=t+"px",s.style.height=t+"px",s.style.minWidth=e+"px",s.style.width=e+"px"},preConfig:function(t){t.use($a.a),t.use(Aa.a),this.resizeCanvas()},afterCreated:function(){var t=Object(xa["a"])(regeneratorRuntime.mark((function t(){var e,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:null,null!==e?this.cy=e:e=this.cy,t.next=4,e;case 4:this.setTheme(),e.layout(this.config.layout).run();case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setTheme:function(){this.isDarkTheme="dark"===localStorage.theme,this.isDarkTheme?this.cy.style().selector("edge").style({color:"#f5f5f5","text-outline-color":"#545454"}).update():this.cy.style().selector("edge").style({color:"#333333","text-outline-color":"#FFFFFF"}).update()}},created:function(){var t=this;window.addEventListener("resize",kt.a.debounce((function(){t.resizeCanvas()}),250)),E.getGraphPluginList().then((function(e){t.graphs=e.data})).catch((function(t){console.error(t)})),E.getSavedGraphList(this.sketch.id).then((function(e){var s=e.data["objects"][0];void 0!==s&&(t.savedGraphs=e.data["objects"][0])})).catch((function(t){console.error(t)})),Xn.$on("isDarkTheme",this.setTheme),this.params={graphId:this.$route.query.graph,pluginName:this.$route.query.plugin},this.params.graphId&&this.buildSavedGraph(this.params.graphId),this.params.pluginName&&this.buildGraph(this.params.pluginName)}},Ia=La,za=(s("b09b"),Object(c["a"])(Ia,Sa,wa,!1,null,null,null)),Ra=za.exports,Qa={components:{TsGraph:Ra},props:["sketchId"],computed:{sketch:function(){return this.$store.state.sketch}}},Ga=Qa,Va=Object(c["a"])(Ga,Ca,ka,!1,null,null,null),qa=Va.exports,Ua=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("router-view")},Ya=[],Ha={},Ja=Object(c["a"])(Ha,Ua,Ya,!1,null,null,null),Ba=Ja.exports,Wa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"analyzers"}})],1)]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content"},[s("p",[t._v("Automatic analysis. Select timelines and analyzers in the lists below.")]),s("br"),s("button",{staticClass:"button is-success",attrs:{disabled:!t.analyzerCheckedRows.length||!t.timelineCheckedRows.length},on:{click:t.runAnalyzers}},[t._v("Run "+t._s(t.analyzerCheckedRows.length)+" analyzers on "+t._s(t.timelineCheckedRows.length)+" timelines")]),s("br"),s("br"),t._l(t.sessions,(function(e){return s("span",{key:e.id},[s("ts-analysis-session-detail",{attrs:{session:e},on:{closeDetail:function(s){t.sessions.splice(t.sessions.indexOf(e),1)}}})],1)}))],2)])])]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content",staticStyle:{"max-height":"500px","overflow-y":"auto"}},[s("span",{staticClass:"title is-6 is-uppercase"},[t._v("1. Select timelines to analyze")]),s("br"),s("br"),s("b-table",{attrs:{data:t.timelines,columns:t.timelineColumns,"checked-rows":t.timelineCheckedRows,checkable:""},on:{"update:checkedRows":function(e){t.timelineCheckedRows=e},"update:checked-rows":function(e){t.timelineCheckedRows=e}}})],1)])])]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content"},[s("span",{staticClass:"title is-6 is-uppercase"},[t._v("2. Select analyzers to run")]),s("br"),s("br"),s("b-table",{attrs:{data:t.availableAnalyzers,columns:t.analyzerColumns,"checked-rows":t.analyzerCheckedRows,"default-sort":"display_name",checkable:""},on:{"update:checkedRows":function(e){t.analyzerCheckedRows=e},"update:checked-rows":function(e){t.analyzerCheckedRows=e}}})],1)])])]),s("br")],1)},Za=[],Ka={props:["sketchId"],components:{TsAnalysisSessionDetail:$t},data:function(){return{availableAnalyzers:[],timelineCheckedRows:[],analyzerCheckedRows:[],sessions:[],timelineColumns:[{field:"name",label:"Timeline"}],analyzerColumns:[{field:"display_name",label:"Analyzer",sortable:!0},{field:"description",label:"Description"}]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},timelines:function(){var t=[];return this.sketch.timelines.forEach((function(e){t.push({id:e.id,name:e.name})})),t}},methods:{runAnalyzers:function(){var t=this,e=this.timelineCheckedRows.map((function(t){return t.id})),s=this.analyzerCheckedRows.map((function(t){return t.name}));this.timelineCheckedRows=[],this.analyzerCheckedRows=[],E.runAnalyzers(this.sketch.id,e,s).then((function(e){t.sessions=e.data.objects[0]})).catch((function(t){}))}},created:function(){var t=this;E.getAnalyzers(this.sketch.id).then((function(e){t.availableAnalyzers=e.data})).catch((function(t){console.error(t)}))}},Xa=Ka,tn=Object(c["a"])(Xa,Wa,Za,!1,null,null,null),en=tn.exports,sn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("router-view")},an=[],nn={},rn=Object(c["a"])(nn,sn,an,!1,null,null,null),on=rn.exports,cn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"stories"}})],1)]),s("b-modal",{attrs:{active:t.showCreateStoryModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showCreateStoryModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Create a new story")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("ts-story-create-form",{on:{toggleModal:function(e){t.showCreateStoryModal=!t.showCreateStoryModal}}})],1)])])]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("button",{staticClass:"button is-success",staticStyle:{"margin-right":"7px"},on:{click:function(e){t.showCreateStoryModal=!t.showCreateStoryModal}}},[t._m(0),s("span",[t._v("Create story")])]),s("div",{staticClass:"card",staticStyle:{"margin-top":"20px"}},[s("div",{staticClass:"card-content"},[t.meta.stories.length?t._e():s("div",[t._v("\n            There are no stories in this sketch yet\n          ")]),s("ts-story-list",{attrs:{controls:!0}})],1)])])])],1)},ln=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-plus-circle"})])}],un=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm(e)}}},[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Title")]),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Title of your story",autofocus:""},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})])]),t._m(0)])},dn=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Create"}})])])}],hn={data:function(){return{title:""}},methods:{clearFormData:function(){this.title=""},submitForm:function(){var t=this,e="";E.createStory(this.title,e,this.sketch.id).then((function(e){var s=e.data.objects[0].id;t.clearFormData(),t.$router.push({name:"SketchStoryContent",params:{storyId:s}}),t.$store.dispatch("updateSketch",t.sketch.id)})).catch((function(t){}))}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}}},mn=hn,pn=Object(c["a"])(mn,un,dn,!1,null,null,null),fn=pn.exports,vn={components:{TsNavbarMain:q["default"],TsStoryList:N,TsStoryCreateForm:fn},data:function(){return{showCreateStoryModal:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}}},gn=vn,_n=Object(c["a"])(gn,cn,ln,!1,null,null,null),yn=_n.exports,bn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"stories"}})],1)]),t.blocks?s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content",staticStyle:{padding:"50px"}},[s("div",{staticClass:"markdown-body ts-markdown-body-color",staticStyle:{"margin-bottom":"20px","padding-left":"10px"}},[s("h1",[t._v(t._s(t.title))])]),t._l(t.blocks,(function(e,i){return s("div",{key:i},[e.componentName?t._e():s("div",{staticClass:"inactiveBlock",class:{activeBlock:e.isActive},staticStyle:{"padding-left":"10px","margin-top":"10px","margin-bottom":"10px"},on:{mouseover:function(t){e.isActive=!0},mouseleave:function(t){e.isActive=!1}}},[e.isActive?s("span",{staticStyle:{float:"right"}},[s("button",{staticClass:"delete",on:{click:function(e){return t.deleteBlock(i)}}})]):t._e(),e.edit?s("div",{staticClass:"columns",staticStyle:{"margin-bottom":"0"}},[s("div",{staticClass:"column"},[s("textarea",{staticClass:"textarea",staticStyle:{height:"100%"},attrs:{placeholder:"Your story starts here.."},domProps:{value:e.content},on:{input:function(s){return t.update(s,e)}}})]),s("transition",{attrs:{name:"fade"}},[e.content?s("div",{staticClass:"column"},[s("div",{staticClass:"markdown-body",staticStyle:{"max-height":"600px",overflow:"auto"},domProps:{innerHTML:t._s(t.toHtml(e.content))}})]):t._e()])],1):t._e(),e.edit?s("div",{staticClass:"field is-grouped"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-rounded is-success",attrs:{disabled:!e.content},on:{click:function(s){return t.saveAndHide(e)}}},[t._m(0,!0),s("span",[t._v("Save")])])])]):t._e(),e.edit?t._e():s("div",{staticClass:"markdown-body",domProps:{innerHTML:t._s(t.toHtml(e.content))},on:{dblclick:function(t){e.edit=!e.edit}}})]),e.componentName?s("div",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"},on:{mouseover:function(t){e.isActive=!0},mouseleave:function(t){e.isActive=!1}}},[s("article",{staticClass:"message"},[s("div",{staticClass:"message-header"},["TsViewEventList"===e.componentName?s("p",[s("router-link",{attrs:{to:{name:"SketchExplore",query:{view:e.componentProps.view.id}}}},[s("strong",[t._v(t._s(e.componentProps.view.name))])])],1):t._e(),"TsAggregationCompact"===e.componentName?s("p",[t._v("\n                    "+t._s(e.componentProps.aggregation.name)+"\n                  ")]):t._e(),"TsAggregationGroupCompact"===e.componentName?s("p",[t._v("\n                    "+t._s(e.componentProps.aggregation_group.name)+"\n                  ")]):t._e(),s("button",{staticClass:"delete",attrs:{"aria-label":"delete"},on:{click:function(e){return t.deleteBlock(i)}}})]),s("div",{staticClass:"message-body"},[s(e.componentName,t._b({tag:"component"},"component",e.componentProps,!1))],1)])]):t._e(),s("div",{staticStyle:{"min-height":"40px"},on:{mouseover:function(t){e.showPanel=!0},mouseleave:function(t){e.showPanel=!1}}},[i===t.blocks.length-1?s("div",{staticStyle:{"padding-top":"20px"}}):t._e(),i===t.blocks.length-1||e.showPanel||e.isActive?s("div",{staticClass:"field is-grouped"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-rounded",on:{click:function(e){return t.addBlock(i)}}},[t._v("\n                      + Text\n                    ")])]),t.meta.views.length?s("p",{staticClass:"control"},[s("ts-view-list-dropdown",{attrs:{"is-simple":!0,"is-last":i===t.blocks.length-1,title:"+ Saved search"},on:{setActiveView:function(e){return t.addViewComponent(e,i)}}})],1):t._e(),t.allAggregations?s("p",{staticClass:"control"},[s("ts-aggregation-list-dropdown",{attrs:{"is-rounded":!0,"is-last":i===t.blocks.length-1,aggregations:t.allAggregations},on:{addAggregation:function(e){return t.addAggregationComponent(e,i)}}})],1):t._e()]):t._e()])])}))],2)])])]):t._e()],1)},Cn=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-save",attrs:{"aria-hidden":"true"}})])}],kn=s("0e54"),Sn=s.n(kn),wn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-dropdown",{ref:"dropdown",attrs:{animation:"none","aria-role":"menu",position:t.position}},[s("a",{staticClass:"button",class:{"is-rounded":t.isRounded},attrs:{slot:"trigger"},slot:"trigger"},[s("span",[t._v("+ Aggregation")]),s("b-icon",{staticStyle:{"font-size":"0.6em"},attrs:{icon:t.active?"chevron-up":"chevron-down"}})],1),s("div",{staticClass:"modal-card",staticStyle:{width:"500px",color:"var(--font-color-dark)"}},[s("section",{staticClass:"modal-card-body"},[t.aggregations&&t.aggregations.length<1?s("span",{staticClass:"dropdown-item"},[t._v("No saved aggregations")]):t._e(),t._l(t.aggregations,(function(e){return s("a",{key:e.id,staticClass:"dropdown-item",on:{click:function(s){return t.setActiveAggregation(e)}}},[s("span",[t._v(t._s(e.name))])])}))],2)])])},xn=[],Tn={props:["isRounded","aggregations","isLast"],data:function(){return{position:"is-bottom-right"}},methods:{setActiveAggregation:function(t){this.$emit("addAggregation",t)}},created:function(){this.isLast&&(this.position="is-top-right")}},En=Tn,$n=Object(c["a"])(En,wn,xn,!1,null,"c8aced48",null),Dn=$n.exports,An=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("div",{ref:"vegaChart",staticClass:"card-content"},[s("ts-vega-lite-chart",{attrs:{vegaSpec:t.vegaSpec}})],1)])},On=[],Fn={props:["aggregation_group"],components:{TsVegaLiteChart:Ce},data:function(){return{vegaSpec:{},title:""}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{getVegaSpec:function(){var t=this;E.runAggregatorGroup(this.sketch.id,this.aggregation_group.id).then((function(e){var s=e.data.meta.vega_spec;s.config.view.width=t.$refs.vegaChart.offsetWidth-50,s.config.autosize={type:"fit",contains:"padding"},t.vegaSpec=JSON.stringify(s),t.title=e.data.meta.vega_chart_title})).catch((function(t){}))}},mounted:function(){this.getVegaSpec()}},Nn=Fn,Pn=Object(c["a"])(Nn,An,On,!1,null,null,null),jn=Pn.exports,Mn=function(){return{componentName:"",componentProps:{},content:"",edit:!0,showPanel:!1,isActive:!1}},Ln={components:{TsAggregationListDropdown:Dn,TsAggregationCompact:ti,TsAggregationGroupCompact:jn,TsViewListDropdown:_i,TsViewEventList:Ma},props:["sketchId","storyId"],data:function(){return{blocks:[],title:"",aggregations:[],aggregationGroups:[]}},methods:{update:kt.a.debounce((function(t,e){e.content=t.target.value,this.save()}),300),addBlock:function(t){var e=t+1,s=Mn();this.blocks.splice(e,0,s)},deleteBlock:function(t){this.blocks.splice(t,1),this.blocks.length||(this.blocks=[Mn()]),this.save()},addAggregationComponent:function(t,e){var s=e+1,i=Mn();"agg_ids"in t?(i.componentName="TsAggregationGroupCompact",i.componentProps={aggregation_group:t}):(i.componentName="TsAggregationCompact",i.componentProps={aggregation:t}),this.blocks.splice(s,0,i),this.save()},addViewComponent:function(t,e){this.showPanel=!1;var s=e+1,i=Mn();i.componentName="TsViewEventList",i.componentProps={view:t},this.blocks.splice(s,0,i),this.save()},hideBlock:function(t){t.edit=!t.edit},saveAndHide:function(t){this.hideBlock(t),this.save()},save:function(){this.blocks.forEach((function(t){t.showPanel=!1,t.isActive=!1}));var t=JSON.stringify(this.blocks);E.updateStory(this.title,t,this.sketchId,this.storyId).then((function(t){})).catch((function(t){}))},toHtml:function(t){return Sn()(t,{sanitize:!1})}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},allAggregations:function(){var t=function(){for(var t,e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return(t=[]).concat.apply(t,Object(it["a"])(s.filter(Array.isArray)))};return t(this.aggregations,this.aggregationGroups)}},created:function(){var t=this;E.getStory(this.sketchId,this.storyId).then((function(e){t.title=e.data.objects[0].title;var s=e.data.objects[0].content;t.blocks="[]"===s?[Mn()]:JSON.parse(s)})).catch((function(t){console.error(t)})),E.getAggregations(this.sketchId).then((function(e){t.aggregations=e.data.objects[0]})).catch((function(t){console.error(t)})),E.getAggregationGroups(this.sketchId).then((function(e){t.aggregationGroups=e.data.objects})).catch((function(t){console.error(t)}))}},In=Ln,zn=(s("dba0"),Object(c["a"])(In,bn,Cn,!1,null,null,null)),Rn=zn.exports;i["default"].use(v["a"]);var Qn=[{name:"Home",path:"/",component:J},{path:"/sketch/:sketchId",component:tt,props:!0,children:[{path:"",name:"SketchOverview",component:je},{path:"explore",name:"SketchExplore",component:ia,props:!0},{path:"graph",component:ca,props:!0,children:[{path:"",name:"SketchGraphOverview",component:ba},{path:"explore",name:"SketchGraphExplore",component:qa,props:!0}]},{path:"aggregate",name:"SketchAggregate",component:ai,props:!0},{path:"analyzers",component:Ba,props:!0,children:[{path:"",name:"SketchAnalyzersOverview",component:en}]},{path:"story",component:on,props:!0,children:[{path:"",name:"SketchStoryOverview",component:yn},{path:":storyId",name:"SketchStoryContent",component:Rn,props:!0}]},{path:"manage",component:Re,props:!0,children:[{path:"views",name:"SketchManageViews",component:Ye},{path:"timelines",name:"SketchManageTimelines",component:re}]}]}],Gn=new v["a"]({mode:"history",routes:Qn}),Vn=s("2f62");i["default"].use(Vn["a"]);var qn=function(t){return{sketch:{},meta:{},count:0,currentUser:t}},Un=qn(),Yn=new Vn["a"].Store({state:Un,mutations:{SET_SKETCH:function(t,e){i["default"].set(t,"sketch",e.objects[0]),i["default"].set(t,"meta",e.meta)},SET_COUNT:function(t,e){i["default"].set(t,"count",e)},RESET_STATE:function(t,e){E.getLoggedInUser().then((function(e){var s=e.data.objects[0].username;Object.assign(t,qn(s))}))}},actions:{updateSketch:function(t,e){E.getSketch(e).then((function(e){t.commit("SET_SKETCH",e.data)})).catch((function(t){})),E.countSketchEvents(e).then((function(e){t.commit("SET_COUNT",e.data.meta.count)})).catch((function(t){}))},resetState:function(t){t.commit("RESET_STATE")}}}),Hn=s("3a6f"),Jn=s.n(Hn),Bn=s("ecee"),Wn=s("ad3d"),Zn=s("c074");Bn["c"].add(Zn["f"],Zn["e"],Zn["g"],Zn["i"],Zn["a"],Zn["b"],Zn["d"],Zn["c"],Zn["h"]),i["default"].component("font-awesome-icon",Wn["a"]),s("b383"),s("2d27"),s("56eb");var Kn=new i["default"],Xn=e["default"]=Kn;i["default"].use(s("2ead")),i["default"].use(Jn.a),i["default"].use(d["a"],{defaultIconComponent:"font-awesome-icon",defaultIconPack:"fas"}),i["default"].use(m.a),i["default"].component("multiselect",f.a),i["default"].config.productionTip=!1,new i["default"]({router:Gn,store:Yn,render:function(t){return t(u)}}).$mount("#app")},"56eb":function(t,e,s){"use strict";s.r(e);s("7f7f"),s("ac6a");var i=s("2b0e"),a=s("6dde");a.keys().forEach((function(t){var e=a(t);i["default"].filter(e.default.name,e.default.filter)}))},"6dde":function(t,e,s){var i={"./Capitalize.js":"76f9","./CompactBytes.js":"3d1d","./CompactNumber.js":"d3b7","./FilterChip.js":"05a2","./FormatTimestamp.js":"09ff"};function a(t){var e=n(t);return s(e)}function n(t){if(!s.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}a.keys=function(){return Object.keys(i)},a.resolve=n,t.exports=a,a.id="6dde"},"747d":function(t,e,s){"use strict";s("a577")},"75a6":function(t,e,s){var i={"./AppNavbarMain.vue":"f7e3","./AppNavbarSecondary.vue":"c5cc"};function a(t){var e=n(t);return s(e)}function n(t){if(!s.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}a.keys=function(){return Object.keys(i)},a.resolve=n,t.exports=a,a.id="75a6"},"76f9":function(t,e,s){"use strict";s.r(e);s("6b54");e["default"]={name:"capitalize",filter:function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""}}},"7b15":function(t,e,s){"use strict";s("cc98")},"7c44":function(t,e,s){"use strict";s("c6c4")},"7d2d":function(t,e,s){},"7eff":function(t,e,s){},a577:function(t,e,s){},af74:function(t,e,s){"use strict";s("7eff")},b09b:function(t,e,s){"use strict";s("ff27")},b383:function(t,e,s){},be8a:function(t,e,s){},c1e9:function(t,e,s){"use strict";s("0509")},c5cc:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("nav",{staticClass:"navbar",attrs:{role:"navigation","aria-label":"main navigation"}},["sketch"===t.currentAppContext?s("div",{staticClass:"navbar-item"},[s("div",{staticClass:"tabs is-left"},[s("ul",[s("li",{class:{"is-active":"overview"===t.currentPage}},[s("router-link",{attrs:{to:{name:"SketchOverview"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-cubes",attrs:{"aria-hidden":"true"}})]),s("span",[t._v("Overview")])])],1),s("li",{class:{"is-active":"explore"===t.currentPage}},[s("router-link",{attrs:{to:{name:"SketchExplore"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-search",attrs:{"aria-hidden":"true"}})]),s("span",[t._v("Explore")])])],1),s("li",{class:{"is-active":"graph"===t.currentPage}},[s("router-link",{attrs:{to:{name:"SketchGraphOverview"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-project-diagram",attrs:{"aria-hidden":"true"}})]),s("span",[t._v("Graph")])])],1),s("li",{class:{"is-active":"aggregate"===t.currentPage}},[s("router-link",{attrs:{to:{name:"SketchAggregate"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-chart-bar",attrs:{"aria-hidden":"true"}})]),s("span",[t._v("Aggregate")])])],1),s("li",{class:{"is-active":"analyzers"===t.currentPage}},[s("router-link",{attrs:{to:{name:"SketchAnalyzersOverview"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-magic",attrs:{"aria-hidden":"true"}})]),s("span",[t._v("Analyze")])])],1),s("li",{class:{"is-active":"timelines"===t.currentPage}},[s("router-link",{attrs:{to:{name:"SketchManageTimelines"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-stream",attrs:{"aria-hidden":"true"}})]),s("span",[t._v("Timelines")])])],1),s("li",{class:{"is-active":"stories"===t.currentPage}},[s("router-link",{attrs:{to:{name:"SketchStoryOverview"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-book",attrs:{"aria-hidden":"true"}})]),s("span",[t._v("Stories")])])],1)])])]):t._e(),s("div",{staticClass:"navbar-end"},[s("div",{staticClass:"navbar-item"},[t._t("default")],2)])])},a=[],n={name:"ts-navbar-secondary",props:["currentAppContext","currentPage"]},r=n,o=(s("ea3f"),s("2877")),c=Object(o["a"])(r,i,a,!1,null,"ab34923c",null);e["default"]=c.exports},c6c4:function(t,e,s){},cc98:function(t,e,s){},d147:function(t,e,s){"use strict";s("be8a")},d3b7:function(t,e,s){"use strict";s.r(e),e["default"]={name:"compactNumber",filter:function(t){t||(t=0);var e="";if(t>999999999)t=Math.round(t/1e9*10)/10,e="B";else if(t>999999)t=Math.round(t/1e6*10)/10,e="M";else{if(!(t>999))return t;t=Math.round(t/1e3*10)/10,e="K"}return t+e}}},dba0:function(t,e,s){"use strict";s("114f")},e8e7:function(t,e,s){"use strict";s("4fb9")},ea3f:function(t,e,s){"use strict";s("4ce9")},f484:function(t,e,s){"use strict";s("7d2d")},f7e3:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("nav",{staticClass:"navbar",attrs:{role:"navigation","aria-label":"main navigation"}},[s("div",{staticClass:"navbar-brand"},[s("router-link",{staticClass:"navbar-item",attrs:{to:"/"}},[s("div",{staticClass:"logo",staticStyle:{"margin-top":"7px"}},[s("img",{attrs:{src:"/dist/timesketch-white.png"}})]),s("span",{staticStyle:{color:"#fff","margin-left":"7px","margin-top":"1px","font-size":"1.2em"}},[t._v("time"),s("b",[t._v("sketch")])])])],1),s("div",{staticClass:"navbar-item",staticStyle:{"margin-left":"20px"}},[t._t("left")],2),s("div",{staticClass:"navbar-item navbar-center"},[t._t("center")],2),s("div",{staticClass:"navbar-end"},[s("div",{staticClass:"navbar-item"},[s("b-switch",{attrs:{size:"is-small","passive-type":"is-info",type:"is-dark"},on:{input:t.switchTheme},model:{value:t.isDarkTheme,callback:function(e){t.isDarkTheme=e},expression:"isDarkTheme"}},[t._v("\n        Dark Mode\n      ")])],1),s("div",{staticClass:"navbar-item",staticStyle:{color:"#ffffff"}},[t._v("\n      "+t._s(t.currentUser)+"\n    ")]),t._m(0)])])},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"navbar-item"},[s("a",{staticStyle:{color:"#fff"},attrs:{href:"/logout"}},[t._v("Logout")])])}],n=s("56d7"),r={name:"ts-navbar-main",data:function(){return{isDarkTheme:null}},computed:{currentUser:function(){return this.$store.state.currentUser}},methods:{switchTheme:function(){var t=document.body;switch(t.dataset.theme){case"light":t.dataset.theme="dark",localStorage.theme="dark",this.isDarkTheme=!0,n["default"].$emit("isDarkTheme",!0);break;case"dark":t.dataset.theme="light",localStorage.theme="light",this.isDarkTheme=!1,n["default"].$emit("isDarkTheme",!1);break}}},created:function(){this.isDarkTheme="dark"===localStorage.theme}},o=r,c=(s("7b15"),s("2877")),l=Object(c["a"])(o,i,a,!1,null,"47f95f41",null);e["default"]=l.exports},ff27:function(t,e,s){}}]);
//# sourceMappingURL=chunk-common.16dc2b1e.js.map