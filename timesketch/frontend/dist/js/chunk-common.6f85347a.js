(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-common"],{0:function(t,e,s){t.exports=s("56d7")},"03d8":function(t,e,s){"use strict";var a=s("f598"),i=s.n(a);i.a},"05a2":function(t,e,s){"use strict";s.r(e),e["default"]={name:"filterChip",filter:function(t){return"must_not"===t.operator?"NOT "+t.field+":"+t.value:"label"===t.type?"__ts_star"===t.value?"Starred":t.value:t.field+":"+t.value}}},"1ba8":function(t,e,s){"use strict";var a=s("3373"),i=s.n(a);i.a},2555:function(t,e,s){"use strict";var a=s("6eea"),i=s.n(a);i.a},"285d":function(t,e,s){},"2d27":function(t,e,s){"use strict";s.r(e);s("7f7f"),s("ac6a");var a=s("2b0e"),i=s("75a6");i.keys().forEach(function(t){var e=i(t),s=e.default.name;a["a"].component(s,e.default||e)})},"310c":function(t,e,s){},3373:function(t,e,s){},3380:function(t,e,s){},"3d1d":function(t,e,s){"use strict";s.r(e),e["default"]={name:"compactBytes",filter:function(t){t||(t=0);var e=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.min(Math.floor(Math.log(t)/Math.log(1e3)),e.length-1),a=1*(t/Math.pow(1e3,s)).toFixed(2);return a+e[s]}}},"448f":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("f751"),s("097d");var a=s("2b0e"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("ts-navbar-main"),s("router-view")],1)},n=[],r={name:"app"},o=r,c=(s("60bc"),s("2877")),l=Object(c["a"])(o,i,n,!1,null,null,null),u=l.exports,d=s("289d"),h=(s("5abe"),s("f13c")),m=s.n(h),p=s("8e5f"),v=s.n(p),f=s("8c4f"),g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("ts-navbar-secondary",[t.mySketches.length||t.sharedSketches.length?s("button",{staticClass:"button is-success is-rounded",on:{click:function(e){t.showSketchCreateModal=!t.showSketchCreateModal}}},[s("strong",[t._v("+ Sketch")])]):t._e()])],1)]),s("b-modal",{attrs:{active:t.showSketchCreateModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showSketchCreateModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Create new sketch")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("ts-create-sketch-form")],1)])])]),t.loading||t.mySketches.length||t.sharedSketches.length?t._e():s("div",{staticClass:"has-text-centered"},[s("h1",{staticClass:"title"},[t._v("Welcome to Timesketch")]),s("button",{staticClass:"button is-success is-rounded",on:{click:function(e){t.showSketchCreateModal=!t.showSketchCreateModal}}},[s("strong",[t._v("Create sketch")])])]),t.mySketches.length||t.sharedSketches.length?s("div",{staticClass:"section"},[s("div",{staticClass:"container",staticStyle:{"margin-bottom":"15px"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"ts-search-input",staticStyle:{background:"#ffffff"},attrs:{type:"text",placeholder:"Search",autofocus:""},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}})])]):t._e(),t.search?s("div",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content"},[t.filteredList.length?t._e():s("p",{staticClass:"subtitle"},[t._v("No search results")]),t.filteredList.length?s("ts-sketch-list",{attrs:{sketches:t.filteredList}}):t._e()],1)])])]):t._e(),t.mySketches.length&&!t.search?s("div",{staticClass:"section"},[s("div",{staticClass:"container"},[s("b-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[s("b-tab-item",{attrs:{label:"My sketches",disabled:!t.mySketches.length}},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content"},[s("ts-sketch-list",{attrs:{sketches:t.mySketches}})],1)])]),s("b-tab-item",{attrs:{label:"Shared with me",disabled:!t.sharedSketches.length}},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content"},[s("ts-sketch-list",{attrs:{sketches:t.sharedSketches}})],1)])]),s("b-tab-item",{attrs:{label:"Archived",disabled:!t.myArchivedSketches.length}},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content"},[s("ts-sketch-list",{attrs:{sketches:t.myArchivedSketches}})],1)])])],1)],1)]):t._e()],1)},_=[],C=(s("386d"),s("7f7f"),s("6762"),s("2fdb"),s("795b")),y=s.n(C),b=s("bc3a"),k=s.n(b),S=s("aced"),w=s("2c4e"),x=k.a.create({baseURL:"/api/v1",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}}),T=k.a.create({baseURL:"/api/v1",responseType:"blob",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}});x.interceptors.response.use(function(t){return t},function(t){return"The CSRF token has expired"===t.response.data.message?w["a"].open({message:t.response.data.message,type:"is-white",position:"is-top",actionText:"Refresh",indefinite:!0,onAction:function(){location.reload()}}):S["a"].open(t.response.data.message),y.a.reject(t)});var E={getSketchList:function(){return x.get("/sketches/")},getSketch:function(t){return x.get("/sketches/"+t+"/")},createSketch:function(t){return x.post("/sketches/",t)},deleteSketch:function(t){return x.delete("/sketches/"+t+"/")},archiveSketch:function(t){var e={action:"archive"};return x.post("/sketches/"+t+"/archive/",e)},unArchiveSketch:function(t){var e={action:"unarchive"};return x.post("/sketches/"+t+"/archive/",e)},exportSketch:function(t){var e={action:"export"};return T.post("/sketches/"+t+"/archive/",e)},getSketchTimelines:function(t){return x.get("/sketches/"+t+"/timelines/")},getSketchTimeline:function(t,e){return x.get("/sketches/"+t+"/timelines/"+e+"/")},getSketchTimelineAnalysis:function(t,e){return x.get("/sketches/"+t+"/timelines/"+e+"/analysis/")},createSketchTimeline:function(t,e){var s={timeline:e};return x.post("/sketches/"+t+/timelines/,s)},saveSketchTimeline:function(t,e,s,a,i){var n={name:s,description:a,color:i};return x.post("/sketches/"+t+/timelines/+e+"/",n)},saveSketchSummary:function(t,e,s){var a={name:e,description:s};return x.post("/sketches/"+t+"/",a)},deleteSketchTimeline:function(t,e){return x.delete("/sketches/"+t+/timelines/+e+"/")},getSearchIndexList:function(){return x.get("/searchindices/")},getEvent:function(t,e,s){var a={params:{searchindex_id:e,event_id:s}};return x.get("/sketches/"+t+"/event/",a)},saveEventAnnotation:function(t,e,s,a){var i={annotation:s,annotation_type:e,events:a};return x.post("/sketches/"+t+"/event/annotate/",i)},getStoryList:function(t){return x.get("sketches/"+t+"/stories/")},getStory:function(t,e){return x.get("/sketches/"+t+"/stories/"+e+"/")},createStory:function(t,e,s){var a={title:t,content:e};return x.post("/sketches/"+s+/stories/,a)},updateStory:function(t,e,s,a){var i={title:t,content:e};return x.post("/sketches/"+s+/stories/+a+"/",i)},getView:function(t,e){return x.get("/sketches/"+t+"/views/"+e+"/")},createView:function(t,e,s,a){var i={name:e,query:s,filter:a,dsl:""};return x.post("/sketches/"+t+/views/,i)},deleteView:function(t,e){return x.delete("/sketches/"+t+"/views/"+e+"/")},search:function(t,e){return x.post("/sketches/"+t+"/explore/",e)},exportSearchResult:function(t,e){return T.post("/sketches/"+t+"/explore/",e)},getAggregations:function(t){return x.get("/sketches/"+t+"/aggregation/")},getAggregationGroups:function(t){return x.get("/sketches/"+t+"/aggregation/group/")},runAggregator:function(t,e){return x.post("/sketches/"+t+"/aggregation/explore/",e)},runAggregatorGroup:function(t,e){return x.get("/sketches/"+t+"/aggregation/group/"+e+"/")},saveAggregation:function(t,e,s,a){var i={name:s,description:e.description,agg_type:e.name,chart_type:a["supported_charts"],parameters:a};return x.post("/sketches/"+t+"/aggregation/",i)},countSketchEvents:function(t){return x.get("/sketches/"+t+"/count/")},uploadTimeline:function(t,e){return x.post("/upload/",t,e)},getSessions:function(t,e){return x.get("/sketches/"+t+"/explore/sessions/"+e+"/")},getUsers:function(){return x.get("/users/")},getGroups:function(){return x.get("/groups/")},editCollaborators:function(t,e,s,a,i,n){var r={public:e,users:s,groups:a,remove_users:i,remove_groups:n};return x.post("/sketches/"+t+/collaborators/,r)},runAnalyzers:function(t,e,s){var a={timeline_id:e,analyzer_names:s};return x.post("/sketches/"+t+/analyzer/,a)},getAnalyzerSession:function(t,e){return x.get("/sketches/"+t+"/analyzer/sessions/"+e+"/")},getLoggedInUser:function(){return x.get("/users/me/")}},$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("b-table",{attrs:{data:t.sketches,"per-page":t.perPage,paginated:"","pagination-simple":"","pagination-position":"bottom","default-sort-direction":"desc","icon-pack":"fas","icon-prev":"chevron-left","icon-next":"chevron-right"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("b-table-column",{attrs:{field:"name",label:"Name"}},[s("router-link",{attrs:{to:{name:"SketchOverview",params:{sketchId:e.row.id}}}},[s("strong",[t._v(t._s(e.row.name))])])],1),s("b-table-column",{attrs:{field:"status"}},["archived"===e.row.status?s("span",[s("b-tag",[t._v(t._s(e.row.status))])],1):t._e()]),s("b-table-column",{attrs:{field:"user",label:"Created by",width:"200"}},[t._v("\n        "+t._s(e.row.user)+"\n      ")]),s("b-table-column",{attrs:{field:"updated_at",label:"Last activity",width:"200"}},[t._v("\n        "+t._s(t._f("moment")(new Date(e.row.updated_at),"YYYY-MM-DD HH:mm"))+"\n      ")])]}}])},[s("template",{slot:"bottom-left"},[s("div",{staticClass:"has-text-right"},[s("div",{staticClass:"level"},[s("div",{staticClass:"level-left",staticStyle:{"margin-right":"10px"}},[t._v("\n            Rows per page:\n          ")]),s("div",{staticClass:"level-right"},[s("b-select",{staticClass:"is-pulled-left",attrs:{placeholder:"Rows per page",size:"is-small"},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}},[s("option",{domProps:{value:t.perPage}},[t._v(t._s(t.perPage))]),s("option",{attrs:{value:"20"}},[t._v("20")]),s("option",{attrs:{value:"40"}},[t._v("40")]),s("option",{attrs:{value:"80"}},[t._v("80")]),s("option",{attrs:{value:"100"}},[t._v("100")]),s("option",{attrs:{value:"200"}},[t._v("200")]),s("option",{attrs:{value:"500"}},[t._v("500")])])],1)])])])],2)],1)},A=[],D={props:["sketches"],data:function(){return{perPage:20}}},F=D,M=Object(c["a"])(F,$,A,!1,null,"6af029d4",null),N=M.exports,O=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm(e)}}},[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Name")]),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Name your sketch",autofocus:""},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}})])]),s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Description (optional)")]),s("div",{staticClass:"control"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.description,expression:"form.description"}],staticClass:"textarea",attrs:{placeholder:"Describe your sketch"},domProps:{value:t.form.description},on:{input:function(e){e.target.composing||t.$set(t.form,"description",e.target.value)}}})])]),t._m(0)])},I=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save"}})])])}],P={data:function(){return{form:{name:"",description:""}}},methods:{clearFormData:function(){this.form.name="",this.form.description=""},submitForm:function(){var t=this,e={name:this.form.name,description:this.form.description};E.createSketch(e).then(function(e){var s=e.data.objects[0].id;t.clearFormData(),t.$router.push({name:"SketchOverview",params:{sketchId:s}})}).catch(function(t){})}}},j=P,L=Object(c["a"])(j,O,I,!1,null,null,null),Q=L.exports,R={components:{TsSketchList:N,TsCreateSketchForm:Q},data:function(){return{showSketchCreateModal:!1,allSketches:[],mySketches:[],myArchivedSketches:[],sharedSketches:[],loading:!0,search:""}},computed:{filteredList:function(){var t=this;return this.allSketches.filter(function(e){return e.name.toLowerCase().includes(t.search.toLowerCase())})}},created:function(){var t=this;this.$store.dispatch("resetState"),E.getSketchList().then(function(e){var s=e.data.objects,a=e.data.meta.current_user;t.mySketches=s.filter(function(t){return t.user===a&&"archived"!==t.status}),t.myArchivedSketches=s.filter(function(t){return t.user===a&&"archived"===t.status}),t.sharedSketches=s.filter(function(t){return t.user!==a}),t.allSketches=s,t.loading=!1}).catch(function(t){console.error(t)})}},z=R,V=Object(c["a"])(z,g,_,!1,null,null,null),q=V.exports,U=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.sketch.status?s("router-view"):t._e()},H=[],Y={props:["sketchId"],created:function(){this.$store.dispatch("updateSketch",this.sketchId)},computed:{sketch:function(){return this.$store.state.sketch}},watch:{sketch:function(t){"archived"===t.status[0].status&&this.$router.push({name:"SketchOverview",params:{sketchId:this.sketch.id}})}}},G=Y,B=Object(c["a"])(G,U,H,!1,null,null,null),J=B.exports,W=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.sketch.status?s("div",["archived"===t.sketch.status[0].status?s("div",{staticClass:"task-container columns is-multiline",staticStyle:{"margin-top":"50px"}},[s("div",{staticClass:"card column is-half is-offset-one-quarter has-text-centered",staticStyle:{"min-height":"300px","padding-top":"90px"}},[s("h4",{staticClass:"title is-4"},[t._v(t._s(t.sketch.name))]),s("p",[t._v("This sketch has been archived")]),s("div",{staticClass:"buttons is-centered",staticStyle:{"margin-top":"30px"}},[s("button",{staticClass:"button is-success is-outlined",on:{click:function(e){return t.unArchiveSketch()}}},[t._v("Unarchive")]),s("button",{staticClass:"button is-link is-outlined",on:{click:function(e){return t.exportSketch()}}},[t._v("Export")])])])]):t._e(),"archived"!==t.sketch.status[0].status?s("div",[s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"overview"}},[t.meta.collaborators?s("b-tooltip",{attrs:{label:t.shareTooltip,position:"is-bottom",type:"is-white"}},[t.meta.permissions.write?s("a",{staticClass:"button is-info is-rounded",staticStyle:{"margin-right":"10px"},on:{click:function(e){t.showShareModal=!t.showShareModal}}},[s("span",{staticClass:"icon is-small"},[t.meta.permissions.public?s("i",{staticClass:"fas fa-globe"}):t.meta.collaborators.users.length||t.meta.collaborators.groups.length?s("i",{staticClass:"fas fa-users"}):t.meta.permissions.public?t._e():s("i",{staticClass:"fas fa-lock"})]),s("span",[t._v("Share")])]):t._e()]):t._e(),t.meta.permissions.write?s("b-dropdown",{attrs:{"aria-role":"list",position:"is-bottom-left"},scopedSlots:t._u([{key:"trigger",fn:function(e){var a=e.active;return s("a",{staticClass:"button",staticStyle:{background:"transparent",border:"none"}},[s("span",{staticClass:"icon is-small"},[s("i",{class:a?"fas fa-angle-up":"fas fa-angle-down"})]),s("span",[t._v("More")])])}}],null,!1,3865603318)},[t.meta.permissions.delete?s("b-dropdown-item",{attrs:{"aria-role":"listitem"}},[s("a",{staticClass:"dropdown-item",on:{click:function(e){t.showDeleteSketchModal=!t.showDeleteSketchModal}}},[s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-trash"})]),s("span",[t._v("Delete")])])]):t._e(),t.meta.permissions.delete?s("b-dropdown-item",{attrs:{"aria-role":"listitem"}},[s("a",{staticClass:"dropdown-item",on:{click:t.archiveSketch}},[s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-archive"})]),s("span",[t._v("Archive")])])]):t._e(),t.meta.permissions.read?s("b-dropdown-item",{attrs:{"aria-role":"listitem"}},[s("a",{staticClass:"dropdown-item",on:{click:function(e){return t.exportSketch()}}},[s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-file-export"})]),s("span",[t._v("Export")])])]):t._e()],1):t._e()],1)],1)]),s("b-modal",{attrs:{active:t.showShareModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showShareModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Share sketch")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("ts-share-form",{on:{closeShareModal:t.closeShareModal}})],1)])])]),s("b-modal",{attrs:{active:t.showUploadTimelineModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showUploadTimelineModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Upload new timeline")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("p",[t._v("\n            Supported formats are Plaso storage file, JSONL, or a CSV file.\n            If you are uploading a CSV or JSONL file make sure to read the "),s("a",{attrs:{href:"https://github.com/google/timesketch/blob/master/docs/Users-Guide.md#adding-timelines",rel:"noreferrer",target:"_blank"}},[t._v("documentation")]),t._v(" to learn what columns are needed.\n          ")]),s("ts-upload-timeline-form",{on:{toggleModal:function(e){t.showUploadTimelineModal=!t.showUploadTimelineModal}}})],1)])])]),s("b-modal",{attrs:{active:t.showDeleteSketchModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showDeleteSketchModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Delete sketch")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("p",[t._v("Are you sure you want to delete this sketch?")]),s("div",{staticClass:"field is-grouped"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-danger",on:{click:t.deleteSketch}},[s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-trash"})]),s("span",[t._v("Delete")])])]),s("p",{staticClass:"control"},[s("button",{staticClass:"button",on:{click:function(e){t.showDeleteSketchModal=!t.showDeleteSketchModal}}},[s("span",[t._v("I changed my mind, keep the sketch!")])])])])])])])]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card",staticStyle:{"min-height":"200px"}},[s("div",{staticClass:"card-content"},[s("ts-sketch-summary",{attrs:{sketch:t.sketch}}),s("br"),s("b-field",{attrs:{grouped:"","group-multiline":""}},[t._l(t.sortedUserList(),function(e){return s("div",{key:e.name,staticClass:"control"},[s("b-tag",{attrs:{attached:"",size:"is-medium"}},[t._v(t._s(e))])],1)}),t._l(t.sortedGroupList(),function(e){return s("div",{key:e.name,staticClass:"control"},[s("b-tag",{attrs:{attached:"",size:"is-medium"}},[t._v(t._s(e))])],1)})],2)],1)])])]),t.sketch.active_timelines.length?s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card",staticStyle:{"min-height":"100px"}},[s("div",{staticClass:"card-content"},[s("ts-sketch-metrics",{attrs:{timelines:t.sketch.active_timelines,views:t.meta.views,stories:t.sketch.stories,count:t.count}})],1)])])]):t._e(),t.sketch.timelines&&t.sketch.timelines.length&&t.sketch.timelines.length?s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"columns"},[t.sketch.timelines&&t.sketch.timelines.length&&t.sketch.timelines.length?s("div",{staticClass:"column"},[s("div",{staticClass:"card has-min-height"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Timelines")]),s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{padding:"0.75rem"}},[t.meta.permissions.write?s("p",{staticClass:"control"},[s("button",{staticClass:"button is-success is-rounded is-small",on:{click:function(e){t.showUploadTimelineModal=!t.showUploadTimelineModal}}},[t._m(0),s("span",[t._v("Timeline")])])]):t._e(),s("p",{staticClass:"control"},[s("router-link",{staticClass:"button is-rounded is-small",attrs:{to:{name:"SketchManageTimelines"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-cog"})]),s("span",[t._v("Manage")])])],1)])]),s("div",{staticClass:"card-content",staticStyle:{padding:"5px"}},[s("ts-timeline-list",{attrs:{timelines:t.sketch.timelines,controls:!0,"is-compact":!0}})],1)])]):t._e(),t.meta.views&&t.meta.views.length&&t.meta.views.length?s("div",{staticClass:"column"},[s("div",{staticClass:"card has-min-height"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Views")]),s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{padding:"0.75rem"}},[s("p",{staticClass:"control"},[s("router-link",{staticClass:"button is-rounded is-small",attrs:{to:{name:"SketchManageViews"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-cog"})]),s("span",[t._v("Manage")])])],1)])]),s("div",{staticClass:"card-content",staticStyle:{padding:"5px"}},[s("ts-saved-view-list",{attrs:{views:t.meta.views}})],1)])]):t._e(),t.sketch.stories&&t.sketch.stories.length&&t.sketch.stories.length?s("div",{staticClass:"column"},[s("div",{staticClass:"card has-min-height"},[t._m(1),s("div",{staticClass:"card-content",staticStyle:{padding:"5px"}},[s("ts-sketch-story-list")],1)])]):t._e()])])]):t._e(),t.sketch.timelines.length?t._e():s("ts-sketch-timelines-manage",{attrs:{"hide-navigation":!0}})],1):t._e()]):t._e()},K=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-plus"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Stories")])])}],X=(s("55dd"),s("75fc")),Z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("h4",{staticClass:"title is-4",attrs:{contenteditable:t.meta.permissions.write},domProps:{textContent:t._s(t.sketch.name)},on:{blur:t.onEditTitle,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.onEditTitle(e))}}}),s("p",{attrs:{contenteditable:t.meta.permissions.write},domProps:{textContent:t._s(t.sketch.description)},on:{blur:t.onEditDescription,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.onEditDescription(e))}}})])},tt=[],et={computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{onEditTitle:function(t){this.sketch.name=t.target.innerText,this.saveSketchSummary()},onEditDescription:function(t){this.sketch.description=t.target.innerText,this.saveSketchSummary()},saveSketchSummary:function(){E.saveSketchSummary(this.sketch.id,this.sketch.name,this.sketch.description).then(function(t){}).catch(function(t){console.error(t)})}}},st=et,at=Object(c["a"])(st,Z,tt,!1,null,null,null),it=at.exports,nt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("nav",{staticClass:"level"},[s("div",{staticClass:"level-item has-text-centered"},[s("div",[s("p",{staticClass:"heading"},[t._v("Timelines")]),s("p",{staticClass:"title"},[t._v(t._s(t.timelines&&t.timelines.length?t.timelines.length:0))])])]),s("div",{staticClass:"level-item has-text-centered"},[s("div",[s("p",{staticClass:"heading"},[t._v("Views")]),s("p",{staticClass:"title"},[t._v(t._s(t.views&&t.views.length?t.views.length:0))])])]),s("div",{staticClass:"level-item has-text-centered"},[s("div",[s("p",{staticClass:"heading"},[t._v("Stories")]),s("p",{staticClass:"title"},[t._v(t._s(t.views&&t.stories.length?t.stories.length:0))])])]),s("div",{staticClass:"level-item has-text-centered"},[s("div",[s("p",{staticClass:"heading"},[t._v("Events")]),s("p",{staticClass:"title"},[t._v(t._s(t._f("compactNumber")(t.count)))])])])])},rt=[],ot={props:["timelines","views","stories","count"]},ct=ot,lt=Object(c["a"])(ct,nt,rt,!1,null,null,null),ut=lt.exports,dt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",{staticClass:"content-list"},[s("transition-group",{attrs:{name:"list",tag:"p"}},t._l(t.timelines,function(e){return s("li",{key:e.id,staticStyle:{padding:"10px"}},[s("ts-timeline-list-item",{attrs:{timeline:e,controls:t.controls,"is-compact":t.isCompact},on:{remove:function(s){return t.remove(e)},save:function(s){return t.save(e)}}})],1)}),0)],1)},ht=[],mt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("b-modal",{attrs:{active:t.showInfoModal,width:1024,scroll:"keep"},on:{"update:active":function(e){t.showInfoModal=e}}},[s("div",{staticClass:"modal-background"}),s("div",{staticClass:"modal-content"},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Detailed information for "+t._s(t.timeline.name))])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("ul",[s("li",[t._v("Elasticsearch index: "+t._s(t.timeline.searchindex.index_name))]),t.meta.stats[t.timeline.searchindex.index_name]?s("li",[t._v("Number of events: "+t._s(t._f("compactNumber")(t.meta.stats[t.timeline.searchindex.index_name]["count"]))+" ("+t._s(t.meta.stats[t.timeline.searchindex.index_name]["count"])+")")]):t._e(),t.meta.stats[t.timeline.searchindex.index_name]?s("li",[t._v("Size on disk: "+t._s(t._f("compactBytes")(t.meta.stats[t.timeline.searchindex.index_name]["bytes"]))+" ("+t._s(t.meta.stats[t.timeline.searchindex.index_name]["bytes"])+")")]):t._e(),s("li",[t._v("Original name: "+t._s(t.timeline.searchindex.name))]),s("li",[t._v("Added by: "+t._s(t.timeline.searchindex.user.username))]),s("li",[t._v("Added: "+t._s(t._f("moment")(t.timeline.searchindex.created_at,"YYYY-MM-DD HH:mm")))])]),"fail"===t.timelineStatus?s("span",[s("h5",{staticStyle:{color:"red"}},[t._v("Error detail")]),s("pre",[t._v(t._s(t.timeline.searchindex.description))])]):t._e()])])])]),s("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){t.showInfoModal=!t.showInfoModal}}})]),s("b-modal",{attrs:{active:t.showEditModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showEditModal=e}}},[s("div",{staticClass:"modal-background"}),s("div",{staticClass:"modal-content"},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Rename timeline")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.saveTimeline(e)}}},[s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.timeline.name,expression:"timeline.name"}],staticClass:"input",attrs:{type:"text",required:"",autofocus:""},domProps:{value:t.timeline.name},on:{input:function(e){e.target.composing||t.$set(t.timeline,"name",e.target.value)}}})])]),s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save"}})])])])])])])]),s("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){t.showEditModal=!t.showEditModal}}})]),"processing"===t.timelineStatus?s("div",{staticClass:"ts-timeline-color-box is-pulled-left blink",staticStyle:{"background-color":"#f5f5f5"}}):"fail"===t.timelineStatus?s("div",{staticClass:"ts-timeline-color-box is-pulled-left",staticStyle:{"background-color":"#f5f5f5"},on:{click:function(e){t.showInfoModal=!t.showInfoModal}}}):"ready"===t.timelineStatus?s("div",{staticClass:"dropdown is-pulled-left",class:{"is-active":t.colorPickerActive}},[s("div",{staticClass:"dropdown-trigger"},[s("div",{staticClass:"ts-timeline-color-box",style:t.timelineColorStyle,on:{click:function(e){t.colorPickerActive=!t.colorPickerActive}}})]),s("div",{staticClass:"dropdown-menu",attrs:{id:"dropdown-menu",role:"menu"}},[s("div",{staticClass:"dropdown-content",staticStyle:{padding:"0"}},[s("div",{staticClass:"dropdown-item",staticStyle:{padding:"0"}},[s("color-picker",{on:{input:t.updateColor},model:{value:t.initialColor,callback:function(e){t.initialColor=e},expression:"initialColor"}})],1)])])]):s("div",{staticClass:"ts-timeline-color-box is-pulled-left",staticStyle:{"background-color":"#f5f5f5"}}),t.controls?s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{"margin-top":"10px"}},[t.isCompact?t._e():s("p",{staticClass:"control"},[s("button",{staticClass:"button is-rounded is-small is-outlined",on:{click:function(e){t.showInfoModal=!t.showInfoModal}}},[t._m(0),s("span",[t._v("Info")])])]),t.meta.permissions.write&&"ready"===t.timelineStatus&&!t.isCompact?s("p",{staticClass:"control"},[s("button",{staticClass:"button is-rounded is-small is-outlined",on:{click:function(e){t.showEditModal=!t.showEditModal}}},[t._m(1),s("span",[t._v("Rename")])])]):t._e(),"ready"===t.timelineStatus?s("p",{staticClass:"control"},[s("span",{staticStyle:{"margin-right":"7px"}},[s("button",{staticClass:"button is-small is-rounded is-outlined",on:{click:function(e){return t.toggleExpansion(t.timeline)}}},[s("span",{staticClass:"icon is-small"},[s("i",{class:[t.isExpanded(t.timeline)?"fas fa-minus-circle":"fas fa-plus-circle"]})]),s("span",[t._v("Show data types")])])]),s("ts-analyzer-list-dropdown",{attrs:{timeline:t.timeline},on:{newAnalysisSession:function(e){return t.setAnalysisSession(e)}}})],1):t._e(),"ready"!==t.timelineStatus||t.isCompact?t._e():s("p",{staticClass:"control"},[s("button",{staticClass:"button is-small is-rounded is-outlined",on:{click:function(e){t.showAnalysisHistory=!t.showAnalysisHistory}}},[t._m(2),s("span",[t._v("History")])])]),t.meta.permissions.write&&!t.isCompact?s("p",{staticClass:"control"},[s("button",{staticClass:"button is-small is-rounded is-danger is-outlined",on:{click:function(e){return t.remove(t.timeline)}}},[t._v("Remove")])]):t._e()]):t._e(),"ready"===t.timelineStatus?s("router-link",{attrs:{to:{name:"SketchExplore",query:{index:t.timeline.searchindex.index_name}}}},[s("strong",[t._v(t._s(t.timeline.name))])]):t._e(),"ready"!==t.timelineStatus?s("strong",[t._v(t._s(t.timeline.name))]):t._e(),s("br"),"ready"===t.timelineStatus?s("span",{staticClass:"is-size-7"},[t._v("\n    Added "+t._s(t._f("moment")(t.timeline.updated_at,"YYYY-MM-DD HH:mm"))+"\n    "),s("span",{staticClass:"tag is-small",attrs:{title:t.meta.stats[t.timeline.searchindex.index_name]["count"]+" events in index"}},[t._v(t._s(t._f("compactNumber")(t.meta.stats[t.timeline.searchindex.index_name]["count"])))]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isExpanded(t.timeline),expression:"isExpanded(timeline)"}],staticClass:"small-top-margin"},[s("ul",t._l(t.meta.stats[t.timeline.searchindex.index_name]["data_types"],function(e){return s("li",{key:e.data_type},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.checkedDataTypes,expression:"checkedDataTypes"}],staticClass:"checkbox-margin",attrs:{type:"checkbox",id:e.data_type},domProps:{value:e.data_type,checked:Array.isArray(t.checkedDataTypes)?t._i(t.checkedDataTypes,e.data_type)>-1:t.checkedDataTypes},on:{change:function(s){var a=t.checkedDataTypes,i=s.target,n=!!i.checked;if(Array.isArray(a)){var r=e.data_type,o=t._i(a,r);i.checked?o<0&&(t.checkedDataTypes=a.concat([r])):o>-1&&(t.checkedDataTypes=a.slice(0,o).concat(a.slice(o+1)))}else t.checkedDataTypes=n}}}),s("label",{attrs:{for:e.data_type}},["ready"===t.timelineStatus?s("router-link",{attrs:{to:{name:"SketchExplore",query:{index:t.timeline.searchindex.index_name,q:'data_type:"'+e.data_type+'"'}}}},[t._v(t._s(e.data_type)+" ")]):t._e()],1),s("span",{staticClass:"tag is-small",attrs:{title:e.count+" events in index"}},[t._v(t._s(t._f("compactNumber")(e.count)))])])}),0),s("a",{staticClass:"button is-rounded is-small small-top-margin checkbox-margin",attrs:{disabled:0===t.checkedDataTypes.length},on:{click:function(e){return t.openFilteredTimeline(t.timeline.searchindex.index_name,t.checkedDataTypes)}}},[t._m(3),s("span",[t._v("Open Filtered")])])])]):"fail"===t.timelineStatus?s("span",{staticClass:"is-size-7"},[t._v("\n    ERROR: "),s("span",{staticStyle:{cursor:"pointer","text-decoration":"underline"},on:{click:function(e){t.showInfoModal=!t.showInfoModal}}},[t._v("Click here for details")])]):"processing"===t.timelineStatus?s("span",{staticClass:"is-size-7"},[t._v("\n    Indexing in progress...\n  ")]):s("span",{staticClass:"is-size-7"},[t._v("\n    Unknown status: "+t._s(t.timelineStatus)+"\n  ")]),s("br"),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showAnalysisDetail,expression:"showAnalysisDetail"}]},[s("ts-analyzer-session-detail",{attrs:{timeline:t.timeline,"session-id":t.analysisSessionId},on:{closeDetail:function(e){t.showAnalysisDetail=!1}}})],1),t.showAnalysisHistory?s("div",[s("ts-analyzer-history",{attrs:{timeline:t.timeline},on:{closeHistory:function(e){t.showAnalysisHistory=!1}}})],1):t._e()],1)},pt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-info-circle"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-edit"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-history"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-check-square"})])}],vt=(s("f559"),s("c345")),ft=s("2ef0"),gt=s.n(ft),_t=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-dropdown",{attrs:{position:"is-bottom-left","aria-role":"menu","trap-focus":""}},[s("button",{staticClass:"button is-outlined is-rounded is-small",attrs:{slot:"trigger"},slot:"trigger"},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-play-circle"})]),s("span",[t._v("Analyze")])]),s("b-dropdown-item",{attrs:{"aria-role":"menu-item",focusable:!1,custom:""}},[s("div",{staticClass:"modal-card",staticStyle:{width:"300px"}},[t._l(t.sortedAnalyzerList(),function(e){return s("div",{staticClass:"field"},[s("b-checkbox",{attrs:{"native-value":e,type:"is-info"},model:{value:t.selectedAnalyzers,callback:function(e){t.selectedAnalyzers=e},expression:"selectedAnalyzers"}},[t._v(t._s(e))])],1)}),t.selectedAnalyzers.length?s("button",{staticClass:"button is-success",on:{click:t.runAnalyzers}},[t._v("Run")]):t._e()],2)])],1)},Ct=[],yt={props:["timeline"],data:function(){return{selectedAnalyzers:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{sortedAnalyzerList:function(){var t=Object(X["a"])(this.$store.state.meta.analyzers);return t.sort()},runAnalyzers:function(){var t=this;E.runAnalyzers(this.sketch.id,this.timeline.id,this.selectedAnalyzers).then(function(e){t.$emit("newAnalysisSession",e.data.objects[0].analysis_session)}).catch(function(t){}),this.selectedAnalyzers=[]}}},bt=yt,kt=Object(c["a"])(bt,_t,Ct,!1,null,null,null),St=kt.exports,wt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card",staticStyle:{"margin-top":"15px"}},[s("header",{staticClass:"card-header",staticStyle:{"background-color":"#eaeaea"}},[s("p",{staticClass:"card-header-title"},[t._v("\n      "+t._s(t.messageTitle)+"\n    ")]),s("span",{staticClass:"card-header-icon",attrs:{"aria-label":"close"}},[s("span",{staticClass:"delete",on:{click:function(e){return t.$emit("closeDetail")}}})])]),s("div",{staticClass:"card-content",staticStyle:{"background-color":"#f7f7f7"}},[s("table",{staticClass:"table is-fullwidth"},[t._m(0),s("tbody",t._l(t.tableData,function(e){return s("tr",[s("td",[s("div",{class:{pending:"PENDING"===e.status,done:"DONE"===e.status,started:"STARTED"===e.status,error:"ERROR"===e.status},staticStyle:{width:"10px",height:"10px","border-radius":"100%","margin-top":"6px","margin-left":"3px"}})]),s("td",[t._v(t._s(e.analyzer))]),s("td",[t._v(t._s(e.result))])])}),0)])])])},xt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("colgroup",[s("col",{staticStyle:{width:"5%"},attrs:{span:"1"}}),s("col",{staticStyle:{width:"15%"},attrs:{span:"1"}}),s("col",{staticStyle:{width:"80%"},attrs:{span:"1"}})])}],Tt=(s("ac6a"),{props:["timeline","sessionId"],data:function(){return{analysisSession:{},analyses:[],autoRefresh:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},totalAnalyzers:function(){return this.analyses.length},finishedAnalyzers:function(){var t=0;return this.analyses.forEach(function(e){"DONE"!==e.status[0].status&&"ERROR"!==e.status[0].status||(t+=1)}),t},runningAnalyzer:function(){var t=!1;return this.analyses.forEach(function(e){"STARTED"===e.status[0].status&&(t=e.analyzer_name)}),t},tableData:function(){var t=[];return this.analyses.forEach(function(e){var s={};s.status=e.status[0].status,s.analyzer=e.analyzer_name,s.result=e.result,t.push(s)}),t},messageTitle:function(){return this.finishedAnalyzers+"/"+this.totalAnalyzers+" analyzers done"}},methods:{fetchData:function(){var t=this;this.sessionId&&E.getAnalyzerSession(this.sketch.id,this.sessionId).then(function(e){t.analysisSession=e.data.objects[0],t.analyses=e.data.objects[0].analyses,t.autoRefresh=!0}).catch(function(t){})}},watch:{autoRefresh:function(t){t&&!this.t?this.t=setInterval(function(){this.fetchData(),this.finishedAnalyzers===this.totalAnalyzers&&(this.autoRefresh=!1)}.bind(this),5e3):(clearInterval(this.t),this.t=!1)},sessionId:function(t){t&&this.fetchData()}}}),Et=Tt,$t=(s("adbc"),Object(c["a"])(Et,wt,xt,!1,null,"d93f0664",null)),At=$t.exports,Dt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card",staticStyle:{"margin-top":"15px"}},[s("header",{staticClass:"card-header",staticStyle:{"background-color":"#eaeaea"}},[s("p",{staticClass:"card-header-title"},[t._v("\n      Analysis history\n    ")]),s("span",{staticClass:"card-header-icon",attrs:{"aria-label":"close"}},[s("span",{staticClass:"delete",on:{click:function(e){return t.$emit("closeHistory")}}})])]),s("div",{staticClass:"card-content",staticStyle:{"background-color":"#f7f7f7"}},[t.analyses?s("b-table",{attrs:{data:t.analyses,"current-page":t.currentPage,"per-page":t.perPage,paginated:"","pagination-simple":"","pagination-position":"bottom","default-sort-direction":"desc","sort-icon":"arrow-down","sort-icon-size":"is-small","icon-pack":"fas","icon-prev":"chevron-left","icon-next":"chevron-right","default-sort":"created_at"},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}},scopedSlots:t._u([{key:"default",fn:function(e){return[s("b-table-column",{attrs:{field:"created_at",label:"Date",width:"150",sortable:""}},[t._v("\n          "+t._s(t._f("moment")(new Date(e.row.created_at),"YYYY-MM-DD HH:mm"))+"\n        ")]),s("b-table-column",{attrs:{field:"name",label:"Analyzer"}},[t._v("\n          "+t._s(e.row.analyzer_name)+"\n        ")]),s("b-table-column",{attrs:{field:"result",label:"Result"}},[t._v("\n          "+t._s(e.row.result)+"\n        ")]),s("b-table-column",{attrs:{field:"status",label:"Status",width:"40"}},[t._v("\n          "+t._s(e.row.status[0].status)+"\n        ")])]}}],null,!1,2396681962)}):t._e(),t.analyses?t._e():s("span",[t._v("No analysis available.")])],1)])},Ft=[],Mt={props:["timeline"],data:function(){return{analyses:[],currentPage:1,perPage:5}},computed:{sketch:function(){return this.$store.state.sketch}},created:function(){var t=this;E.getSketchTimelineAnalysis(this.sketch.id,this.timeline.id).then(function(e){t.analyses=e.data.objects[0]}).catch(function(t){})}},Nt=Mt,Ot=Object(c["a"])(Nt,Dt,Ft,!1,null,null,null),It=Ot.exports,Pt={components:{"color-picker":vt["Chrome"],TsAnalyzerListDropdown:St,TsAnalyzerSessionDetail:At,TsAnalyzerHistory:It},props:["timeline","controls","isCompact"],data:function(){return{checkedDataTypes:[],expandedDataSource:[],initialColor:{},newColor:"",newTimelineName:"",colorPickerActive:!1,showInfoModal:!1,showEditModal:!1,analysisSessionId:!1,showAnalysisDetail:!1,showAnalysisHistory:!1,timelineStatus:null,autoRefresh:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},timelineColorStyle:function(){var t=this.newColor||this.timeline.color;return t.startsWith("#")||(t="#"+t),{"background-color":t}}},methods:{remove:function(t){this.$emit("remove",t)},updateColor:gt.a.debounce(function(t){this.newColor=t.hex,this.newColor.startsWith("#")&&(this.newColor=this.newColor.substring(1)),a["a"].set(this.timeline,"color",this.newColor),this.$emit("save",this.timeline)},300),saveTimeline:function(){this.showEditModal=!1,this.$emit("save",this.timeline)},setAnalysisSession:function(t){this.analysisSessionId=t,this.showAnalysisDetail=!0},fetchData:function(){var t=this;E.getSketchTimeline(this.sketch.id,this.timeline.id).then(function(e){t.timelineStatus=e.data.objects[0].searchindex.status[0].status,"ready"!==t.timelineStatus&&(t.autoRefresh=!0),t.$store.dispatch("updateSketch",t.$store.state.sketch.id)}).catch(function(t){})},openFilteredTimeline:function(t,e){for(var s="",a=0;a<e.length;a++){var i=e[a];0!=a&&(s+=" OR "),s+='data_type:"'+i+'"'}this.$router.push({name:"SketchExplore",query:{index:t,q:s}})},isExpanded:function(t){return-1!==this.expandedDataSource.indexOf(t)},toggleExpansion:function(t){this.isExpanded(t)?this.expandedDataSource.splice(this.expandedDataSource.indexOf(t),1):this.expandedDataSource.push(t)}},mounted:function(){var t=this;window.addEventListener("click",function(e){t.$el.contains(e.target)||(t.colorPickerActive=!1)})},created:function(){this.initialColor={hex:this.timeline.color},this.timelineStatus=this.timeline.searchindex.status[0].status,"ready"!==this.timelineStatus&&(this.autoRefresh=!0)},beforeDestroy:function(){clearInterval(this.t),this.t=!1},watch:{autoRefresh:function(t){t&&!this.t?this.t=setInterval(function(){this.fetchData(),"ready"===this.timelineStatus&&(this.autoRefresh=!1)}.bind(this),5e3):(clearInterval(this.t),this.t=!1)}}},jt=Pt,Lt=(s("a2cf"),Object(c["a"])(jt,mt,pt,!1,null,"0973e95d",null)),Qt=Lt.exports,Rt={components:{TsTimelineListItem:Qt},props:["timelines","controls","isCompact"],computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{remove:function(t){var e=this;E.deleteSketchTimeline(this.sketch.id,t.id).then(function(s){e.$emit("remove-timeline",t),e.$store.dispatch("updateSketch",e.sketch.id)}).catch(function(t){console.error(t)})},save:function(t){var e=this;E.saveSketchTimeline(this.sketch.id,t.id,t.name,t.description,t.color).then(function(t){e.$store.dispatch("updateSketch",e.sketch.id)}).catch(function(t){console.error(t)})}},created:function(){this.$store.dispatch("updateSketch",this.sketch.id)}},zt=Rt,Vt=Object(c["a"])(zt,dt,ht,!1,null,null,null),qt=Vt.exports,Ut=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ul",{staticClass:"content-list"},t._l(t.views,function(e,a){return s("li",{key:e.id,staticStyle:{padding:"10px","border-bottom":"none"}},[s("router-link",{attrs:{to:{name:"SketchExplore",query:{view:e.id}}}},[s("strong",[t._v(t._s(e.name))])]),s("br"),t.controls?t._e():s("span",{staticClass:"is-size-7"},[t._v("\n        Created "+t._s(t._f("moment")(e.created_at,"YYYY-MM-DD HH:mm"))+" "),e.user?s("span",[t._v(" by "+t._s(e.user))]):t._e(),e.description?s("span",[t._v(" ("+t._s(e.description)+")")]):t._e()]),t.controls?s("span",{staticClass:"is-size-7"},[s("b",[t._v("Query:")]),t._v(" "+t._s(e.query)+"\n      ")]):t._e(),t.controls?s("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{"margin-top":"-15px"}},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-small is-rounded is-danger is-outlined",on:{click:function(s){return t.remove(e,a)}}},[t._v("Remove")])])]):t._e()],1)}),0)])},Ht=[],Yt={props:["views","controls"],computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{remove:function(t,e){a["a"].delete(this.views,e),E.deleteView(this.sketch.id,t.id).then(function(t){}).catch(function(t){console.error(t)})}}},Gt=Yt,Bt=Object(c["a"])(Gt,Ut,Ht,!1,null,null,null),Jt=Bt.exports,Wt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ul",{staticClass:"content-list"},t._l(t.sketch.stories,function(e){return s("li",{key:e.id,staticStyle:{padding:"10px","border-bottom":"none"}},[s("div",[s("router-link",{attrs:{to:{name:"SketchStoryContent",params:{sketchId:t.sketch.id,storyId:e.id}}}},[s("strong",[t._v(t._s(e.title))])]),s("br"),s("span",{staticClass:"is-size-7"},[t._v("Last activity "+t._s(t._f("moment")(e.updated_at,"YYYY-MM-DD HH:mm")))])],1)])}),0)])},Kt=[],Xt={data:function(){return{stories:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}}},Zt=Xt,te=(s("e1a2"),Object(c["a"])(Zt,Wt,Kt,!1,null,"dafc239c",null)),ee=te.exports,se=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm(e)}}},[s("div",{staticClass:"field"},[s("div",{staticClass:"file has-name"},[s("label",{staticClass:"file-label"},[s("input",{staticClass:"file-input",attrs:{type:"file",name:"resume"},on:{change:function(e){return t.setFileName(e.target.files)}}}),t._m(0),t.fileName?s("span",{staticClass:"file-name"},[t.fileName?t._e():s("span",[t._v("No file selected")]),t._v("\n          "+t._s(t.fileName)+"\n        ")]):t._e()])])]),t.fileName?s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Name")]),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Name your timeline (optional)"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}})])]):t._e(),t.fileName&&0===t.percentCompleted?s("div",{staticClass:"field"},[t._m(1)]):t._e()]),s("br"),0!==t.percentCompleted?s("b-progress",{attrs:{value:t.percentCompleted,"show-value":"",format:"percent",type:"is-info",size:"is-medium"}},[100===t.percentCompleted?s("span",[t._v("Waiting for request to finish..")]):t._e()]):t._e()],1)},ae=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"file-cta"},[s("span",{staticClass:"file-icon"},[s("i",{staticClass:"fas fa-upload"})]),s("span",{staticClass:"file-label"},[t._v("\n            Choose a fileâ€¦\n          ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control"},[s("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Upload"}})])}],ie=(s("28a5"),{data:function(){return{form:{name:"",file:""},fileName:"",percentCompleted:0}},methods:{clearFormData:function(){this.form.name="",this.form.file="",this.fileName=""},submitForm:function(){var t=this,e=new FormData;e.append("file",this.form.file),e.append("name",this.form.name),e.append("sketch_id",this.$store.state.sketch.id);var s={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){this.percentCompleted=Math.round(100*t.loaded/t.total)}.bind(this)};E.uploadTimeline(e,s).then(function(e){t.$store.dispatch("updateSketch",t.$store.state.sketch.id),t.$emit("toggleModal"),t.clearFormData(),t.percentCompleted=0}).catch(function(t){})},setFileName:function(t){var e=t[0].name;this.form.file=t[0],this.form.name=e.split(".").slice(0,-1).join("."),this.fileName=e}}}),ne=ie,re=Object(c["a"])(ne,se,ae,!1,null,null,null),oe=re.exports,ce=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.hideNavigation?t._e():s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:""}})],1)]),t.sketch.timelines.length?s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card",staticStyle:{"min-height":"160px"}},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Active Timelines")]),s("p",{staticClass:"is-pulled-right",staticStyle:{padding:"0.75rem","font-weight":"bold",color:"#777777"}},[t._v(t._s(t._f("compactNumber")(t.count))+" events")])]),s("div",{staticClass:"card-content"},[s("ts-timeline-list",{attrs:{timelines:t.sketch.timelines,controls:!0},on:{"remove-timeline":t.makeTimelineAvailable}})],1)])])]):t._e(),t.meta.permissions.write?s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card",staticStyle:{"min-height":"160px"}},[t._m(0),s("div",{staticClass:"card-content"},[s("b-message",{attrs:{type:"is-success"}},[s("p",[t._v("\n              Upload a new timeline or choose an existing one from the list below. You can upload either a Plaso storage file, JSONL, or a CSV file.\n              "),s("br"),t._v("\n              If you are uploading a CSV or JSONL file make sure to read the "),s("a",{attrs:{href:"https://github.com/google/timesketch/blob/master/docs/Users-Guide.md#adding-timelines",rel:"noreferrer",target:"_blank"}},[t._v("documentation")]),t._v(" to learn what columns are needed.\n            ")]),s("br"),s("ts-upload-timeline-form")],1),t.availableSearchIndices.length?s("ul",{staticClass:"content-list"},[s("transition-group",{attrs:{name:"list",tag:"p"}},t._l(t.availableSearchIndices,function(e){return s("li",{key:e.id,staticStyle:{padding:"10px"}},[s("div",{staticClass:"ts-timeline-color-box is-pulled-left has-text-centered",staticStyle:{"background-color":"#f5f5f5",cursor:"pointer"},on:{click:function(s){return t.addTimelineToSketch(e)}}},[s("span",{staticClass:"icon",staticStyle:{"margin-top":"10px",color:"#d1d1d1"}},[s("i",{staticClass:"fas fa-plus"})])]),s("div",{staticClass:"is-pulled-right",staticStyle:{"margin-top":"10px"}},[s("button",{staticClass:"button is-small is-rounded is-success is-outlined",on:{click:function(s){return t.addTimelineToSketch(e)}}},[t._v("Add")])]),s("strong",[t._v(t._s(e.name))]),s("br"),s("span",{staticClass:"is-size-7"},[t._v("\n                    Created "+t._s(t._f("moment")(e.updated_at,"YYYY-MM-DD HH:mm"))+"\n                  ")])])}),0)],1):t._e()],1),t.availableSearchIndices.length?t._e():s("div",{staticClass:"card-content"},[s("p",{staticStyle:{color:"#777","font-weight":"bold"}},[t._v("No timelines available")])])])])]):t._e()])},le=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Add Timelines")])])}],ue={components:{TsTimelineList:qt,TsUploadTimelineForm:oe},props:["hideNavigation"],data:function(){return{availableSearchIndices:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},count:function(){return this.$store.state.count}},methods:{addTimelineToSketch:function(t){var e=this;E.createSketchTimeline(this.sketch.id,t.id).then(function(s){var a=e.availableSearchIndices.indexOf(t);e.availableSearchIndices.splice(a,1),e.$store.dispatch("updateSketch",e.sketch.id)}).catch(function(t){console.error(t)})},makeTimelineAvailable:function(t){"ready"===t.searchindex.status[0].status&&this.availableSearchIndices.unshift(t.searchindex)}},created:function(){var t=this;E.getSearchIndexList().then(function(e){var s=e.data.objects[0],a=t.$store.state.sketch.timelines.map(function(t){return t.searchindex.index_name});s.forEach(function(t){a.includes(t.index_name)||"ready"===t.status[0].status&&this.push(t)},t.availableSearchIndices)}).catch(function(t){console.error(t)})}},de=ue,he=(s("e49a"),Object(c["a"])(de,ce,le,!1,null,null,null)),me=he.exports,pe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{on:{submit:function(t){t.preventDefault()}}},[s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("b-radio",{attrs:{type:"is-info",name:"name","native-value":"false"},model:{value:t.isPublic,callback:function(e){t.isPublic=e},expression:"isPublic"}},[s("i",{staticClass:"fa fa-lock",staticStyle:{"margin-left":"10px","margin-right":"5px"}}),t._v("\n        Private - Only you and selected users/groups can access this sketch\n      ")]),s("br"),s("b-radio",{attrs:{type:"is-info",name:"name","native-value":"true"},model:{value:t.isPublic,callback:function(e){t.isPublic=e},expression:"isPublic"}},[s("i",{staticClass:"fa fa-globe",staticStyle:{"margin-left":"10px","margin-right":"5px"}}),t._v("\n        Public -  All users of the system can access this sketch\n      ")]),s("hr"),t.currentUsers.length||t.currentGroups.length?s("div",[t._v("\n        Who has access\n        "),s("br"),s("br"),s("table",{staticClass:"table is-hoverable"},[t._l(t.currentUsers,function(e,a){return s("tr",[s("td",[t._v(t._s(e))]),s("td",{staticStyle:{cursor:"pointer"},attrs:{width:"10px"},on:{click:function(s){return t.removeUser(e,a)}}},[s("i",{staticClass:"fa fa-trash"})])])}),t._l(t.currentGroups,function(e,a){return s("tr",[s("td",[t._v(t._s(e))]),s("td",{staticStyle:{cursor:"pointer"},attrs:{width:"10px"},on:{click:function(s){return t.removeGroup(e,a)}}},[s("i",{staticClass:"fa fa-trash"})])])})],2),s("br"),s("br")]):t._e(),t.usersToRemove.length||t.groupsToRemove.length?s("b-notification",{attrs:{type:"is-warning",role:"alert",closable:!1}},[t._v("\n        You have made changes that you need to save\n      ")]):t._e(),s("b-field",{attrs:{label:"Share with user"}},[s("b-autocomplete",{attrs:{"clear-on-select":"",data:t.filteredUserArray,placeholder:"Username ..",icon:"magnify"},on:{select:t.addUser},model:{value:t.userNameInput,callback:function(e){t.userNameInput=e},expression:"userNameInput"}},[s("template",{slot:"empty"},[t._v("No user found")])],2)],1)],1)]),s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("b-field",{attrs:{label:"Share with group"}},[s("b-autocomplete",{attrs:{"clear-on-select":"","open-on-focus":"",data:t.filteredGroupArray,placeholder:"Group name ..",icon:"magnify"},on:{select:t.addGroup},model:{value:t.groupNameInput,callback:function(e){t.groupNameInput=e},expression:"groupNameInput"}},[s("template",{slot:"empty"},[t._v("No group found")])],2)],1)],1)]),t.usersToAdd.length||t.groupsToAdd.length?s("div",[s("br"),s("strong",[t._v("Users/Groups to add")]),s("br"),s("br"),s("b-field",{attrs:{grouped:"","group-multiline":""}},[t._l(t.usersToAdd,function(e,a){return s("div",{key:e.name,staticClass:"control"},[s("b-tag",{attrs:{attached:"",closable:"","aria-close-label":"Close tag",size:"is-medium"},on:{close:function(e){return t.usersToAdd.splice(a,1)}}},[t._v(t._s(e))])],1)}),t._l(t.groupsToAdd,function(e,a){return s("div",{key:e.name,staticClass:"control"},[s("b-tag",{attrs:{attached:"",closable:"","aria-close-label":"Close tag",size:"is-medium"},on:{close:function(e){return t.groupsToAdd.splice(a,1)}}},[t._v(t._s(e))])],1)})],2)],1):t._e(),s("br"),s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("button",{staticClass:"button is-info",on:{click:t.submitForm}},[t._v("Save changes")])])])])},ve=[],fe=(s("6b54"),{data:function(){return{isPublic:!1,systemUsers:[],systemGroups:[],usersToAdd:[],groupsToAdd:[],usersToRemove:[],groupsToRemove:[],userNameInput:"",groupNameInput:""}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},currentUsers:function(){var t=this;return this.meta.collaborators.users.filter(function(e){return!t.usersToRemove.includes(e)})},currentGroups:function(){var t=this;return this.meta.collaborators.groups.filter(function(e){return!t.groupsToRemove.includes(e)})},filteredUserArray:function(){var t=this;return this.systemUsers.filter(function(e){return e.toString().toLowerCase().indexOf(t.userNameInput.toLowerCase())>=0})},filteredGroupArray:function(){var t=this;return this.systemGroups.filter(function(e){return e.toString().toLowerCase().indexOf(t.groupNameInput.toLowerCase())>=0})}},methods:{addUser:function(t){t&&(this.usersToAdd.includes(t)||this.usersToAdd.push(t))},addGroup:function(t){this.groupsToAdd.includes(t)||this.groupsToAdd.push(t)},removeUser:function(t,e){this.usersToRemove.push(t)},removeGroup:function(t,e){this.groupsToRemove.push(t)},submitForm:function(){E.editCollaborators(this.sketch.id,this.isPublic,this.usersToAdd,this.groupsToAdd,this.usersToRemove,this.groupsToRemove).then(function(t){}).catch(function(t){}),this.$emit("closeShareModal")}},mounted:function(){var t=this;this.meta.permissions.public&&(this.isPublic=!0),E.getUsers().then(function(e){e.data.objects[0].forEach(function(e){t.systemUsers.push(e.username)})}).catch(function(t){}),E.getGroups().then(function(e){e.data.objects[0].forEach(function(e){t.systemGroups.push(e.name)})}).catch(function(t){})}}),ge=fe,_e=Object(c["a"])(ge,pe,ve,!1,null,null,null),Ce=_e.exports,ye={components:{TsSketchMetrics:ut,TsSketchSummary:it,TsTimelineList:qt,TsSavedViewList:Jt,TsUploadTimelineForm:oe,TsSketchStoryList:ee,TsSketchTimelinesManage:me,TsShareForm:Ce},data:function(){return{showUploadTimelineModal:!1,showDeleteSketchModal:!1,showShareModal:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},count:function(){return this.$store.state.count},shareTooltip:function(){var t="",e="Shared with ";return this.meta.collaborators.users.length&&(t=e+this.meta.collaborators.users.length+" users",this.meta.collaborators.groups.length&&(t=t+" and "+this.meta.collaborators.groups.length+" groups")),!t&&this.meta.collaborators.groups.length&&(t=e+this.meta.collaborators.groups.length+" groups"),t}},methods:{deleteSketch:function(){var t=this;E.deleteSketch(this.sketch.id).then(function(e){t.$router.push({name:"Home"})}).catch(function(t){console.error(t)})},archiveSketch:function(){var t=this;E.archiveSketch(this.sketch.id).then(function(e){t.$store.dispatch("updateSketch",t.sketch.id),t.$router.push({name:"SketchOverview",params:{sketchId:t.sketch.id}})}).catch(function(t){console.error(t)})},unArchiveSketch:function(){var t=this;E.unArchiveSketch(this.sketch.id).then(function(e){t.$store.dispatch("updateSketch",t.sketch.id),t.$router.push({name:"SketchOverview",params:{sketchId:t.sketch.id}})}).catch(function(t){console.error(t)})},exportSketch:function(){var t=this;E.exportSketch(this.sketch.id).then(function(e){var s=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a"),i="sketch-"+t.sketch.id+"-export.zip";a.href=s,a.setAttribute("download",i),document.body.appendChild(a),a.click()}).catch(function(t){console.error(t)})},sortedUserList:function(){var t=Object(X["a"])(this.$store.state.meta.collaborators.users);return t.sort()},sortedGroupList:function(){var t=Object(X["a"])(this.$store.state.meta.collaborators.groups);return t.sort()},closeShareModal:function(){this.showShareModal=!1,this.$buefy.snackbar.open({duration:3500,message:"Sharing settings have been saved",type:"is-white",position:"is-top",queue:!1}),this.$store.dispatch("updateSketch",this.sketch.id)}}},be=ye,ke=(s("d147"),Object(c["a"])(be,W,K,!1,null,null,null)),Se=ke.exports,we=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("router-view")},xe=[],Te={},Ee=Object(c["a"])(Te,we,xe,!1,null,null,null),$e=Ee.exports,Ae=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:""}})],1)]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card",staticStyle:{"min-height":"160px"}},[t._m(0),s("div",{staticClass:"card-content"},[s("ts-view-list",{attrs:{views:t.meta.views,controls:!0}})],1)])])])])},De=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Manage Saved Views")])])}],Fe={components:{TsViewList:Jt},computed:{meta:function(){return this.$store.state.meta}}},Me=Fe,Ne=Object(c["a"])(Me,Ae,De,!1,null,null,null),Oe=Ne.exports,Ie=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"explore"}})],1)]),s("b-modal",{attrs:{active:t.showCreateViewModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showCreateViewModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Create new view")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("ts-create-view-form",{attrs:{sketchId:t.sketchId,currentQueryString:t.currentQueryString,currentQueryFilter:t.currentQueryFilter},on:{toggleCreateViewModal:t.toggleCreateViewModal}})],1)])])]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header",staticStyle:{cursor:"pointer"},on:{click:function(e){t.showSearch=!t.showSearch}}},[t._m(0),s("a",{staticClass:"button is-rounded is-small",staticStyle:{"margin-top":"10px"},on:{click:function(e){t.showCreateViewModal=!t.showCreateViewModal}}},[t._m(1),s("span",[t._v("Save as view")])]),s("span",{staticClass:"card-header-icon"},[s("span",{staticClass:"icon"},[t.showSearch?t._e():s("i",{staticClass:"fas fa-angle-down",attrs:{"aria-hidden":"true"}}),t.showSearch?s("i",{staticClass:"fas fa-angle-up",attrs:{"aria-hidden":"true"}}):t._e()])])]),t.showSearch?s("div",{staticClass:"card-content"},[s("form",{staticStyle:{width:"100%"},on:{submit:function(e){return e.preventDefault(),t.search(e)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currentQueryString,expression:"currentQueryString"}],staticClass:"ts-search-input",attrs:{type:"text",placeholder:"Search",autofocus:""},domProps:{value:t.currentQueryString},on:{input:function(e){e.target.composing||(t.currentQueryString=e.target.value)}}})]),s("div",{staticClass:"field is-grouped",staticStyle:{"margin-top":"15px","margin-bottom":"25px"}},[s("p",{staticClass:"control"},[s("ts-view-list-dropdown",{attrs:{"is-rounded":"true"},on:{setActiveView:t.searchView}})],1),s("p",{staticClass:"control"},[s("b-dropdown",{attrs:{"trap-focus":"","aria-role":"menu"}},[s("a",{staticClass:"button is-text",attrs:{slot:"trigger",role:"button"},slot:"trigger"},[s("span",[t._v("+ Time range")])]),s("b-dropdown-item",{staticStyle:{"min-width":"500px",padding:"30px"},attrs:{custom:"",focusable:!1}},[s("strong",[t._v("Add time range")]),s("br"),s("br"),s("ts-explore-filter-time",{on:{addChip:function(e){return t.addChip(e)}}})],1)],1)],1),s("p",{staticClass:"control"},[s("b-dropdown",{attrs:{"trap-focus":"","aria-role":"menu"}},[s("a",{staticClass:"button is-text",attrs:{slot:"trigger",role:"button"},slot:"trigger"},[s("span",[t._v("+ Filter")])]),s("b-dropdown-item",{staticStyle:{"min-width":"500px",padding:"30px"},attrs:{custom:"",focusable:!1}},[s("strong",[t._v("Add filter")]),s("br"),s("br"),s("b-switch",{attrs:{type:"is-info"},on:{input:function(e){return t.toggleLabelChip("__ts_star")}},model:{value:t.activeStarFilter,callback:function(e){t.activeStarFilter=e},expression:"activeStarFilter"}},[s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-star",staticStyle:{color:"#ffe300","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"silver"}})]),t._v("Show only starred events\n                  ")])],1)],1)],1)]),s("div",{staticClass:"tags",staticStyle:{"margin-bottom":"5px"}},t._l(t.currentQueryFilter.chips,function(e,a){return s("span",{key:a},["datetime_range"===e.type?s("span",{staticClass:"tag is-light is-rounded",staticStyle:{"margin-right":"7px"}},[t._m(2,!0),s("span",[t._v(t._s(e.value.split(",")[0]))]),e.value.split(",")[0]!==e.value.split(",")[1]?s("span",[t._v("â†’ "+t._s(e.value.split(",")[1]))]):t._e(),s("button",{staticClass:"delete is-small",staticStyle:{"margin-left":"7px"},on:{click:function(e){return t.removeChip(a)}}})]):t._e()])}),0),s("div",{staticClass:"tags"},t._l(t.currentQueryFilter.chips,function(e,a){return s("span",{key:a},["datetime_range"!==e.type?s("span",{staticClass:"tag is-light is-rounded",staticStyle:{"margin-right":"7px"}},["__ts_star"===e.value?s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"7px"}},[s("i",{staticClass:"fas fa-star",staticStyle:{color:"#ffe300","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"silver"}})]):"label"===e.type?s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"7px"}},[s("i",{staticClass:"fas fa-tag"})]):t._e(),s("span",{staticStyle:{"margin-right":"7px"}},[t._v(t._s(t._f("filterChip")(e)))]),s("button",{staticClass:"delete is-small",staticStyle:{"margin-left":"7px"},on:{click:function(e){return t.removeChip(a)}}})]):t._e()])}),0),t.sketch.active_timelines?s("ts-explore-timeline-picker",{attrs:{"current-query-filter":t.currentQueryFilter,"count-per-index":t.eventList.meta.count_per_index},on:{updateQueryFilter:function(e){return t.updateQueryFilter(e)}}}):t._e()],1):t._e()])])]),s("ts-sketch-explore-aggregation",{attrs:{"show-aggregations":t.showAggregations}}),s("section",{directives:[{name:"show",rawName:"v-show",value:t.contextEvent,expression:"contextEvent"}],staticClass:"section",attrs:{id:"context"}},[s("div",{staticClass:"container is-fluid"},[s("b-message",{attrs:{type:"is-warning","aria-close-label":"Close message"}},[s("strong",[t._v("Context query")]),s("br"),s("br"),s("div",{staticClass:"buttons"},[s("button",{staticClass:"button",on:{click:t.removeContext}},[t._v("â† Go back to original query")]),s("button",{staticClass:"button",on:{click:t.scrollToContextEvent}},[t._v("Help me find my event")])])])],1)]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content"},[s("nav",{staticClass:"level"},[s("div",{staticClass:"level-left"},[s("div",{staticClass:"level-item"},[t.toEvent&&!t.searchInProgress?s("span",[t._v(t._s(t.fromEvent)+"-"+t._s(t.toEvent)+" of "+t._s(t.totalHits)+" events ("+t._s(t.totalTime)+"s)")]):t._e()]),s("div",{staticClass:"level-item"},[t.toEvent||t.searchInProgress?t._e():s("span",[t._v(t._s(t.totalHits)+" events ("+t._s(t.totalTime)+"s)")])]),t.numSelectedEvents?s("div",{staticClass:"level-item",staticStyle:{"margin-right":"50px"}},[s("button",{staticClass:"button is-small is-outlined",staticStyle:{"border-radius":"4px"},on:{click:t.toggleStar}},[t._m(3),s("span",[t._v("Toggle star ("+t._s(t.numSelectedEvents)+")")])])]):t._e()]),s("div",{staticClass:"level-right"},[s("div",{staticClass:"level-item"},[t.eventList.objects.length?s("div",[s("b-pagination",{attrs:{total:t.totalHitsForPagination,"per-page":t.currentQueryFilter.size,current:t.currentPage,simple:!0,size:"is-small","icon-pack":"fas","icon-prev":"chevron-left","icon-next":"chevron-right"},on:{change:function(e){return t.paginate(e)},"update:current":function(e){t.currentPage=e}}})],1):t._e()]),s("div",{staticClass:"level-item"},[t.eventList.objects.length?s("div",{staticClass:"select is-small"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.currentQueryFilter.size,expression:"currentQueryFilter.size"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.currentQueryFilter,"size",e.target.multiple?s:s[0])},t.search]}},[s("option",{domProps:{value:t.currentQueryFilter.size}},[t._v(t._s(t.currentQueryFilter.size))]),s("option",{attrs:{value:"10"}},[t._v("10")]),s("option",{attrs:{value:"20"}},[t._v("20")]),s("option",{attrs:{value:"40"}},[t._v("40")]),s("option",{attrs:{value:"80"}},[t._v("80")]),s("option",{attrs:{value:"100"}},[t._v("100")]),s("option",{attrs:{value:"200"}},[t._v("200")]),s("option",{attrs:{value:"500"}},[t._v("500")])])]):t._e()]),s("div",{staticClass:"level-item"},[t.eventList.objects.length?s("div",{staticClass:"select is-small"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.currentQueryFilter.order,expression:"currentQueryFilter.order"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.currentQueryFilter,"order",e.target.multiple?s:s[0])},t.search]}},[s("option",{attrs:{value:"desc"}},[t._v("desc")]),s("option",{attrs:{value:"asc"}},[t._v("asc")])])]):t._e()]),s("div",{staticClass:"level-item"},[t.eventList.objects.length?s("div",[s("b-dropdown",{attrs:{position:"is-bottom-left","aria-role":"menu","trap-focus":"","can-close":!0}},[s("button",{staticClass:"button is-outlined is-small",staticStyle:{"border-radius":"4px"},attrs:{slot:"trigger"},slot:"trigger"},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-table"})]),s("span",[t._v("Fields ("+t._s(t.selectedFields.length)+")")])]),s("b-dropdown-item",{attrs:{"aria-role":"menu-item",focusable:!1,custom:""}},[s("div",{class:{tsdropdown:t.expandFieldDropdown},staticStyle:{width:"300px"}},[t.meta.mappings?s("multiselect",{staticStyle:{display:"block"},attrs:{options:t.meta.mappings,value:t.selectedFieldsProxy,multiple:!0,searchable:!0,"close-on-select":!1,label:"field","track-by":"field",placeholder:"Add more fields ..."},on:{open:function(e){t.expandFieldDropdown=!0},close:function(e){t.expandFieldDropdown=!1},input:t.updateSelectedFields}}):t._e()],1)]),s("b-dropdown-item",{attrs:{"aria-role":"menu-item",focusable:!1,custom:""}},[t.selectedFields.length?s("span",[s("br"),s("strong",[t._v("Selected fields")]),s("br"),s("br")]):t._e(),s("div",{staticClass:"tags"},t._l(t.selectedFields,function(e,a){return s("span",{key:a},[s("span",{staticClass:"tag is-light is-rounded",staticStyle:{"margin-right":"7px"}},[s("span",{staticStyle:{"margin-right":"7px"}},[t._v(t._s(e.field))]),s("button",{staticClass:"delete is-small",staticStyle:{"margin-left":"7px"},on:{click:function(e){return t.removeField(a)}}})])])}),0),s("hr"),s("b-switch",{attrs:{type:"is-info"},model:{value:t.displayOptions.showTags,callback:function(e){t.$set(t.displayOptions,"showTags",e)},expression:"displayOptions.showTags"}},[s("span",[t._v("Show tags")])]),s("br"),s("b-switch",{attrs:{type:"is-info"},model:{value:t.displayOptions.showEmojis,callback:function(e){t.$set(t.displayOptions,"showEmojis",e)},expression:"displayOptions.showEmojis"}},[s("span",[t._v("Show emojis")])])],1)],1)],1):t._e()]),s("div",{staticClass:"level-item"},[t.eventList.objects.length?s("button",{staticClass:"button is-small",staticStyle:{"border-radius":"4px"},on:{click:t.exportSearchResult}},[t._m(4),s("span",[t._v("Export to CSV")])]):t._e()])])]),t.searchInProgress?s("div",[t._m(5),t._v(" Searching..")]):t._e(),t.totalHits>0?s("div",{staticStyle:{"margin-top":"20px"}}):t._e(),t.eventList.objects.length?s("ts-sketch-explore-event-list",{attrs:{"event-list":t.eventList.objects,order:t.currentQueryFilter.order,"selected-fields":t.selectedFields,"display-options":t.displayOptions},on:{addChip:function(e){return t.addChip(e)},searchContext:function(e){return t.searchContext(e)}}}):t._e(),t.eventList.objects.length?s("div",{staticStyle:{float:"right"}},[s("b-pagination",{attrs:{total:t.totalHitsForPagination,"per-page":t.currentQueryFilter.size,current:t.currentPage,simple:!0,size:"is-small","icon-pack":"fas","icon-prev":"chevron-left","icon-next":"chevron-right"},on:{change:function(e){return t.paginate(e)},"update:current":function(e){t.currentPage=e}}})],1):t._e(),s("br")],1)]),s("br")])])],1)},Pe=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"card-header-title"},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-search"})]),s("span",{staticStyle:{"margin-left":"10px"}},[t._v("Search")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-save"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"7px"}},[s("i",{staticClass:"fas fa-clock"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-star"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[s("i",{staticClass:"fas fa-file-export"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-circle-notch fa-pulse"})])}],je=s("f499"),Le=s.n(je),Qe=s("a4bb"),Re=s.n(Qe),ze=s("e814"),Ve=s.n(ze),qe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dropdown",class:{"is-active":t.viewListDropdownActive}},[s("div",{staticClass:"dropdown-trigger"},[s("a",{staticClass:"button",class:{"is-rounded":t.isRounded},attrs:{"aria-haspopup":"true","aria-controls":"dropdown-menu"},on:{click:function(e){t.viewListDropdownActive=!t.viewListDropdownActive}}},[s("span",[t._v(t._s(t.title||"Views"))]),t._m(0)])]),s("div",{staticClass:"dropdown-menu",attrs:{id:"dropdown-menu",role:"menu"}},[s("div",{staticClass:"dropdown-content"},[t.meta.views&&t.meta.views.length<1?s("span",{staticClass:"dropdown-item"},[t._v("No saved views")]):t._e(),t._l(t.meta.views,function(e){return s("a",{key:e.id,staticClass:"dropdown-item",on:{click:function(s){return t.setActiveView(e)}}},[s("span",[t._v(t._s(e.name))])])})],2)])])},Ue=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-angle-down",attrs:{"aria-hidden":"true"}})])}],He={props:["isRounded","title"],data:function(){return{viewListDropdownActive:!1}},methods:{setActiveView:function(t){this.$emit("setActiveView",t),this.viewListDropdownActive=!1}},computed:{meta:function(){return this.$store.state.meta}}},Ye=He,Ge=Object(c["a"])(Ye,qe,Ue,!1,null,"530f703c",null),Be=Ge.exports,Je=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm(e)}}},[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Name")]),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.viewName,expression:"viewName"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Name your view",autofocus:""},domProps:{value:t.viewName},on:{input:function(e){e.target.composing||(t.viewName=e.target.value)}}})])]),s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save"},on:{click:t.toggleCreateViewModal}})])])])},We=[],Ke={props:["sketchId","currentQueryString","currentQueryFilter"],data:function(){return{viewName:""}},methods:{clearFormData:function(){this.viewName=""},submitForm:function(){var t=this;E.createView(this.sketchId,this.viewName,this.currentQueryString,this.currentQueryFilter).then(function(e){var s=e.data.objects[0];t.$store.state.meta.views.push(s),t.clearFormData(),t.$router.push({name:"SketchExplore",query:{view:s.id}})}).catch(function(t){})},toggleCreateViewModal:function(){this.$emit("toggleCreateViewModal")}}},Xe=Ke,Ze=Object(c["a"])(Xe,Je,We,!1,null,null,null),ts=Ze.exports,es=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",{staticClass:"table is-fullwidth"},[s("thead",[s("th",{attrs:{width:"220"}}),s("th",{attrs:{width:"1"}},[s("span",{staticClass:"control"},[s("input",{attrs:{type:"checkbox"},on:{click:t.toggleSelectAll}})])]),t._l(t.selectedFields,function(e,a){return s("th",{key:a},[t._v(t._s(e.field))])}),s("th",{attrs:{width:"150"}},[t._v("Timeline name")])],2),t._l(t.eventList,function(e,a){return s("ts-sketch-explore-event-list-row",{key:a,attrs:{event:e,prevEvent:t.eventList[a-1],order:t.order,"selected-fields":t.selectedFields,"display-options":t.displayOptions,"display-controls":!0,id:e._id},on:{addChip:function(e){return t.$emit("addChip",e)},searchContext:function(e){return t.$emit("searchContext",e)}}})})],2)},ss=[],as=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tbody",[t.deltaDays>0?s("tr",[s("td",{staticStyle:{padding:"0"},attrs:{colspan:"5"}},[s("div",{staticClass:"ts-time-bubble-vertical-line"}),s("div",{staticClass:"ts-time-bubble"},[s("h5",[s("b",[t._v(t._s(t.deltaDays))]),s("br"),t._v("days")])]),s("div",{staticClass:"ts-time-bubble-vertical-line"})])]):t._e(),s("tr",{staticClass:"ts-shadow-on-hover"},[s("td",{style:t.timelineColor},[t._v("\n        "+t._s(t._f("moment")(t.event._source.datetime,"utc","YYYY-MM-DDTHH:mm:ss.SSSSSS"))+"\n      ")]),s("td",[s("div",{staticClass:"field is-grouped"},[t.displayControls?s("span",{staticClass:"control"},[s("input",{attrs:{type:"checkbox"},domProps:{checked:t.isSelected},on:{click:t.toggleSelect}})]):t._e(),s("span",{staticClass:"icon control",staticStyle:{"margin-right":"3px",cursor:"pointer"},on:{click:t.toggleStar}},[t.isStarred?s("i",{staticClass:"fas fa-star",staticStyle:{color:"#ffe300","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"#d1d1d1"}}):t._e(),t.isStarred?t._e():s("i",{staticClass:"fas fa-star",staticStyle:{color:"#d3d3d3"}})]),t.displayControls?s("span",{staticClass:"icon control",staticStyle:{cursor:"pointer"},on:{click:t.searchContext}},[s("i",{staticClass:"fas fa-search",staticStyle:{color:"#d3d3d3"}})]):t._e()])]),t._l(t.selectedFields,function(e,a){return s("td",{key:a,staticStyle:{cursor:"pointer","max-width":"50ch"},style:t.fieldColumnColor,on:{click:function(e){t.showDetail=!t.showDetail}}},[s("span",{class:{"ts-event-field-container":1===t.selectedFields.length}},[s("span",{class:{"ts-event-field-ellipsis":1===t.selectedFields.length}},[0===a?s("span",[t._l(t.event._source.__ts_emojis,function(e){return t.displayOptions.showEmojis?s("span",{key:e,attrs:{title:t.meta.emojis[e]},domProps:{innerHTML:t._s(e)}},[t._v(t._s(e))]):t._e()}),s("span",{staticStyle:{"margin-left":"10px"}}),t._l(t.event._source.tag,function(e){return t.displayOptions.showTags?s("span",{key:e,staticClass:"tag is-rounded",staticStyle:{"margin-right":"5px",background:"#d1d1d1"}},[t._v(t._s(e))]):t._e()})],2):t._e(),s("span",{staticStyle:{"word-break":"break-word"},attrs:{title:t.event._source[e.field]}},[t._v("\n              "+t._s(t.event._source[e.field])+"\n            ")])])])])}),s("td",{staticClass:"ts-timeline-name-column"},[s("span",[t._v("\n          "+t._s(t.timelineName)+"\n        ")])])],2),t.comments.length?s("tr",[s("td",{attrs:{colspan:"5"}},[s("div",{staticStyle:{"max-width":"600px",border:"1px solid #f5f5f5","border-radius":"4px",padding:"10px","margin-bottom":"20px"}},t._l(t.comments,function(e){return s("article",{key:e.created_at,staticClass:"media"},[t._m(0,!0),s("div",{staticClass:"media-content"},[s("div",{staticClass:"content"},[s("p",[s("strong",[t._v(t._s(e.user.username))]),s("small",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t._f("moment")(e.created_at,"ll")))]),s("br"),t._v("\n                  "+t._s(e.comment)+"\n                ")])])])])}),0)])]):t._e(),s("tr",[s("td",{staticStyle:{padding:"0"},attrs:{colspan:"5"}},[t.showDetail?s("div",{staticStyle:{"padding-top":"20px","padding-bottom":"20px"}},[s("div",{staticClass:"field",staticStyle:{"max-width":"50%"}},[s("p",{staticClass:"control"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"textarea",attrs:{required:"",autofocus:"",rows:"1",placeholder:"Add a comment ..."},domProps:{value:t.comment},on:{input:function(e){e.target.composing||(t.comment=e.target.value)}}})])]),s("div",{staticClass:"field"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button",on:{click:function(e){return t.postComment(t.comment)}}},[t._v("Post comment")])])]),s("ts-sketch-explore-event-list-row-detail",{attrs:{event:t.event},on:{addChip:function(e){return t.$emit("addChip",e)}}})],1):t._e()])])])},is=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("figure",{staticClass:"media-left"},[s("div",{staticClass:"ts-avatar-circle"})])}],ns=(s("7514"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",{staticClass:"table is-bordered",staticStyle:{width:"100%","table-layout":"fixed"}},[s("tbody",t._l(t.fullEventFiltered,function(e,a){return s("tr",{key:a},[s("td",{staticStyle:{"white-space":"pre-wrap","word-wrap":"break-word",width:"150px"}},[t._v(t._s(a))]),s("td",[s("span",{staticStyle:{"white-space":"pre-wrap","word-wrap":"break-word"}},[t._v(t._s(e))])]),s("td",{staticStyle:{width:"40px"}},[s("span",{staticClass:"icon is-small",staticStyle:{cursor:"pointer"},on:{click:function(s){return t.addFilter(a,e,"must")}}},[s("i",{staticClass:"fas fa-search-plus"})])]),s("td",{staticStyle:{width:"40px"}},[s("span",{staticClass:"icon is-small",staticStyle:{cursor:"pointer"},on:{click:function(s){return t.addFilter(a,e,"must_not")}}},[s("i",{staticClass:"fas fa-search-minus"})])])])}),0)])}),rs=[],os=s("03cc"),cs=s.n(os),ls={props:["event"],data:function(){return{fullEvent:{}}},computed:{sketch:function(){return this.$store.state.sketch},fullEventFiltered:function(){var t=this;return cs()(this.fullEvent).forEach(function(e){e.startsWith("__ts")&&delete t.fullEvent[e]}),this.fullEvent}},methods:{getEvent:function(){var t=this,e=this.event._index,s=this.event._id;E.getEvent(this.sketch.id,e,s).then(function(e){t.fullEvent=e.data.objects}).catch(function(t){})},addFilter:function(t,e,s){var a={field:t,value:e,type:"term",operator:s};this.$emit("addChip",a)}},created:function(){this.getEvent()}},us=ls,ds=Object(c["a"])(us,ns,rs,!1,null,null,null),hs=ds.exports,ms={components:{TsSketchExploreEventListRowDetail:hs},props:["event","prevEvent","order","selectedFields","isRemoteSelected","displayOptions","displayControls"],data:function(){return{showDetail:!1,isStarred:!1,isSelected:!1,comment:"",comments:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},timelineColor:function(){var t=this.timeline(this.event._index).color;return t.startsWith("#")||(t="#"+t),{"background-color":t}},fieldColumnColor:function(){var t="#f5f5f5";return this.isStarred&&(t="#fff4b3"),this.isSelected&&(t="#c3ecff"),{"background-color":t}},timelineName:function(){return this.timeline(this.event._index).name},deltaDays:function(){if(!this.prevEvent)return 0;var t=Math.floor(this.event._source.timestamp/1e6),e=Math.floor(this.prevEvent._source.timestamp/1e6),s=Math.floor(t-e);"desc"===this.order&&(s=Math.floor(e-t));var a=s/60/60/24;return Math.floor(a)},eventDataSparse:function(){var t={};return t["_index"]=this.event._index,t["_id"]=this.event._id,t["_type"]=this.event._type,t["isSelected"]=this.isSelected,t}},methods:{timeline:function(t){return this.sketch.timelines.find(function(e){return e.searchindex.index_name===t})},toggleStar:function(){this.isStarred=!this.isStarred,E.saveEventAnnotation(this.sketch.id,"label","__ts_star",this.event).then(function(t){}).catch(function(t){console.error(t)})},toggleStarOnSelect:function(){this.isSelected&&(this.isStarred=!this.isStarred)},postComment:function(t){var e=this;E.saveEventAnnotation(this.sketch.id,"comment",t,[this.event]).then(function(t){e.comments.push(t.data.objects[0][0]),e.comment=""}).catch(function(t){})},searchContext:function(){this.$emit("searchContext",this.event)},selectEvent:function(){this.isSelected=!0,qi.$emit("eventSelected",this.eventDataSparse)},unSelectEvent:function(){this.isSelected=!1,qi.$emit("eventSelected",this.eventDataSparse)},toggleSelect:function(){this.isSelected?this.unSelectEvent():this.selectEvent()}},beforeDestroy:function(){qi.$off("selectEvent",this.selectEvent),qi.$off("clearSelectedEvents",this.unSelectEvent),qi.$off("toggleStar",this.toggleStarOnSelect)},created:function(){var t=this;if(qi.$on("selectEvent",this.selectEvent),qi.$on("clearSelectedEvents",this.unSelectEvent),qi.$on("toggleStar",this.toggleStarOnSelect),this.event._source.label.indexOf("__ts_star")>-1&&(this.isStarred=!0),this.event._source.label.indexOf("__ts_comment")>-1){var e=this.event._index,s=this.event._id;E.getEvent(this.sketch.id,e,s).then(function(e){t.comments=e.data.meta.comments}).catch(function(t){})}}},ps=ms,vs=(s("1ba8"),Object(c["a"])(ps,as,is,!1,null,"b69146c2",null)),fs=vs.exports,gs={components:{TsSketchExploreEventListRow:fs},props:["eventList","order","selectedFields","displayOptions"],data:function(){return{selectAll:!1}},methods:{toggleSelectAll:function(){this.selectAll?(qi.$emit("clearSelectedEvents"),this.selectAll=!1):(qi.$emit("selectEvent"),this.selectAll=!0)}}},_s=gs,Cs=(s("c45b"),Object(c["a"])(_s,es,ss,!1,null,"2d6dafee",null)),ys=Cs.exports,bs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._l(t.sketch.active_timelines,function(e){return s("span",{key:e.id,staticClass:"tag is-medium",staticStyle:{cursor:"pointer","margin-right":"7px","margin-bottom":"7px"},style:t.timelineColor(e),on:{click:function(s){return t.toggleIndex(e.searchindex.index_name)}}},[t._v("\n    "+t._s(e.name)+" "),t.indexIsEnabled(e.searchindex.index_name)&&t.countPerIndex?s("span",{staticClass:"tag is-small",staticStyle:{"margin-left":"10px","margin-right":"-7px","background-color":"rgba(255,255,255,0.5)"}},[t._v(t._s(t.countPerIndex[e.searchindex.index_name]||"0"))]):t._e()])}),t.sketch.active_timelines.length>3?s("div",{staticStyle:{"margin-top":"7px"}},[s("span",{staticStyle:{"text-decoration":"underline",cursor:"pointer","margin-right":"10px"},on:{click:t.enableAllIndices}},[t._v("Enable all")]),s("span",{staticStyle:{"text-decoration":"underline",cursor:"pointer"},on:{click:t.disableAllIndices}},[t._v("Disable all")])]):t._e()],2)},ks=[],Ss={props:["currentQueryFilter","countPerIndex"],computed:{sketch:function(){return this.$store.state.sketch}},methods:{timelineColor:function(t){var e=t.searchindex.index_name,s=t.color;return s.startsWith("#")||(s="#"+s),this.currentQueryFilter.indices.includes(e)||(s="#f5f5f5"),{"background-color":s}},toggleIndex:function(t){var e=this.currentQueryFilter.indices.slice(),s=e.indexOf(t);-1===s?e.push(t):e.splice(s,1),this.currentQueryFilter.indices=e,this.$emit("updateQueryFilter",this.currentQueryFilter)},enableAllIndices:function(){var t=[];this.sketch.active_timelines.forEach(function(e){t.push(e.searchindex.index_name)}),this.currentQueryFilter.indices=t,this.$emit("updateQueryFilter",this.currentQueryFilter)},disableAllIndices:function(){this.currentQueryFilter.indices=[],this.$emit("updateQueryFilter",this.currentQueryFilter)},indexIsEnabled:function(t){return this.currentQueryFilter.indices.includes(t)}},created:function(){if(this.currentQueryFilter.indices.includes("_all")){var t=[];this.sketch.active_timelines.forEach(function(e){t.push(e.searchindex.index_name)}),this.currentQueryFilter.indices=t}}},ws=Ss,xs=Object(c["a"])(ws,bs,ks,!1,null,null,null),Ts=xs.exports,Es=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"field is-horizontal"},[s("div",{staticClass:"field-body"},[s("div",{staticClass:"field"},[s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.startDateTime,expression:"startDateTime"}],staticClass:"input",attrs:{type:"text",placeholder:"2019-07-07T10:00:01"},domProps:{value:t.startDateTime},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.formatDateTime(e)},input:function(e){e.target.composing||(t.startDateTime=e.target.value)}}})])]),s("span",{staticStyle:{"margin-right":"10px","padding-top":"5px"}},[t._v("â†’")]),s("div",{staticClass:"field"},[s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.endDateTime,expression:"endDateTime"}],staticClass:"input",attrs:{type:"text",placeholder:"2019-07-07T10:00:01"},domProps:{value:t.endDateTime},on:{input:function(e){e.target.composing||(t.endDateTime=e.target.value)}}})])])])]),s("div",{staticClass:"field is-horizontal"},[s("div",{staticClass:"field is-grouped"},[s("p",{staticClass:"control"},[s("a",{staticClass:"button is-light",attrs:{disabled:!t.startDateTime},on:{click:t.formatDateTime}},[t._m(0),s("span",[t._v("Format")])])]),s("p",{staticClass:"control"},[s("button",{staticClass:"button is-success is-outlined",attrs:{disabled:!(t.startDateTime&&t.endDateTime)},on:{click:t.submit}},[t._v("+ Add time range")])])])])])},$s=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-magic"})])}],As={data:function(){return{startDateTime:"",endDateTime:"",chip:null}},methods:{formatDateTime:function(){var t=this.startDateTime,e="",s="YYYY-MM-DDTHH:mm:ss";if(null!=t&&""!==t){var a=/(.*?)(-|\+|\+-|-\+)(\d+)(y|d|h|m|s|M|Q|w|ms)/g,i=a.exec(t);if(null!=i){var n=this.$moment.utc(i[1]),r=i[2],o=i[3],c=i[4]||"m";return"+"===r&&(this.startDateTime=n.format(s),this.endDateTime=n.add(o,c).format(s)),"-"===r&&(this.startDateTime=n.subtract(o,c).format(s),this.endDateTime=n.format(s)),void("-+"!==r&&"+-"!==r||(this.startDateTime=n.subtract(o,c).format(s),this.endDateTime=n.add(o,c).format(s)))}e||(e=t);var l=this.$moment.utc(t),u=this.$moment.utc(e);l.hour()||l.minute()||l.second()||(s="YYYY-MM-DD"),this.startDateTime=l.format(s),this.endDateTime=u.format(s)}},submit:function(){this.startDateTime&&this.endDateTime&&(this.chip={field:"",value:this.startDateTime+","+this.endDateTime,type:"datetime_range",operator:"must"},this.$emit("addChip",this.chip),this.startDateTime="",this.endDateTime="")}}},Ds=As,Fs=Object(c["a"])(Ds,Es,$s,!1,null,null,null),Ms=Fs.exports,Ns=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",["{}"===this.spec&&!0===this.showChart?s("div",[t._m(0),t._v(" Loading..")]):t._e(),t.isTruncated&&t.showChart?s("p",[t._v("Warning: only retrieved 100 sessions for each session type.")]):t._e(),s("ts-vega-lite-chart",{attrs:{vegaSpec:t.spec},on:{viewCreated:t.registerClickListener}}),s("div",{staticClass:"field"},[s("button",{staticClass:"button",attrs:{disabled:t.indices.length>1},on:{click:t.toggleChart}},[t._v(t._s(t.message))])]),t.showChart?s("div",{staticClass:"field"},[this.showTimeRange?t._e():s("p",[t._v("\n             Showing sessions within the last year of the timeline by default. "),s("u",[s("em",{on:{click:t.toggleTimeRange}},[t._v("Choose a different timeframe.")])])]),this.showTimeRange?s("div",{staticClass:"control"},[t._m(1),s("input",{staticClass:"input",attrs:{type:"text",name:"start_time_range_input",placeholder:"mm/dd/yyyy"},on:{change:t.updateTimeRange}}),t._m(2),s("input",{staticClass:"input",attrs:{type:"text",name:"end_time_range_input",placeholder:"mm/dd/yyyy"},on:{change:t.updateTimeRange}})]):t._e(),s("p",[t._v(t._s(t.timeRangeMessage))])]):t._e(),t.showChart?s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Type of Session:")]),s("div",{staticClass:"control"},[s("div",{staticClass:"select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedType,expression:"selectedType"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.selectedType=e.target.multiple?s:s[0]},t.selectSessionType]}},[s("option",{attrs:{disabled:"",value:""}},[t._v("Please select one")]),t._l(t.sessionTypes,function(e){return s("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])})],2)])])]):t._e(),t.selectedSessions.length>0?s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Session ID:")]),s("div",{staticClass:"control"},[s("div",{staticClass:"select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedID,expression:"selectedID"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.selectedID=e.target.multiple?s:s[0]},t.selectSessionID]}},[s("option",{attrs:{disabled:"",value:""}},[t._v("Please select one")]),t._l(t.selectedSessions,function(e){return s("option",{key:e.session_type+e.session_id,domProps:{value:e.session_id}},[t._v(t._s(e.session_id))])})],2)])])]):t._e()],1)},Os=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-circle-notch fa-pulse"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"label"},[s("em",[t._v("Start date:")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"label"},[s("em",[t._v("End date:")])])}],Is=s("0a0d"),Ps=s.n(Is),js=s("b6d0"),Ls=s.n(js),Qs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:t.vegaId}})},Rs=[],zs=s("7ad3"),Vs={props:["vegaSpec"],data:function(){return{vegaId:"vega-"+this._uid}},watch:{vegaSpec:function(t,e){Object(zs["a"])("#"+this.vegaId,JSON.parse(this.vegaSpec),{actions:!1})}}},qs=Vs,Us=Object(c["a"])(qs,Qs,Rs,!1,null,null,null),Hs=Us.exports,Ys={components:{TsVegaLiteChart:Hs},data:function(){return{processedSessions:[],message:"Show Session Chart",showChart:!1,showTimeRange:!1,selectedSessions:[],spec:"{}",sessionTypes:["all"],barSize:0,smallest_timestamp:0,selectedType:"",selectedID:"",sessions:[],startTimeRange:null,endTimeRange:null,timeRangeMessage:"",isTruncated:!1}},computed:{sketch:function(){return this.$store.state.sketch},indices:function(){return this.$store.state.currentQueryFilter.indices}},methods:{registerClickListener:function(t){var e=this.$store,s=this.sketch.id;t.addEventListener("click",function(t,a){var i=a.datum.session_type,n=a.datum.session_id;if(void 0!=i&&void 0!=n){var r="session_id."+i+":"+n;e.dispatch("updateCurrentQueryString",r),e.dispatch("search",s)}})},toggleChart:function(){var t=this;this.showChart=!this.showChart,this.showChart?(this.message="Hide Session Chart",0==this.sessions.length?E.getSessions(this.sketch.id,this.indices[0]).then(function(e){t.sessions=e.data,t.sessionTypes=t.sessionTypes.concat(Object(X["a"])(new Ls.a(t.sessions.map(function(t){return t.session_type})))),t.getVegaSpec()}).catch(function(t){}):this.getVegaSpec()):(this.message="Show Session Chart",this.selectedSessions=[],this.spec="{}",this.selectedType="",this.selectedID="",this.showTimeRange=!1,this.startTimeRange=Ps()()-31556952e3,this.endTimeRange=Ps()(),this.timeRangeMessage="")},toggleTimeRange:function(){this.showTimeRange=!this.showTimeRange},updateTimeRange:function(t){var e=/\d{1,2}\/\d{1,2}\/\d{4}/;e.test(t.target.value)?(this.timeRangeMessage="",this.selectedSessions=[],this.selectedType="",this.selectedID="","start_time_range_input"===t.target.name?this.startTimeRange=new Date(t.target.value).getTime():this.endTimeRange=new Date(t.target.value).getTime(),this.getVegaSpec()):this.timeRangeMessage="Please enter a valid date."},selectSessionType:function(t){var e=this;this.selectedID="";var s=JSON.parse(this.spec);"all"===this.selectedType?(this.selectedSessions=[],s["data"]["values"]=this.processedSessions):(this.selectedSessions=this.processedSessions.filter(function(t){return t["session_type"]===e.selectedType}),s["data"]["values"]=this.selectedSessions),s["vconcat"][1]["selection"]["brush"]["init"]["x"]=[this.smallest_timestamp,this.smallest_timestamp+50*this.barSize],this.spec=Le()(s)},selectSessionID:function(t){for(var e="",s=[],a=JSON.parse(Le()(this.selectedSessions)),i=0;i<a.length;i++){var n=a[i];this.selectedType===n.session_type&&this.selectedID===n.session_id?(n["selected"]=!0,e="session_id."+n["session_type"]+":"+n["session_id"],s=[n["start_timestamp"]-5*this.barSize,n["end_timestamp"]+5*this.barSize]):n["selected"]=!1}var r=JSON.parse(this.spec);r["data"]["values"]=a,r["vconcat"][1]["selection"]["brush"]["init"]["x"]=s,this.spec=Le()(r),this.$store.dispatch("updateCurrentQueryString",e),this.$store.dispatch("search",this.sketch.id)},getProcessedSessions:function(){var t=this,e=31556952e3,s=JSON.parse(Le()(this.sessions));if(this.isTruncated=s.pop()["truncated"],s.length>0){var a=s[0].end_timestamp,i=s[0].start_timestamp;if(null==this.endTimeRange){for(var n=1;n<s.length;n++)s[n].end_timestamp>a&&(a=s[n].end_timestamp);this.endTimeRange=a,this.startTimeRange=this.endTimeRange-e,s=s.filter(function(e){return e.start_timestamp>=t.startTimeRange&&e.start_timestamp<=t.endTimeRange}),i=s[0].start_timestamp;for(n=1;n<s.length;n++)s[n].start_timestamp<i&&(i=s[n].start_timestamp)}else{s=s.filter(function(e){return e.start_timestamp>=t.startTimeRange&&e.start_timestamp<=t.endTimeRange}),i=s[0].start_timestamp,a=s[0].end_timestamp;for(n=1;n<s.length;n++)s[n].start_timestamp<i&&(i=s[n].start_timestamp),s[n].end_timestamp>a&&(a=s[n].end_timestamp)}var r=a-i;this.barSize=Math.round(r/1e3),this.smallest_timestamp=i;for(n=0;n<s.length;n++){var o=s[n],c=o.start_timestamp+this.barSize;o.end_timestamp<c&&(o.end_timestamp=c)}}this.processedSessions=s},getVegaSpec:function(){var t=900,e=400;this.getProcessedSessions(),void 0!==this.processedSessions&&0!=this.processedSessions.length||(this.timeRangeMessage="There are no sessions in this time range.");var s={$schema:"https://vega.github.io/schema/vega-lite/v3.json",data:{values:this.processedSessions},vconcat:[{width:t,height:e,padding:5,mark:"bar",encoding:{y:{field:"session_type",type:"ordinal",axis:{title:"Session Type"}},x:{field:"start_timestamp",type:"temporal",timeUnit:"yearmonthdatehoursminutesseconds",axis:{title:"Timestamp",tickCount:5},scale:{domain:{selection:"brush"}}},x2:{field:"end_timestamp",type:"temporal",timeUnit:"yearmonthdatehoursminutesseconds",axis:{title:"End Timestamp"}},color:{field:"session_id",type:"nominal",scale:{scheme:"tableau20"},legend:!1},opacity:{condition:[{test:"datum.selected == true",value:1},{test:"datum.selected == false",value:.2}],value:.8}}},{width:t,height:e/4,padding:5,selection:{brush:{type:"interval",encodings:["x"],init:{x:[this.smallest_timestamp,this.smallest_timestamp+50*this.barSize]}}},mark:{type:"bar",x2Offset:t/100,clip:!0},encoding:{y:{field:"session_type",type:"ordinal",axis:{title:"Session Type"}},x:{field:"start_timestamp",type:"temporal",axis:{title:"Timestamp",tickCount:5}},x2:{field:"end_timestamp",type:"temporal",axis:{title:"End Timestamp"}},color:{field:"session_id",type:"nominal",scale:{scheme:"tableau20"},legend:!1},opacity:{condition:[{test:"datum.selected == true",value:1},{test:"datum.selected == false",value:.2}],value:.8}}}]};this.spec=Le()(s)}}},Gs=Ys,Bs=Object(c["a"])(Gs,Ns,Os,!1,null,null,null),Js=Bs.exports,Ws=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("b-modal",{attrs:{active:t.showSaveModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showSaveModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Save aggregation")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.save()}}},[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Name")]),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.aggregationName,expression:"aggregationName"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Name your aggregation",autofocus:""},domProps:{value:t.aggregationName},on:{input:function(e){e.target.composing||(t.aggregationName=e.target.value)}}})])]),s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save"}})])])])])])])]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header",staticStyle:{cursor:"pointer"},on:{click:function(e){t.showAggregations=!t.showAggregations}}},[t._m(0),s("span",{staticClass:"card-header-icon"},[s("span",{staticClass:"icon"},[t.showAggregations?t._e():s("i",{staticClass:"fas fa-angle-down",attrs:{"aria-hidden":"true"}}),t.showAggregations?s("i",{staticClass:"fas fa-angle-up",attrs:{"aria-hidden":"true"}}):t._e()])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showAggregations,expression:"showAggregations"}],staticClass:"card-content"},[s("ts-sketch-explore-aggregator-list-dropdown",{on:{setActiveAggregator:t.updateAggregatorFormFields}}),s("br"),s("ts-dynamic-form",{key:t.selectedAggregator.name,ref:"vegaChart",attrs:{schema:t.schema},on:{formSubmitted:t.getVegaSpec},model:{value:t.formData,callback:function(e){t.formData=e},expression:"formData"}})],1)])])]),s("section",{directives:[{name:"show",rawName:"v-show",value:t.showChart&&t.showAggregations&&0!==Object.keys(t.vegaSpec).length,expression:"showChart && showAggregations && Object.keys(vegaSpec).length !== 0"}],staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("span",{staticClass:"card-header-title"},[t._v("\n            "+t._s(t.selectedAggregator.display_name)+"\n          ")]),s("span",{staticClass:"card-header-icon"},[s("a",{staticClass:"button is-rounded is-small",on:{click:function(e){t.showSaveModal=!t.showSaveModal}}},[t._m(1),s("span",[t._v("Save")])])])]),s("div",{staticClass:"card-content"},[s("ts-table-chart",{directives:[{name:"show",rawName:"v-show",value:"table"===t.chartType,expression:"chartType === 'table'"}],attrs:{"table-data":t.chartData}}),s("ts-vega-lite-chart",{directives:[{name:"show",rawName:"v-show",value:"table"!==t.chartType,expression:"chartType !== 'table'"}],attrs:{vegaSpec:t.vegaSpec}})],1)])])])],1)},Ks=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"card-header-title"},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-chart-bar"})]),s("span",{staticStyle:{"margin-left":"10px"}},[t._v("Insights")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-save"})])}],Xs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.schema.length?s("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm(e)}}},[t._l(t.schema,function(e,a){return s(e.type,t._b({key:a,tag:"component",attrs:{value:t.formData[e.name],display:e.display},on:{input:function(s){return t.updateForm(e.name,s)}}},"component",e,!1))}),t._m(0)],2):t._e()},Zs=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control"},[s("input",{staticClass:"button is-info",attrs:{type:"submit",value:"Run"}})])}],ta=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.display?s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v(t._s(t.label))]),s("input",{staticClass:"input",staticStyle:{"max-width":"400px"},attrs:{type:"text",name:t.name,placeholder:t.placeholder},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}})]):t._e()},ea=[],sa={props:["placeholder","label","name","value","display"]},aa=sa,ia=Object(c["a"])(aa,ta,ea,!1,null,null,null),na=ia.exports,ra=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.display?s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v(t._s(t.label))]),s("div",{staticClass:"control"},[s("div",{staticClass:"select"},[s("select",{domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}},[s("option",{attrs:{disabled:"",value:""}},[t._v("Please select one")]),t._l(t.options,function(e){return s("option",{key:e},[t._v(t._s(e))])})],2)])])]):t._e()},oa=[],ca={props:["options","label","value","display"]},la=ca,ua=Object(c["a"])(la,ra,oa,!1,null,null,null),da=ua.exports,ha={components:{TsDynamicFormTextInput:na,TsDynamicFormSelectInput:da},props:["schema","value"],data:function(){return{formData:this.value||{}}},methods:{updateForm:function(t,e){this.$set(this.formData,t,e),this.$emit("input",this.formData)},submitForm:function(){this.$emit("formSubmitted")}}},ma=ha,pa=Object(c["a"])(ma,Xs,Zs,!1,null,null,null),va=pa.exports,fa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Choose an aggregator")]),s("div",{staticClass:"control"},[s("div",{staticClass:"select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.selected=e.target.multiple?s:s[0]},function(e){return t.setActiveAggregator()}]}},[s("option",{attrs:{disabled:"",value:""}},[t._v("Please select one")]),t._l(t.meta.aggregators,function(e,a){return s("option",{key:e.id,domProps:{value:a}},[t._v("\n          "+t._s(e.display_name)+"\n        ")])})],2)])])])},ga=[],_a={props:["isRounded","title"],data:function(){return{selected:"",selectedChart:""}},computed:{meta:function(){return this.$store.state.meta}},methods:{setActiveAggregator:function(){var t=JSON.parse(Le()(this.meta.aggregators[this.selected]));t.name=this.selected,this.$emit("setActiveAggregator",t)}}},Ca=_a,ya=Object(c["a"])(Ca,fa,ga,!1,null,null,null),ba=ya.exports,ka=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.tableData.length?s("div",[s("b-table",{attrs:{data:t.tableData,columns:t.getColumns(),paginated:!0,"pagination-simple":!0,"per-page":10,hoverable:!0,"icon-pack":"fas","pagination-size":"is-small"}})],1):t._e()},Sa=[],wa={props:["tableData"],methods:{getColumns:function(){var t=[],e=this.tableData[0];return Re()(e).forEach(function(e){t.push({field:e,label:e,sortable:!0})}),t}}},xa=wa,Ta=Object(c["a"])(xa,ka,Sa,!1,null,null,null),Ea=Ta.exports,$a={props:["showAggregations"],components:{TsDynamicForm:va,TsVegaLiteChart:Hs,TsSketchExploreAggregatorListDropdown:ba,TsTableChart:Ea},data:function(){return{schema:{},formData:{},vegaSpec:{},selectedAggregator:"",showChart:!1,showSaveModal:!1,aggregationName:"",chartType:"",chartData:{}}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{updateAggregatorFormFields:function(t){this.showChart=!1;var e={};this.schema=t.form_fields,this.schema.forEach(function(t){e[t.name]=t.default_value}),this.formData=e,this.selectedAggregator=t},getVegaSpec:function(){var t=this;this.showChart=!0;var e={aggregator_name:this.selectedAggregator.name,aggregator_parameters:this.formData};E.runAggregator(this.sketch.id,e).then(function(e){var s=e.data.meta.vega_spec;s.config.view.width=t.$refs.vegaChart.$el.offsetWidth,s.config.autosize={type:"fit",contains:"padding"},t.vegaSpec=Le()(s),t.chartType=e.data.meta.chart_type,t.chartData=s.datasets[Re()(s.datasets)[0]]}).catch(function(t){})},save:function(){var t=this;this.showSaveModal=!1,E.saveAggregation(this.sketch.id,this.selectedAggregator,this.aggregationName,this.formData).then(function(e){var s=e.data.objects[0];t.$store.state.sketch.aggregations.push(s),t.aggregationName=""}).catch(function(t){})}}},Aa=$a,Da=Object(c["a"])(Aa,Ws,Ks,!1,null,null,null),Fa=Da.exports,Ma={components:{TsSketchExploreAggregation:Fa,TsViewListDropdown:Be,TsCreateViewForm:ts,TsSketchExploreEventList:ys,TsExploreTimelinePicker:Ts,TsExploreFilterTime:Ms,TsExploreSessionChart:Js},props:["sketchId"],data:function(){return{params:{},showCreateViewModal:!1,showAggregations:!1,showSearch:!0,searchInProgress:!1,activeStarFilter:!1,currentPage:1,contextEvent:!1,originalContext:!1,eventList:{meta:{},objects:[]},currentQueryString:"",previousQueryString:"",currentQueryFilter:{from:0,time_start:null,time_end:null,terminate_after:40,size:40,indices:["_all"],order:"asc",chips:[],fields:[]},selectedFields:[{field:"message",type:"text"}],selectedFieldsProxy:[],expandFieldDropdown:!1,selectedEvents:{},displayOptions:{showTags:!0,showEmojis:!0}}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},totalHits:function(){return this.eventList.meta.es_total_count||0},totalHitsForPagination:function(){var t=this.eventList.meta.es_total_count||0;return t>9999&&(t=1e4),t},totalTime:function(){return this.eventList.meta.es_time/1e3||0},fromEvent:function(){return this.currentQueryFilter.from||1},toEvent:function(){if(!(this.totalHits<this.currentQueryFilter.size))return Ve()(this.currentQueryFilter.from)+Ve()(this.currentQueryFilter.size)},numSelectedEvents:function(){return Re()(this.selectedEvents).length}},methods:{search:function(){var t=this;this.contextEvent&&this.$scrollTo("#context",200,{offset:-300}),this.selectedEvents={},this.eventList={meta:{},objects:[]},this.previousQueryString!==this.currentQueryString&&(this.currentQueryFilter.from=0),this.previousQueryString=this.currentQueryString,this.currentQueryFilter.fields=this.selectedFields;var e={query:this.currentQueryString,filter:this.currentQueryFilter};E.search(this.sketchId,e).then(function(e){t.eventList.objects=e.data.objects,t.eventList.meta=e.data.meta}).catch(function(t){})},exportSearchResult:function(){var t={query:this.currentQueryString,filter:this.currentQueryFilter,file_name:"export.zip"};E.exportSearchResult(this.sketchId,t).then(function(t){var e=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a"),a="export.zip";s.href=e,s.setAttribute("download",a),document.body.appendChild(s),s.click()}).catch(function(t){console.error(t)})},searchView:function(t){var e=this;this.selectedEvents={},t!==Ve()(t,10)&&"string"!==typeof t&&(t=t.id,this.$router.push({name:"SketchExplore",query:{view:t}})),E.getView(this.sketchId,t).then(function(t){var s=t.data.objects[0];if(e.currentQueryString=s.query_string,e.currentQueryFilter=JSON.parse(s.query_filter),e.currentQueryFilter.fields&&e.currentQueryFilter.fields.length||(e.currentQueryFilter.fields=[{field:"message",type:"text"}]),e.selectedFields=e.currentQueryFilter.fields,"_all"===e.currentQueryFilter.indices){var a=[];e.sketch.active_timelines.forEach(function(t){a.push(t.searchindex.index_name)}),e.currentQueryFilter.indices=a}e.activeStarFilter=!1;var i=e.currentQueryFilter.chips;if(i)for(var n=0;n<i.length;n++)"__ts_star"===i[n].value&&(e.activeStarFilter=!0);e.contextEvent=!1,e.search()}).catch(function(t){})},searchContext:function(t){var e=300,s=500;if(this.contextEvent=t,!this.originalContext){var a=JSON.parse(Le()(this.currentQueryString)),i=JSON.parse(Le()(this.currentQueryFilter));this.originalContext={queryString:a,queryFilter:i}}var n="YYYY-MM-DDTHH:mm:ss",r=this.$moment.utc(this.contextEvent._source.datetime),o=r.clone().subtract(e,"s").format(n),c=r.clone().add(e,"s").format(n),l={field:"",value:o+","+r.format(n),type:"datetime_range",operator:"must"},u={field:"",value:r.format(n)+","+c,type:"datetime_range",operator:"must"};this.currentQueryString="* OR _id:"+this.contextEvent._id,this.currentQueryFilter.chips=[l,u],this.currentQueryFilter.indices=[this.contextEvent._index],this.currentQueryFilter.size=s,this.search()},removeContext:function(){this.contextEvent=!1,this.currentQueryString=JSON.parse(Le()(this.originalContext.queryString)),this.currentQueryFilter=JSON.parse(Le()(this.originalContext.queryFilter)),this.search()},scrollToContextEvent:function(){this.$scrollTo("#"+this.contextEvent._id,200,{offset:-300})},updateQueryFilter:function(t){this.currentQueryFilter=t,this.search()},toggleCreateViewModal:function(){this.showCreateViewModal=!this.showCreateViewModal},removeChip:function(t){var e=this.currentQueryFilter.chips[t];"__ts_star"===e.value&&(this.activeStarFilter=!1),this.currentQueryFilter.chips.splice(t,1),this.search()},addChip:function(t){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.push(t),this.showFilters=!1,this.search()},toggleLabelChip:function(t){var e={field:"",value:t,type:"label",operator:"must"},s=this.currentQueryFilter.chips;if(s)for(var a=0;a<s.length;a++)if(s[a].value===t)return void this.removeChip(a);this.addChip(e)},paginate:function(t){this.currentQueryFilter.from=t*this.currentQueryFilter.size-this.currentQueryFilter.size,this.search()},updateSelectedFields:function(t){var e=this;t.forEach(function(t){!e.selectedFields.filter(function(e){return e.field===t.field}).length>0&&e.search()}),t.forEach(function(t){e.selectedFields.push(t)}),this.selectedFieldsProxy=[]},removeField:function(t){this.selectedFields.splice(t,1)},updateSelectedEvents:function(t){var e=t._index+":"+t._id;t.isSelected?this.$set(this.selectedEvents,e,t):this.$delete(this.selectedEvents,e)},toggleStar:function(){var t=this,e=[];Re()(this.selectedEvents).forEach(function(s,a){e.push(t.selectedEvents[s])}),E.saveEventAnnotation(this.sketch.id,"label","__ts_star",e).then(function(t){}).catch(function(t){}),qi.$emit("toggleStar",this.selectedEvents)}},watch:{numEvents:function(t){this.currentQueryFilter.size=t,this.search()}},mounted:function(){var t=this;qi.$on("eventSelected",function(e){t.updateSelectedEvents(e)}),qi.$on("clearSelectedEvents",function(){t.selectedEvents={}})},created:function(){var t=!1;this.params={viewId:this.$route.query.view,indexName:this.$route.query.index,resultLimit:this.$route.query.limit,queryString:this.$route.query.q},this.params.viewId&&this.searchView(this.params.viewId),this.params.queryString&&(this.currentQueryString=this.params.queryString,t=!0),this.params.indexName&&(this.params.queryString||(this.currentQueryString="*"),this.currentQueryFilter.indices=[this.params.indexName],t=!0),t&&this.search()}},Na=Ma,Oa=(s("2555"),Object(c["a"])(Na,Ie,Pe,!1,null,null,null)),Ia=Oa.exports,Pa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("router-view")},ja=[],La={},Qa=Object(c["a"])(La,Pa,ja,!1,null,null,null),Ra=Qa.exports,za=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"stories"}},[t.sketch.stories.length?s("a",{staticClass:"button is-success is-rounded",staticStyle:{"margin-right":"7px"},on:{click:function(e){t.showCreateStoryModal=!t.showCreateStoryModal}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-plus"})]),s("span",[t._v("Story")])]):t._e()])],1)]),s("b-modal",{attrs:{active:t.showCreateStoryModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showCreateStoryModal=e}}},[s("div",{staticClass:"card"},[s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[t._v("Create a new story")])]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[s("ts-story-create-form",{on:{toggleModal:function(e){t.showCreateStoryModal=!t.showCreateStoryModal}}})],1)])])]),s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content"},[t.sketch.stories.length?t._e():s("div",[t._v("\n            There are no stories in this sketch yet.\n            "),s("br"),s("br"),s("a",{staticClass:"button is-success is-rounded",staticStyle:{"margin-right":"7px"},on:{click:function(e){t.showCreateStoryModal=!t.showCreateStoryModal}}},[t._m(0),s("span",[t._v("Create a new story")])])]),s("ts-story-list")],1)])])])],1)},Va=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-plus"})])}],qa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm(e)}}},[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Title")]),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Title of your story",autofocus:""},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})])]),t._m(0)])},Ua=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Create"}})])])}],Ha={data:function(){return{title:""}},methods:{clearFormData:function(){this.title=""},submitForm:function(){var t=this,e="";E.createStory(this.title,e,this.sketch.id).then(function(e){var s=e.data.objects[0].id;t.clearFormData(),t.$router.push({name:"SketchStoryContent",params:{storyId:s}})}).catch(function(t){})}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}}},Ya=Ha,Ga=Object(c["a"])(Ya,qa,Ua,!1,null,null,null),Ba=Ga.exports,Ja={components:{TsStoryList:ee,TsStoryCreateForm:Ba},data:function(){return{showCreateStoryModal:!1}},computed:{sketch:function(){return this.$store.state.sketch}}},Wa=Ja,Ka=Object(c["a"])(Wa,za,Va,!1,null,null,null),Xa=Ka.exports,Za=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"stories"}})],1)]),t.blocks?s("section",{staticClass:"section"},[s("div",{staticClass:"container is-fluid"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content",staticStyle:{padding:"50px"}},[s("div",{staticClass:"markdown-body",staticStyle:{"margin-bottom":"20px","padding-left":"10px"}},[s("h1",[t._v(t._s(t.title))])]),t._l(t.blocks,function(e,a){return s("div",{key:a},[e.componentName?t._e():s("div",{staticClass:"inactiveBlock",class:{activeBlock:e.isActive},staticStyle:{"padding-left":"10px"},on:{mouseover:function(t){e.isActive=!0},mouseleave:function(t){e.isActive=!1}}},[e.isActive?s("span",{staticStyle:{float:"right"}},[s("button",{staticClass:"delete",on:{click:function(e){return t.deleteBlock(a)}}})]):t._e(),e.edit?s("div",{staticClass:"columns",staticStyle:{"margin-bottom":"0"}},[s("div",{staticClass:"column"},[s("textarea",{staticClass:"textarea",staticStyle:{height:"100%"},attrs:{placeholder:"Your story starts here.."},domProps:{value:e.content},on:{input:function(s){return t.update(s,e)}}})]),s("transition",{attrs:{name:"fade"}},[e.content?s("div",{staticClass:"column"},[s("div",{staticClass:"markdown-body",staticStyle:{"max-height":"600px",overflow:"auto"},domProps:{innerHTML:t._s(t.toHtml(e.content))}})]):t._e()])],1):t._e(),e.edit?s("div",{staticClass:"field is-grouped"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-rounded is-success",attrs:{disabled:!e.content},on:{click:function(s){return t.saveAndHide(e)}}},[t._m(0,!0),s("span",[t._v("Save")])])])]):t._e(),e.edit?t._e():s("div",{staticClass:"markdown-body",domProps:{innerHTML:t._s(t.toHtml(e.content))},on:{dblclick:function(t){e.edit=!e.edit}}})]),e.componentName?s("div",{on:{mouseover:function(t){e.isActive=!0},mouseleave:function(t){e.isActive=!1}}},[s("article",{staticClass:"message"},[s("div",{staticClass:"message-header"},["TsViewEventList"===e.componentName?s("p",[s("router-link",{attrs:{to:{name:"SketchExplore",query:{view:e.componentProps.view.id}}}},[s("strong",[t._v(t._s(e.componentProps.view.name))])])],1):t._e(),"TsAggregationCompact"===e.componentName?s("p",[t._v("\n                    "+t._s(e.componentProps.aggregation.name)+"\n                  ")]):t._e(),"TsAggregationGroupCompact"===e.componentName?s("p",[t._v("\n                    "+t._s(e.componentProps.aggregation_group.name)+"\n                  ")]):t._e(),s("button",{staticClass:"delete",attrs:{"aria-label":"delete"},on:{click:function(e){return t.deleteBlock(a)}}})]),s("div",{staticClass:"message-body"},[s(e.componentName,t._b({tag:"component"},"component",e.componentProps,!1))],1)])]):t._e(),s("div",{staticStyle:{"min-height":"35px","margin-top":"10px","margin-bottom":"10px"},on:{mouseover:function(t){e.showPanel=!0},mouseleave:function(t){e.showPanel=!1}}},[a===t.blocks.length-1?s("div",{staticStyle:{"padding-top":"20px"}}):t._e(),a===t.blocks.length-1||e.showPanel||e.isActive?s("div",{staticClass:"field is-grouped"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-rounded",on:{click:function(e){return t.addBlock(a)}}},[t._v("\n                      + Text\n                    ")])]),t.meta.views.length?s("p",{staticClass:"control"},[s("ts-view-list-dropdown",{attrs:{"is-rounded":!0,title:"+ Saved view"},on:{setActiveView:function(e){return t.addViewComponent(e,a)}}})],1):t._e(),t.allAggregations?s("p",{staticClass:"control"},[s("ts-aggregation-list-dropdown",{attrs:{"is-rounded":!0,title:"+ Aggregation",aggregations:t.allAggregations},on:{addAggregation:function(e){return t.addAggregationComponent(e,a)}}})],1):t._e()]):t._e()])])})],2)])])]):t._e()])},ti=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-save",attrs:{"aria-hidden":"true"}})])}],ei=s("a745"),si=s.n(ei),ai=s("0e54"),ii=s.n(ai),ni=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dropdown",class:{"is-active":t.dropdownActive}},[s("div",{staticClass:"dropdown-trigger"},[s("a",{staticClass:"button",class:{"is-rounded":t.isRounded},attrs:{"aria-haspopup":"true","aria-controls":"dropdown-menu"},on:{click:function(e){t.dropdownActive=!t.dropdownActive}}},[s("span",[t._v(t._s(t.title||"Aggregations"))]),t._m(0)])]),s("div",{staticClass:"dropdown-menu",attrs:{id:"dropdown-menu",role:"menu"}},[s("div",{staticClass:"dropdown-content"},[t.aggregations&&t.aggregations.length<1?s("span",{staticClass:"dropdown-item"},[t._v("No saved aggregations")]):t._e(),t._l(t.aggregations,function(e){return s("a",{key:e.id,staticClass:"dropdown-item",on:{click:function(s){return t.setActiveAggregation(e)}}},[s("span",[t._v(t._s(e.name))])])})],2)])])},ri=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-angle-down",attrs:{"aria-hidden":"true"}})])}],oi={props:["isRounded","title","aggregations"],data:function(){return{dropdownActive:!1}},methods:{setActiveAggregation:function(t){this.$emit("addAggregation",t),this.viewListDropdownActive=!1}}},ci=oi,li=Object(c["a"])(ci,ni,ri,!1,null,"59778fe0",null),ui=li.exports,di=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("div",{ref:"vegaChart",staticClass:"card-content"},["table"===t.chartType?s("ts-table-chart",{attrs:{"table-data":t.chartData}}):t._e(),"table"!==t.chartType?s("ts-vega-lite-chart",{attrs:{vegaSpec:t.vegaSpec}}):t._e()],1)])},hi=[],mi={props:["aggregation"],components:{TsVegaLiteChart:Hs,TsTableChart:Ea},data:function(){return{vegaSpec:{},title:"",chartType:"",chartData:{}}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{getVegaSpec:function(){var t=this,e={aggregator_name:this.aggregation.agg_type,aggregator_parameters:this.aggregation.parameters};E.runAggregator(this.sketch.id,e).then(function(e){var s=e.data.meta.vega_spec;s.config.view.width=t.$refs.vegaChart.offsetWidth-50,s.config.autosize={type:"fit",contains:"padding"},t.vegaSpec=Le()(s),t.title=e.data.meta.vega_chart_title,t.chartType=e.data.meta.chart_type,t.chartData=s.datasets[Re()(s.datasets)[0]]}).catch(function(t){})}},mounted:function(){this.getVegaSpec()}},pi=mi,vi=Object(c["a"])(pi,di,hi,!1,null,null,null),fi=vi.exports,gi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("div",{ref:"vegaChart",staticClass:"card-content"},[s("ts-vega-lite-chart",{attrs:{vegaSpec:t.vegaSpec}})],1)])},_i=[],Ci={props:["aggregation_group"],components:{TsVegaLiteChart:Hs},data:function(){return{vegaSpec:{},title:""}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{getVegaSpec:function(){var t=this;E.runAggregatorGroup(this.sketch.id,this.aggregation_group.id).then(function(e){var s=e.data.meta.vega_spec;s.config.view.width=t.$refs.vegaChart.offsetWidth-50,s.config.autosize={type:"fit",contains:"padding"},t.vegaSpec=Le()(s),t.title=e.data.meta.vega_chart_title}).catch(function(t){})}},mounted:function(){this.getVegaSpec()}},yi=Ci,bi=Object(c["a"])(yi,gi,_i,!1,null,null,null),ki=bi.exports,Si=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",{staticClass:"table is-fullwidth"},[s("thead",[s("th",{attrs:{width:"220"}}),s("th",{attrs:{width:"1"}}),t._l(t.selectedFields,function(e,a){return s("th",{key:a},[t._v(t._s(e.field))])}),s("th",{attrs:{width:"150"}},[t._v("Timeline name")])],2),t._l(t.eventList.objects,function(e,a){return s("ts-sketch-explore-event-list-row",{key:a,attrs:{event:e,prevEvent:t.eventList.objects[a-1],"selected-fields":t.selectedFields,"display-options":t.displayOptions,"display-controls":!1}})})],2)},wi=[],xi={components:{TsSketchExploreEventListRow:fs},props:["view"],data:function(){return{queryString:"",queryFilter:{},eventList:[],selectedFields:[],displayOptions:{showTags:!0,showEmojis:!0}}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{search:function(){var t=this,e={query:this.queryString,filter:this.queryFilter};E.search(this.sketch.id,e).then(function(e){t.eventList=e.data}).catch(function(t){})},searchView:function(t){var e=this;E.getView(this.sketch.id,t).then(function(t){var s=t.data.objects[0];e.queryString=s.query_string,e.queryFilter=JSON.parse(s.query_filter),e.queryFilter.fields&&e.queryFilter.fields.length||(e.queryFilter.fields=[{field:"message",type:"text"}]),e.selectedFields=e.queryFilter.fields,e.search()}).catch(function(t){})}},created:function(){this.searchView(this.view.id)}},Ti=xi,Ei=Object(c["a"])(Ti,Si,wi,!1,null,null,null),$i=Ei.exports,Ai=function(){return{componentName:"",componentProps:{},content:"",edit:!0,showPanel:!1,isActive:!1}},Di={components:{TsAggregationListDropdown:ui,TsAggregationCompact:fi,TsAggregationGroupCompact:ki,TsViewListDropdown:Be,TsViewEventList:$i},props:["sketchId","storyId"],data:function(){return{blocks:[],title:"",aggregations:[],aggregationGroups:[]}},methods:{update:gt.a.debounce(function(t,e){e.content=t.target.value,this.save()},300),addBlock:function(t){var e=t+1,s=Ai();this.blocks.splice(e,0,s)},deleteBlock:function(t){this.blocks.splice(t,1),this.blocks.length||(this.blocks=[Ai()]),this.save()},addAggregationComponent:function(t,e){var s=e+1,a=Ai();"agg_ids"in t?(a.componentName="TsAggregationGroupCompact",a.componentProps={aggregation_group:t}):(a.componentName="TsAggregationCompact",a.componentProps={aggregation:t}),this.blocks.splice(s,0,a),this.save()},addViewComponent:function(t,e){var s=e+1,a=Ai();a.componentName="TsViewEventList",a.componentProps={view:t},this.blocks.splice(s,0,a),this.save()},hideBlock:function(t){t.edit=!t.edit},saveAndHide:function(t){this.hideBlock(t),this.save()},save:function(){this.blocks.forEach(function(t){t.showPanel=!1,t.isActive=!1});var t=Le()(this.blocks);E.updateStory(this.title,t,this.sketchId,this.storyId).then(function(t){}).catch(function(t){})},toHtml:function(t){return ii()(t,{sanitize:!1})}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},allAggregations:function(){var t=function(){for(var t,e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];return(t=[]).concat.apply(t,Object(X["a"])(s.filter(si.a)))};return t(this.aggregations,this.aggregationGroups)}},created:function(){var t=this;E.getStory(this.sketchId,this.storyId).then(function(e){t.title=e.data.objects[0].title;var s=e.data.objects[0].content;t.blocks="[]"===s?[Ai()]:JSON.parse(s)}).catch(function(t){console.error(t)}),E.getAggregations(this.sketchId).then(function(e){t.aggregations=e.data.objects[0]}).catch(function(t){console.error(t)}),E.getAggregationGroups(this.sketchId).then(function(e){t.aggregationGroups=e.data.objects}).catch(function(t){console.error(t)})}},Fi=Di,Mi=(s("dba0"),Object(c["a"])(Fi,Za,ti,!1,null,null,null)),Ni=Mi.exports;a["a"].use(f["a"]);var Oi=[{name:"Home",path:"/",component:q},{path:"/sketch/:sketchId",component:J,props:!0,children:[{path:"",name:"SketchOverview",component:Se},{path:"explore",name:"SketchExplore",component:Ia,props:!0},{path:"story",component:Ra,props:!0,children:[{path:"",name:"SketchStoryOverview",component:Xa},{path:":storyId",name:"SketchStoryContent",component:Ni,props:!0}]},{path:"manage",component:$e,props:!0,children:[{path:"views",name:"SketchManageViews",component:Oe},{path:"timelines",name:"SketchManageTimelines",component:me}]}]}],Ii=new f["a"]({mode:"history",routes:Oi}),Pi=s("5176"),ji=s.n(Pi),Li=s("2f62");a["a"].use(Li["a"]);var Qi=function(t){return{sketch:{},meta:{},count:0,currentUser:t}},Ri=Qi(),zi=new Li["a"].Store({state:Ri,mutations:{SET_SKETCH:function(t,e){a["a"].set(t,"sketch",e.objects[0]),a["a"].set(t,"meta",e.meta)},SET_COUNT:function(t,e){a["a"].set(t,"count",e)},RESET_STATE:function(t,e){E.getLoggedInUser().then(function(e){var s=e.data.objects[0].username;ji()(t,Qi(s))})}},actions:{updateSketch:function(t,e){E.getSketch(e).then(function(e){t.commit("SET_SKETCH",e.data)}).catch(function(t){}),E.countSketchEvents(e).then(function(e){t.commit("SET_COUNT",e.data.meta.count)}).catch(function(t){})},resetState:function(t){t.commit("RESET_STATE")}}});s("b383"),s("2d27"),s("56eb");var Vi=new a["a"],qi=e["default"]=Vi;a["a"].use(s("2ead")),a["a"].use(d["a"]),a["a"].use(m.a),a["a"].component("multiselect",v.a),a["a"].config.productionTip=!1,new a["a"]({router:Ii,store:zi,render:function(t){return t(u)}}).$mount("#app")},"56eb":function(t,e,s){"use strict";s.r(e);s("7f7f"),s("ac6a"),s("cadf"),s("551c"),s("f751"),s("097d");var a=s("2b0e"),i=s("6dde");i.keys().forEach(function(t){var e=i(t);a["a"].filter(e.default.name,e.default.filter)})},"592e":function(t,e,s){},"6c03":function(t,e,s){"use strict";var a=s("592e"),i=s.n(a);i.a},"6dde":function(t,e,s){var a={"./CompactBytes.js":"3d1d","./CompactNumber.js":"d3b7","./FilterChip.js":"05a2"};function i(t){var e=n(t);return s(e)}function n(t){var e=a[t];if(!(e+1)){var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}return e}i.keys=function(){return Object.keys(a)},i.resolve=n,t.exports=i,i.id="6dde"},"6eea":function(t,e,s){},7392:function(t,e,s){},"75a6":function(t,e,s){var a={"./AppNavbarMain.vue":"f7e3","./AppNavbarSecondary.vue":"c5cc"};function i(t){var e=n(t);return s(e)}function n(t){var e=a[t];if(!(e+1)){var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}return e}i.keys=function(){return Object.keys(a)},i.resolve=n,t.exports=i,i.id="75a6"},"90df":function(t,e,s){},a2cf:function(t,e,s){"use strict";var a=s("a32f"),i=s.n(a);i.a},a32f:function(t,e,s){},adbc:function(t,e,s){"use strict";var a=s("90df"),i=s.n(a);i.a},b383:function(t,e,s){},c45b:function(t,e,s){"use strict";var a=s("310c"),i=s.n(a);i.a},c5cc:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("nav",{staticClass:"navbar",attrs:{role:"navigation","aria-label":"main navigation"}},["sketch"===t.currentAppContext?s("div",{staticClass:"navbar-item"},[s("div",{staticClass:"tabs is-left"},[s("ul",[s("li",{class:{"is-active":"overview"===t.currentPage}},[s("router-link",{attrs:{to:{name:"SketchOverview"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-cubes",attrs:{"aria-hidden":"true"}})]),s("span",[t._v("Overview")])])],1),s("li",{class:{"is-active":"explore"===t.currentPage}},[s("router-link",{attrs:{to:{name:"SketchExplore"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-search",attrs:{"aria-hidden":"true"}})]),s("span",[t._v("Explore")])])],1),s("li",{class:{"is-active":"stories"===t.currentPage}},[s("router-link",{attrs:{to:{name:"SketchStoryOverview"}}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-book",attrs:{"aria-hidden":"true"}})]),s("span",[t._v("Stories")])])],1)])])]):t._e(),s("div",{staticClass:"navbar-end"},[s("div",{staticClass:"navbar-item"},[t._t("default")],2)])])},i=[],n={name:"ts-navbar-secondary",props:["currentAppContext","currentPage"]},r=n,o=(s("03d8"),s("2877")),c=Object(o["a"])(r,a,i,!1,null,"32d774ca",null);e["default"]=c.exports},d147:function(t,e,s){"use strict";var a=s("448f"),i=s.n(a);i.a},d3b7:function(t,e,s){"use strict";s.r(e),e["default"]={name:"compactNumber",filter:function(t){t||(t=0);var e="";if(t>999999999)t=Math.round(t/1e9*10)/10,e="B";else if(t>999999)t=Math.round(t/1e6*10)/10,e="M";else{if(!(t>999))return t;t=Math.round(t/1e3*10)/10,e="K"}return t+e}}},dba0:function(t,e,s){"use strict";var a=s("285d"),i=s.n(a);i.a},e1a2:function(t,e,s){"use strict";var a=s("7392"),i=s.n(a);i.a},e49a:function(t,e,s){"use strict";var a=s("3380"),i=s.n(a);i.a},f598:function(t,e,s){},f7e3:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("nav",{staticClass:"navbar",attrs:{role:"navigation","aria-label":"main navigation"}},[s("div",{staticClass:"navbar-brand"},[s("router-link",{staticClass:"navbar-item",attrs:{to:"/"}},[s("div",{staticClass:"logo",staticStyle:{"margin-top":"7px"}},[s("img",{attrs:{src:"/dist/timesketch-white.png"}})]),s("span",{staticStyle:{color:"#fff","margin-left":"7px","margin-top":"1px","font-size":"1.2em"}},[t._v("time"),s("b",[t._v("sketch")])])])],1),s("div",{staticClass:"navbar-end"},[s("div",{staticClass:"navbar-item",staticStyle:{color:"#ffffff"}},[t._v("\n      "+t._s(t.currentUser)+"\n    ")]),t._m(0)])])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"navbar-item"},[s("a",{staticStyle:{color:"#fff"},attrs:{href:"/logout"}},[t._v("Logout")])])}],n={name:"ts-navbar-main",computed:{currentUser:function(){return this.$store.state.currentUser}}},r=n,o=(s("6c03"),s("2877")),c=Object(o["a"])(r,a,i,!1,null,"2afaf5bb",null);e["default"]=c.exports}}]);
//# sourceMappingURL=chunk-common.6f85347a.js.map