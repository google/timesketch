(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-common"],{0:function(t,e,s){t.exports=s("56d7")},"0351":function(t,e,s){"use strict";s("7f02")},"05a2":function(t,e,s){"use strict";s.r(e),e["default"]={name:"filterChip",filter:function(t){return"label"===t.type?"__ts_star"===t.value?"Starred":"__ts_comment"===t.value?"Commented":t.value:t.field+":"+t.value}}},"09ff":function(t,e,s){"use strict";s.r(e);s("6b54");e["default"]={name:"formatTimestamp",filter:function(t){var e=parseInt(t).toString().length;return 13===e||(15===e||16===e?t/=1e3:10===e?t*=1e6:19===e&&(t/=1e6)),t}}},"0c67":function(t,e,s){"use strict";s("bee2")},"103a":function(t,e,s){},"154e":function(t,e,s){},"2cd0":function(t,e,s){},"2d27":function(t,e,s){"use strict";s.r(e);s("7f7f"),s("ac6a");var i=s("2b0e"),a=s("75a6");a.keys().forEach((function(t){var e=a(t),s=e.default.name;i["default"].component(s,e.default||e)}))},"332a":function(t,e,s){"use strict";s("978d")},"37ea":function(t,e,s){"use strict";s("fdeb")},"3ce4":function(t,e,s){},"3d1d":function(t,e,s){"use strict";s.r(e),e["default"]={name:"compactBytes",filter:function(t){t||(t=0);var e=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.min(Math.floor(Math.log(t)/Math.log(1e3)),e.length-1),i=1*(t/Math.pow(1e3,s)).toFixed(2);return i+e[s]}}},"3d7f":function(t,e,s){"use strict";s("4aba")},"3d85":function(t,e,s){"use strict";s("7388")},"3df4":function(t,e,s){"use strict";s("c2b8")},4283:function(t,e,s){"use strict";s("154e")},"4aba":function(t,e,s){},"4bf5":function(t,e,s){"use strict";s("cb41")},"4fcc":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("f751"),s("097d");var i=s("2b0e"),a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},n=[],r={name:"app",created:function(){var t=document.body;localStorage.theme||(localStorage.theme="light"),t.dataset.theme=localStorage.theme}},o=r,c=(s("8498"),s("2877")),l=Object(c["a"])(o,a,n,!1,null,null,null),u=l.exports,d=s("8c4f"),h=(s("386d"),function(){var t=this,e=t._self._c;return e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"center",fn:function(){return[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery,expression:"searchQuery"}],staticClass:"ts-home-input",attrs:{type:"text",placeholder:"Search for investigations",autofocus:""},domProps:{value:t.searchQuery},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},input:function(e){e.target.composing||(t.searchQuery=e.target.value)}}})]},proxy:!0}])}),e("section",{staticClass:"section",staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("div",{staticClass:"container is-fluid"},[e("button",{staticClass:"button is-success",on:{click:function(e){t.showSketchCreateModal=!t.showSketchCreateModal}}},[t._m(0),e("strong",[t._v("New investigation")])])])]),e("b-modal",{attrs:{active:t.showSketchCreateModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showSketchCreateModal=e}}},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Create new sketch")])]),e("div",{staticClass:"card-content"},[e("div",{staticClass:"content"},[e("ts-create-sketch-form")],1)])])]),t.newSearchQuery?e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("b-message",{attrs:{title:"Search results",closable:!1}},[e("ts-sketch-list",{attrs:{scope:"search","search-query":t.newSearchQuery}}),e("button",{staticClass:"button",on:{click:function(e){t.newSearchQuery=""}}},[t._v("Close")])],1)],1)]):t._e(),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[t._m(1),e("div",{staticClass:"card-content"},[e("ts-sketch-list",{attrs:{scope:"recent"}})],1)])]),e("br")]),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[t._m(2),e("div",{staticClass:"card-content"},[e("ts-sketch-list",{attrs:{scope:"user"}})],1)])])]),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[t._m(3),e("div",{staticClass:"card-content"},[e("ts-sketch-list",{attrs:{scope:"shared"}})],1)])])]),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[t._m(4),e("div",{staticClass:"card-content"},[e("ts-sketch-list",{attrs:{scope:"archived"}})],1)])])]),e("br")],1)}),p=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-plus-circle"})])},function(){var t=this,e=t._self._c;return e("header",{staticClass:"card-header"},[e("div",{staticClass:"card-header-title"},[t._v("\n            My recent activity\n          ")])])},function(){var t=this,e=t._self._c;return e("header",{staticClass:"card-header"},[e("div",{staticClass:"card-header-title"},[t._v("\n            My investigations\n          ")])])},function(){var t=this,e=t._self._c;return e("header",{staticClass:"card-header"},[e("div",{staticClass:"card-header-title"},[t._v("\n            Shared with me\n          ")])])},function(){var t=this,e=t._self._c;return e("header",{staticClass:"card-header"},[e("div",{staticClass:"card-header-title"},[t._v("\n            Archived\n          ")])])}],m=(s("7f7f"),s("6762"),s("2fdb"),function(){var t=this,e=t._self._c;return e("div",[t.sketches.length?t._e():e("div",[t._v("No "+t._s(t.scope)+" investigations found")]),e("ul",{staticClass:"content-list"},t._l(t.sketches,(function(s){return e("li",{key:s.id,staticClass:"list-item",staticStyle:{padding:"20px"}},[e("div",{staticClass:"columns"},[e("div",{staticClass:"column is-8"},[e("router-link",{attrs:{to:{name:"Overview",params:{sketchId:s.id}}}},[e("strong",[t._v(t._s(s.name))])]),e("div",{staticClass:"description"},[t._v(t._s(s.description))])],1),e("div",{staticClass:"column"},[e("strong",{staticStyle:{color:"var(--default-font-color)"}},[t._v("Created by:")]),t._v(" "+t._s(s.user)+"\n          "),e("div",{staticStyle:{"font-size":"0.9em"}},[t._v(t._s(t._f("moment")(s.created_at,"YYYY-MM-DD")))])]),e("div",{staticClass:"column",staticStyle:{"text-align":"right"}},[e("span",{staticClass:"button is-small is-rounded is-light",staticStyle:{"border-radius":"20px","margin-top":"10px"}},["archived"===s.status?e("span",[t._v("\n              Archived\n            ")]):s.last_activity?e("span",[t._v("\n              Active\n              "+t._s(t.$moment.utc(s.last_activity).local().fromNow())+"\n            ")]):s.last_activity?t._e():e("span",[t._v("\n              No activity yet\n            ")])]),e("div")])])])})),0),e("br"),t.numSketches>t.perPage?e("b-pagination",{staticClass:"is-right",attrs:{total:t.numSketches,simple:!0,"per-page":t.perPage,size:"is-small"},on:{change:t.paginate},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1)}),f=[],v=s("bc3a"),g=s.n(v),y=s("2c4e"),b=g.a.create({baseURL:"/legacy/api/v1",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}}),C=g.a.create({baseURL:"/legacy/api/v1",responseType:"blob",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}});b.interceptors.response.use((function(t){return t}),(function(t){return"The CSRF token has expired."===t.response.data.message?y["a"].open({message:t.response.data.message,type:"is-white",position:"is-top",actionText:"Refresh",indefinite:!0,onAction:function(){location.reload()}}):(console.error(t.response.data),y["a"].open({message:'Error: "'.concat(t.message,'" (see console for details)'),type:"is-danger",position:"is-top",actionText:"Close",duration:7e3})),Promise.reject(t)}));var w={getSketchList:function(t,e,s){var i={params:{scope:t,page:e,search_query:s}};return b.get("/sketches/",i)},getSketch:function(t){return b.get("/sketches/"+t+"/")},createSketch:function(t){return b.post("/sketches/",t)},deleteSketch:function(t){return b.delete("/sketches/"+t+"/")},archiveSketch:function(t){var e={action:"archive"};return b.post("/sketches/"+t+"/archive/",e)},unArchiveSketch:function(t){var e={action:"unarchive"};return b.post("/sketches/"+t+"/archive/",e)},exportSketch:function(t){var e={action:"export"};return C.post("/sketches/"+t+"/archive/",e)},getSketchAttributes:function(t){return b.get("/sketches/"+t+"/attribute/")},addSketchAttribute:function(t,e,s,i){var a={name:e,values:[s],ontology:i,action:"post"};return b.post("/sketches/"+t+"/attribute/",a)},getSketchTimeline:function(t,e){return b.get("/sketches/"+t+"/timelines/"+e+"/")},getSketchTimelineAnalysis:function(t,e){return b.get("/sketches/"+t+"/timelines/"+e+"/analysis/")},saveSketchTimeline:function(t,e,s,i,a){var n={name:s,description:i,color:a};return b.post("/sketches/"+t+/timelines/+e+"/",n)},saveSketchSummary:function(t,e,s){var i={name:e,description:s};return b.post("/sketches/"+t+"/",i)},deleteSketchTimeline:function(t,e){return b.delete("/sketches/"+t+/timelines/+e+"/")},getEvent:function(t,e,s){var i={params:{searchindex_id:e,event_id:s}};return b.get("/sketches/"+t+"/event/",i)},saveEventAnnotation:function(t,e,s,i,a){var n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r={annotation:s,annotation_type:e,events:i,current_search_node_id:a.id,remove:n};return b.post("/sketches/"+t+"/event/annotate/",r)},updateEventAnnotation:function(t,e,s,i,a){var n={annotation:s,annotation_type:e,events:i,current_search_node_id:a.id};return b.put("/sketches/"+t+"/event/annotate/",n)},deleteEventAnnotation:function(t,e,s,i,a){var n={params:{annotation_id:s,annotation_type:e,event_id:i._id,searchindex_id:i._index,current_search_node_id:a.id}};return b.delete("/sketches/"+t+"/event/annotate/",n)},getStoryList:function(t){return b.get("sketches/"+t+"/stories/")},getStory:function(t,e){return b.get("/sketches/"+t+"/stories/"+e+"/")},createStory:function(t,e,s){var i={title:t,content:e};return b.post("/sketches/"+s+/stories/,i)},updateStory:function(t,e,s,i){var a={title:t,content:e};return b.post("/sketches/"+s+/stories/+i+"/",a)},deleteStory:function(t,e){return b.delete("/sketches/"+t+/stories/+e+"/")},getView:function(t,e){return b.get("/sketches/"+t+"/views/"+e+"/")},createView:function(t,e,s,i){var a={name:e,query:s,filter:i,dsl:""};return b.post("/sketches/"+t+/views/,a)},updateView:function(t,e,s,i){var a={query:s,filter:i};return b.post("/sketches/"+t+/views/+e+"/",a)},deleteView:function(t,e){return b.delete("/sketches/"+t+"/views/"+e+"/")},search:function(t,e){return b.post("/sketches/"+t+"/explore/",e)},exportSearchResult:function(t,e){return C.post("/sketches/"+t+"/explore/",e)},getAggregations:function(t){return b.get("/sketches/"+t+"/aggregation/")},getAggregationGroups:function(t){return b.get("/sketches/"+t+"/aggregation/group/")},runAggregator:function(t,e){return b.post("/sketches/"+t+"/aggregation/explore/",e)},runAggregatorGroup:function(t,e){return b.get("/sketches/"+t+"/aggregation/group/"+e+"/")},saveAggregation:function(t,e,s,i){var a={name:s,description:e.description,agg_type:e.name,chart_type:i["supported_charts"],parameters:i};return b.post("/sketches/"+t+"/aggregation/",a)},countSketchEvents:function(t){return b.get("/sketches/"+t+"/count/")},uploadTimeline:function(t,e){return b.post("/upload/",t,e)},getSessions:function(t,e){return b.get("/sketches/"+t+"/explore/sessions/"+e+"/")},getUsers:function(){return b.get("/users/")},getGroups:function(){return b.get("/groups/")},editCollaborators:function(t,e,s,i,a,n){var r={public:e,users:s,groups:i,remove_users:a,remove_groups:n};return b.post("/sketches/"+t+/collaborators/,r)},getAnalyzers:function(t){return b.get("/sketches/"+t+"/analyzer/")},runAnalyzers:function(t,e,s){var i={timeline_ids:e,analyzer_names:s};return b.post("/sketches/"+t+/analyzer/,i)},getAnalyzerSession:function(t,e){return b.get("/sketches/"+t+"/analyzer/sessions/"+e+"/")},getActiveAnalyzerSessions:function(t){return b.get("/sketches/"+t+"/analyzer/sessions/active/")},getLoggedInUser:function(){return b.get("/users/me/")},generateGraphFromPlugin:function(t,e,s,i,a){var n={plugin:e,config:{filter:{indices:s,timelineIds:i}},refresh:a};return i.length&&(n["timeline_ids"]=i),b.post("/sketches/"+t+/graph/,n)},getGraphPluginList:function(){return b.get("/graphs/")},saveGraph:function(t,e,s){var i={name:e,elements:s};return b.post("/sketches/"+t+/graphs/,i)},getSavedGraphList:function(t){return b.get("/sketches/"+t+/graphs/)},getSavedGraph:function(t,e){var s={params:{format:"cytoscape"}};return b.get("/sketches/"+t+/graphs/+e+"/",s)},getSearchHistory:function(t){return b.get("/sketches/"+t+/searchhistory/)},getSearchHistoryTree:function(t){return b.get("/sketches/"+t+/searchhistorytree/)},getSigmaRuleList:function(){return b.get("/sigmarules/")},getSigmaRuleResource:function(t){return b.get("/sigmarules/"+t+"/")},getSigmaRuleByText:function(t){var e={content:t};return b.post("/sigmarules/text/",e)},deleteSigmaRule:function(t){return b.delete("/sigmarules/"+t+"/")},createSigmaRule:function(t){var e={rule_yaml:t};return b.post("/sigmarules/",e)},updateSigmaRule:function(t,e){var s={id:t,rule_yaml:e};return b.put("/sigmarules/"+t+"/",s)},getTagMetadata:function(){return b.get("/intelligence/tagmetadata/")}},k={props:["scope","searchQuery"],data:function(){return{sketches:[],numSketches:0,currentPage:1,perPage:10}},methods:{getSketches:function(){var t=this;w.getSketchList(this.scope,this.currentPage,this.searchQuery).then((function(e){t.sketches=e.data.objects,t.numSketches=e.data.meta.total_items})).catch((function(t){console.error(t)}))},paginate:function(){this.getSketches()}},created:function(){this.getSketches()},watch:{searchQuery:function(){"search"===this.scope&&this.getSketches()}}},S=k,x=(s("e8df"),Object(c["a"])(S,m,f,!1,null,"014f3ae4",null)),T=x.exports,A=function(){var t=this,e=t._self._c;return e("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v("Name")]),e("div",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Name your sketch",autofocus:""},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}})])]),e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v("Description (optional)")]),e("div",{staticClass:"control"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.description,expression:"form.description"}],staticClass:"textarea",attrs:{placeholder:"Describe your sketch"},domProps:{value:t.form.description},on:{input:function(e){e.target.composing||t.$set(t.form,"description",e.target.value)}}})])]),t._m(0)])},O=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save"}})])])}],D={data:function(){return{form:{name:"",description:""}}},methods:{clearFormData:function(){this.form.name="",this.form.description=""},submitForm:function(){var t=this,e={name:this.form.name,description:this.form.description};w.createSketch(e).then((function(e){var s=e.data.objects[0].id;t.clearFormData(),t.$router.push({name:"Overview",params:{sketchId:s}})})).catch((function(t){}))}}},E=D,$=Object(c["a"])(E,A,O,!1,null,null,null),F=$.exports,N=s("f7e3"),I={components:{TsNavbarMain:N["default"],TsSketchList:T,TsCreateSketchForm:F},data:function(){return{showSketchCreateModal:!1,allSketches:[],mySketches:[],myArchivedSketches:[],sharedSketches:[],loading:!0,isFullPage:!0,loadingComponent:null,searchQuery:"",newSearchQuery:""}},computed:{filteredList:function(){var t=this;return this.allSketches.filter((function(e){return e.name.toLowerCase().includes(t.search.toLowerCase())}))}},methods:{loadingOpen:function(){this.loading=!0,this.loadingComponent=this.$buefy.loading.open({container:this.isFullPage?null:this.$refs.element.$el})},loadingClose:function(){this.loading=!1,this.loadingComponent.close()},search:function(){this.newSearchQuery=this.searchQuery}},created:function(){this.$store.dispatch("resetState"),document.title="Timesketch"}},M=I,P=Object(c["a"])(M,h,p,!1,null,null,null),L=P.exports,j=function(){var t=this,e=t._self._c;return t.sketch.status?e("router-view"):t._e()},R=[],z={props:["sketchId"],created:function(){this.$store.dispatch("updateSketch",this.sketchId),this.$store.dispatch("updateSearchHistory",this.sketchId),this.$store.dispatch("updateSigmaList",this.sketchId)},computed:{sketch:function(){return this.$store.state.sketch}},watch:{sketch:function(t){"archived"===t.status[0].status&&this.$router.push({name:"Overview",params:{sketchId:this.sketch.id}}),document.title=this.sketch.name}}},Q=z,H=Object(c["a"])(Q,j,R,!1,null,null,null),G=H.exports,q=function(){var t=this,e=t._self._c;return t.sketch.status?e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}],null,!1,4238446144)}),t.isArchived?e("div",{staticClass:"task-container columns is-multiline",staticStyle:{"margin-top":"50px"}},[e("div",{staticClass:"card column is-half is-offset-one-quarter has-text-centered",staticStyle:{"min-height":"300px","padding-top":"90px"}},[e("h4",{staticClass:"title is-4"},[t._v(t._s(t.sketch.name))]),e("p",[t._v("This sketch has been archived")]),e("div",{staticClass:"buttons is-centered",staticStyle:{"margin-top":"30px"}},[e("button",{staticClass:"button is-success is-outlined",on:{click:function(e){return t.unArchiveSketch()}}},[t._v("Unarchive")]),e("button",{staticClass:"button is-link is-outlined",on:{click:function(e){return t.exportSketch()}}},[t._v("Export")])])])]):t._e(),t.isArchived?t._e():e("div",[e("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"overview"}},[t._l(t.meta.sketch_labels,(function(s){return e("span",{key:s,staticStyle:{"margin-right":"10px",color:"var(--default-font-color)","font-size":"0.7em"}},[t._v(t._s(s))])})),t.meta.collaborators?e("b-tooltip",{attrs:{label:t.shareTooltip,position:"is-bottom",type:"is-white"}},[t.meta.permissions.write?e("a",{staticClass:"button is-info is-small",staticStyle:{"margin-right":"10px","border-radius":"4px"},on:{click:function(e){t.showShareModal=!t.showShareModal}}},[e("span",{staticClass:"icon is-small"},[t.meta.permissions.public?e("i",{staticClass:"fas fa-globe"}):t.meta.collaborators.users.length||t.meta.collaborators.groups.length?e("i",{staticClass:"fas fa-users"}):t.meta.permissions.public?t._e():e("i",{staticClass:"fas fa-lock"})]),e("span",[t._v("Share")])]):t._e()]):t._e(),t.meta.permissions.write?e("ts-dropdown",{attrs:{position:"is-bottom-left"},scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("a",{staticClass:"button ts-dropdown-button is-small",staticStyle:{background:"transparent",border:"none","margin-right":"-18px"}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-angle-down"})]),e("span",[t._v("More")])])]},proxy:!0}],null,!1,4256829278)},[t.meta.permissions.delete?e("div",{staticClass:"ts-dropdown-item",attrs:{"aria-role":"listitem"}},[e("span",{on:{click:function(e){t.showDeleteSketchModal=!t.showDeleteSketchModal}}},[e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[e("i",{staticClass:"fas fa-trash"})]),e("span",[t._v("Delete")])])]):t._e(),t.meta.permissions.delete?e("div",{staticClass:"ts-dropdown-item",attrs:{"aria-role":"listitem"}},[e("a",{on:{click:function(e){return t.archiveSketch()}}},[e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[e("i",{staticClass:"fas fa-archive"})]),e("span",[t._v("Archive")])])]):t._e(),t.meta.permissions.read?e("div",{staticClass:"ts-dropdown-item",attrs:{"aria-role":"listitem"}},[e("a",{on:{click:function(e){return t.exportSketch()}}},[e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[e("i",{staticClass:"fas fa-file-export"})]),e("span",[t._v("Export")])])]):t._e()]):t._e()],2),e("b-modal",{attrs:{active:t.showShareModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showShareModal=e}}},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Share sketch")])]),e("div",{staticClass:"card-content"},[e("div",{staticClass:"content"},[e("ts-share-form",{on:{closeShareModal:t.closeShareModal}})],1)])])]),e("b-modal",{attrs:{active:t.showUploadTimelineModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showUploadTimelineModal=e}}},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Upload new timeline")])]),e("div",{staticClass:"card-content"},[e("div",{staticClass:"content"},[e("p",[t._v("\n              Supported formats are Plaso storage file, JSON(L), or a CSV file. If you are uploading a CSV or JSON(L)\n              file make sure to read the\n              "),e("a",{attrs:{href:"https://github.com/google/timesketch/blob/master/docs/guides/user/import-from-json-csv.md",rel:"noreferrer",target:"_blank"}},[t._v("documentation")]),t._v("\n              to learn what columns are needed.\n            ")]),e("ts-upload-timeline-form",{on:{toggleModal:function(e){t.showUploadTimelineModal=!t.showUploadTimelineModal}}})],1)])])]),e("b-modal",{attrs:{active:t.showDeleteSketchModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showDeleteSketchModal=e}}},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Delete sketch")])]),e("div",{staticClass:"card-content"},[e("div",{staticClass:"content"},[e("p",[t._v("Are you sure you want to delete this sketch?")]),e("div",{staticClass:"field is-grouped"},[e("p",{staticClass:"control"},[e("button",{staticClass:"button is-danger",on:{click:t.deleteSketch}},[e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[e("i",{staticClass:"fas fa-trash"})]),e("span",[t._v("Delete")])])]),e("p",{staticClass:"control"},[e("button",{staticClass:"button",on:{click:function(e){t.showDeleteSketchModal=!t.showDeleteSketchModal}}},[e("span",[t._v("I changed my mind, keep the sketch!")])])])])])])])]),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"tile is-ancestor"},[e("div",{staticClass:"tile is-8 is-parent"},[e("div",{staticClass:"tile is-child tile-box"},[e("div",{staticClass:"card-content"},[e("ts-sketch-summary",{attrs:{sketch:t.sketch}})],1)])]),e("div",{staticClass:"tile is-parent"},[e("div",{staticClass:"tile is-child tile-box"},[t._m(0),e("div",{staticClass:"card-content"},[e("div",{staticClass:"block-condensed"},[e("span",{staticStyle:{"font-weight":"bold"}},[t._v("Creator:")]),t._v(" "+t._s(t.sketch.user.username)+"\n                ")]),t.sortedUserList().length?e("div",{staticClass:"block-condensed"},[e("span",{staticStyle:{"font-weight":"bold"}},[t._v("Shared with user:")]),t._l(t.sortedUserList(),(function(s){return e("span",{key:s.name},[t._v("\n                    "+t._s(s)+"\n                  ")])}))],2):t._e(),t.sortedGroupList().length?e("div",{staticClass:"block-condensed"},[e("span",{staticStyle:{"font-weight":"bold"}},[t._v("Shared with group:")]),t._l(t.sortedGroupList(),(function(s){return e("span",{key:s.name},[t._v("\n                    "+t._s(s)+"\n                  ")])}))],2):t._e()]),t.sketch.active_timelines.length?e("div",{staticClass:"card-header"}):t._e(),t.sketch.active_timelines.length?e("div",{staticClass:"card-content"},[e("ts-sketch-metrics",{attrs:{timelines:t.sketch.active_timelines,views:t.meta.views,stories:t.meta.stories,count:t.count}})],1):t._e()])])])])]),t.sketch.timelines&&t.sketch.timelines.length&&t.sketch.timelines.length?e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"tile is-ancestor"},[e("div",{staticClass:"tile is-vertical is-12"},[e("div",{staticClass:"tile"},[e("div",{staticClass:"tile is-parent is-vertical"},[t.sketch.timelines&&t.sketch.timelines.length&&t.sketch.timelines.length?e("div",{staticClass:"tile is-child tile-box"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Timelines")]),e("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{padding:"0.75rem"}},[t.meta.permissions.write?e("div",{staticClass:"control"},[e("div",{staticClass:"button is-success is-rounded is-small",on:{click:function(e){t.showUploadTimelineModal=!t.showUploadTimelineModal}}},[t._m(1),e("span",[t._v("Upload timeline")])])]):t._e()])]),e("div",{staticStyle:{padding:"1.25em"}},[e("ts-timeline-list",{attrs:{timelines:t.sketch.timelines,controls:!1,"is-compact":!0}})],1)]):t._e(),t.meta.stories.length?e("div",{staticClass:"tile is-child tile-box"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Stories")]),e("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{padding:"0.75rem"}},[e("p",{staticClass:"control"},[e("router-link",{staticClass:"button is-rounded is-small is-success",attrs:{to:{name:"StoryOverview"}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-plus-circle"})]),e("span",[t._v("Create story")])])],1)])]),e("div",{staticStyle:{padding:"1.25em"}},[t.meta.stories.length?t._e():e("span",[t._v("No stories")]),e("ts-sketch-story-list",{attrs:{controls:!1}})],1)]):t._e()]),e("div",{staticClass:"tile is-parent is-vertical"},[t.meta.views.length||t.sketch.graphs.length?t._e():e("div",{staticClass:"tile is-child tile-box"},[t._m(2),e("div",{staticStyle:{padding:"1.25em"}},[e("p",[t._v("\n                      Welcome to your new investigation. You get started by navigating to the\n                      "),e("router-link",{staticStyle:{"text-decoration":"underline"},attrs:{to:{name:"Explore"}}},[t._v("explore page")]),t._v("\n                      where you can navigate your timelines, use search queries, apply filters, view timeline data and\n                      save your search discoveries as new saved searches.\n                    ")],1),e("br"),e("router-link",{staticClass:"button is-success",attrs:{to:{name:"Explore"}}},[e("span",[t._v("Begin to explore your data")]),e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-chevron-circle-right"})])])],1)]),t.meta.views.length?e("div",{staticClass:"tile is-child tile-box"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Saved searches")]),e("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{padding:"0.75rem"}},[t.meta.views.length?e("p",{staticClass:"control"},[e("router-link",{staticClass:"button is-rounded is-small",attrs:{to:{name:"SavedSearches"}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-cog"})]),e("span",[t._v("Manage")])])],1):t._e()])]),e("div",{staticStyle:{padding:"1.25em"}},[t.meta.views.length?t._e():e("span",[t._v("No saved searches")]),e("ts-saved-view-list",{attrs:{views:t.meta.views}})],1)]):t._e(),t.sketch.graphs.length?e("div",{staticClass:"tile is-child tile-box"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Saved graphs")]),e("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{padding:"0.75rem"}},[e("p",{staticClass:"control"},[e("router-link",{staticClass:"button is-rounded is-small is-success",attrs:{to:{name:"GraphOverview"}}},[e("span",[t._v("Explore all graphs")]),e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-chevron-circle-right"})])])],1)])]),e("div",{staticStyle:{padding:"1.25em"}},[e("ts-graph-list")],1)]):t._e()])])])])])]):t._e(),t.sketch.timelines.length?t._e():e("ts-sketch-timelines-manage",{attrs:{"hide-navigation":!0}})],1)],1):t._e()},V=[function(){var t=this,e=t._self._c;return e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Metadata")])])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-upload"})])},function(){var t=this,e=t._self._c;return e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Get started!")]),e("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{padding:"0.75rem"}})])}],U=(s("55dd"),s("75fc")),Y=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticStyle:{"font-size":"var(--font-size-title)","margin-bottom":"10px"},attrs:{contenteditable:t.meta.permissions.write},domProps:{textContent:t._s(t.sketch.name)},on:{blur:t.onEditTitle,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.onEditTitle.apply(null,arguments))}}}),e("p",{staticStyle:{"max-width":"75ch"},attrs:{contenteditable:t.meta.permissions.write},domProps:{textContent:t._s(t.sketch.description)},on:{blur:t.onEditDescription,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.onEditDescription.apply(null,arguments))}}})])},W=[],B={computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{onEditTitle:function(t){this.sketch.name=t.target.innerText,this.saveSketchSummary()},onEditDescription:function(t){this.sketch.description=t.target.innerText,this.saveSketchSummary()},saveSketchSummary:function(){w.saveSketchSummary(this.sketch.id,this.sketch.name,this.sketch.description).then((function(t){})).catch((function(t){console.error(t)}))}}},J=B,Z=Object(c["a"])(J,Y,W,!1,null,null,null),K=Z.exports,X=function(){var t=this,e=t._self._c;return e("nav",{staticClass:"level"},[e("div",{staticClass:"level-item has-text-centered"},[e("div",[e("p",{staticClass:"heading"},[t._v("Timelines")]),e("p",{staticClass:"title"},[t._v(t._s(t.timelines&&t.timelines.length?t.timelines.length:0))])])]),e("div",{staticClass:"level-item has-text-centered"},[e("div",[e("p",{staticClass:"heading"},[t._v("Views")]),e("p",{staticClass:"title"},[t._v(t._s(t.views&&t.views.length?t.views.length:0))])])]),e("div",{staticClass:"level-item has-text-centered"},[e("div",[e("p",{staticClass:"heading"},[t._v("Stories")]),e("p",{staticClass:"title"},[t._v(t._s(t.views&&t.stories.length?t.stories.length:0))])])]),e("div",{staticClass:"level-item has-text-centered"},[e("div",[e("p",{staticClass:"heading"},[t._v("Events")]),e("p",{staticClass:"title"},[t._v(t._s(t._f("compactNumber")(t.count)))])])])])},tt=[],et={props:["timelines","views","stories","count"]},st=et,it=Object(c["a"])(st,X,tt,!1,null,null,null),at=it.exports,nt=function(){var t=this,e=t._self._c;return e("ul",{staticClass:"content-list"},[t._l(t.timelineList,(function(s){return e("li",{key:s.id,staticStyle:{padding:"10px"}},[e("ts-timeline-list-item",{attrs:{timeline:s,controls:t.controls,"is-compact":t.isCompact},on:{remove:function(e){return t.remove(s)},save:t.save}})],1)})),t.timelines.length>9?e("li",{staticStyle:{padding:"10px",cursor:"pointer"}},[t.showAllTimelines?t._e():e("span",{on:{click:function(e){t.showAllTimelines=!0}}},[t._v("Show more ("+t._s(t.sketch.timelines.length-10)+")")]),t.showAllTimelines?e("span",{on:{click:function(e){t.showAllTimelines=!1}}},[t._v("Show less")]):t._e()]):t._e()],2)},rt=[],ot=function(){var t=this,e=t._self._c;return e("div",[e("b-modal",{staticStyle:{"z-index":"999"},attrs:{active:t.showInfoModal,width:1024,scroll:"keep"},on:{"update:active":function(e){t.showInfoModal=e}}},[e("div",{staticClass:"modal-background"}),e("div",{staticClass:"modal-content"},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Detailed information for "+t._s(t.timeline.name))])]),e("div",{staticClass:"card-content"},[e("ul",[e("li",[t._v("Elasticsearch index: "+t._s(t.timeline.searchindex.index_name))]),t.meta.stats_per_timeline[t.timeline.id]?e("li",[t._v("\n              Number of events: "+t._s(t._f("compactNumber")(t.meta.stats_per_timeline[t.timeline.id]["count"]))+" ("+t._s(t.meta.stats_per_timeline[t.timeline.id]["count"])+")\n            ")]):t._e(),e("li",[t._v("Created by: "+t._s(t.timeline.user.username))]),e("li",[t._v("Created at: "+t._s(t._f("moment")(t.timeline.created_at,"YYYY-MM-DD HH:mm")))])]),e("br"),t._l(t.timeline.datasources,(function(s){return e("b-message",{key:s.id,attrs:{type:s.error_message?"is-danger":"is-success",title:s.created_at,closable:!1}},[e("ul",[e("li",[e("strong",[t._v("Provider:")]),t._v(" "+t._s(s.provider))]),e("li",[e("strong",[t._v("Context:")]),t._v(" "+t._s(s.context))]),e("li",[e("strong",[t._v("User:")]),t._v(" "+t._s(s.user.username))]),e("li",[e("strong",[t._v("File on disk:")]),t._v(" "+t._s(s.file_on_disk))]),e("li",[e("strong",[t._v("File size:")]),t._v(" "+t._s(t._f("compactBytes")(s.file_size)))]),e("li",[e("strong",[t._v("Original filename:")]),t._v(" "+t._s(s.original_filename))]),e("li",[e("strong",[t._v("Data label:")]),t._v(" "+t._s(s.data_label))])]),e("br"),s.error_message?e("div",[e("strong",{staticStyle:{"font-size":"1.2rem","margin-bottom":"10px"}},[t._v("Error detail")]),e("pre",{staticStyle:{"margin-top":"10px"}},[t._v(t._s(s.error_message))])]):t._e()])}))],2)])]),e("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){t.showInfoModal=!t.showInfoModal}}})]),e("b-modal",{staticStyle:{"z-index":"999"},attrs:{active:t.showEditModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showEditModal=e}}},[e("div",{staticClass:"modal-background"}),e("div",{staticClass:"modal-content"},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Rename timeline")])]),e("div",{staticClass:"card-content"},[e("div",{staticClass:"content"},[e("form",{on:{submit:function(t){t.preventDefault()}}},[e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.newTimelineName,expression:"newTimelineName"}],staticClass:"input",attrs:{type:"text",required:"",autofocus:""},domProps:{value:t.newTimelineName},on:{input:function(e){e.target.composing||(t.newTimelineName=e.target.value)}}})])]),e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save"},on:{click:t.saveTimeline}})])])])])])])]),e("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){t.showEditModal=!t.showEditModal}}})]),e("b-modal",{staticStyle:{"z-index":"999"},attrs:{active:t.showAnalyzerModal,width:1024,scroll:"keep"},on:{"update:active":function(e){t.showAnalyzerModal=e}}},[e("div",{staticClass:"modal-background"}),e("div",{staticClass:"modal-content"},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Analyzer logs for "+t._s(t.timeline.name))])]),t.showAnalyzerModal?e("div",{staticClass:"card-content"},[e("ts-analyzer-history",{attrs:{timeline:t.timeline,isModal:"true"},on:{closeHistory:function(e){t.showAnalyzerModal=!1}}})],1):t._e()])]),e("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){t.showAnalyzerModal=!t.showAnalyzerModal}}})]),"processing"===t.timelineStatus?e("div",{staticClass:"ts-timeline-color-box is-pulled-left blink",staticStyle:{"background-color":"#f5f5f5"}}):"fail"===t.timelineStatus?e("div",{staticClass:"ts-timeline-color-box is-pulled-left",staticStyle:{"background-color":"#f5f5f5"},on:{click:function(e){t.showInfoModal=!t.showInfoModal}}}):"ready"===t.timelineStatus&&t.controls?e("div",{staticClass:"dropdown is-pulled-left",class:{"is-active":t.colorPickerActive}},[e("div",{staticClass:"dropdown-trigger"},[e("div",{staticClass:"ts-timeline-color-box",style:t.timelineColorStyle,on:{click:function(e){t.colorPickerActive=!t.colorPickerActive}}})]),e("div",{staticClass:"dropdown-menu",attrs:{id:"dropdown-menu",role:"menu"}},[e("div",{staticClass:"dropdown-content",staticStyle:{padding:"0"}},[e("div",{staticClass:"dropdown-item",staticStyle:{padding:"0"}},[e("color-picker",{on:{input:t.updateColor},model:{value:t.initialColor,callback:function(e){t.initialColor=e},expression:"initialColor"}})],1)])])]):"ready"===t.timelineStatus?e("div",{staticClass:"ts-timeline-color-box is-pulled-left",style:t.timelineColorStyle,on:{click:function(e){t.colorPickerActive=!t.colorPickerActive}}}):e("div",{staticClass:"ts-timeline-color-box is-pulled-left",staticStyle:{"background-color":"#f5f5f5"}}),e("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{"margin-top":"7px"}},[t.meta.permissions.write?e("span",{on:{click:function(t){t.stopPropagation()}}},[e("ts-dropdown",{attrs:{width:"270px"},scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("a",{attrs:{role:"button"}},[e("i",{staticClass:"fas fa-ellipsis-v",staticStyle:{"padding-left":"14px"}})])]},proxy:!0}],null,!1,4034084509)},[e("div",{staticClass:"ts-dropdown-item",on:{click:function(e){t.showInfoModal=!t.showInfoModal}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-info-circle"})]),e("span",[t._v("Info")])]),"ready"===t.timelineStatus?e("div",{staticClass:"ts-dropdown-item",on:{click:function(e){t.showEditModal=!t.showEditModal}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-edit"})]),e("span",[t._v("Rename")])]):t._e(),"ready"===t.timelineStatus?e("div",{staticClass:"ts-dropdown-item",on:{click:function(e){t.showAnalyzerModal=!t.showAnalyzerModal}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-history"})]),e("span",[t._v("Analyzer logs")])]):t._e(),e("div",{staticClass:"ts-dropdown-item",on:{click:function(e){return t.remove()}}},[e("span",{staticClass:"icon is-small is-danger"},[e("i",{staticClass:"fas fa-trash"})]),e("span",[t._v("Delete")])]),e("hr"),"ready"===t.timelineStatus?e("div",[e("color-picker",{staticStyle:{"box-shadow":"none","background-color":"transparent",padding:"0"},attrs:{palette:t.colorPickerPalette},on:{input:t.updateColor},model:{value:t.initialColor,callback:function(e){t.initialColor=e},expression:"initialColor"}})],1):t._e()])],1):t._e()]),t.controls?t._e():e("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{"margin-top":"10px"}},[e("span",{staticClass:"is-size-7"},[t._v(t._s(t._f("moment")(t.timeline.updated_at,"YYYY-MM-DD HH:mm")))])]),t.controls?e("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{"margin-top":"10px"}},[t.isCompact?t._e():e("p",{staticClass:"control"},[e("button",{staticClass:"button is-rounded is-small is-outlined",on:{click:function(e){t.showInfoModal=!t.showInfoModal}}},[t._m(0),e("span",[t._v("Info")])])]),t.meta.permissions.write&&"ready"===t.timelineStatus&&t.controls?e("p",{staticClass:"control"},[e("button",{staticClass:"button is-rounded is-small is-outlined",on:{click:function(e){t.showEditModal=!t.showEditModal}}},[t._m(1),e("span",[t._v("Rename")])])]):t._e(),"ready"===t.timelineStatus&&t.controls?e("p",{staticClass:"control"},[e("button",{staticClass:"button is-small is-rounded is-outlined",on:{click:function(e){t.showAnalysisHistory=!t.showAnalysisHistory}}},[t._m(2),e("span",[t._v("Analysis History")])])]):t._e(),t.meta.permissions.write&&t.controls?e("p",{staticClass:"control"},[e("button",{staticClass:"button is-small is-rounded is-danger",on:{click:function(e){return t.remove(t.timeline)}}},[t._m(3),e("span",[t._v("Remove")])])]):t._e()]):t._e(),"ready"===t.timelineStatus?e("router-link",{attrs:{to:{name:"Explore",query:{timeline:t.timeline.id}}}},[t._v(t._s(t.timeline.name))]):t._e(),"ready"!==t.timelineStatus?e("span",[t._v(t._s(t.timeline.name))]):t._e(),e("br"),"ready"===t.timelineStatus?e("span",{staticClass:"is-size-7"},[e("span",{staticClass:"is-small",attrs:{title:t.meta.stats_per_timeline[t.timeline.id]["count"]+" events in index"}},[t._v(t._s(t._f("compactNumber")(t.meta.stats_per_timeline[t.timeline.id]["count"]))+" events")]),t.timeline.datasources.length>1?e("span",[t._v("\n      ("+t._s(t.timeline.datasources.length)+" imports:\n      "),e("span",{staticStyle:{cursor:"pointer","text-decoration":"underline"},on:{click:function(e){t.showInfoModal=!t.showInfoModal}}},[t._v("details")]),t._v(")")]):t._e(),1===t.timeline.datasources.length?e("span",[t._v(" (imported with "+t._s(t.timeline.datasources[0].provider)+")")]):t._e(),t.datasourceErrors.length?e("span",{staticStyle:{"margin-left":"10px"}},[t._m(4),e("span",{staticStyle:{cursor:"pointer","text-decoration":"underline","margin-left":"5px"},on:{click:function(e){t.showInfoModal=!t.showInfoModal}}},[t._v(t._s(t.datasourceErrors.length)+" failed imports")])]):t._e()]):"fail"===t.timelineStatus?e("span",{staticClass:"is-size-7"},[t._m(5),t._v("\n    ERROR:\n    "),e("span",{staticStyle:{cursor:"pointer","text-decoration":"underline"},on:{click:function(e){t.showInfoModal=!t.showInfoModal}}},[t._v("Click here for details")])]):"processing"===t.timelineStatus?e("span",{staticClass:"is-size-7"},[t._v("\n    Indexing in progress...\n  ")]):e("span",{staticClass:"is-size-7"},[t._v(" Unknown status: "+t._s(t.timelineStatus)+" ")]),t.showAnalysisHistory?e("div",[e("ts-analyzer-history",{attrs:{timeline:t.timeline},on:{closeHistory:function(e){t.showAnalysisHistory=!1}}})],1):t._e()],1)},ct=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-info-circle"})])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-edit"})])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-history"})])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-trash"})])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small",staticStyle:{color:"orange"}},[e("i",{staticClass:"fas fa-exclamation-triangle"})])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small",staticStyle:{color:"var(--font-color-red)"}},[e("i",{staticClass:"fas fa-exclamation-triangle"})])}],lt=(s("f559"),s("c345")),ut=s("2ef0"),dt=s.n(ut),ht=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card card-accent-background",staticStyle:{"margin-top":"15px"}},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("\n      Analysis history\n    ")]),t.isModal?e("span",{staticClass:"card-header-icon",attrs:{"aria-label":"close"}},[e("span",{staticClass:"delete",on:{click:function(e){return t.$emit("closeHistory")}}})]):t._e()]),e("div",{staticClass:"card-content"},[t.analyses.length?e("b-table",{attrs:{data:t.analyses,"current-page":t.currentPage,"per-page":t.perPage,paginated:"","pagination-simple":"","pagination-position":"bottom","default-sort-direction":"desc","sort-icon":"arrow-down","sort-icon-size":"is-small","icon-pack":"fas","icon-prev":"chevron-left","icon-next":"chevron-right","default-sort":"created_at"},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}},[e("b-table-column",{attrs:{field:"created_at",label:"Date",width:"150",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("moment")(new Date(e.row.created_at),"YYYY-MM-DD HH:mm:ss"))+"\n      ")]}}],null,!1,66904155)}),e("b-table-column",{attrs:{field:"name",label:"Analyzer",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.analyzer_name)+"\n      ")]}}],null,!1,2798663795)}),e("b-table-column",{attrs:{field:"result",label:"Result",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.result)+"\n      ")]}}],null,!1,656249812)}),e("b-table-column",{attrs:{field:"status",label:"Status",sortable:"",width:"40"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.status[0].status)+"\n      ")]}}],null,!1,3012980133)})],1):t._e(),t.analyses&&t.analyses.length?t._e():e("span",[t._v("No logs available. You need to run one of the analyzers first.")])],1)])},pt=[],mt=(s("ac6a"),{props:["timeline","isModal"],data:function(){return{analyses:[],currentPage:1,perPage:5}},computed:{sketch:function(){return this.$store.state.sketch}},created:function(){var t=this;this.timeline?w.getSketchTimelineAnalysis(this.sketch.id,this.timeline.id).then((function(e){t.analyses=e.data.objects[0]})).catch((function(t){})):this.sketch.timelines.forEach((function(e){w.getSketchTimelineAnalysis(t.sketch.id,e.id).then((function(e){t.analyses=t.analyses.concat(e.data.objects[0])})).catch((function(t){}))}))}}),ft=mt,vt=Object(c["a"])(ft,ht,pt,!1,null,null,null),gt=vt.exports,yt=function(){var t=this,e=t._self._c;return e("b-dropdown",{attrs:{position:t.position,"append-to-body":"","aria-role":"menu"}},[e("span",{attrs:{slot:"trigger"},slot:"trigger"},[t._t("dropdown-trigger-element")],2),e("div",{staticStyle:{"border-radius":"6px","background-color":"var(--dropdown-background-color)",color:"var(--default-font-color)",padding:"16px",border:"1px solid var(--table-cell-border-color)"},style:t.dropdownWidth},[e("b-dropdown-item",{staticStyle:{color:"var(--default-font-color)"},attrs:{paddingless:"",custom:"",focusable:!1}},[t._t("default")],2)],1)])},_t=[],bt={props:{width:{default:"300px",type:String},position:{default:"is-bottom-right",type:String}},computed:{dropdownWidth:function(){var t={width:this.width};return t}}},Ct=bt,wt=Object(c["a"])(Ct,yt,_t,!1,null,null,null),kt=wt.exports,St=["#55efc4","#81ecec","#74b9ff","#a29bfe","#00b894","#00cec9","#0984e3","#6c5ce7","#ffeaa7","#fab1a0","#ff7675","#fd79a8","#fdcb6e","#e17055","#ff4d4d","#fffa65","#e84393","#f6e58d","#ffbe76","#ff7979","#badc58","#dff9fb","#f9ca24","#f0932b","#eb4d4b","#6ab04c","#c7ecee","#7ed6df","#e056fd","#686de0","#95afc0","#22a6b3","#4bcffa","#34e7e4","#0be881","#ffdd59"],xt={components:{"color-picker":lt["Compact"],TsAnalyzerHistory:gt,TsDropdown:kt},props:["timeline","controls","isCompact"],data:function(){return{checkedDataTypes:[],initialColor:{},newColor:"",newTimelineName:"",colorPickerActive:!1,showInfoModal:!1,showEditModal:!1,showAnalyzerModal:!1,analysisSessionId:!1,showAnalysisDetail:!1,showAnalysisHistory:!1,timelineStatus:null,autoRefresh:!1,isOpen:!1,isDarkTheme:!1,colorPickerPalette:St}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},timelineColorStyle:function(){var t=this.newColor||this.timeline.color;return t.startsWith("#")||(t="#"+t),this.isDarkTheme?{"background-color":t,filter:"grayscale(25%)",color:"#333"}:{"background-color":t}},datasourceErrors:function(){return this.timeline.datasources.filter((function(t){return t.error_message}))}},methods:{remove:function(t){confirm("Delete the timeline?")&&this.$emit("remove",t)},updateColor:dt.a.debounce((function(t){this.newColor=t.hex,this.newColor.startsWith("#")&&(this.newColor=this.newColor.substring(1)),i["default"].set(this.timeline,"color",this.newColor),this.$emit("save",this.timeline)}),0),saveTimeline:function(){this.showEditModal=!1,console.log(this.newTimelineName),this.$emit("save",this.timeline,this.newTimelineName)},fetchData:function(){var t=this;w.getSketchTimeline(this.sketch.id,this.timeline.id).then((function(e){t.timelineStatus=e.data.objects[0].status[0].status,"ready"!==t.timelineStatus&&"fail"!==t.timelineStatus?t.autoRefresh=!0:t.autoRefresh=!1,t.$store.dispatch("updateSketch",t.$store.state.sketch.id)})).catch((function(t){}))},openFilteredTimeline:function(t,e){if(0===e.length)return!1;for(var s="",i=0;i<e.length;i++){var a=e[i];0!==i&&(s+=" OR "),s+='data_type:"'+a+'"'}this.$router.push({name:"Explore",query:{index:t,q:s}})},toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme}},mounted:function(){var t=this;window.addEventListener("click",(function(e){t.$el.contains(e.target)||(t.colorPickerActive=!1)}))},created:function(){this.isDarkTheme="dark"===localStorage.theme,gl.$on("isDarkTheme",this.toggleTheme),this.initialColor={hex:this.timeline.color},this.timelineStatus=this.timeline.status[0].status,"ready"!==this.timelineStatus&&"fail"!==this.timelineStatus?this.autoRefresh=!0:this.autoRefresh=!1},beforeDestroy:function(){clearInterval(this.t),this.t=!1},watch:{autoRefresh:function(t){t&&!this.t?this.t=setInterval(function(){this.fetchData(),"ready"!==this.timelineStatus&&"fail"!==this.timelineStatus||(this.autoRefresh=!1)}.bind(this),5e3):(clearInterval(this.t),this.t=!1)}}},Tt=xt,At=(s("d538"),Object(c["a"])(Tt,ot,ct,!1,null,"4b58650c",null)),Ot=At.exports,Dt={components:{TsTimelineListItem:Ot},props:["timelines","controls","isCompact"],data:function(){return{showAllTimelines:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},timelineList:function(){var t=Object(U["a"])(this.timelines);return this.showAllTimelines?t.reverse():this.isCompact&&this.timelines.length>9?t.reverse().slice(0,10):t.reverse()}},methods:{remove:function(t){var e=this;w.deleteSketchTimeline(this.sketch.id,t.id).then((function(t){e.$store.dispatch("updateSketch",e.sketch.id)})).catch((function(t){console.error(t)}))},save:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];w.saveSketchTimeline(this.sketch.id,t.id,s||t.name,t.description,t.color).then((function(){e.$store.dispatch("updateSketch",e.sketch.id).then((function(){}))})).catch((function(t){console.error(t)}))}}},Et=Dt,$t=Object(c["a"])(Et,nt,rt,!1,null,null,null),Ft=$t.exports,Nt=function(){var t=this,e=t._self._c;return e("div",[e("ul",{staticClass:"content-list"},t._l(t.views,(function(s,i){return e("li",{key:s.id,staticStyle:{padding:"10px","border-bottom":"none"}},[e("router-link",{attrs:{to:{name:"Explore",query:{view:s.id}}}},[t._v(t._s(s.name))]),e("br"),t.controls?t._e():e("span",{staticClass:"is-size-7"},[t._v("\n        Created "+t._s(t._f("moment")(s.created_at,"YYYY-MM-DD HH:mm"))+" "),s.user?e("span",[t._v(" by "+t._s(s.user))]):t._e(),s.description?e("span",[t._v(" ("+t._s(s.description)+")")]):t._e()]),t.controls?e("span",{staticClass:"is-size-7"},[e("b",[t._v("Query:")]),t._v(" "+t._s(s.query)+" ")]):t._e(),t.controls?e("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{"margin-top":"-15px"}},[e("p",{staticClass:"control"},[e("button",{staticClass:"button is-small is-rounded is-danger",on:{click:function(e){return t.remove(s,i)}}},[t._m(0,!0),e("span",[t._v("Remove")])])])]):t._e()],1)})),0)])},It=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-trash"})])}],Mt={props:["views","controls"],computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{remove:function(t,e){i["default"].delete(this.views,e),w.deleteView(this.sketch.id,t.id).then((function(t){})).catch((function(t){console.error(t)}))}}},Pt=Mt,Lt=Object(c["a"])(Pt,Nt,It,!1,null,null,null),jt=Lt.exports,Rt=function(){var t=this,e=t._self._c;return e("div",[e("ul",{staticClass:"content-list"},t._l(t.meta.stories,(function(s){return e("li",{key:s.id,staticStyle:{padding:"10px","border-bottom":"none"}},[e("div",[e("router-link",{attrs:{to:{name:"StoryContent",params:{sketchId:t.sketch.id,storyId:s.id}}}},[t._v(t._s(s.title))]),e("div",{staticClass:"field is-grouped is-pulled-right",staticStyle:{"margin-top":"10px"}},[e("p",{staticClass:"control"},[t.controls?e("button",{staticClass:"button is-small is-rounded is-danger",on:{click:function(e){return t.remove(s)}}},[t._m(0,!0),e("span",[t._v("Remove")])]):t._e()])]),e("br"),e("span",{staticClass:"is-size-7"},[t._v("Last activity "+t._s(t._f("moment")(s.updated_at,"YYYY-MM-DD HH:mm")))])],1)])})),0)])},zt=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-trash"})])}],Qt={props:["controls"],data:function(){return{stories:[]}},methods:{remove:function(t){var e=this;w.deleteStory(this.sketch.id,t.id).then((function(t){e.$store.dispatch("updateSketch",e.sketch.id)})).catch((function(t){console.error(t)}))}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}}},Ht=Qt,Gt=Object(c["a"])(Ht,Rt,zt,!1,null,"b1f94040",null),qt=Gt.exports,Vt=function(){var t=this,e=t._self._c;return e("div",[e("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[e("div",{staticClass:"field"},[e("div",{staticClass:"file has-name"},[e("label",{staticClass:"file-label"},[e("input",{staticClass:"file-input",attrs:{id:"datafile",type:"file",name:"resume"},on:{change:function(e){return t.setFile(e.target.files)}}}),t._m(0),t.fileName?e("span",{staticClass:"file-name"},[t.fileName?t._e():e("span",[t._v("Please select a file")]),t._v("\n            "+t._s(t.fileName)+"\n          ")]):t._e()])])]),e("div",{staticClass:"field"},[["json","jsonl","csv"].includes(t.extension)&&""!==t.valuesString?e("div",[e("hr"),e("button",{staticClass:"button is-success",attrs:{type:"button"},on:{click:t.showHelper}},[t._v("\n          "+t._s(t.showHelperFlag?"Hide Helper":"Show Helper"))]),t._v("\n        "),e("button",{staticClass:"button is-success",attrs:{type:"button"},on:{click:t.showPreview}},[t._v("\n          "+t._s(t.showPreviewFlag?"Hide preview":"Show preview"))]),t._v("\n        "),t.showPreviewFlag?e("button",{staticClass:"button is-success",attrs:{type:"button"},on:{click:t.showAddColumn}},[t._v("\n          "+t._s(t.showAddColumnFlag?"Hide colums":"Add Columns"))]):t._e(),e("br"),e("br"),t.showPreviewFlag?e("div",[t._m(1),t.showAddColumnFlag?e("ul",{staticStyle:{"list-style":"none",height:"100px",width:"100%",overflow:"auto"}},t._l(t.allHeaders,(function(s){return e("li",{key:s},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.checkedHeaders,expression:"checkedHeaders"}],attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.checkedHeaders)?t._i(t.checkedHeaders,s)>-1:t.checkedHeaders},on:{change:function(e){var i=t.checkedHeaders,a=e.target,n=!!a.checked;if(Array.isArray(i)){var r=s,o=t._i(i,r);a.checked?o<0&&(t.checkedHeaders=i.concat([r])):o>-1&&(t.checkedHeaders=i.slice(0,o).concat(i.slice(o+1)))}else t.checkedHeaders=n}}}),t._v("\n              "+t._s(s)+"\n            ")])})),0):t._e(),e("br"),e("table",{staticClass:"table is-striped",staticStyle:{width:"100%"},attrs:{id:"example"}},[e("thead",[e("tr",t._l(t.headersTable,(function(s){return e("th",{key:s.name,style:s.color},[t._v("\n                  "+t._s(s.name)+"\n                ")])})),0)]),e("tbody",t._l(t.numberRows,(function(s){return e("tr",{key:s},t._l(t.headersTable,(function(i){return e("td",{key:i.name},[t._v("\n                  "+t._s(i.values[s-1])+"\n                ")])})),0)})),0)])]):t._e(),t.showHelperFlag?e("div",[t._m(2),e("section",{staticClass:"modal-card-body"},[e("div",[t._v("\n              The form below allows you to map the headers in your file to the\n              mandatory ones:\n              "),e("div",{staticClass:"content"},[e("ul",t._l(t.missingHeaders,(function(s){return e("li",{key:s.name},[t._v("\n                    "+t._s(s.name)+"\n                  ")])})),0)]),t._v("\n              You can map a missing header using a dropdown menu or a list of\n              checkboxes.\n              "),t._m(3)])])]):t._e(),e("hr",{staticStyle:{height:"2px","border-width":"0",color:"gray","background-color":"#b5b5b5"}}),t._l(t.missingHeaders,(function(s){return e("div",{key:s.name},[e("span",{staticClass:"tag is-info is-large is-light"},[e("label",[t._v(t._s(s.name))])]),t._v("\n          \n\n          "),"single"===s.type?e("div",{staticClass:"select is-link"},[e("select",{attrs:{name:s.name,id:s.name},on:{change:function(e){return t.changeHeaderMapping(e.target.options[e.target.options.selectedIndex].text,s.name)}}},[e("option",{attrs:{selected:"",disabled:""}},[t._v("-")]),e("option",[t._v("Create new header")]),t._l(t.headers,(function(s){return e("option",{key:s,domProps:{value:s}},[t.mandatoryHeaders.map((function(t){return t.name})).includes(s)?t._e():e("div",[t._v("\n                  "+t._s(s)+"\n                ")])])}))],2)]):t._e(),t._v("\n          \n          "),t.getDefaultValue(s.name)?e("span",{staticClass:"tag is-info is-large is-light"},[e("label",[t._v("Def. Value: "+t._s(t.getDefaultValue(s.name)))])]):t._e(),"multiple"===s.type?e("div",[e("br"),e("ul",{staticClass:"city__list",staticStyle:{"list-style":"none",height:"100px",width:"100%",overflow:"auto"}},t._l(t.headers,(function(i){return e("li",{key:i},[e("input",{attrs:{id:"chk",type:"checkbox",name:s.name},domProps:{value:i},on:{click:function(e){return t.changeHeaderMapping(i,s.name)}}}),t._v("\n                "+t._s(i)+"\n              ")])})),0)]):t._e(),e("hr")])})),"csv"===t.extension?e("div",[e("label",{staticClass:"label"},[t._v("CSV Separator")]),t._l(t.delimitersList,(function(s,i){return e("div",{key:i,staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.CSVDelimiter,expression:"CSVDelimiter"}],attrs:{type:"radio",name:"CSVDelimiter"},domProps:{value:s,checked:t._q(t.CSVDelimiter,s)},on:{change:[function(e){t.CSVDelimiter=s},t.changeCSVDelimiter]}}),t._v("\n            "+t._s(i)+" ("+t._s(s)+")\n          ")])}))],2):t._e()],2):t._e()]),t.fileName?e("div",{staticClass:"field"},[e("hr",{staticStyle:{height:"2px","border-width":"0",color:"gray","background-color":"#b5b5b5"}}),e("label",{staticClass:"label"},[t._v("Name")]),e("div",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Name your timeline"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}})]),e("hr")]):t._e(),t.error.length?e("div",t._l(t.error,(function(s,i){return e("span",{key:i},[e("article",{staticClass:"message is-danger mb-0"},[e("div",{staticClass:"message-body"},[t._v("\n            "+t._s(s)+"\n          ")])])])})),0):e("div",{staticClass:"error"},[t.fileName&&0===t.percentCompleted?e("div",{staticClass:"field"},[t._m(4)]):t._e()])]),e("br"),0!==t.percentCompleted?e("b-progress",{attrs:{value:t.percentCompleted,"show-value":"",format:"percent",type:"is-info",size:"is-medium"}},[100===t.percentCompleted?e("span",[t._v("Waiting for request to finish..")]):t._e()]):t._e()],1)},Ut=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"file-cta"},[e("span",{staticClass:"file-icon"},[e("i",{staticClass:"fas fa-upload"})]),e("span",{staticClass:"file-label"},[t._v(" Choose a file ")])])},function(){var t=this,e=t._self._c;return e("span",[e("article",{staticClass:"message is-info mb-0"},[e("div",{staticClass:"message-body"},[t._v('\n                The columns shown in the preview are only a representation of\n                what will be uploaded on the server. Adding or removing\n                columns using the "Add columns" button does not affect what\n                will be uploaded on the server.\n              ')])])])},function(){var t=this,e=t._self._c;return e("header",{staticClass:"modal-card-head"},[e("p",{staticClass:"modal-card-title"},[t._v("Header Mapping Helper")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"content"},[e("ul",[e("li",[t._v("\n                    Dropdown menu:\n                    "),e("div",{staticClass:"content"},[e("ul",[e("li",[t._v("\n                          Choose one existing header from your CSV. Timesketch\n                          will rename that column with the name of the missing\n                          header.\n                        ")]),e("li",[t._v('\n                          Create a new column by selecting "Create new\n                          header". Timesketch will add a new column with the\n                          name of the missing header. Doing so, you need to\n                          specify a default value that Timesketch will use to\n                          fill the new column.\n                        ')])])])]),e("li",[t._v("\n                    List of checkboxes:\n                    "),e("div",{staticClass:"content"},[e("ul",[e("li",[t._v("\n                          By choosing only one checkbox, Timesketch will\n                          rename that column with the name of the missing\n                          header.\n                        ")]),e("li",[t._v("\n                          By choosing more than one checkbox, Timesketch will\n                          create a new column that combines the different\n                          values of the selected columns.\n                        ")])])])])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"control"},[e("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Upload"}})])}],Yt=(s("6b54"),s("6c7b"),s("7514"),s("5df3"),s("4f7f"),s("456d"),s("28a5"),{data:function(){return{headersString:"",valuesString:[],headersMapping:[],mandatoryHeaders:[{name:"datetime",type:"single"},{name:"message",type:"multiple"},{name:"timestamp_desc",type:"single"}],form:{name:"",file:""},fileName:"",error:[],percentCompleted:0,CSVDelimiter:",",infoMessage:"",delimitersList:{Comma:",",Semicolon:";",Pipe:"|"},showHelperFlag:!1,showPreviewFlag:!1,showAddColumnFlag:!1,checkedHeaders:[],staticNumberRows:3,colors:[{name:"red",value:"background-color: #FEECF0; color:#CC0F35"},{name:"blue",value:"background-color: #EEF6FC; color:#1D72AA"},{name:"green",value:"background-color: #EFFAF3; color:#257942"}]}},computed:{headers:function(){var t=[];return"csv"===this.extension?t=this.headersString.split(this.CSVDelimiter):["json","jsonl"].includes(this.extension)&&(t=Object.keys(this.headersString)),t},missingHeaders:function(){var t=this;return this.mandatoryHeaders.filter((function(e){return t.headers.indexOf(e.name)<0}))},extension:function(){var t=this.fileName.split(".")[1];return t?t.toLowerCase():null},numberRows:function(){if("csv"===this.extension){var t=this.valuesString.indexOf("");return t<0?this.staticNumberRows:t}return["json","jsonl"].includes(this.extension)?this.valuesString.length:0},allHeaders:function(){var t=new Set(this.mandatoryHeaders.map((function(t){return t.name})).concat(this.headers)),e=Object(U["a"])(t);return e},headersTable:function(){var t=this,e={};if("csv"===this.extension)for(var s=this.valuesString.map((function(e){return e.split(t.CSVDelimiter)})),i=0;i<this.headers.length;i++){for(var a=[],n=0;n<s.length;n++)a.push(s[n][i]);e[this.headers[i]]=a}else if(["json","jsonl"].includes(this.extension))for(var r=0;r<this.valuesString.length;r++)for(var o in this.valuesString[r])o in e?e[o].push(this.valuesString[r][o]):e[o]=[this.valuesString[r][o]];var c=this.checkedHeaders;return c.sort().map((function(s){var i="",a=[];if(t.headers.includes(s))a=e[s],i=t.colors.find((function(t){return"blue"===t.name})).value;else{var n=t.headersMapping.find((function(t){return t.target===s}));if(n){if(n.source)if(1===n.source.length)a=e[n.source[0]];else for(var r=n.source,o=function(t){var s="";r.forEach((function(i){s+=i+": ",s+=JSON.stringify(e[i][t])+" | "})),a.push(s)},c=0;c<t.numberRows;c++)o(c);else a=Array(t.numberRows).fill(n.default_value);i=t.colors.find((function(t){return"green"===t.name})).value}else a=Array(t.numberRows).fill("Header not mapped"),i=t.colors.find((function(t){return"red"===t.name})).value}return{name:s,values:a,color:i}}))}},methods:{showHelper:function(){this.showPreviewFlag=!1,this.showAddColumnFlag=!1,this.showHelperFlag=!this.showHelperFlag},showPreview:function(){this.showHelperFlag=!1,this.showPreviewFlag=!this.showPreviewFlag,this.showPreviewFlag||(this.showAddColumnFlag=!1)},showAddColumn:function(){this.showAddColumnFlag=!this.showAddColumnFlag},getDefaultValue:function(t){var e=this.headersMapping.find((function(e){return e["target"]===t}));return e?e["default_value"]:null},changeCSVDelimiter:function(){this.headersMapping=[],this.checkedHeaders=this.mandatoryHeaders.map((function(t){return t.name})),this.validateFile()},changeHeaderMapping:function(t,e){if(t){var s=null,i=this.mandatoryHeaders.filter((function(t){return t.name===e}))[0].type,a=[];if("single"===i){if("Create new header"===t){t=null;do{s=prompt("Insert the default value for this header"),s.includes(this.CSVDelimiter)&&(alert("New header value cannot contain CSV separator (found ".concat(this.CSVDelimiter,")")),s=null)}while(!s)}a=t?[t]:null,this.headersMapping=this.headersMapping.filter((function(t){return t["target"]!==e})),this.headersMapping.push({target:e,source:a,default_value:s})}else{if("multiple"!==i)return;var n=this.headersMapping.find((function(t){return t["target"]===e}));a=n?n["source"]:[],a.includes(t)?a=a.filter((function(e){return e!==t})):a.push(t),this.headersMapping=this.headersMapping.filter((function(t){return t["target"]!==e})),a.length>0&&this.headersMapping.push({target:e,source:a,default_value:s})}this.validateFile()}},clearFormData:function(){this.form.name="",this.form.file="",this.fileName="",this.headersMapping=[],this.infoMessage="",this.headersString="",this.valuesString=[]},submitForm:function(){var t=this;if(this.validateFile()){var e=new FormData;if(e.append("file",this.form.file),e.append("name",this.form.name),e.append("provider","WebUpload"),e.append("context",this.fileName),e.append("total_file_size",this.form.file.size),e.append("sketch_id",this.$store.state.sketch.id),["csv","jsonl","json"].includes(this.extension)){var s=JSON.stringify(this.headersMapping);e.append("headersMapping",s),e.append("delimiter",this.CSVDelimiter)}var i={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){this.percentCompleted=Math.round(100*t.loaded/t.total)}.bind(this)};w.uploadTimeline(e,i).then((function(e){t.$store.dispatch("updateSketch",t.$store.state.sketch.id),t.$emit("toggleModal"),t.clearFormData(),t.percentCompleted=0})).catch((function(t){}))}},validateFile:function(){this.error=[],this.form.file.size<=0&&this.error.push("Please select a non empty file");var t=["csv","json","jsonl","plaso"];if(t.includes(this.extension)||this.error.push("Please select a file with a valid extension: "+t.toString()),["csv","jsonl","json"].includes(this.extension)){this.headersMapping.length!==this.missingHeaders.length&&this.error.push("Missing headers: "+this.missingHeaders.map((function(t){return t.name})).toString());var e=this.headersMapping.filter((function(t){return t["source"]})).map((function(t){return t.source}));e=e.filter((function(t){return 1===t.length})).map((function(t){return t[0]})),e.length>new Set(e).size&&this.error.push("New headers mapping contains duplicates (".concat(e,")"))}return 0===this.error.length},setFile:function(t){if(t[0]){var e=t[0].name;this.headersMapping=[],this.headersString="",this.valuesString=[],this.form.file=t[0],this.form.name=e.split(".").slice(0,-1).join("."),this.fileName=e,"csv"===this.extension?this.extractCSVHeader():["json","jsonl"].includes(this.extension)?this.extractJSONLHeader():this.validateFile(),this.checkedHeaders=this.mandatoryHeaders.map((function(t){return t.name}))}},extractCSVHeader:function(){var t=new FileReader,e=document.getElementById("datafile").files[0],s=this;t.readAsText(e.slice(0,1e4)),t.onloadend=function(t){if(t.target.readyState===FileReader.DONE){var e=t.target.result;s.headersString=e.split("\n")[0].replaceAll('"',""),s.valuesString=e.split("\n").slice(1,s.staticNumberRows+1),s.validateFile()}}},extractJSONLHeader:function(){var t=new FileReader,e=document.getElementById("datafile").files[0],s=this;t.readAsText(e.slice(0,1e4)),t.onloadend=function(t){if(t.target.readyState===FileReader.DONE){var e=t.target.result,i=e.split("\n"),a=Math.min(s.staticNumberRows,i.length);try{s.headersString=JSON.parse(i[0]),s.valuesString=i.slice(0,a).map((function(t){return JSON.parse(t)})),s.validateFile()}catch(r){s.headersString="",s.valuesString="";var n=r.message;n+=". Your first lines of JSON: ",n+=i[0],s.error.push(n),s.error.push("Submit a valid JSONL/Plaso/CSV file")}}}}}}),Wt=Yt,Bt=Object(c["a"])(Wt,Vt,Ut,!1,null,null,null),Jt=Bt.exports,Zt=function(){var t=this,e=t._self._c;return e("div",[t.hideNavigation?t._e():e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}],null,!1,4238446144)}),t.hideNavigation?t._e():e("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"timelines"}}),t.meta.permissions.write?e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card",staticStyle:{"min-height":"160px"}},[t._m(0),e("div",{staticClass:"card-content"},[e("b-message",[e("p",[t._v("\n              Upload a new timeline or choose an existing one from the list below. You can upload either a Plaso\n              storage file, JSONL, or a CSV file.\n              "),e("br"),t._v("\n              If you are uploading a CSV or JSONL file make sure to read the\n              "),e("a",{attrs:{href:"https://timesketch.org/guides/user/import-from-json-csv/",rel:"noreferrer",target:"_blank"}},[t._v("documentation")]),t._v("\n              to learn what columns are needed.\n            ")]),e("br"),e("ts-upload-timeline-form")],1)],1)])])]):t._e(),t.sketch.timelines.length?e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card",staticStyle:{"min-height":"160px"}},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Active Timelines")]),e("p",{staticClass:"is-pulled-right",staticStyle:{padding:"0.75rem","font-weight":"bold",color:"#777777"}},[t._v("\n            "+t._s(t._f("compactNumber")(t.count))+" events\n          ")])]),e("div",{staticClass:"card-content"},[e("ts-timeline-list",{attrs:{timelines:t.sketch.timelines,controls:!0}})],1)])])]):t._e()],1)},Kt=[function(){var t=this,e=t._self._c;return e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Upload timeline")])])}],Xt={components:{TsTimelineList:Ft,TsUploadTimelineForm:Jt},props:["hideNavigation"],computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},count:function(){return this.$store.state.count}}},te=Xt,ee=Object(c["a"])(te,Zt,Kt,!1,null,null,null),se=ee.exports,ie=function(){var t=this,e=t._self._c;return e("form",{on:{submit:function(t){t.preventDefault()}}},[e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("b-radio",{attrs:{type:"is-info",name:"name","native-value":"false"},model:{value:t.isPublic,callback:function(e){t.isPublic=e},expression:"isPublic"}},[e("i",{staticClass:"fa fa-lock",staticStyle:{"margin-left":"10px","margin-right":"5px"}}),t._v("\n        Private - Only you and selected users/groups can access this sketch\n      ")]),e("br"),e("b-radio",{attrs:{type:"is-info",name:"name","native-value":"true"},model:{value:t.isPublic,callback:function(e){t.isPublic=e},expression:"isPublic"}},[e("i",{staticClass:"fa fa-globe",staticStyle:{"margin-left":"10px","margin-right":"5px"}}),t._v("\n        Public - All users of the system can access this sketch\n      ")]),e("hr"),t.currentUsers.length||t.currentGroups.length?e("div",[t._v("\n        Who has access\n        "),e("br"),e("br"),e("table",{staticClass:"table is-hoverable"},[t._l(t.currentUsers,(function(s,i){return e("tr",{key:i},[e("td",[t._v(t._s(s))]),e("td",{staticStyle:{cursor:"pointer"},attrs:{width:"10px"},on:{click:function(e){return t.removeUser(s,i)}}},[e("i",{staticClass:"fa fa-trash"})])])})),t._l(t.currentGroups,(function(s,i){return e("tr",{key:i},[e("td",[t._v(t._s(s))]),e("td",{staticStyle:{cursor:"pointer"},attrs:{width:"10px"},on:{click:function(e){return t.removeGroup(s,i)}}},[e("i",{staticClass:"fa fa-trash"})])])}))],2),e("br"),e("br")]):t._e(),t.usersToRemove.length||t.groupsToRemove.length?e("b-notification",{attrs:{type:"is-warning",role:"alert",closable:!1}},[t._v("\n        You have made changes that you need to save\n      ")]):t._e(),e("b-field",{attrs:{label:"Share with user"}},[e("b-autocomplete",{attrs:{"clear-on-select":"",data:t.filteredUserArray,placeholder:"Username ..",icon:"magnify"},on:{select:t.addUser},model:{value:t.userNameInput,callback:function(e){t.userNameInput=e},expression:"userNameInput"}},[e("template",{slot:"empty"},[t._v("No user found")])],2)],1)],1)]),e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("b-field",{attrs:{label:"Share with group"}},[e("b-autocomplete",{attrs:{"clear-on-select":"","open-on-focus":"",data:t.filteredGroupArray,placeholder:"Group name ..",icon:"magnify"},on:{select:t.addGroup},model:{value:t.groupNameInput,callback:function(e){t.groupNameInput=e},expression:"groupNameInput"}},[e("template",{slot:"empty"},[t._v("No group found")])],2)],1)],1)]),t.usersToAdd.length||t.groupsToAdd.length?e("div",[e("br"),e("strong",[t._v("Users/Groups to add")]),e("br"),e("br"),e("b-field",{attrs:{grouped:"","group-multiline":""}},[t._l(t.usersToAdd,(function(s,i){return e("div",{key:s.name,staticClass:"control"},[e("b-tag",{attrs:{attached:"",closable:"","aria-close-label":"Close tag",size:"is-medium"},on:{close:function(e){return t.usersToAdd.splice(i,1)}}},[t._v(t._s(s))])],1)})),t._l(t.groupsToAdd,(function(s,i){return e("div",{key:s.name,staticClass:"control"},[e("b-tag",{attrs:{attached:"",closable:"","aria-close-label":"Close tag",size:"is-medium"},on:{close:function(e){return t.groupsToAdd.splice(i,1)}}},[t._v(t._s(s))])],1)}))],2)],1):t._e(),e("br"),e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("button",{staticClass:"button is-info",on:{click:t.submitForm}},[t._v("Save changes")])])])])},ae=[],ne={data:function(){return{isPublic:!1,systemUsers:[],systemGroups:[],usersToAdd:[],groupsToAdd:[],usersToRemove:[],groupsToRemove:[],userNameInput:"",groupNameInput:""}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},currentUsers:function(){var t=this;return this.meta.collaborators.users.filter((function(e){return!t.usersToRemove.includes(e)}))},currentGroups:function(){var t=this;return this.meta.collaborators.groups.filter((function(e){return!t.groupsToRemove.includes(e)}))},filteredUserArray:function(){var t=this;return this.systemUsers.filter((function(e){return e.toString().toLowerCase().indexOf(t.userNameInput.toLowerCase())>=0}))},filteredGroupArray:function(){var t=this;return this.systemGroups.filter((function(e){return e.toString().toLowerCase().indexOf(t.groupNameInput.toLowerCase())>=0}))}},methods:{addUser:function(t){t&&(this.usersToAdd.includes(t)||this.usersToAdd.push(t))},addGroup:function(t){this.groupsToAdd.includes(t)||this.groupsToAdd.push(t)},removeUser:function(t,e){this.usersToRemove.push(t)},removeGroup:function(t,e){this.groupsToRemove.push(t)},submitForm:function(){w.editCollaborators(this.sketch.id,this.isPublic,this.usersToAdd,this.groupsToAdd,this.usersToRemove,this.groupsToRemove).then((function(t){})).catch((function(t){})),this.$emit("closeShareModal")}},mounted:function(){var t=this;this.meta.permissions.public&&(this.isPublic=!0),w.getUsers().then((function(e){e.data.objects[0].forEach((function(e){t.systemUsers.push(e.username)}))})).catch((function(t){})),w.getGroups().then((function(e){e.data.objects[0].forEach((function(e){t.systemGroups.push(e.name)}))})).catch((function(t){}))}},re=ne,oe=Object(c["a"])(re,ie,ae,!1,null,null,null),ce=oe.exports,le=function(){var t=this,e=t._self._c;return e("div",t._l(t.graphs,(function(s){return e("router-link",{key:s.id,attrs:{to:{name:"GraphExplore",query:{graph:s.id}}}},[e("ul",{staticClass:"content-list"},[e("li",{staticStyle:{padding:"10px","border-bottom":"none",cursor:"pointer"}},[e("strong",{staticStyle:{color:"var(--default-font-color)"}},[t._v(t._s(s.name))]),e("br"),e("span",[t._v("Created: "+t._s(t._f("moment")(s.created_at,"YYYY-MM-DD HH:mm")))])])])])})),1)},ue=[],de={data:function(){return{graphs:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},created:function(){var t=this;w.getSavedGraphList(this.sketch.id).then((function(e){var s=e.data["objects"][0];void 0!==s&&(t.graphs=e.data["objects"][0])})).catch((function(t){console.error(t)}))}},he=de,pe=Object(c["a"])(he,le,ue,!1,null,"c0d55220",null),me=pe.exports,fe={components:{TsSketchMetrics:at,TsSketchSummary:K,TsTimelineList:Ft,TsSavedViewList:jt,TsUploadTimelineForm:Jt,TsSketchStoryList:qt,TsSketchTimelinesManage:se,TsShareForm:ce,TsGraphList:me,TsDropdown:kt},data:function(){return{showUploadTimelineModal:!1,showDeleteSketchModal:!1,showShareModal:!1,isFullPage:!0,loadingComponent:null,isArchived:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},count:function(){return this.$store.state.count},shareTooltip:function(){var t="",e="Shared with ";return this.meta.collaborators.users.length&&(t=e+this.meta.collaborators.users.length+" users",this.meta.collaborators.groups.length&&(t=t+" and "+this.meta.collaborators.groups.length+" groups")),!t&&this.meta.collaborators.groups.length&&(t=e+this.meta.collaborators.groups.length+" groups"),t}},methods:{deleteSketch:function(){var t=this;w.deleteSketch(this.sketch.id).then((function(e){t.$router.push({name:"Home"})})).catch((function(t){console.error(t)}))},archiveSketch:function(){var t=this;this.isArchived=!0,w.archiveSketch(this.sketch.id).then((function(e){t.$store.dispatch("updateSketch",t.sketch.id),t.$router.push({name:"Overview",params:{sketchId:t.sketch.id}})})).catch((function(t){console.error(t)}))},unArchiveSketch:function(){var t=this;this.isArchived=!1,w.unArchiveSketch(this.sketch.id).then((function(e){t.$store.dispatch("updateSketch",t.sketch.id),t.$router.push({name:"Overview",params:{sketchId:t.sketch.id}})})).catch((function(t){console.error(t)}))},exportSketch:function(){var t=this;this.loadingOpen(),w.exportSketch(this.sketch.id).then((function(e){var s=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a"),a="sketch-"+t.sketch.id+"-export.zip";i.href=s,i.setAttribute("download",a),document.body.appendChild(i),i.click(),t.loadingClose()})).catch((function(e){console.error(e),t.loadingClose()}))},sortedUserList:function(){var t=Object(U["a"])(this.$store.state.meta.collaborators.users);return t.sort()},sortedGroupList:function(){var t=Object(U["a"])(this.$store.state.meta.collaborators.groups);return t.sort()},closeShareModal:function(){this.showShareModal=!1,this.$buefy.snackbar.open({duration:3500,message:"Sharing settings have been saved",type:"is-white",position:"is-top",queue:!1}),this.$store.dispatch("updateSketch",this.sketch.id)},loadingOpen:function(){this.loadingComponent=this.$buefy.loading.open({container:this.isFullPage?null:this.$refs.element.$el})},loadingClose:function(){this.loadingComponent.close()}},created:function(){"archived"===this.sketch.status[0].status&&(this.isArchived=!0)}},ve=fe,ge=(s("332a"),Object(c["a"])(ve,q,V,!1,null,null,null)),ye=ge.exports,_e=function(){var t=this,e=t._self._c;return e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),e("ts-navbar-secondary",{ref:"navigation",attrs:{currentAppContext:"sketch",currentPage:"explore"}}),e("b-modal",{staticStyle:{"z-index":"999"},attrs:{active:t.showSaveSearchModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showSaveSearchModal=e}}},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Save search")])]),e("div",{staticClass:"card-content"},[e("div",{staticClass:"content"},[e("ts-create-view-form",{attrs:{sketchId:t.sketchId,currentQueryString:t.currentQueryString,currentQueryFilter:t.currentQueryFilter},on:{setActiveView:t.searchView}})],1)])])]),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[t.showSearch?e("div",{staticClass:"card-content"},[e("div",{staticStyle:{position:"relative"}},[e("div",{staticClass:"ts-search-box",staticStyle:{"z-index":"998",position:"absolute",width:"100%"}},[e("ts-search-history-buttons",{staticStyle:{position:"absolute",top:"7px","margin-left":"10px"}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentQueryString,expression:"currentQueryString"}],ref:"searchInput",staticClass:"ts-search-input",staticStyle:{"padding-left":"90px"},attrs:{type:"text",placeholder:"Search",autofocus:"",required:""},domProps:{value:t.currentQueryString},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},click:function(e){t.showSearchDropdown=!0},input:function(e){e.target.composing||(t.currentQueryString=e.target.value)}}}),t.showSearchDropdown?e("div",[e("ts-search-dropdown",{attrs:{"selected-labels":t.selectedLabels,"query-string":t.currentQueryString},on:{setActiveView:t.searchView,addChip:t.addChip,updateLabelChips:function(e){return t.updateLabelChips()},close:t.closeSearchDropdown,"close-on-click":function(e){t.showSearchDropdown=!1},"node-click":t.jumpInHistory,setQueryAndFilter:t.setQueryAndFilter}})],1):t._e()],1)]),e("div",{staticClass:"field is-grouped",staticStyle:{"margin-top":"60px"}},[e("p",{staticClass:"control"},[e("ts-dropdown",{attrs:{width:"500px"},scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("a",{staticClass:"button is-text",staticStyle:{"text-decoration":"none"},attrs:{slot:"trigger",role:"button"},slot:"trigger"},[e("span",[t._v("+ Time filter")])])]},proxy:!0}],null,!1,2669727996)},[e("strong",[t._v("Create time filter")]),e("br"),e("br"),e("ts-explore-filter-time",{on:{addChip:t.addChip,hideDropdown:t.hideDropdown}})],1)],1),e("p",{staticClass:"control"},[e("ts-dropdown",{scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("a",{staticClass:"button is-text",staticStyle:{"text-decoration":"none"},attrs:{role:"button"}},[e("span",[t._v("+ Add label filter")])])]},proxy:!0}],null,!1,983329550)},[e("div",{staticClass:"field"},[e("b-checkbox",{attrs:{type:"is-info","native-value":"__ts_star"},model:{value:t.selectedLabels,callback:function(e){t.selectedLabels=e},expression:"selectedLabels"}},[e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[e("i",{staticClass:"fas fa-star",staticStyle:{color:"#ffe300","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"silver"}})]),t._v("Show starred events\n                  ")])],1),e("div",{staticClass:"field"},[e("b-checkbox",{attrs:{type:"is-info","native-value":"__ts_comment"},model:{value:t.selectedLabels,callback:function(e){t.selectedLabels=e},expression:"selectedLabels"}},[e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[e("i",{staticClass:"fas fa-comment"})]),t._v("Show\n                    events with comments\n                  ")])],1),t._l(t.filteredLabels,(function(s){return e("div",{key:s.label,staticClass:"level",staticStyle:{"margin-bottom":"5px"}},[e("div",{staticClass:"level-left"},[e("div",{staticClass:"field"},[e("b-checkbox",{attrs:{type:"is-info","native-value":s.label},model:{value:t.selectedLabels,callback:function(e){t.selectedLabels=e},expression:"selectedLabels"}},[t._v("\n                        "+t._s(s.label)+"\n                      ")])],1)])])})),e("br"),e("button",{staticClass:"button is-info",on:{click:function(e){return t.updateLabelChips()}}},[t._v("Add filter")])],2)],1)]),e("p",{staticClass:"control",staticStyle:{top:"-40px",float:"right"}},[e("b-switch",{staticStyle:{top:"2px","margin-right":"15px"},attrs:{size:"is-small",type:"is-info"},model:{value:t.showHistogram,callback:function(e){t.showHistogram=e},expression:"showHistogram"}},[t._v("Chart")]),e("b-switch",{staticStyle:{top:"2px"},attrs:{size:"is-small",type:"is-info"},on:{input:t.triggerScrollTo},model:{value:t.showSearchHistory,callback:function(e){t.showSearchHistory=e},expression:"showSearchHistory"}},[t._v("Show history")])],1),e("div",{staticClass:"tags",staticStyle:{"margin-bottom":"-5px"}},t._l(t.timeFilterChips,(function(s,i){return e("span",{key:i+s.value},[e("ts-dropdown",{ref:"TimeFilters",refInFor:!0,attrs:{width:"500px"},scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("span",{staticClass:"is-small is-outlined",attrs:{role:"button"}},[e("div",{staticClass:"tags",staticStyle:{"margin-bottom":"5px","margin-right":"7px"}},[e("span",{staticClass:"tag is-medium",class:{"chip-disabled":!1===s.active},staticStyle:{cursor:"pointer"}},[e("span",{on:{click:function(e){return e.stopPropagation(),t.toggleChip(s)}}},[i>0?e("span",{staticClass:"chip-operator-label"},[t._v("OR")]):t._e(),e("span",{staticClass:"icon",staticStyle:{"margin-right":"7px"}},[e("i",{staticClass:"fas fa-clock"})]),e("span",[t._v(t._s(s.value.split(",")[0]))]),"datetime_range"===s.type&&s.value.split(",")[0]!==s.value.split(",")[1]?e("span",[t._v("\n                             "+t._s(s.value.split(",")[1]))]):t._e()]),e("span",{staticClass:"fa-stack fa-lg is-small",staticStyle:{"margin-left":"5px",width:"20px"}},[e("i",{staticClass:"fas fa-edit fa-stack-1x",staticStyle:{transform:"scale(0.7)",color:"#777"}})]),e("button",{staticClass:"delete is-small",staticStyle:{"margin-left":"5px"},on:{click:function(e){return t.removeChip(s)}}})])])])]},proxy:!0}],null,!0)},[e("strong",[t._v("Update time filter")]),e("br"),e("br"),e("ts-explore-filter-time",{attrs:{selectedChip:s},on:{updateChip:function(e){return t.updateChip(e,s)},hideDropdown:t.hideDropdown}})],1)],1)})),0),e("div",{staticClass:"tags"},t._l(t.filterChips,(function(s,i){return e("span",{key:i+s.value},["label"===s.type?e("span",{staticClass:"tag is-medium",class:{"chip-disabled":!1===s.active},staticStyle:{"margin-right":"7px",cursor:"pointer"},on:{click:function(e){return t.toggleChip(s,i)}}},[i>0||t.timeFilterChips.length?e("span",{staticClass:"chip-operator-label"},[t._v("AND")]):t._e(),"__ts_star"===s.value?e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"7px"}},[e("i",{staticClass:"fas fa-star",staticStyle:{color:"#ffe300","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"silver"}})]):"__ts_comment"===s.value?e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"7px"}},[e("i",{staticClass:"fas fa-comment"})]):"label"===s.type?e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"7px"}},[e("i",{staticClass:"fas fa-tag"})]):t._e(),e("span",{staticStyle:{"margin-right":"7px"}},[t._v(t._s(t._f("filterChip")(s)))]),e("button",{staticClass:"delete is-small",staticStyle:{"margin-left":"7px"},on:{click:function(e){return t.removeChip(s)}}})]):t._e(),"term"===s.type?e("span",{staticClass:"tag is-medium",class:{"chip-disabled":!1===s.active,"is-danger":"must_not"===s.operator},staticStyle:{"margin-right":"7px",cursor:"pointer"},on:{click:function(e){return t.toggleChip(s,i)}}},[i>0||t.timeFilterChips.length?e("span",{staticClass:"chip-operator-label"},[t._v("AND")]):t._e(),"must_not"===s.operator?e("span",{staticClass:"chip-operator-label",staticStyle:{"font-weight":"bold"}},[t._v("NOT")]):t._e(),e("span",{staticStyle:{"margin-right":"7px"}},[t._v(t._s(t._f("filterChip")(s)))]),e("button",{staticClass:"delete is-small",staticStyle:{"margin-left":"7px"},on:{click:function(e){return t.removeChip(s)}}})]):t._e()])})),0),t.sketch.active_timelines?e("ts-explore-timeline-picker",{attrs:{"current-query-filter":t.currentQueryFilter,"count-per-index":t.eventList.meta.count_per_index,"count-per-timeline":t.eventList.meta.count_per_timeline},on:{updateSelectedTimelines:function(e){return t.updateSelectedTimelines(e)}}}):t._e()],1):t._e()])])]),e("section",{directives:[{name:"show",rawName:"v-show",value:t.showSearchHistory,expression:"showSearchHistory"}],staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("\n            My searches\n          ")]),e("div",{staticClass:"card-header-icon",staticStyle:{width:"20%"}},[e("span",{staticStyle:{"margin-right":"10px"}},[t._v("Zoom")]),e("b-slider",{staticStyle:{"margin-right":"10px"},attrs:{format:"percent",min:.1,max:1,step:.01},on:{dragend:t.triggerScrollTo},model:{value:t.zoomLevel,callback:function(e){t.zoomLevel=e},expression:"zoomLevel"}})],1)]),e("div",{directives:[{name:"dragscroll",rawName:"v-dragscroll"}],staticClass:"card-content no-scrollbars",staticStyle:{overflow:"scroll","white-space":"nowrap","max-height":"700px","min-height":"500px"}},[e("ts-search-history-tree",{staticStyle:{"transform-origin":"top left"},style:{transform:"scale("+t.zoomLevel+")"},attrs:{"show-history":t.showSearchHistory},on:{"node-click":t.jumpInHistory}})],1)])])]),t.showHistogram?e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-content"},[e("ts-bar-chart",{attrs:{"chart-data":t.eventList.meta.count_over_time},on:{addChip:function(e){return t.addChipFromHistogram(e)}}})],1)])])]):t._e(),e("section",{directives:[{name:"show",rawName:"v-show",value:t.contextEvent,expression:"contextEvent"}],staticClass:"section",attrs:{id:"context"}},[e("div",{staticClass:"container is-fluid"},[e("b-message",{attrs:{type:"is-warning","aria-close-label":"Close message"}},[e("strong",[t._v("Context query")]),e("br"),e("br"),e("div",{staticClass:"buttons"},[e("button",{staticClass:"button",on:{click:t.removeContext}},[t._v(" Go back to original query")]),e("button",{staticClass:"button",on:{click:t.scrollToContextEvent}},[t._v("Help me find my event")])])])],1)]),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-content"},[e("nav",{staticClass:"level"},[e("div",{staticClass:"level-left"},[e("div",{staticClass:"level-item"},[t.toEvent&&!t.searchInProgress?e("span",[t._v(t._s(t.fromEvent)+"-"+t._s(t.toEvent)+" of "+t._s(t.totalHits)+" events ("+t._s(t.totalTime)+"s)")]):t._e()]),e("div",{staticClass:"level-item"},[t.toEvent||t.searchInProgress?t._e():e("span",[t._v(t._s(t.totalHits)+" events ("+t._s(t.totalTime)+"s)")]),t.searchInProgress?e("div",[t._m(0),t._v(" Searching..\n                ")]):t._e()]),e("div",{staticClass:"level-item"},[t.totalHits>0?e("button",{staticClass:"button is-small is-outlined is-rounded",on:{click:function(e){t.showSaveSearchModal=!t.showSavedSearchModal}}},[t._m(1),e("span",[t._v("Save this search")])]):t._e()]),t.numSelectedEvents?e("div",{staticClass:"level-item",staticStyle:{"margin-right":"50px"}},[e("button",{staticClass:"button is-small is-outlined",staticStyle:{"border-radius":"4px"},on:{click:t.toggleStar}},[t._m(2),e("span",[t._v("Star events ("+t._s(t.numSelectedEvents)+")")])])]):t._e()]),e("div",{staticClass:"level-right"},[e("div",{staticClass:"level-item"},[e("b-pagination",{attrs:{total:t.totalHitsForPagination,"per-page":t.currentQueryFilter.size,current:t.currentPage,simple:!0,size:"is-small","icon-pack":"fas","icon-prev":"chevron-left","icon-next":"chevron-right"},on:{change:function(e){return t.paginate(e)},"update:current":function(e){t.currentPage=e}}})],1),e("div",{staticClass:"level-item"},[e("div",{staticClass:"select is-small"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.currentQueryFilter.size,expression:"currentQueryFilter.size"}],staticStyle:{border:"1px solid var(--table-cell-border-color)"},on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.currentQueryFilter,"size",e.target.multiple?s:s[0])},function(e){return t.search(!0,!0,!0)}]}},[e("option",{domProps:{value:t.currentQueryFilter.size}},[t._v(t._s(t.currentQueryFilter.size))]),e("option",{attrs:{value:"10"}},[t._v("10")]),e("option",{attrs:{value:"20"}},[t._v("20")]),e("option",{attrs:{value:"40"}},[t._v("40")]),e("option",{attrs:{value:"80"}},[t._v("80")]),e("option",{attrs:{value:"100"}},[t._v("100")]),e("option",{attrs:{value:"200"}},[t._v("200")]),e("option",{attrs:{value:"500"}},[t._v("500")])])])]),e("div",{staticClass:"level-item"},[e("button",{staticClass:"button is-small",staticStyle:{"border-radius":"4px"},on:{click:t.changeSortOrder}},[t._v("\n                  "+t._s(t.currentQueryFilter.order)+"\n                ")])]),e("div",{staticClass:"level-item"},[e("ts-dropdown",{attrs:{position:"is-bottom-left",width:"300px"},scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("button",{staticClass:"button is-small",staticStyle:{"border-radius":"4px"}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-table"})]),e("span",[t._v("Customize columns")])])]},proxy:!0}])},[t.meta.mappings?e("multiselect",{staticStyle:{display:"block"},attrs:{options:t.meta.mappings,value:t.selectedFieldsProxy,multiple:!0,searchable:!0,"close-on-select":!0,label:"field","track-by":"field",placeholder:"Add columns ..."},on:{open:function(e){t.expandFieldDropdown=!0},close:function(e){t.expandFieldDropdown=!1},input:t.updateSelectedFields}}):t._e(),t.selectedFields.length?e("span",[e("br"),e("strong",[t._v("Selected columns")]),e("br"),e("br")]):t._e(),e("div",{staticClass:"tags"},t._l(t.selectedFields,(function(s,i){return e("span",{key:i},[e("span",{staticClass:"tag is-light is-rounded",staticStyle:{"margin-right":"7px"}},[e("span",{staticStyle:{"margin-right":"7px"}},[t._v(t._s(s.field))]),e("button",{staticClass:"delete is-small",staticStyle:{"margin-left":"7px"},on:{click:function(e){return t.removeField(i)}}})])])})),0),e("br"),e("b-switch",{staticStyle:{"margin-bottom":"7px"},attrs:{type:"is-info"},model:{value:t.displayOptions.showTags,callback:function(e){t.$set(t.displayOptions,"showTags",e)},expression:"displayOptions.showTags"}},[e("span",[t._v("Show tags")])]),e("br"),e("b-switch",{staticStyle:{"margin-bottom":"7px"},attrs:{type:"is-info"},model:{value:t.displayOptions.showEmojis,callback:function(e){t.$set(t.displayOptions,"showEmojis",e)},expression:"displayOptions.showEmojis"}},[e("span",[t._v("Show emojis")])]),e("br"),e("b-switch",{attrs:{type:"is-info"},model:{value:t.displayOptions.showMillis,callback:function(e){t.$set(t.displayOptions,"showMillis",e)},expression:"displayOptions.showMillis"}},[e("span",[t._v("Show microseconds")])])],1)],1),e("div",{staticClass:"level-item"},[t.eventList.objects.length?e("button",{staticClass:"button is-small",staticStyle:{"border-radius":"4px"},on:{click:t.exportSearchResult}},[t._m(3),e("span",[t._v("Export to CSV")])]):t._e()])])]),t.totalHits>0?e("div",{staticStyle:{"margin-top":"20px"}}):t._e(),t.eventList.objects.length?e("ts-sketch-explore-event-list",{attrs:{"event-list":t.eventList.objects,order:t.currentQueryFilter.order,"selected-fields":t.selectedFields,"display-options":t.displayOptions},on:{addChip:function(e){return t.addChip(e)},addLabel:function(e){return t.updateLabelList(e)},searchContext:function(e){return t.searchContext(e)}}}):t._e(),t.eventList.objects.length?e("div",{staticStyle:{float:"right"}},[e("b-pagination",{attrs:{total:t.totalHitsForPagination,"per-page":t.currentQueryFilter.size,current:t.currentPage,simple:!0,size:"is-small","icon-pack":"fas","icon-prev":"chevron-left","icon-next":"chevron-right"},on:{change:function(e){return t.paginate(e)},"update:current":function(e){t.currentPage=e}}})],1):t._e(),e("br")],1)]),e("br")])])],1)},be=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon"},[e("i",{staticClass:"fas fa-circle-notch fa-pulse"})])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-save"})])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon"},[e("i",{staticClass:"fas fa-star"})])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[e("i",{staticClass:"fas fa-file-export"})])}],Ce=(s("ac4d"),s("8a81"),s("1c4c"),s("20d6"),s("a481"),function(){var t=this,e=t._self._c;return e("table",{staticClass:"table is-fullwidth",staticStyle:{"border-radius":"4px"}},[e("thead",[e("th",{attrs:{width:t.datetimeWidth}},[t._v("Datetime (UTC)")]),e("th",{attrs:{width:"1"}},[e("span",{staticClass:"control"},[e("input",{attrs:{type:"checkbox"},on:{click:t.toggleSelectAll}})])]),t._l(t.selectedFields,(function(s,i){return e("th",{key:i},[t._v(t._s(s.field))])})),e("th",{attrs:{width:"150"}},[t._v("Timeline name")])],2),t._l(t.eventList,(function(s,i){return e("ts-sketch-explore-event-list-row",{key:i,attrs:{event:s,prevEvent:t.eventList[i-1],order:t.order,"selected-fields":t.selectedFields,"display-options":t.displayOptions,"display-controls":!0,"search-node":t.searchNode,id:s._id},on:{addChip:function(e){return t.$emit("addChip",e)},addLabel:function(e){return t.$emit("addLabel",e)},searchContext:function(e){return t.$emit("searchContext",e)}}})}))],2)}),we=[],ke=function(){var t=this,e=t._self._c;return e("tbody",[t.deltaDays>0?e("tr",[e("td",{staticStyle:{padding:"0"},attrs:{colspan:"5"}},[e("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color"}),e("div",{staticClass:"ts-time-bubble ts-time-bubble-color"},[e("h5",[e("b",[t._v(t._s(t._f("compactNumber")(t.deltaDays)))]),e("br"),t._v("days\n        ")])]),e("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color"})])]):t._e(),e("tr",[e("td",{style:t.timelineColor},[t._v("\n      "+t._s(t._f("moment")(t._f("formatTimestamp")(t.event._source.timestamp),"utc",t.datetimeFormat))+"\n    ")]),e("td",[e("div",{staticClass:"field is-grouped"},[t.displayControls?e("span",{staticClass:"control"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.isSelected},on:{click:t.toggleSelect}})]):t._e(),e("span",{staticClass:"icon control",staticStyle:{"margin-right":"3px",cursor:"pointer"},on:{click:t.toggleStar}},[t.isStarred?e("i",{staticClass:"fas fa-star",staticStyle:{color:"#ffe300","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"#d1d1d1"},attrs:{title:"Unstar the event"}}):t._e(),t.isStarred?t._e():e("i",{staticClass:"fas fa-star",staticStyle:{color:"#d3d3d3"},attrs:{title:"Star the event"}})]),t.displayControls?e("span",{staticClass:"icon control",staticStyle:{"margin-right":"3px",cursor:"pointer"},on:{click:t.searchContext}},[e("i",{staticClass:"fas fa-search",staticStyle:{color:"#d3d3d3"},attrs:{title:"Search +/- 5min"}})]):t._e(),e("span",{staticClass:"icon control"},[e("ts-dropdown",{scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("i",{staticClass:"fas fa-tag",staticStyle:{color:"#d3d3d3"},attrs:{slot:"trigger",title:"Labels"},slot:"trigger"})]},proxy:!0}])},[t.filteredLabelsToAdd.length?e("span",[e("b",[t._v("Add label")]),e("br"),e("br"),t._l(t.filteredLabelsToAdd,(function(s){return e("div",{key:s.label,staticClass:"level",staticStyle:{"margin-bottom":"5px"}},[e("div",{staticClass:"level-left"},[e("div",{staticClass:"field"},[e("b-checkbox",{attrs:{type:"is-info","native-value":s.label},model:{value:t.selectedLabels,callback:function(e){t.selectedLabels=e},expression:"selectedLabels"}},[t._v("\n                      "+t._s(s.label)+"\n                    ")])],1)])])}))],2):t._e(),t.event._source.label.length?e("span",[e("i",{staticClass:"fas fa-trash",staticStyle:{"margin-right":"7px"}}),e("b",[t._v("Remove label")]),e("br"),e("br"),t._l(t.event._source.label,(function(s){return e("div",{key:s,staticClass:"level",staticStyle:{"margin-bottom":"5px"}},[e("div",{staticClass:"level-left"},[e("div",{staticClass:"field"},[e("b-checkbox",{attrs:{type:"is-danger","native-value":s},model:{value:t.labelsToRemove,callback:function(e){t.labelsToRemove=e},expression:"labelsToRemove"}},[t._v("\n                      "+t._s(s)+"\n                    ")])],1)])])}))],2):t._e(),e("br"),e("b",[t._v("Create and add a new label")]),e("div",{staticClass:"field is-grouped",staticStyle:{"padding-top":"10px"}},[e("p",{staticClass:"control is-expanded"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.labelToAdd,expression:"labelToAdd"}],staticClass:"input",attrs:{placeholder:"New label"},domProps:{value:t.labelToAdd},on:{input:function(e){e.target.composing||(t.labelToAdd=e.target.value)}}})]),e("p",{staticClass:"control"},[e("button",{staticClass:"button",on:{click:function(e){return t.addLabels(t.labelToAdd)}}},[t._v("Save")])])]),t.selectedLabels.length||t.labelsToRemove.length?e("button",{staticClass:"button is-info",attrs:{disabled:null!==t.labelToAdd&&""!==t.labelToAdd},on:{click:function(e){return t.addLabels()}}},[t._v("\n              Apply\n            ")]):t._e()])],1)])]),t._l(t.selectedFields,(function(s,i){return e("td",{key:i,staticClass:"ts-event-list-row-background-color",staticStyle:{cursor:"pointer","max-width":"50ch"},style:t.fieldColumnColor,on:{click:function(e){t.showDetail=!t.showDetail}}},[e("span",{class:{"ts-event-field-container":1===t.selectedFields.length}},[e("span",{class:{"ts-event-field-ellipsis":1===t.selectedFields.length}},[0===i?e("span",[t._l(t.event._source.__ts_emojis,(function(s){return t.displayOptions.showEmojis?e("span",{key:s,attrs:{title:t.meta.emojis[s]},domProps:{innerHTML:t._s(s)}},[t._v(t._s(s))]):t._e()})),e("span",{staticStyle:{"margin-left":"10px"}}),t._l(t.event._source.tag,(function(s){return t.displayOptions.showTags?e("span",{key:s,staticClass:"tag is-small",staticStyle:{"margin-right":"5px","background-color":"var(--tag-background-color)",color:"var(--tag-font-color)"}},[t._v(t._s(s))]):t._e()})),t._l(t.filteredLabels,(function(s){return t.displayOptions.showTags?e("span",{key:s,staticClass:"tag is-small",staticStyle:{"margin-right":"5px","background-color":"var(--tag-background-color)",color:"var(--tag-font-color)"}},[t._v(t._s(s))]):t._e()}))],2):t._e(),e("span",{staticStyle:{"word-break":"break-word"},attrs:{title:t.event._source[s.field]}},[t._v("\n            "+t._s(t.event._source[s.field])+"\n          ")])])])])})),e("td",{staticClass:"ts-timeline-name-column ts-timeline-name-column-color"},[e("span",{attrs:{title:t.timelineName}},[t._v("\n        "+t._s(t.timelineName)+"\n      ")])])],2),t.comments.length?e("tr",[e("td",{staticStyle:{padding:"0"},attrs:{colspan:"5"}},[e("div",{staticStyle:{"max-width":"100%",border:"1px solid #f5f5f5","border-radius":"4px",padding:"10px","margin-bottom":"20px"}},t._l(t.comments,(function(s,i){return e("article",{key:s.id,staticClass:"field"},[e("small",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t._f("moment")(s.updated_at,"utc","YYYY-MM-DD HH:mm:ss")))]),e("small",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(s.user.username))]),e("br"),s&&s.editable?e("div",{staticClass:"media-content"},[e("div",{staticClass:"field",staticStyle:{"max-width":"50%"}},[e("p",{staticClass:"control"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comments[i].comment,expression:"comments[index].comment"}],staticClass:"textarea",attrs:{required:"",autofocus:"",rows:"1"},domProps:{value:t.comments[i].comment},on:{input:function(e){e.target.composing||t.$set(t.comments[i],"comment",e.target.value)}}})])]),e("div",{staticClass:"field"},[e("p",{staticClass:"control"},[e("button",{staticClass:"button is-small is-rounded",staticStyle:{"margin-right":"0.75rem"},on:{click:function(e){return t.updateComment(s,i)}}},[t._v("\n                  Save\n                ")]),e("button",{staticClass:"button is-small is-rounded",staticStyle:{"margin-right":"0.75rem"},on:{click:function(e){return t.toggleEditComment(i,!1)}}},[t._v("\n                  Cancel\n                ")])])])]):t._e(),s&&!s.editable?e("div",{staticClass:"media-content"},[e("div",{staticClass:"level content"},[e("div",{staticClass:"level-left"},[t._v("\n                "+t._s(s.comment)+"\n              ")]),t.meta.permissions.write&&t.getCurrentUser()==s.user.username?e("div",{staticClass:"level-right field"},[e("button",{staticClass:"button is-small is-rounded",staticStyle:{"margin-right":"0.75rem"},on:{click:function(e){return t.toggleEditComment(i,!0)}}},[t._v("\n                  Edit\n                ")]),e("button",{staticClass:"button is-small is-rounded is-danger",staticStyle:{"margin-right":"0.75rem"},on:{click:function(e){return t.deleteComment(s.id,i)}}},[t._v("\n                  Remove\n                ")])]):t._e()])]):t._e()])})),0)])]):t._e(),e("tr",[e("td",{staticStyle:{padding:"0"},attrs:{colspan:"5"}},[t.showDetail?e("div",{staticStyle:{"padding-top":"20px","padding-bottom":"20px","padding-left":"10px"}},[e("div",{staticClass:"field",staticStyle:{"max-width":"50%"}},[e("p",{staticClass:"control"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"textarea",attrs:{required:"",autofocus:"",rows:"1",placeholder:"Add a comment ..."},domProps:{value:t.comment},on:{input:function(e){e.target.composing||(t.comment=e.target.value)}}})])]),e("div",{staticClass:"field"},[e("p",{staticClass:"control"},[e("button",{staticClass:"button is-small is-rounded",on:{click:function(e){return t.postComment(t.comment)}}},[t._v("Post comment")])])]),e("ts-sketch-explore-event-list-row-detail",{attrs:{event:t.event},on:{addChip:function(e){return t.$emit("addChip",e)}}})],1):t._e()])])])},Se=[],xe=function(){var t=this,e=t._self._c;return e("table",{staticClass:"table is-bordered",staticStyle:{width:"100%","table-layout":"fixed"},on:{mouseup:t.handleSelectionChange}},[e("tbody",t._l(t.fullEventFiltered,(function(s,i){return e("tr",{key:i,on:{mouseover:function(e){t.c_key=i},mouseleave:function(e){t.c_key=-1}}},[e("td",{staticStyle:{width:"40px"}},[e("span",{staticClass:"icon is-small",staticStyle:{cursor:"pointer"},attrs:{title:"Apply 'Include' filter"},on:{click:function(e){return t.addFilter(i,s,"must")}}},[e("i",{staticClass:"fas fa-search-plus"})])]),e("td",{staticStyle:{width:"40px"}},[e("span",{staticClass:"icon is-small",staticStyle:{cursor:"pointer"},attrs:{title:"Apply 'Exclude' filter"},on:{click:function(e){return t.addFilter(i,s,"must_not")}}},[e("i",{staticClass:"fas fa-search-minus"})])]),e("td",{staticStyle:{"word-wrap":"break-word",width:"150px"}},[t._v("\n        "+t._s(i)+"\n        "),i==t.c_key?e("span",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:i,expression:"key",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.handleCopyStatus,expression:"handleCopyStatus",arg:"success"}],staticClass:"icon is-small",staticStyle:{cursor:"pointer"},attrs:{title:"Copy key"}},[e("i",{staticClass:"fas fa-copy"})]):t._e()]),e("td",[i==t.c_key?e("span",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:s,expression:"item",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.handleCopyStatus,expression:"handleCopyStatus",arg:"success"}],staticClass:"icon is-small",staticStyle:{cursor:"pointer","margin-left":"3px",float:"right"},attrs:{title:"Copy value"}},[e("i",{staticClass:"fas fa-copy"})]):t._e(),t.getRegexes(i).length>0?e("text-highlight",{attrs:{highlightComponent:t.TsIOCMenu,queries:t.getRegexes(i),attributeKey:i},on:{addChip:function(e){return t.$emit("addChip",e)}}},[t._v(t._s(s))]):e("span",[t._v(t._s(s))])],1)])})),0)])},Te=[],Ae=(s("8615"),function(){var t=this,e=this,s=e._self._c;return s("div",{staticStyle:{display:"inline"}},[s("span",{ref:"contextMenuParent",staticClass:"ioc-match",on:{click:function(s){return t.$refs.contextMenu.open(s,e.getIOC(e.$attrs.text),e.$refs.contextMenuParent)}}},[e._t("default")],2),s("TsContextMenu",{ref:"contextMenu",scopedSlots:e._u([{key:"default",fn:function(t){return[t.data?s("section",{staticClass:"box ioc-context-menu"},[s("div",{staticClass:"ioc-display"},[s("span",{staticClass:"icon is-small",attrs:{title:"Apply 'Include' filter"},on:{click:function(s){return e.addFilter(e.attributeKey,t.data.ioc,"must")}}},[s("i",{staticClass:"fas fa-search-plus"})]),s("pre",[e._v(e._s(t.data.ioc))])]),e.isInIntelligence(t.data)?s("div",[s("small",[e._v("Already added to "),s("router-link",{attrs:{to:{name:"Intelligence"}}},[e._v("Intelligence")])],1)]):s("div",[s("b-field",{attrs:{grouped:"",message:"Add to Intelligence"}},[s("b-select",{attrs:{size:"is-small",placeholder:"IOC type"},model:{value:t.data.type,callback:function(s){e.$set(t.data,"type",s)},expression:"params.data.type"}},e._l(e.IOCTypes,(function(t){return s("option",{key:t.type,domProps:{value:t.type}},[e._v("\n                "+e._s(t.type)+"\n              ")])})),0),s("b-taginput",{attrs:{ellipsis:"",icon:"label",placeholder:"Add a tag","aria-close-label":"Delete this tag",size:"is-small"},model:{value:t.data.tags,callback:function(s){e.$set(t.data,"tags",s)},expression:"params.data.tags"}}),s("b-button",{attrs:{size:"is-small",type:"is-primary"},on:{click:function(s){return e.saveThreatIntel(t.data)}}},[e._v("Add")])],1)],1)]):e._e()]}}])})],1)}),Oe=[],De=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.isOpen,expression:"isOpen"}],ref:"menuBox",staticClass:"context-menu",style:t.style},[t._t("default",null,{data:t.data})],2)},Ee=[],$e={name:"TsContextMenu",data:function(){return{isOpen:!1,posX:0,posY:0,data:null,parentComponent:null}},methods:{open:function(t,e,s){this.close(),t&&(this.posX=t.clientX,this.posY=t.clientY),this.data=e,this.isOpen=!0,this.parentComponent=s,document.addEventListener("click",this.handleClick)},close:function(){this.isOpen=!1,document.removeEventListener("click",this.handleClick)},handleClick:function(t){if(this.$refs.menuBox&&this.isOpen){var e=this.$refs.menuBox.contains(t.target),s=this.parentComponent.contains(t.target);e||s||this.close()}}},computed:{style:function(){return{left:"".concat(this.posX,"px"),top:"".concat(this.posY,"px")}}}},Fe=$e,Ne=(s("4283"),Object(c["a"])(Fe,De,Ee,!1,null,"7d63fbec",null)),Ie=Ne.exports,Me=[{regex:/^(\/[\S]+)+$/i,type:"fs_path"},{regex:/^([-\w]+\.)+[a-z]{2,}$/i,type:"hostname"},{regex:/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g,type:"ipv4"},{regex:/^[0-9a-f]{64}$/i,type:"hash_sha256"},{regex:/^[0-9a-f]{40}$/i,type:"hash_sha1"},{regex:/^[0-9a-f]{32}$/i,type:"hash_md5"},{regex:/./g,type:"other"}];function Pe(t,e){var s="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!s){if(Array.isArray(t)||(s=Le(t))||e&&t&&"number"===typeof t.length){s&&(t=s);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r=!0,o=!1;return{s:function(){s=s.call(t)},n:function(){var t=s.next();return r=t.done,t},e:function(t){o=!0,n=t},f:function(){try{r||null==s.return||s.return()}finally{if(o)throw n}}}}function Le(t,e){if(t){if("string"===typeof t)return je(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?je(t,e):void 0}}function je(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}var Re={components:{TsContextMenu:Ie},props:["attributeKey"],name:"TsIOCMenu",data:function(){return{IOCTypes:Me,iocColumns:[{field:"ioc",label:"IOC"},{field:"type",label:"Type"}],selectedIOC:{}}},methods:{addFilter:function(t,e,s){var i={field:t,value:e,type:"term",operator:s,active:!0};this.$emit("addChip",i)},getIOC:function(t){var e,s=Pe(this.IOCTypes);try{for(s.s();!(e=s.n()).done;){var i=e.value,a=i.regex.exec(t);if(a)return{ioc:t,type:i.type,tags:this.tags}}}catch(n){s.e(n)}finally{s.f()}return{ioc:this.$attrs.text,type:"other"}},isInIntelligence:function(t){var e=this.$store.state.meta.attributes;return!!e.intelligence&&e.intelligence.value.data.map((function(t){return t.ioc})).indexOf(t.ioc)>=0},saveThreatIntel:function(t){var e=this;w.getSketchAttributes(this.sketch.id).then((function(s){var i=s.data;i.intelligence||(i.intelligence={ontology:"intelligence",value:{data:[]}}),i.intelligence.value.data.map((function(t){return t.ioc})).indexOf(t.ioc)>=0||(i.intelligence.value.data.push(t),w.addSketchAttribute(e.sketch.id,"intelligence",i.intelligence.value,"intelligence").then((function(){y["a"].open({message:"Attribute added successfully",type:"is-white",position:"is-top",actionText:"View intelligence",indefinite:!1,onAction:function(){e.$router.push({name:"Intelligence"})}}),e.$store.state.meta.attributes=i})))}))}},computed:{sketch:function(){return this.$store.state.sketch}},mounted:function(){}},ze=Re,Qe=(s("b5b3"),Object(c["a"])(ze,Ae,Oe,!1,null,null,null)),He=Qe.exports,Ge=s("b50c"),qe={components:{TextHighlight:Ge["a"]},props:["event"],data:function(){return{TsIOCMenu:He,regexSelection:"",regexes:[{type:"fs_path",regex:/(\/[\S]+)+/i,match_field:"message"},{type:"hostname",regex:/([-\w]+\.)+[a-z]{2,}/i,match_field:"hostname"},{type:"ipv4",regex:/((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)/g,match_field:"message"},{type:"hash_md5",regex:/[0-9a-f]{32}/i,match_field:"message"},{type:"hash_sha1",regex:/[0-9a-f]{40}/i,match_field:"message"},{type:"hash_sha256",regex:/[0-9a-f]{64}/i,match_field:"message"}],c_key:-1,fullEvent:{}}},computed:{sketch:function(){return this.$store.state.sketch},fullEventFiltered:function(){var t=this;return Object.getOwnPropertyNames(this.fullEvent).forEach((function(e){e.startsWith("__ts")&&delete t.fullEvent[e]})),this.fullEvent}},methods:{getEvent:function(){var t=this,e=this.event._index,s=this.event._id;w.getEvent(this.sketch.id,e,s).then((function(e){t.fullEvent=e.data.objects})).catch((function(t){}))},addFilter:function(t,e,s){var i={field:t,value:e,type:"term",operator:s,active:!0};this.$emit("addChip",i)},handleCopyStatus:function(){this.$buefy.notification.open("Copied!")},handleSelectionChange:function(t){if(!t.target.closest(".ioc-match")&&!t.target.closest(".ioc-context-menu")){var e=window.getSelection().toString();this.regexSelection=e}},getRegexes:function(t){if(""!==this.regexSelection)return this.regexSelection;var e=Object.values(this.regexes.filter((function(e){return e.match_field===t||"*"===e.match_field})).map((function(t){return t.regex})));return""!==this.regexSelection&&e.push(this.regexSelection),e}},created:function(){this.getEvent()}},Ve=qe,Ue=Object(c["a"])(Ve,xe,Te,!1,null,null,null),Ye=Ue.exports,We=s("aced"),Be={components:{TsSketchExploreEventListRowDetail:Ye,TsDropdown:kt},props:["event","prevEvent","order","selectedFields","isRemoteSelected","displayOptions","displayControls","searchNode"],data:function(){return{showDetail:!1,isStarred:!1,isSelected:!1,isDarkTheme:!1,comment:"",comments:[],labelToAdd:null,selectedLabels:[],labelsToRemove:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},currentSearchNode:function(){return this.searchNode||this.$store.state.currentSearchNode},timelineColor:function(){var t=this.timeline.color;return t.startsWith("#")||(t="#"+t),this.isDarkTheme?{"background-color":t,filter:"grayscale(25%)",color:"#333"}:{"background-color":t}},fieldColumnColor:function(){return this.isSelected?{"background-color":"#c3ecff",color:"#333"}:this.isStarred?{"background-color":"#fff4b3",color:"#333"}:{}},datetimeFormat:function(){return this.displayOptions.showMillis?"YYYY-MM-DDTHH:mm:ss.SSSSSS":"YYYY-MM-DDTHH:mm:ss"},timeline:function(){var t,e=this,s=this.meta.indices_metadata[this.event._index].is_legacy;return t=s?this.sketch.active_timelines.filter((function(t){return t.searchindex.index_name===e.event._index}))[0]:this.sketch.active_timelines.filter((function(t){return t.id===e.event._source.__ts_timeline_id}))[0],t},timelineName:function(){return this.timeline.name},deltaDays:function(){if(!this.prevEvent)return 0;var t=this.$options.filters.formatTimestamp(this.event._source.timestamp),e=this.$options.filters.formatTimestamp(this.prevEvent._source.timestamp),s=Math.floor(t/1e3),i=Math.floor(e/1e3),a=Math.floor(s-i);"desc"===this.order&&(a=Math.floor(i-s));var n=a/60/60/24;return Math.floor(n)},eventDataSparse:function(){var t={};return t["_index"]=this.event._index,t["_id"]=this.event._id,t["_type"]=this.event._type,t["isSelected"]=this.isSelected,t["isStarred"]=this.isStarred,t},filteredLabels:function(){return this.event._source.label.filter((function(t){return!t.startsWith("__")}))},filteredLabelsToAdd:function(){var t=this;return this.meta.filter_labels.filter((function(e){return-1===t.event._source.label.indexOf(e.label)}))},filteredLabelsToRemove:function(){var t=this;return this.meta.filter_labels.filter((function(e){return-1!==t.event._source.label.indexOf(e.label)}))}},methods:{toggleStar:function(){this.isStarred||gl.$emit("eventAnnotated",{type:"__ts_star",event:this.event,searchNode:this.currentSearchNode}),this.isStarred=!this.isStarred,w.saveEventAnnotation(this.sketch.id,"label","__ts_star",this.event,this.currentSearchNode).then((function(t){})).catch((function(t){console.error(t)}))},toggleStarOnSelect:function(t){this.isSelected&&t.includes(this.event._id)&&(this.isStarred=!this.isStarred)},postComment:function(t){var e=this;gl.$emit("eventAnnotated",{type:"__ts_comment",event:this.event,searchNode:this.currentSearchNode}),w.saveEventAnnotation(this.sketch.id,"comment",t,[this.event],this.currentSearchNode).then((function(t){e.comments.push(t.data.objects[0][0]),e.comment=""})).catch((function(t){}))},updateComment:function(t,e){var s=this;w.updateEventAnnotation(this.sketch.id,"comment",t,[this.event],this.currentSearchNode).then((function(t){s.$set(s.comments,e,t.data.objects[0][0])})).catch((function(t){console.error(t)}))},deleteComment:function(t,e){var s=this;confirm("Are you sure?")&&w.deleteEventAnnotation(this.sketch.id,"comment",t,this.event,this.currentSearchNode).then((function(t){s.comments.splice(e,1)})).catch((function(t){console.error(t)}))},toggleEditComment:function(t,e){if(e){var s=this.comments[t];s.editable=!0,this.$set(this.comments,t,s)}else{var i=this.comments[t];i.editable=!1,this.$set(this.comments,t,i)}},getCurrentUser:function(){var t=this;return this.$store.state.currentUser?this.currentUser=this.$store.state.currentUser:this.currentUser||w.getLoggedInUser().then((function(e){t.currentUser=e.data.objects[0].username})),this.currentUser},addLabels:function(t){var e=this;void 0===t&&(t=this.selectedLabels),Array.isArray(t)||(t=[t]),t.length&&gl.$emit("eventAnnotated",{type:"__ts_label",event:this.event,searchNode:this.currentSearchNode}),t.forEach((function(t){-1===e.event._source.label.indexOf(t)&&(e.event._source.label.push(t),w.saveEventAnnotation(e.sketch.id,"label",t,[e.event],e.currentSearchNode).then((function(s){e.$emit("addLabel",t)})).catch((function(s){We["a"].open("Error adding label"),e.event._source.label=e.event._source.label.filter((function(e){return e!==t}))})))})),this.labelsToRemove.length&&(this.labelsToRemove.forEach((function(t){w.saveEventAnnotation(e.sketch.id,"label",t,[e.event],e.currentSearchNode,!0).then((function(t){})).catch((function(t){})),e.event._source.label=e.event._source.label.filter((function(e){return e!==t}))})),this.labelsToRemove=[]),this.selectedLabels=[],this.labelToAdd=null,this.$refs.labelDropdown.toggle()},searchContext:function(){this.$emit("searchContext",this.event)},selectEvent:function(){this.isSelected=!0,gl.$emit("eventSelected",this.eventDataSparse)},unSelectEvent:function(){this.isSelected=!1,gl.$emit("eventSelected",this.eventDataSparse)},toggleSelect:function(){this.isSelected?this.unSelectEvent():this.selectEvent()},toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme}},beforeDestroy:function(){gl.$off("selectEvent",this.selectEvent),gl.$off("clearSelectedEvents",this.unSelectEvent),gl.$off("toggleStar",this.toggleStarOnSelect)},created:function(){var t=this;if(gl.$on("selectEvent",this.selectEvent),gl.$on("clearSelectedEvents",this.unSelectEvent),gl.$on("toggleStar",this.toggleStarOnSelect),gl.$on("isDarkTheme",this.toggleTheme),this.isDarkTheme="dark"===localStorage.theme,this.event._source.label.indexOf("__ts_star")>-1&&(this.isStarred=!0),this.event._source.label.indexOf("__ts_comment")>-1){var e=this.event._index,s=this.event._id;w.getEvent(this.sketch.id,e,s).then((function(e){t.comments=e.data.meta.comments})).catch((function(t){}))}}},Je=Be,Ze=(s("37ea"),Object(c["a"])(Je,ke,Se,!1,null,"158bafc4",null)),Ke=Ze.exports,Xe={components:{TsSketchExploreEventListRow:Ke},props:["eventList","order","selectedFields","displayOptions","searchNode"],data:function(){return{selectAll:!1}},methods:{toggleSelectAll:function(){this.selectAll?(gl.$emit("clearSelectedEvents"),this.selectAll=!1):(gl.$emit("selectEvent"),this.selectAll=!0)}},computed:{datetimeWidth:function(){return this.displayOptions.showMillis?"220":"165"}}},ts=Xe,es=(s("dc39"),Object(c["a"])(ts,Ce,we,!1,null,"3d4b2d6f",null)),ss=es.exports,is=function(){var t=this,e=t._self._c;return e("div",[e("b-loading",{attrs:{"is-full-page":!1,"can-cancel":!1},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[e("div",{staticClass:"lds-ripple"},[e("div"),e("div")]),e("div",{staticStyle:{position:"absolute","margin-top":"120px"}},[e("b",[t._v("Reloading timelines")])])]),t._l(t.activeTimelines,(function(s){return e("ts-timeline-chip",{key:s.id+s.name,attrs:{timeline:s,"is-selected":t.isSelected(s),"is-empty-state":t.isEmptyState,"events-count":t.getCount(s)},on:{remove:t.remove,save:t.save,toggle:t.toggleTimeline}})})),t.activeTimelines.length>3?e("div",{staticStyle:{"margin-top":"7px"}},[e("span",{staticStyle:{"text-decoration":"underline",cursor:"pointer","margin-right":"10px"},on:{click:t.enableAllTimelines}},[t._v("Enable all\n    ")]),e("span",{staticStyle:{"text-decoration":"underline",cursor:"pointer"},on:{click:t.disableAllTimelines}},[t._v("Disable all ")])]):t._e()],2)},as=[],ns=function(){var t=this,e=t._self._c;return e("span",[t.meta.permissions.write?e("span",[e("b-modal",{staticStyle:{"z-index":"999"},attrs:{active:t.showInfoModal,width:1024,scroll:"keep"},on:{"update:active":function(e){t.showInfoModal=e}}},[e("div",{staticClass:"modal-background"}),e("div",{staticClass:"modal-content"},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Detailed information for "+t._s(t.timeline.name))])]),e("div",{staticClass:"card-content"},[e("ul",[e("li",[t._v("Elasticsearch index: "+t._s(t.timeline.searchindex.index_name))]),t.meta.stats_per_timeline[t.timeline.id]?e("li",[t._v("\n                Number of events: "+t._s(t._f("compactNumber")(t.meta.stats_per_timeline[t.timeline.id]["count"]))+" ("+t._s(t.meta.stats_per_timeline[t.timeline.id]["count"])+")\n              ")]):t._e(),e("li",[t._v("Created by: "+t._s(t.timeline.user.username))]),e("li",[t._v("Created at: "+t._s(t._f("moment")(t.timeline.created_at,"YYYY-MM-DD HH:mm")))])]),e("br"),t._l(t.timeline.datasources,(function(s){return e("b-message",{key:s.id,attrs:{type:s.error_message?"is-danger":"is-success",title:s.created_at,closable:!1}},[e("ul",[e("li",[e("strong",[t._v("Provider:")]),t._v(" "+t._s(s.provider))]),e("li",[e("strong",[t._v("Context:")]),t._v(" "+t._s(s.context))]),e("li",[e("strong",[t._v("User:")]),t._v(" "+t._s(s.user.username))]),e("li",[e("strong",[t._v("File on disk:")]),t._v(" "+t._s(s.file_on_disk))]),e("li",[e("strong",[t._v("File size:")]),t._v(" "+t._s(t._f("compactBytes")(s.file_size)))]),e("li",[e("strong",[t._v("Original filename:")]),t._v(" "+t._s(s.original_filename))]),e("li",[e("strong",[t._v("Data label:")]),t._v(" "+t._s(s.data_label))])]),e("br"),s.error_message?e("div",[e("strong",{staticStyle:{"font-size":"1.2rem","margin-bottom":"10px"}},[t._v("Error detail")]),e("pre",{staticStyle:{"margin-top":"10px"}},[t._v(t._s(s.error_message))])]):t._e()])}))],2)])]),e("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){t.showInfoModal=!t.showInfoModal}}})]),e("b-modal",{staticStyle:{"z-index":"999"},attrs:{active:t.showEditModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showEditModal=e}}},[e("div",{staticClass:"modal-background"}),e("div",{staticClass:"modal-content"},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Rename timeline")])]),e("div",{staticClass:"card-content"},[e("div",{staticClass:"content"},[e("form",{on:{submit:function(t){t.preventDefault()}}},[e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.newTimelineName,expression:"newTimelineName"}],staticClass:"input",attrs:{type:"text",required:"",autofocus:""},domProps:{value:t.newTimelineName},on:{input:function(e){e.target.composing||(t.newTimelineName=e.target.value)}}})])]),e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save"},on:{click:function(e){return t.rename()}}})])])])])])])]),e("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){t.showEditModal=!t.showEditModal}}})]),e("b-modal",{staticStyle:{"z-index":"999"},attrs:{active:t.showAnalyzerModal,width:1024,scroll:"keep"},on:{"update:active":function(e){t.showAnalyzerModal=e}}},[e("div",{staticClass:"modal-background"}),e("div",{staticClass:"modal-content"},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Analyzer logs for "+t._s(t.timeline.name))])]),t.showAnalyzerModal?e("div",{staticClass:"card-content"},[e("ts-analyzer-history",{attrs:{timeline:t.timeline,isModal:"true"},on:{closeHistory:function(e){t.showAnalyzerModal=!1}}})],1):t._e()])]),e("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){t.showAnalyzerModal=!t.showAnalyzerModal}}})])],1):t._e(),e("span",{staticClass:"tag is-medium has-text-left timeline-chip",style:t.getTimelineStyle(t.timeline),on:{click:function(e){return t.toggleTimeline(t.timeline)}}},[t._v("\n    "+t._s(t.timeline.name)+"\n    "),t.datasourceErrors.length?e("span",{staticClass:"b-tooltips import-error",on:{click:function(t){t.stopPropagation()}}},[e("b-tooltip",{attrs:{label:t.datasourceErrors.length+" failed imports",type:t.isDarkTheme?"is-dark":"is-light"}},[e("span",{staticClass:"icon is-small",staticStyle:{color:"orange"}},[e("i",{staticClass:"fas fa-exclamation-triangle",on:{click:function(e){t.showInfoModal=!t.showInfoModal}}})])])],1):t._e(),e("span",{staticClass:"tag is-small timeline-count",staticStyle:{color:"#333"}},[t.isSelected&&!t.isEmptyState?e("span",[t._v(t._s(t._f("compactNumber")(t.eventsCount))+" ")]):t._e()]),t.meta.permissions.write?e("span",{on:{click:function(t){t.stopPropagation()}}},[e("ts-dropdown",{attrs:{width:"270px"},scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("a",{staticStyle:{color:"#333"},attrs:{role:"button"}},[e("i",{staticClass:"fas fa-ellipsis-v",staticStyle:{"padding-left":"14px","padding-right":"6px"}})])]},proxy:!0}],null,!1,3000788609)},[e("div",{staticClass:"ts-dropdown-item",on:{click:function(e){t.showInfoModal=!t.showInfoModal}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-info-circle"})]),e("span",[t._v("Info")])]),"ready"===t.timelineStatus?e("div",{staticClass:"ts-dropdown-item",on:{click:function(e){t.showEditModal=!t.showEditModal}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-edit"})]),e("span",[t._v("Rename")])]):t._e(),"ready"===t.timelineStatus?e("div",{staticClass:"ts-dropdown-item",on:{click:function(e){t.showAnalyzerModal=!t.showAnalyzerModal}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-history"})]),e("span",[t._v("Analyzer logs")])]):t._e(),e("div",{staticClass:"ts-dropdown-item",on:{click:function(e){return t.remove()}}},[e("span",{staticClass:"icon is-small is-danger"},[e("i",{staticClass:"fas fa-trash"})]),e("span",[t._v("Delete")])]),e("hr"),"ready"===t.timelineStatus?e("div",[e("color-picker",{staticStyle:{"box-shadow":"none","background-color":"transparent",padding:"0"},attrs:{palette:t.colorPickerPalette},on:{input:t.updateColor},model:{value:t.initialColor,callback:function(e){t.initialColor=e},expression:"initialColor"}})],1):t._e()])],1):t._e()])])},rs=[],os={components:{"color-picker":lt["Compact"],TsAnalyzerHistory:gt,TsDropdown:kt},props:["timeline","eventsCount","isSelected","isEmptyState"],data:function(){return{initialColor:{},newColor:"",newTimelineName:"",timelineStatus:"",colorPickerActive:!1,showInfoModal:!1,showEditModal:!1,showAnalyzerModal:!1,isDarkTheme:!1,colorPickerPalette:St}},computed:{meta:function(){return this.$store.state.meta},datasourceErrors:function(){return this.timeline.datasources.filter((function(t){return t.error_message}))}},methods:{showColorPicker:function(){this.$refs.colorPicker.click()},rename:function(){this.showEditModal=!1,this.$emit("save",this.timeline,this.newTimelineName)},remove:function(){confirm("Delete the timeline?")&&this.$emit("remove",this.timeline)},updateColor:dt.a.debounce((function(t){this.newColor=t.hex,this.newColor.startsWith("#")&&(this.newColor=this.newColor.substring(1)),i["default"].set(this.timeline,"color",this.newColor),this.$emit("save",this.timeline)}),0),toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme},getTimelineStyle:function(t){this.isDarkTheme="dark"===localStorage.theme;var e=t.color,s="none",i="100%";return e.startsWith("#")||(e="#"+e),this.isSelected||(e="#d2d2d2",s="line-through",i="50%"),this.isDarkTheme?{"background-color":e,"text-decoration":s,opacity:i,filter:"grayscale(25%)",color:"#333333"}:{"background-color":e,"text-decoration":s,opacity:i}},toggleTimeline:function(t){this.$emit("toggle",t)}},mounted:function(){var t=this;window.addEventListener("click",(function(e){t.$el.contains(e.target)||(t.colorPickerActive=!1)}))},created:function(){this.isDarkTheme="dark"===localStorage.theme,gl.$on("isDarkTheme",this.toggleTheme),this.initialColor={hex:this.timeline.color},this.timelineStatus=this.timeline.status[0].status,this.newTimelineName=this.timeline.name},beforeDestroy:function(){clearInterval(this.t),this.t=!1}},cs=os,ls=(s("f3d2"),s("966b"),Object(c["a"])(cs,ns,rs,!1,null,"76a411a2",null)),us=ls.exports,ds={components:{TsTimelineChip:us},props:["currentQueryFilter","countPerIndex","countPerTimeline"],computed:{sketch:function(){return this.$store.state.sketch},activeTimelines:function(){var t=Object(U["a"])(this.sketch.active_timelines);return t.sort((function(t,e){return t.name.localeCompare(e.name)}))},isEmptyState:function(){return void 0===this.countPerTimeline}},data:function(){return{isDarkTheme:!1,isLoading:!1,selectedTimelines:[]}},methods:{isSelected:function(t){return this.selectedTimelines.includes(t)},getCount:function(t){var e=0;return this.countPerTimeline&&(e=this.countPerTimeline[t.id],"number"===typeof e)||!e&&this.countPerIndex&&(e=this.countPerIndex[t.searchindex.index_name]),e},remove:function(t){var e=this;this.isLoading=!0,w.deleteSketchTimeline(this.sketch.id,t.id).then((function(){e.$store.dispatch("updateSketch",e.sketch.id).then((function(){e.syncSelectedTimelines(),e.isLoading=!1}))})).catch((function(t){console.error(t),e.isLoading=!1}))},save:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s&&(this.isLoading=!0),w.saveSketchTimeline(this.sketch.id,t.id,s||t.name,t.description,t.color).then((function(){e.$store.dispatch("updateSketch",e.sketch.id).then((function(){e.syncSelectedTimelines(),e.isLoading=!1}))})).catch((function(t){console.error(t),e.isLoading=!1}))},enableAllTimelines:function(){this.selectedTimelines=this.activeTimelines,this.$emit("updateSelectedTimelines",this.selectedTimelines)},disableAllTimelines:function(){this.selectedTimelines=[],this.$emit("updateSelectedTimelines",this.selectedTimelines)},toggleTimeline:function(t){var e=this.selectedTimelines.slice(),s=e.indexOf(t);-1===s?e.push(t):e.splice(s,1),this.selectedTimelines=e,this.$emit("updateSelectedTimelines",this.selectedTimelines)},toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme},syncSelectedTimelines:function(){var t=this;if(this.currentQueryFilter.indices.includes("_all"))this.selectedTimelines=this.activeTimelines;else{var e=[];this.currentQueryFilter.indices.forEach((function(s){if("string"===typeof s){var i=t.activeTimelines.find((function(t){return t.searchindex.index_name===s}));e.push(i)}else if("number"===typeof s){var a=t.activeTimelines.find((function(t){return t.id===s}));e.push(a)}})),this.selectedTimelines=e}}},created:function(){gl.$on("isDarkTheme",this.toggleTheme),gl.$on("clearSearch",this.enableAllTimelines),this.currentQueryFilter.indices.includes("_all")?this.selectedTimelines=this.activeTimelines:this.syncSelectedTimelines()},watch:{"currentQueryFilter.indices":function(t){this.syncSelectedTimelines()},deep:!0}},hs=ds,ps=Object(c["a"])(hs,is,as,!1,null,null,null),ms=ps.exports,fs=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"field is-horizontal"},[e("div",{staticClass:"field-body",staticStyle:{display:"flex","align-items":"center"}},[e("b-radio",{attrs:{"native-value":"interval",type:"is-info"},on:{input:function(e){return t.formatDateTime()}},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}}),e("div",{staticClass:"field",staticStyle:{"margin-left":"5px"}},[e("p",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.offsetStart,expression:"offsetStart",modifiers:{trim:!0}}],ref:"offsetStartInput",staticClass:"input",attrs:{type:"text",disabled:!t.isSelected("interval"),placeholder:t.getPlaceholder("interval")},domProps:{value:t.offsetStart},on:{change:function(e){t.offsetStart&&t.formatDateTime()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit()},input:function(e){e.target.composing||(t.offsetStart=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]),e("div",[t._v("-")]),e("div",{staticClass:"field",staticStyle:{margin:"0px"}},[e("p",{staticClass:"control",staticStyle:{width:"40px","margin-left":"2px"}},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.offsetMinus,expression:"offsetMinus",modifiers:{trim:!0}}],ref:"offsetMinusInput",staticClass:"input",staticStyle:{width:"90%"},attrs:{type:"text",disabled:!t.isSelected("interval")},domProps:{value:t.offsetMinus},on:{change:function(e){t.offsetMinus&&t.formatDateTime()},keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit()},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"]))return null;t.offsetMinus++},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"]))return null;t.offsetMinus--}],input:function(e){e.target.composing||(t.offsetMinus=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]),e("div",[t._v("+")]),e("div",{staticClass:"field",staticStyle:{margin:"0px"}},[e("p",{staticClass:"control",staticStyle:{width:"40px","margin-left":"2px"}},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.offsetPlus,expression:"offsetPlus",modifiers:{trim:!0}}],ref:"offsetPlusInput",staticClass:"input",staticStyle:{width:"90%"},attrs:{type:"text",disabled:!t.isSelected("interval")},domProps:{value:t.offsetPlus},on:{change:function(e){t.offsetPlus&&t.formatDateTime()},keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit()},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"]))return null;t.offsetPlus++},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"]))return null;t.offsetPlus--}],input:function(e){e.target.composing||(t.offsetPlus=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]),e("div"),e("div",{staticClass:"field",staticStyle:{"margin-right":"5px"}},[e("p",{staticClass:"control"},[e("span",{staticClass:"select"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedInterval,expression:"selectedInterval"}],attrs:{disabled:!t.isSelected("interval")},on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedInterval=e.target.multiple?s:s[0]},function(e){t.offsetStart&&t.formatDateTime()}]}},t._l(t.intervals,(function(s){return e("option",{key:s.value,domProps:{value:s.value}},[t._v(t._s(s.text))])})),0)])])])],1)]),e("div",{staticClass:"field is-horizontal"},[e("div",{staticClass:"field-body",staticStyle:{display:"flex","align-items":"center"}},[e("b-radio",{attrs:{"native-value":"range",type:"is-info"},on:{input:function(e){return t.formatDateTime()}},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}}),e("div",{staticClass:"field",staticStyle:{margin:"5px"}},[e("p",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.startDateTime,expression:"startDateTime",modifiers:{trim:!0}}],ref:"startInput",staticClass:"input",attrs:{type:"text",disabled:!t.isSelected("range"),placeholder:t.getPlaceholder("range")},domProps:{value:t.startDateTime},on:{change:function(e){t.startDateTime&&t.formatDateTime()},keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.endDateTime?t.submit():t.formatDateTime(t.skipCheck=!0)&&t.jumpTo("endInput")},input:function(e){e.target.composing||(t.startDateTime=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]),e("div",[t._v("")]),e("div",{staticClass:"field",staticStyle:{margin:"5px"}},[e("p",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.endDateTime,expression:"endDateTime",modifiers:{trim:!0}}],ref:"endInput",staticClass:"input",attrs:{type:"text",disabled:!t.isSelected("range"),placeholder:t.getPlaceholder("range")},domProps:{value:t.endDateTime},on:{change:function(e){t.endDateTime&&t.formatDateTime()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit()},input:function(e){e.target.composing||(t.endDateTime=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])])],1)]),e("div",{staticClass:"field is-horizontal"},[e("div",{staticClass:"field is-grouped"},[e("p",{staticClass:"control"},[e("button",{staticClass:"button is-info",attrs:{disabled:!t.ready},on:{click:t.submit}},[t._v("\n          "+t._s(t.selectedChip?"Update":"Add filter")+"\n        ")])])])])])},vs=[],gs=(s("8e6e"),s("4917"),s("bd86"));function ys(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function _s(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?ys(Object(s),!0).forEach((function(e){Object(gs["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ys(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var bs={props:["selectedChip"],data:function(){return{startDateTime:"",endDateTime:"",chip:"",radio:"interval",offsetStart:"",offsetMinus:5,offsetPlus:5,intervals:[{text:"Second",value:"s"},{text:"Minute",value:"m"},{text:"Hour",value:"h"},{text:"Day",value:"d"}],selectedInterval:"m",ready:!1,now:this.$moment.utc().format("YYYY-MM-DD[T]hh:mm:ss")}},created:function(){if(this.selectedChip)if(this.chip=_s({},this.selectedChip),"datetime_range"===this.chip.type){this.radio="range";var t=this.chip.value.split(",");this.startDateTime=t[0],this.endDateTime=t[1]}else{this.radio="interval";var e=this.chip.value;this.offsetStart=e.match(/^\s*([0-9/:T -]{4,})(:? -)/)[1],this.offsetPlus=e.match(/\s[+]([0-9]+)/)[1],this.offsetMinus=e.match(/\s[-]([0-9]+)/)[1],this.selectedInterval=e.match(/\s\+[0-9]+([a-zA-Z])/)[1],this.formatDateTime()}},methods:{hasAllInputs:function(){if(this.isSelected("interval")){if(this.offsetStart&&this.offsetMinus&&this.offsetPlus)return!0}else if(this.isSelected("range")&&this.startDateTime&&this.endDateTime)return!0;return!1},getPlaceholder:function(t){return this.radio===t?this.now:""},getOffsetDateTime:function(){return"".concat(this.offsetStart," -").concat(this.offsetMinus).concat(this.selectedInterval," +").concat(this.offsetPlus).concat(this.selectedInterval)},formatDateTime:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.ready=!1,!t&&!this.hasAllInputs())return!1;var e=this.isSelected("interval")?this.getOffsetDateTime():this.startDateTime,s="YYYY-MM-DDTHH:mm:ss",i=this.endDateTime,a=/^(.+?)[ ]?(-|\+|\+-|-\+)(\d+)(y|d|h|m|s|M|Q|w|ms)[ ]*(?:(-|\+|\+-|-\+)(\d+)(y|d|h|m|s|M|Q|w|ms))?$/,n=a.exec(e);if(null!=n){var r=this.$moment.utc(n[1]);if(!r.isValid())return!1;this.startDateTime=r.format(s),this.endDateTime=r.format(s),n=n.slice(2);while(n.length){var o=n[0],c=n[1],l=n[2]||"m";n=n.slice(3),"-"===o?this.startDateTime=r.clone().subtract(c,l).format(s):"+"===o?this.endDateTime=r.clone().add(c,l).format(s):"-+"!==o&&"+-"!==o||(this.startDateTime=r.clone().subtract(c,l).format(s),this.endDateTime=r.clone().add(c,l).format(s))}return this.ready=!0,!0}i||(i=e);var u=this.$moment.utc(e),d=this.$moment.utc(i);return u.hour()||u.minute()||u.second()||d.hour()||d.minute()||d.second()||(s="YYYY-MM-DD"),u.isValid()&&(this.startDateTime=u.format(s)),d.isValid()&&(this.endDateTime=d.format(s)),!(!u.isValid()||!d.isValid())&&(this.ready=!0,!0)},submit:function(){if(this.startDateTime&&this.endDateTime&&this.formatDateTime()){if(this.startDateTime>this.endDateTime){var t=[this.endDateTime,this.startDateTime];this.startDateTime=t[0],this.endDateTime=t[1]}var e="",s="";"interval"===this.radio?(e="datetime_interval",s=this.getOffsetDateTime()):(e="datetime_range",s=this.startDateTime+","+this.endDateTime),this.chip?(this.chip["type"]=e,this.chip["value"]=s,this.$emit("updateChip",this.chip)):(this.chip={field:"",type:e,value:s,operator:"must",active:!0},this.$emit("addChip",this.chip),this.resetInterface()),this.$emit("hideDropdown")}},resetInterface:function(){Object.assign(this.$data,this.$options.data.apply(this))},isSelected:function(t){return this.radio===t},jumpTo:function(t){this.$refs[t].focus()}}},Cs=bs,ws=Object(c["a"])(Cs,fs,vs,!1,null,null,null),ks=ws.exports,Ss=function(){var t=this,e=t._self._c;return Object.keys(t.treeData).length>0?e("ul",{staticClass:"tree"},[e("tree-node",{attrs:{node:t.treeData,"handle-click":t.handleClick,"selected-node":t.selectedNode}})],1):t._e()},xs=[],Ts=s("7618"),As=function(){var t=this,e=t._self._c;return e("li",[e("span",{class:[{active:t.isSelected},{star:t.hasStar&&!t.isSelected},{dimmed:0===t.count&&!t.isSelected}],staticStyle:{"min-width":"205px"},attrs:{id:t.node.id},on:{click:function(e){return t.handleClick(t.node)}}},[t.hasStar?e("i",{staticClass:"fas fa-star",staticStyle:{float:"left",color:"#FFD700","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"#777777","margin-right":"10px","margin-top":"3px"}}):t._e(),t.hasComment?e("i",{staticClass:"fas fa-comment",staticStyle:{float:"left","margin-right":"10px","margin-top":"3px"}}):t._e(),t.hasLabel?e("i",{staticClass:"fas fa-tag",staticStyle:{float:"left","margin-right":"10px","margin-top":"3px"}}):t._e(),e("div",{staticClass:"query-string",class:[{"query-string-active":t.isSelected}],staticStyle:{float:"left"}},[t._v("\n      "+t._s(t.node.query_string)+"\n    ")]),e("div",{staticClass:"tag is-light",staticStyle:{"margin-left":"10px","margin-right":"-5px",float:"right"}},[t._v("\n      "+t._s(t._f("compactNumber")(t.count))+"\n    ")])]),t.node.children&&t.node.children.length?e("ul",t._l(t.node.children,(function(s){return e("node",{key:s.id,attrs:{node:s,"handle-click":t.handleClick,"selected-node":t.selectedNode}})})),1):t._e()])},Os=[],Ds={name:"node",props:{node:Object,handleClick:Function,selectedNode:Object},computed:{hasStar:function(){return this.node.labels.includes("__ts_star")},hasLabel:function(){return this.node.labels.includes("__ts_label")},hasComment:function(){return this.node.labels.includes("__ts_comment")},isSelected:function(){return this.selectedNode.id===this.node.id},count:function(){return this.node.query_result_count||0}}},Es=Ds,$s=(s("8855"),Object(c["a"])(Es,As,Os,!1,null,"6be41fe6",null)),Fs=$s.exports;function Ns(t,e,s){if(t.hasOwnProperty(e)&&!0===s(e,t[e]))return t;for(var i=0;i<Object.keys(t).length;i++){var a=t[Object.keys(t)[i]];if("object"===Object(Ts["a"])(a)&&null!=a){var n=Ns(a,e,s);if(null!=n)return n}}return null}var Is={components:{TreeNode:Fs},data:function(){return{treeData:{},selectedNode:null,initialNode:null}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{handleClick:function(t){this.$emit("node-click",t),this.selectedNode=t},handleClickFromDropdown:function(t){var e;e="number"===typeof t?t:t.id;var s=Ns(this.treeData,"id",(function(t,s){return s===e}));this.$emit("node-click",s),this.selectedNode=s},createBranch:function(t){if(this.selectedNode){if(this.selectedNode.id===t.id)return;return this.selectedNode.children.push(t),void(this.selectedNode=t)}this.fetchHistory();var e=Ns(this.treeData,"id",(function(e,s){return s===t.parent}));if(e){if(e.children.some((function(e){return e.id===t.id})))return;return e.children.push(t),void(this.selectedNode=t)}var s=Ns(this.treeData,"id",(function(e,s){return s===t.id}));s&&(this.selectedNode=s)},annotateNode:function(t){t.searchNode.labels.includes(t.type)||t.searchNode.labels.push(t.type)},scrollTo:function(){this.$nextTick((function(){document.getElementById(this.selectedNode.id.toString()).scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}))},fetchHistory:function(){var t=this;w.getSearchHistoryTree(this.sketch.id).then((function(e){if(t.treeData=e.data.objects[0],!t.selectedNode){var s=e.data.meta["last_node_id"];t.selectedNode=Ns(t.treeData,"id",(function(t,e){return e===s}))}})).catch((function(t){}))}},beforeDestroy:function(){gl.$off("createBranch"),gl.$off("eventAnnotated"),gl.$off("triggerScrollTo"),gl.$off("selected-node-from-dropdown")},created:function(){gl.$on("createBranch",this.createBranch),gl.$on("eventAnnotated",this.annotateNode),gl.$on("triggerScrollTo",this.scrollTo),gl.$on("selected-node-from-dropdown",this.handleClickFromDropdown),this.fetchHistory()},watch:{selectedNode:function(){this.$store.dispatch("updateSearchNode",this.selectedNode),this.scrollTo()}}},Ms=Is,Ps=Object(c["a"])(Ms,Ss,xs,!1,null,"4fb2ef28",null),Ls=Ps.exports,js=function(){var t=this,e=t._self._c;return e("span",[e("button",{staticClass:"button",attrs:{title:"Click to go back",disabled:!t.hasParent},on:{click:t.searchHistoryBack}},[t._m(0)]),e("button",{staticClass:"button",staticStyle:{"padding-left":"7px"},attrs:{title:"Click to go forward",disabled:!t.hasChild},on:{click:t.searchHistoryForward}},[t._m(1)])])},Rs=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-arrow-left"})])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-arrow-right"})])}],zs={computed:{currentSearchNode:function(){return this.$store.state.currentSearchNode},hasParent:function(){return!!this.currentSearchNode&&"number"===typeof this.currentSearchNode.parent},hasChild:function(){return!!this.currentSearchNode&&this.currentSearchNode.children.length}},methods:{searchHistoryBack:function(){gl.$emit("selected-node-from-dropdown",this.currentSearchNode.parent)},searchHistoryForward:function(){if(this.currentSearchNode.children.length){var t=this.currentSearchNode.children.slice(-1).pop();gl.$emit("selected-node-from-dropdown",t)}}}},Qs=zs,Hs=(s("6db3"),Object(c["a"])(Qs,js,Rs,!1,null,"29dba5ca",null)),Gs=Hs.exports,qs=function(){var t=this,e=t._self._c;return e("div",[e("apexchart",{attrs:{height:"250",options:t.options,series:t.series}})],1)},Vs=[],Us=(s("ffc1"),s("1321")),Ys=s.n(Us),Ws={props:["chartData"],components:{Apexchart:Ys.a},data:function(){var t=this;return{options:{chart:{type:"bar",zoom:{enabled:!0,type:"x",autoScaleYaxis:!0},foreColor:"#fff",animations:{enabled:!0,easing:"easeinout",speed:50,animateGradually:{enabled:!0,delay:50},dynamicAnimation:{enabled:!0,speed:50}},colors:["#4285f"],toolbar:{show:!0,tools:{download:!1,selection:!0,zoom:!0,zoomin:!0,zoomout:!0}},events:{dataPointSelection:function(e,s,i){t.emitFilterRequest(i)}}},tooltip:{enabled:!0,followCursor:!1,theme:"dark",x:{formatter:function(e){var s=t.getBucketDateTimeRange(e),i=t.$moment.duration(s.start.diff(s.end));return"".concat(s.start.format("YYYY-MM-DD HH:mm:ss")," + ").concat(i.humanize())}}},plotOptions:{bar:{columnWidth:"95%",borderRadius:4}},dataLabels:{enabled:!1},grid:{xaxis:{lines:{show:!1}},yaxis:{lines:{show:!1}}},xaxis:{type:"datetime",tickPlacement:"on"}}}},computed:{series:function(){var t={name:"Events",data:[]};return this.chartData?(t.data=Object.entries(this.chartData.data).map((function(t){return[parseInt(t[0]),t[1]]})),[t]):[t]}},methods:{getBucketDateTimeRange:function(t){var e=this.$moment.utc(t),s=this.chartData.interval.split(/(\d+)/),i=s[1],a=s[2],n=this.$moment.utc(t).add(parseInt(i),a);return{start:e,end:n}},emitFilterRequest:function(t){var e=t.selectedDataPoints[0][0],s=t.w.config.series[0]["data"];if(1!==s.length){var i=s[e][0],a=this.getBucketDateTimeRange(i),n={field:"",type:"datetime_range",value:a.start.toISOString()+","+a.end.toISOString(),operator:"must",active:!0};this.$emit("addChip",n)}},setTheme:function(){"dark"===localStorage.theme?this.options={chart:{foreColor:"#fff"},tooltip:{theme:"dark"}}:this.options={chart:{foreColor:"#333"},tooltip:{theme:"light"}}}},created:function(){gl.$on("isDarkTheme",this.setTheme)},mounted:function(){this.setTheme()}},Bs=Ws,Js=Object(c["a"])(Bs,qs,Vs,!1,null,null,null),Zs=Js.exports,Ks=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"max-height":"600px","border-top":"1px solid var(--table-cell-border-color)",overflow:"hidden"}},[Object.keys(t.matches).length?e("div",{staticClass:"columns is-gapless"},[t.matches.fields.length?e("div",{staticClass:"column",staticStyle:{"max-width":"50%",overflow:"auto","overflow-x":"hidden","max-height":"600px"}},[e("div",{staticStyle:{padding:"20px"}},[t._m(0),t._l(t.matches.fields,(function(s){return e("div",{key:s.field,staticClass:"list-item",staticStyle:{cursor:"pointer",padding:"5px 0 5px 0"},on:{click:function(e){return t.searchForField(s.field)}}},[e("span",{staticStyle:{"margin-right":"5px"}},[t._v(t._s(s.field))])])}))],2)]):t._e(),t.matches.dataTypes.length?e("div",{staticClass:"column",staticStyle:{"border-left":"1px solid var(--table-cell-border-color)","max-width":"50%",overflow:"auto","overflow-x":"hidden","max-height":"600px"}},[e("div",{staticStyle:{padding:"20px"}},[t._m(1),t._l(t.matches.dataTypes,(function(s){return e("div",{key:s.data_type,staticClass:"list-item",staticStyle:{cursor:"pointer",padding:"5px 0 5px 0"},on:{click:function(e){return t.searchForDataType(s.data_type)}}},[e("span",{staticStyle:{"margin-right":"5px"}},[t._v(t._s(s.data_type))]),e("strong",{staticStyle:{opacity:"0.9"}},[t._v("("+t._s(t._f("compactNumber")(s.count))+")")])])}))],2)]):t._e(),t.matches.tags.length||t.matches.labels.length?e("div",{staticClass:"column",staticStyle:{"border-left":"1px solid var(--table-cell-border-color)","max-width":"50%",overflow:"auto","overflow-x":"hidden","max-height":"600px"}},[e("div",{staticStyle:{padding:"20px"}},[t._m(2),t._l(t.matches.labels,(function(s){return e("div",{key:s.label,staticClass:"list-item",staticStyle:{cursor:"pointer",padding:"5px 0 5px 0"},on:{click:function(e){return t.searchForLabel(s.label)}}},["__ts_star"===s.label?e("span",[t._m(3,!0),t._v("\n            Starred\n          ")]):"__ts_comment"===s.label?e("span",[t._m(4,!0),t._v("\n            Commented\n          ")]):e("span",{staticStyle:{"margin-right":"5px"}},[t._v(t._s(s.label))]),e("strong",{staticStyle:{opacity:"0.9"}},[t._v("("+t._s(t._f("compactNumber")(s.count))+")")])])})),t._l(t.matches.tags,(function(s){return e("div",{key:s.tag,staticClass:"list-item",staticStyle:{cursor:"pointer",padding:"5px 0 5px 0"},on:{click:function(e){return t.searchForTag(s.tag)}}},[e("span",{staticStyle:{"margin-right":"5px"}},[t._v(t._s(s.tag))]),e("strong",{staticStyle:{opacity:"0.9"}},[t._v("("+t._s(t._f("compactNumber")(s.count))+")")])])}))],2)]):t._e(),t.matches.savedSearches.length?e("div",{staticClass:"column",staticStyle:{"border-left":"1px solid var(--table-cell-border-color)","max-width":"50%",overflow:"auto","overflow-x":"hidden","max-height":"600px"}},[e("div",{staticStyle:{padding:"20px"}},[t._m(5),e("ts-view-list-compact",{attrs:{views:t.matches.savedSearches},on:{setActiveView:function(e){return t.$emit("setActiveView",e)}}})],1)]):t._e()]):t._e()])},Xs=[function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"padding-bottom":"10px"}},[e("strong",[t._v("Fields")])])},function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"padding-bottom":"10px"}},[e("strong",[t._v("Data Types")])])},function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"padding-bottom":"10px"}},[e("strong",[t._v("Tags")])])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[e("i",{staticClass:"fas fa-star",staticStyle:{color:"#ffe300","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"silver"}})])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"5px"}},[e("i",{staticClass:"fas fa-comment"})])},function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"padding-bottom":"10px"}},[e("strong",[t._v("Saved Searches")])])}],ti=function(){var t=this,e=t._self._c;return e("div",t._l(t.views,(function(s){return e("div",{key:s.id,staticClass:"view-list-item",on:{click:function(e){return t.setActiveView(s)}}},[t._v("\n    "+t._s(s.name)+"\n  ")])})),0)},ei=[],si={props:["views"],methods:{setActiveView:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&this.$emit("setActiveView",t)}}},ii=si,ai=(s("7295"),Object(c["a"])(ii,ti,ei,!1,null,"a6ceb8f4",null)),ni=ai.exports,ri=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},oi={components:{TsViewListCompact:ni},props:["selectedLabels","queryString"],computed:{meta:function(){return this.$store.state.meta},searchHistory:function(){return this.$store.state.searchHistory},tags:function(){return this.$store.state.tags},dataTypes:function(){return this.$store.state.dataTypes},all:function(){return{fields:this.meta.mappings,tags:this.tags,labels:this.meta.filter_labels,dataTypes:this.dataTypes,savedSearches:this.meta.views}},matches:function(){var t=this,e={};return this.queryString?(e["fields"]=this.meta.mappings.filter((function(e){return e.field.toLowerCase().includes(t.queryString.toLowerCase())})),e["tags"]=this.tags.filter((function(e){return e.tag.toLowerCase().includes(t.queryString.toLowerCase())})),e["labels"]=this.meta.filter_labels.filter((function(e){return e.label.toLowerCase().includes(t.queryString.toLowerCase())})),e["dataTypes"]=this.dataTypes.filter((function(e){return e.data_type.toLowerCase().includes(t.queryString.toLowerCase())})),e["savedSearches"]=this.meta.views.filter((function(e){return e.name.toLowerCase().includes(t.queryString.toLowerCase())})),Object.values(e).filter((function(t){return t.length})).length?e:this.all):this.all}},beforeDestroy:function(){window.removeEventListener("click",this.close)},created:function(){window.addEventListener("click",this.close)},methods:{close:function(t){this.$el.contains(t.target)||this.$emit("close",t.target)},searchForLabel:function(t){var e={doSearch:!0,queryString:"*"};e.queryFilter=ri();var s={field:"",value:t,type:"label",operator:"must",active:!0};e.queryFilter.chips.push(s),this.$emit("setQueryAndFilter",e)},searchForTag:function(t){var e={doSearch:!0};e.queryString="tag:"+t,e.queryFilter=ri(),this.$emit("setQueryAndFilter",e)},searchForDataType:function(t){var e={doSearch:!0};e.queryString='data_type:"'+t+'"',e.queryFilter=ri(),this.$emit("setQueryAndFilter",e)},searchForField:function(t){var e={},s="";""!==this.queryString&&(s=this.queryString+" "),this.queryString.includes(" ")||(s=""),e.doSearch=!1,e.queryString=s+t+":",e.queryFilter=ri(),this.$emit("setQueryAndFilter",e)}}},ci=oi,li=(s("0351"),Object(c["a"])(ci,Ks,Xs,!1,null,"cf019368",null)),ui=li.exports,di=function(){var t=this,e=t._self._c;return e("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.viewName,expression:"viewName"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Name your search",autofocus:""},domProps:{value:t.viewName},on:{input:function(e){e.target.composing||(t.viewName=e.target.value)}}})])]),t._m(0)])},hi=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save search"}})])])}],pi={props:["sketchId","currentQueryString","currentQueryFilter"],data:function(){return{viewName:""}},methods:{clearFormData:function(){this.viewName=""},submitForm:function(){var t=this;w.createView(this.sketchId,this.viewName,this.currentQueryString,this.currentQueryFilter).then((function(e){var s=e.data.objects[0];t.$emit("setActiveView",s),t.$store.state.meta.views.push(s),t.clearFormData(),t.$router.push({name:"Explore",query:{view:s.id}})})).catch((function(t){}))}}},mi=pi,fi=Object(c["a"])(mi,di,hi,!1,null,null,null),vi=fi.exports,gi=s("e1a1"),yi=s("34f3");function _i(t,e){var s="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!s){if(Array.isArray(t)||(s=bi(t))||e&&t&&"number"===typeof t.length){s&&(t=s);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r=!0,o=!1;return{s:function(){s=s.call(t)},n:function(){var t=s.next();return r=t.done,t},e:function(t){o=!0,n=t},f:function(){try{r||null==s.return||s.return()}finally{if(o)throw n}}}}function bi(t,e){if(t){if("string"===typeof t)return Ci(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Ci(t,e):void 0}}function Ci(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}var wi=function(){return{from:0,terminate_after:40,size:40,indices:[],order:"asc",chips:[]}},ki=function(){return{meta:{count_per_index:{}},objects:[]}},Si={directives:{dragscroll:yi["a"]},components:{TsSketchExploreEventList:ss,TsExploreTimelinePicker:ms,TsExploreFilterTime:ks,TsSearchHistoryTree:Ls,TsSearchHistoryButtons:Gs,TsBarChart:Zs,TsSearchDropdown:ui,TsCreateViewForm:vi,TsDropdown:kt},props:["sketchId"],data:function(){return{params:{},showCreateViewModal:!1,showFilterCard:!0,showSearch:!0,searchInProgress:!1,currentPage:1,contextEvent:!1,originalContext:!1,isFullPage:!0,loadingComponent:null,showSearchDropdown:!0,showSaveSearchModal:!1,eventList:{meta:{},objects:[]},currentQueryString:"",currentQueryFilter:wi(),selectedFields:[{field:"message",type:"text"}],selectedFieldsProxy:[],expandFieldDropdown:!1,selectedEvents:{},displayOptions:{showTags:!0,showEmojis:!0,showMillis:!1},selectedLabels:[],showSearchHistory:!1,showHistogram:!1,branchParent:gi["None"],zoomLevel:1,zoomOrigin:{x:0,y:0}}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},totalHits:function(){return this.eventList.meta.es_total_count_complete||0},totalHitsForPagination:function(){var t=this.eventList.meta.es_total_count_complete||0;return t>9999&&(t=1e4),t},totalTime:function(){return this.eventList.meta.es_time/1e3||0},fromEvent:function(){return this.currentQueryFilter.from||1},toEvent:function(){if(!(this.totalHits<this.currentQueryFilter.size))return parseInt(this.currentQueryFilter.from)+parseInt(this.currentQueryFilter.size)},numSelectedEvents:function(){return Object.keys(this.selectedEvents).length},filterChips:function(){return this.currentQueryFilter.chips.filter((function(t){return"label"===t.type||"term"===t.type}))},timeFilterChips:function(){return this.currentQueryFilter.chips.filter((function(t){return t.type.startsWith("datetime")}))},filteredLabels:function(){return this.$store.state.meta.filter_labels.filter((function(t){return!t.label.startsWith("__")}))},currentSearchNode:function(){return this.$store.state.currentSearchNode}},methods:{hideDropdown:function(){this.$refs["NewTimeFilter"].isActive=!1},search:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.searchInProgress=!0,this.currentQueryString){this.contextEvent&&this.$scrollTo("#context",200,{offset:-300}),this.selectedEvents={},this.eventList=ki(),s&&(this.currentQueryFilter.from=0,this.currentPage=1),this.currentQueryFilter.fields=this.selectedFields;var n={query:this.currentQueryString,filter:this.currentQueryFilter};i&&(n["incognito"]=!0),a&&(n["parent"]=a),a&&i&&(this.branchParent=a),this.branchParent&&(n["parent"]=this.branchParent),e&&(gl.$emit("newSearch"),this.showSearchDropdown=!1),w.search(this.sketchId,n).then((function(e){t.eventList.objects=e.data.objects,t.eventList.meta=e.data.meta,t.searchInProgress=!1,i||(gl.$emit("createBranch",t.eventList.meta.search_node),t.$store.dispatch("updateSearchHistory"),t.branchParent=t.eventList.meta.search_node.id)})).catch((function(t){}))}},setQueryAndFilter:function(t){this.currentQueryString=t.queryString,this.currentQueryFilter=t.queryFilter,this.$refs.searchInput.focus(),t.doSearch&&this.search()},exportSearchResult:function(){var t=this;this.loadingOpen();var e={query:this.currentQueryString,filter:this.currentQueryFilter,file_name:"export.zip"};w.exportSearchResult(this.sketchId,e).then((function(e){var s=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a"),a="export.zip";i.href=s,i.setAttribute("download",a),document.body.appendChild(i),i.click(),t.loadingClose()})).catch((function(e){console.error(e),t.loadingClose()}))},searchView:function(t){var e=this;this.selectedEvents={},this.showSearchDropdown=!1,this.showSaveSearchModal=!1,t!==parseInt(t,10)&&"string"!==typeof t&&(t=t.id,this.$router.push({name:"Explore",query:{view:t}})),w.getView(this.sketchId,t).then((function(t){var s=t.data.objects[0];if(e.currentQueryString=s.query_string,e.currentQueryFilter=JSON.parse(s.query_filter),e.currentQueryFilter.fields&&e.currentQueryFilter.fields.length||(e.currentQueryFilter.fields=[{field:"message",type:"text"}]),e.selectedFields=e.currentQueryFilter.fields,"_all"===e.currentQueryFilter.indices[0]||"_all"===e.currentQueryFilter.indices){var i=[];e.sketch.active_timelines.forEach((function(t){var s=e.meta.indices_metadata[t.searchindex.index_name].is_legacy;s?i.push(t.searchindex.index_name):i.push(t.id)})),e.currentQueryFilter.indices=i}var a=e.currentQueryFilter.chips;if(a)for(var n=0;n<a.length;n++)"label"===a[n].type&&e.selectedLabels.push(a[n].value);e.contextEvent=!1,e.search(!1)})).catch((function(t){}))},searchContext:function(t){var e=300,s=500;if(this.contextEvent=t,!this.originalContext){var i=JSON.parse(JSON.stringify(this.currentQueryString)),a=JSON.parse(JSON.stringify(this.currentQueryFilter));this.originalContext={queryString:i,queryFilter:a}}var n="YYYY-MM-DDTHH:mm:ss",r=this.$moment.utc(this.contextEvent._source.datetime),o=r.clone().subtract(e,"s").format(n),c=r.clone().add(e,"s").format(n),l={field:"",value:o+","+r.format(n),type:"datetime_range",operator:"must",active:!0},u={field:"",value:r.format(n)+","+c,type:"datetime_range",operator:"must",active:!0};this.currentQueryString="* OR _id:"+this.contextEvent._id,this.currentQueryFilter.chips=[l,u];var d=this.meta.indices_metadata[this.contextEvent._index].is_legacy;this.currentQueryFilter.indices=d?[this.contextEvent._index]:[this.contextEvent._source.__ts_timeline_id],this.currentQueryFilter.size=s,this.search()},removeContext:function(){this.contextEvent=!1,this.currentQueryString=JSON.parse(JSON.stringify(this.originalContext.queryString)),this.currentQueryFilter=JSON.parse(JSON.stringify(this.originalContext.queryFilter)),this.search()},scrollToContextEvent:function(){this.$scrollTo("#"+this.contextEvent._id,200,{offset:-300})},updateSelectedTimelines:function(t){var e=this,s=[];t.forEach((function(t){var i=e.meta.indices_metadata[t.searchindex.index_name].is_legacy;i?s.push(t.searchindex.index_name):s.push(t.id)})),this.currentQueryFilter.indices=s,this.search()},clearSearch:function(){this.currentQueryString="",this.currentQueryFilter=wi(),this.currentQueryFilter.indices="_all",this.eventList=ki(),this.$router.replace({query:null})},toggleChip:function(t){void 0===t.active&&(t.active=!0),t.active=!t.active,this.search()},removeChip:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=this.currentQueryFilter.chips.findIndex((function(e){return e.value===t.value}));this.currentQueryFilter.chips.splice(s,1),"label"===t.type&&(this.selectedLabels=this.selectedLabels.filter((function(e){return e!==t.value}))),e&&this.search()},updateChip:function(t,e){var s=this.currentQueryFilter.chips.findIndex((function(t){return t.value===e.value&&t.type===e.type}));this.currentQueryFilter.chips.splice(s,1,t),this.search()},addChip:function(t){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.push(t),this.search()},addChipFromHistogram:function(t){var e=this;this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.forEach((function(t){"datetime_range"===t.type&&e.removeChip(t,!1)})),this.addChip(t)},toggleLabelChip:function(t){var e={field:"",value:t,type:"label",operator:"must",active:!0},s=this.currentQueryFilter.chips;if(s)for(var i=0;i<s.length;i++)if(s[i].value===t)return void this.removeChip(i);this.addChip(e)},updateLabelChips:function(){var t=this;this.currentQueryFilter.chips=this.currentQueryFilter.chips.filter((function(t){return"label"!==t.type})),this.selectedLabels.forEach((function(e){var s={field:"",value:e,type:"label",operator:"must",active:!0};t.addChip(s),t.showSearchDropdown=!1}))},updateLabelList:function(t){-1===this.meta.filter_labels.indexOf(t)&&this.meta.filter_labels.push(t)},paginate:function(t){this.currentQueryFilter.from=t*this.currentQueryFilter.size-this.currentQueryFilter.size,this.search(!0,!1,!0)},updateSelectedFields:function(t){var e=this;t.forEach((function(t){!e.selectedFields.filter((function(e){return e.field===t.field})).length>0&&e.search(!0,!0,!0)})),t.forEach((function(t){e.selectedFields.push(t)})),this.selectedFieldsProxy=[]},removeField:function(t){this.selectedFields.splice(t,1)},updateSelectedEvents:function(t){var e=t._index+":"+t._id;t.isSelected?this.$set(this.selectedEvents,e,t):this.$delete(this.selectedEvents,e)},toggleStar:function(){var t=this,e=[],s=[],i=[];Object.keys(this.selectedEvents).forEach((function(i,a){t.selectedEvents[i].isStarred?e.push(t.selectedEvents[i]):s.push(t.selectedEvents[i])})),i=e.length&&s.length||s.length?s:e,w.saveEventAnnotation(this.sketch.id,"label","__ts_star",i,this.currentSearchNode).then((function(t){})).catch((function(t){}));var a=i.map((function(t){return t._id}));gl.$emit("toggleStar",a);var n,r=_i(i);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.isStarred=!o.isStarred}}catch(c){r.e(c)}finally{r.f()}},changeSortOrder:function(){"asc"===this.currentQueryFilter.order?this.currentQueryFilter.order="desc":this.currentQueryFilter.order="asc",this.search(!0,!0,!0)},loadingOpen:function(){this.loadingComponent=this.$buefy.loading.open({container:this.isFullPage?null:this.$refs.element.$el})},loadingClose:function(){this.loadingComponent.close()},jumpInHistory:function(t){var e=this;if(this.currentQueryString=t.query_string,this.currentQueryFilter=JSON.parse(t.query_filter),this.currentQueryFilter.fields&&this.currentQueryFilter.fields.length||(this.currentQueryFilter.fields=[{field:"message",type:"text"}]),this.selectedFields=this.currentQueryFilter.fields,"_all"===this.currentQueryFilter.indices[0]||"_all"===this.currentQueryFilter.indices){var s=[];this.sketch.active_timelines.forEach((function(t){var i=e.meta.indices_metadata[t.searchindex.index_name].is_legacy;i?s.push(t.searchindex.index_name):s.push(t.id)})),this.currentQueryFilter.indices=s}var i=this.currentQueryFilter.chips;if(i)for(var a=0;a<i.length;a++)"label"===i[a].type&&this.selectedLabels.push(i[a].value);this.contextEvent=!1,this.search(!1,!0,!0,t.id)},triggerScrollTo:function(){gl.$emit("triggerScrollTo")},zoomWithMouse:function(t){this.zoomOrigin.x=t.pageX,this.zoomOrigin.y=t.pageY,t.deltaY<0?this.zoomLevel+=.07:t.deltaY>0&&(this.zoomLevel-=.07)},closeSearchDropdown:function(t){t!==this.$refs.searchInput&&null===t.getAttribute("data-explore-element")&&(this.showSearchDropdown=!1)}},watch:{numEvents:function(t){this.currentQueryFilter.size=t,this.search(!1,!0,!0)}},mounted:function(){var t=this;this.$refs.searchInput.focus(),this.showSearchDropdown=!0,gl.$on("eventSelected",(function(e){t.updateSelectedEvents(e)})),gl.$on("clearSelectedEvents",(function(){t.selectedEvents={}}))},created:function(){var t=this,e=!1;if(this.params={viewId:this.$route.query.view,indexName:this.$route.query.timeline,resultLimit:this.$route.query.limit,queryString:this.$route.query.q},this.params.viewId)this.searchView(this.params.viewId);else{if(this.params.queryString&&(this.currentQueryString=this.params.queryString,e=!0),this.params.indexName){this.params.queryString||(this.currentQueryString="*");var s=this.sketch.active_timelines.find((function(e){return e.id===parseInt(t.params.indexName,10)})),i=this.meta.indices_metadata[s.searchindex.index_name].is_legacy;this.currentQueryFilter.indices=i?[s.searchindex.index_name]:[s.id],e=!0}this.currentQueryString||(this.currentQueryFilter.indices=["_all"]),e&&(this.currentQueryFilter.indices.length||(this.currentQueryFilter.indices=["_all"]),this.search())}}},xi=Si,Ti=(s("0c67"),Object(c["a"])(xi,_e,be,!1,null,null,null)),Ai=Ti.exports,Oi=function(){var t=this,e=t._self._c;return e("router-view")},Di=[],Ei={},$i=Object(c["a"])(Ei,Oi,Di,!1,null,null,null),Fi=$i.exports,Ni=function(){var t=this,e=t._self._c;return e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),e("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"graph"}}),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-content"},[t.sketch.graphs.length?e("div",[e("span",{staticClass:"title is-6 is-uppercase"},[t._v("Saved graphs")]),e("ts-graph-list"),e("br"),e("br")],1):t._e(),e("span",{staticClass:"title is-6 is-uppercase"},[t._v("Graph plugins")]),e("ts-graph-plugin-list")],1)])])])],1)},Ii=[],Mi=function(){var t=this,e=t._self._c;return e("div",t._l(t.graphs,(function(s){return e("router-link",{key:s.name,attrs:{to:{name:"GraphExplore",query:{plugin:s.name}}}},[e("ul",{staticClass:"content-list"},[e("li",{staticStyle:{padding:"10px","border-bottom":"none",cursor:"pointer"}},[e("strong",{staticStyle:{color:"var(--default-font-color)"}},[t._v(t._s(s.display_name))]),e("br"),e("span",[t._v(t._s(s.description))])])])])})),1)},Pi=[],Li={data:function(){return{graphs:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},created:function(){var t=this;w.getGraphPluginList().then((function(e){t.graphs=e.data})).catch((function(t){console.error(t)}))}},ji=Li,Ri=Object(c["a"])(ji,Mi,Pi,!1,null,"0cf3b22b",null),zi=Ri.exports,Qi={props:["sketchId"],components:{TsGraphList:me,TsGraphPluginList:zi},computed:{sketch:function(){return this.$store.state.sketch}}},Hi=Qi,Gi=Object(c["a"])(Hi,Ni,Ii,!1,null,null,null),qi=Gi.exports,Vi=function(){var t=this,e=t._self._c;return e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),e("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"graph"}}),e("ts-graph")],1)},Ui=[],Yi=function(){var t=this,e=t._self._c;return e("div",[e("section",{staticClass:"section"},[e("div",{ref:"graphContainer",staticClass:"container is-fluid",staticStyle:{height:"75vh"}},[e("div",{staticClass:"card",staticStyle:{height:"100%"}},[e("header",{staticClass:"card-header",staticStyle:{"border-bottom":"0"}},[t.currentGraph?e("div",[e("ts-dropdown",{scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("a",{staticClass:"button ts-search-dropdown",staticStyle:{"background-color":"transparent"}},[e("span",{staticClass:"icon is-small",staticStyle:{"margin-right":"10px","margin-top":"2px","font-size":"0.6em"}},[e("i",{staticClass:"fas fa-project-diagram"})]),t.currentGraph?e("div",{staticStyle:{"margin-right":"7px"}},[e("strong",[t._v(t._s(t.currentGraph))])]):t._e(),e("b-icon",{staticStyle:{"font-size":"0.6em"},attrs:{icon:"chevron-down"}})],1)]},proxy:!0}],null,!1,250318476)},[t._l(t.graphs,(function(s){return e("div",{key:s.name,staticClass:"ts-dropdown-item",on:{click:function(e){return t.buildGraph(s)}}},[e("router-link",{attrs:{to:{name:"GraphExplore",query:{plugin:s.name}}}},[t._v(t._s(s.display_name))])],1)})),t._l(t.savedGraphs,(function(s){return e("div",{key:s.id,staticClass:"ts-dropdown-item",on:{click:function(e){return t.buildSavedGraph(s)}}},[e("router-link",{attrs:{to:{name:"GraphExplore",query:{graph:s.id}}}},[t._v(t._s(s.name))])],1)}))],2)],1):t._e(),e("ts-dropdown",{scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("a",{staticClass:"button ts-search-dropdown",staticStyle:{"background-color":"transparent"}},[t.currentGraphCacheConfig.filter.timelineIds.length?e("span",[t._v("\n                  "+t._s(t.getTimelineFromId(t.currentGraphCacheConfig.filter.timelineIds[0])[0].name)+"\n                ")]):e("strong",[t._v("Choose timeline")]),e("b-icon",{staticStyle:{"font-size":"0.6em"},attrs:{icon:"chevron-down"}})],1)]},proxy:!0}])},t._l(t.sketch.timelines,(function(s){return e("div",{key:s.id,staticClass:"ts-dropdown-item",on:{click:function(e){return t.buildGraph(t.currentGraph)}}},[e("router-link",{attrs:{to:{name:"GraphExplore",query:{plugin:t.currentGraph,timeline:s.id}}}},[t._v(t._s(s.name))])],1)})),0),t.currentGraph?e("input",{directives:[{name:"model",rawName:"v-model",value:t.filterString,expression:"filterString"}],staticClass:"ts-search-input",staticStyle:{"border-radius":"0",padding:"25px"},attrs:{placeholder:"Filter nodes and edges"},domProps:{value:t.filterString},on:{keyup:t.filterGraphByInput,input:function(e){e.target.composing||(t.filterString=e.target.value)}}}):t._e(),t.currentGraph?e("span",{staticClass:"card-header-icon"},[e("ts-dropdown",{attrs:{position:"is-bottom-left",width:"500px"},scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("button",{staticClass:"button is-outlined is-rounded is-small",attrs:{slot:"trigger",disabled:!t.currentGraph},slot:"trigger"},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-cog"})]),e("span",[t._v("Settings")])])]},proxy:!0}],null,!1,1929958955)},[e("div",[e("div",{staticClass:"ts-dropdown-item"},[e("b-field",{attrs:{label:"Transparency for unselected elements"}},[e("b-slider",{staticClass:"is-rounded",attrs:{type:"is-info","custom-formatter":function(t){return t+"%"}},on:{input:t.changeOpacity},model:{value:t.fadeOpacity,callback:function(e){t.fadeOpacity=e},expression:"fadeOpacity"}})],1),e("b-field",{attrs:{label:"Layout type"}},t._l(t.layouts,(function(s){return e("b-radio",{key:s,attrs:{"native-value":s,type:"is-info",disabled:!t.hasGraphCache},on:{input:function(e){return t.buildGraph({name:t.currentGraph})}},model:{value:t.layoutName,callback:function(e){t.layoutName=e},expression:"layoutName"}},[e("span",[t._v(t._s(s))])])})),1),e("b-field",{attrs:{label:"Edge style"}},t._l(t.edgeStyles,(function(s){return e("b-radio",{key:s,attrs:{"native-value":s,type:"is-info",disabled:!t.hasGraphCache},on:{input:function(e){return t.buildGraph({name:t.currentGraph})}},model:{value:t.edgeStyle,callback:function(e){t.edgeStyle=e},expression:"edgeStyle"}},[e("span",[t._v(t._s(s))])])})),1)],1)])]),e("ts-dropdown",{attrs:{position:"is-bottom-left",width:"500px"},scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("button",{staticClass:"button is-outlined is-rounded is-small"},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-save"})]),e("span",[t._v("Save selection")])])]},proxy:!0}],null,!1,2016672635)},[e("strong",[t._v("Save selected graph")]),e("br"),e("br"),e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.saveAsName,expression:"saveAsName"}],staticClass:"input",attrs:{type:"text",placeholder:"Graph name",required:""},domProps:{value:t.saveAsName},on:{input:function(e){e.target.composing||(t.saveAsName=e.target.value)}}})])]),e("button",{staticClass:"button is-small",on:{click:t.saveSelection}},[t._v("Save")])]),e("button",{staticClass:"button is-outlined is-rounded is-small",staticStyle:{"margin-left":"7px"},attrs:{disabled:!t.hasGraphCache},on:{click:function(e){return t.buildGraph({name:t.currentGraph},!0)}}},[t._m(0),e("span",[t._v("Refresh cache")])]),e("button",{staticClass:"button is-outlined is-rounded is-small",staticStyle:{"margin-left":"7px"},on:{click:function(e){return t.cy.fit()}}},[t._m(1),e("span",[t._v("Fit to canvas")])])],1):t._e()],1),e("div",{staticClass:"card-content"},[e("b-loading",{attrs:{"is-full-page":!1,"can-cancel":!1},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[e("div",{staticClass:"lds-ripple"},[e("div"),e("div")]),e("div",{staticStyle:{position:"absolute","margin-top":"120px"}},[t._v("\n              Generating graph: "),e("b",[t._v(t._s(t.currentGraph))])])]),!t.elements.length&&t.showGraph&&t.currentGraph?e("div",{staticClass:"no-data"},[t._v("Empty graph")]):t._e(),t.elements.length&&t.showGraph?e("cytoscape",{ref:"cyRef",attrs:{config:t.config,preConfig:t.preConfig,afterCreated:t.afterCreated},on:{select:function(e){return t.filterGraphBySelection(e)},unselect:function(e){return t.unSelectAllElements(e)},tap:function(e){return t.unSelectAllElements(e)}}},t._l(t.elements,(function(t){return e("cy-element",{key:t.data.id,attrs:{definition:t}})})),1):t._e(),t.hasGraphCache?e("span",[e("span",[e("i",[t._v("Generated\n                "+t._s(t.$moment.utc(t.currentGraphCache.updated_at).local().fromNow()))])]),e("a",{staticClass:"is-small",staticStyle:{"text-decoration":"underline","margin-left":"15px"},on:{click:function(e){return t.buildGraph({name:t.currentGraph},!0)}}},[e("span",[t._v("Refresh")])])]):t._e(),t._l(t.currentGraphCacheConfig.filter.timelineIds,(function(s){return e("span",{key:s,staticStyle:{color:"red","margin-left":"20px"}},[t._v("\n            Note: Graph generated for timeline: "+t._s(t.getTimelineFromId(s)[0].name)+"\n          ")])}))],2)])])]),t.edgeQuery?e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[t._m(2),e("div",{staticClass:"card-content"},[t.edgeQuery?e("ts-event-list-compact",{attrs:{"query-dsl":t.edgeQuery}}):t._e()],1)])])]):t._e()])},Wi=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-sync-alt"})])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-eye"})])},function(){var t=this,e=t._self._c;return e("header",{staticClass:"card-header"},[e("span",{staticClass:"card-header-title"},[t._v("Events for selected edges")])])}],Bi=(s("96cf"),s("3b8d")),Ji=s("6882"),Zi=s.n(Ji),Ki=s("b17d"),Xi=s.n(Ki),ta=function(){var t=this,e=t._self._c;return e("table",{staticClass:"table is-fullwidth"},[e("thead",[e("th",{attrs:{width:"220"}}),e("th",{attrs:{width:"1"}}),t._l(t.selectedFields,(function(s,i){return e("th",{key:i},[t._v(t._s(s.field))])})),e("th",{attrs:{width:"150"}},[t._v("Timeline name")])],2),t._l(t.eventList.objects,(function(s,i){return e("ts-sketch-explore-event-list-row",{key:i,attrs:{event:s,prevEvent:t.eventList.objects[i-1],"selected-fields":t.selectedFields,"display-options":t.displayOptions,"display-controls":!1}})}))],2)},ea=[],sa={components:{TsSketchExploreEventListRow:Ke},props:["view","queryString","queryDsl","queryFilter"],data:function(){return{eventList:[],selectedFields:[],displayOptions:{showTags:!0,showEmojis:!0}}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{search:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(s).length||(s={},this.selectedFields=[{field:"message",type:"text"}]);var i={filter:s};"object"===Object(Ts["a"])(t)?i["dsl"]=t:i["query"]=t,w.search(this.sketch.id,i).then((function(t){e.eventList=t.data})).catch((function(t){}))},searchView:function(t){var e=this;w.getView(this.sketch.id,t).then((function(t){var s=t.data.objects[0],i=s.query_string,a=JSON.parse(s.query_filter);a.fields&&a.fields.length||(a.fields=[{field:"message",type:"text"}]),e.selectedFields=a.fields,e.search(i,a)})).catch((function(t){}))}},created:function(){this.view&&this.searchView(this.view.id),this.queryDsl&&this.search(this.queryDsl),this.queryString&&this.search(this.queryString)},watch:{queryString:function(t){this.search(t)},queryDsl:function(t){this.search(t)}}},ia=sa,aa=Object(c["a"])(ia,ta,ea,!1,null,null,null),na=aa.exports,ra={components:{TsEventListCompact:na,TsDropdown:kt},data:function(){return{showGraph:!0,isLoading:!1,filterString:"",graphs:{},savedGraphs:[],currentGraph:"",currentGraphCache:{},currentGraphCacheConfig:{},selectedGraphs:[],fadeOpacity:7,elements:[],edgeQuery:"",maxEvents:500,saveAsName:"",layouts:["spread","dagre","circle","concentric","breadthfirst"],layoutName:"spread",edgeStyles:["bezier","taxi"],edgeStyle:"bezier",config:{style:[{selector:"node",style:{shape:"roundrectangle",width:"label",height:"label","compound-sizing-wrt-labels":"include","text-halign":"center","text-valign":"center",color:"#FFFFFF","font-size":"10","font-weight":"bold","text-outline-width":"0px",padding:"7px","background-color":"gray","text-outline-color":"gray","text-wrap":"wrap","text-max-width":"12em",label:"data(label)"}},{selector:"node:selected",style:{"overlay-color":"black","overlay-opacity":"0.3","overlay-padding":"7px"}},{selector:"node[type = 'user']",style:{"background-color":"#FF756E","text-outline-color":"#FF756E"}},{selector:"node[type = 'computer']",style:{"background-color":"#6992f3","text-outline-color":"#ffffff"}},{selector:"node[type = 'file']",style:{"background-color":"#82b578","text-outline-color":"#2b2b2b"}},{selector:"node[type = 'winservice']",style:{"background-color":"#9d8f35","text-outline-color":"#2b2b2b"}},{selector:"edge",style:{width:1,"curve-style":"bezier","control-point-step-size":70,"target-arrow-shape":"triangle","font-size":11,"text-rotation":"autorotate","text-outline-width":3,"text-outline-color":"#FFFFFF",label:"data(label)"}},{selector:"edge:selected",style:{width:2,"line-color":"#333333","source-arrow-color":"#333333","target-arrow-color":"#333333"}},{selector:".faded",style:{opacity:.07,color:"#333333"}}],layout:{name:"",animate:!1,prelayout:!1,spacingFactor:2},minZoom:.1,maxZoom:1.5,zoomingEnabled:!0,userZoomingEnabled:!0,panningEnabled:!0,userPanningEnabled:!0,boxSelectionEnabled:!0,selectionType:"single",touchTapThreshold:8,desktopTapThreshold:4,autolock:!1,autoungrabify:!1,autounselectify:!1,headless:!1,styleEnabled:!0,hideEdgesOnViewport:!1,hideLabelsOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.2,pixelRatio:"auto"}}},computed:{sketch:function(){return this.$store.state.sketch},hasGraphCache:function(){return 0!==Object.keys(this.currentGraphCache).length}},methods:{buildGraph:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.config.layout.name=this.layoutName;var i=this.config.style.filter((function(t){return"edge"===t.selector}));i[0].style["curve-style"]=this.edgeStyle,"object"===Object(Ts["a"])(t)?this.currentGraph=t.name:this.currentGraph=t,this.showGraph=!1,this.elements=[],this.loadingTimeout=setTimeout((function(){e.elements.length||(e.isLoading=!0)}),600),this.edgeQuery="";var a=[],n=[];this.$route.query.timeline?(n.push(parseInt(this.$route.query.timeline)),s=!0):this.sketch.timelines.forEach((function(t){a.push(t.searchindex.index_name)})),w.generateGraphFromPlugin(this.sketch.id,this.currentGraph,a,n,s).then((function(t){var s,i,a=t.data["objects"][0],n=JSON.parse(a.graph_elements),r=JSON.parse(a.graph_config),o=[];"elements"in n?(s=n["elements"]["nodes"],i=n["elements"]["edges"]):(s=n["nodes"],i=n["edges"]),s.forEach((function(t){o.push({data:t.data,group:"nodes"})})),i.forEach((function(t){o.push({data:t.data,group:"edges"})})),delete a.graph_elements,e.currentGraphCache=a,e.currentGraphCacheConfig=r,e.elements=o,clearTimeout(e.loadingTimeout),e.showGraph=!0,e.isLoading=!1})).catch((function(t){console.error(t)}))},buildSavedGraph:function(t){var e=this;this.config.layout.name="preset",this.currentGraph=t.name,this.currentGraphCache={},this.showGraph=!1,this.elements=[],this.loadingTimeout=setTimeout((function(){e.elements.length||(e.isLoading=!0)}),600),this.edgeQuery="";var s="";s="object"===Object(Ts["a"])(t)?t.id:t,w.getSavedGraph(this.sketch.id,s).then((function(t){e.currentGraph=t.data["objects"][0].name;var s=JSON.parse(t.data["objects"][0].graph_elements),i=s.filter((function(t){return"nodes"===t.group})),a=s.filter((function(t){return"edges"===t.group})),n=[];i.forEach((function(t){t.selected=!1,n.push(t)})),a.forEach((function(t){t.selected=!1,n.push(t)})),clearTimeout(e.loadingTimeout),e.elements=n,e.showGraph=!0,e.isLoading=!1})).catch((function(t){console.error(t)}))},buildNeighborhood:function(t){var e=this.cy.collection();return e=e.add(t.filter("node").neighborhood()),e=e.add(t.filter("edge").connectedNodes()),e=e.add(t),e},showNeighborhood:function(t){var e=this.buildNeighborhood(t);if(0!==t.length){this.cy.elements().addClass("faded"),e.removeClass("faded");var s={query:{bool:{should:[]}},size:this.maxEvents};e.forEach((function(t){"edges"===t.group()&&Object.keys(t.data().events).forEach((function(e){var i={bool:{must:[{ids:{values:t.data().events[e]}},{term:{_index:{value:e}}}]}};s.query.bool.should.push(i)}))})),this.edgeQuery=s}else this.cy.elements().removeClass("faded")},saveSelection:function(){var t=this,e=this.cy.filter(":selected"),s=this.buildNeighborhood(e),i=s.jsons();this.showGraph=!1,this.elements=i,this.currentGraph=this.saveAsName,this.showGraph=!0,w.saveGraph(this.sketch.id,this.saveAsName,i).then((function(e){var s=e.data["objects"][0];t.savedGraphs.push(s)})),this.saveAsName=""},filterGraphBySelection:function(t){var e=this.cy.filter(":selected");this.showNeighborhood(e)},filterGraphByInput:function(){var t=this;this.cy.elements().unselect();var e=this.cy.elements().filter((function(e){return e.data("label").toLowerCase().includes(t.filterString)}));this.showNeighborhood(e)},unSelectAllElements:function(t){this.cy.elements().removeClass("faded"),this.edgeQuery=null},changeOpacity:function(){this.cy&&this.cy.style().selector(".faded").style({opacity:this.fadeOpacity/100}).update()},resizeCanvas:function(){var t=this.$refs.graphContainer.clientHeight-100,e=this.$refs.graphContainer.clientWidth-100,s=document.getElementById("cytoscape-div");s.style.minHeight=t+"px",s.style.height=t+"px",s.style.minWidth=e+"px",s.style.width=e+"px"},preConfig:function(t){t.use(Zi.a),t.use(Xi.a),this.resizeCanvas()},afterCreated:function(){var t=Object(Bi["a"])(regeneratorRuntime.mark((function t(){var e,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:null,null!==e?this.cy=e:e=this.cy,t.next=4,e;case 4:this.setTheme(),e.layout(this.config.layout).run();case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setTheme:function(){this.isDarkTheme="dark"===localStorage.theme,this.isDarkTheme?this.cy.style().selector("edge").style({color:"#f5f5f5","text-outline-color":"#25272c"}).update():this.cy.style().selector("edge").style({color:"#333333","text-outline-color":"#FFFFFF"}).update()},getTimelineFromId:function(t){return this.sketch.timelines.filter((function(e){return e.id===t}))}},created:function(){var t=this;window.addEventListener("resize",dt.a.debounce((function(){t.resizeCanvas()}),250)),w.getGraphPluginList().then((function(e){t.graphs=e.data})).catch((function(t){console.error(t)})),w.getSavedGraphList(this.sketch.id).then((function(e){var s=e.data["objects"][0];void 0!==s&&(t.savedGraphs=e.data["objects"][0])})).catch((function(t){console.error(t)})),gl.$on("isDarkTheme",this.setTheme),this.params={graphId:this.$route.query.graph,pluginName:this.$route.query.plugin,timelineId:this.$route.query.timeline},this.params.graphId&&this.buildSavedGraph(this.params.graphId),this.params.pluginName&&this.buildGraph(this.params.pluginName)}},oa=ra,ca=(s("d2aa"),Object(c["a"])(oa,Yi,Wi,!1,null,null,null)),la=ca.exports,ua={components:{TsGraph:la},props:["sketchId"],computed:{sketch:function(){return this.$store.state.sketch}}},da=ua,ha=Object(c["a"])(da,Vi,Ui,!1,null,null,null),pa=ha.exports,ma=function(){var t=this,e=t._self._c;return e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),e("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"aggregate"}}),e("ts-sketch-explore-aggregation",{on:{newAggregation:function(e){return t.addAggregation(e)}}}),e("br"),e("br"),t.allAggregations.length?e("section",{staticClass:"section"},[t._m(0)]):t._e(),t._l(t.allAggregations,(function(t){return e("section",{key:t.id,staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("ts-aggregation-compact",{attrs:{aggregation:t,"card-header":!0}})],1)])}))],2)},fa=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"container is-fluid"},[e("span",{staticClass:"title is-5"},[t._v("Saved aggregations")])])}],va=function(){var t=this,e=t._self._c;return e("div",[e("b-modal",{attrs:{active:t.showSaveModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showSaveModal=e}}},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Save aggregation")])]),e("div",{staticClass:"card-content"},[e("div",{staticClass:"content"},[e("form",{on:{submit:function(e){return e.preventDefault(),t.save()}}},[e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v("Name")]),e("div",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.aggregationName,expression:"aggregationName"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Name your aggregation",autofocus:""},domProps:{value:t.aggregationName},on:{input:function(e){e.target.composing||(t.aggregationName=e.target.value)}}})])]),e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Save"}})])])])])])])]),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[t._m(0),e("div",{staticClass:"card-content"},[e("label",{staticClass:"label"},[t._v("Select timelines (optional)")]),e("ts-timeline-list-dropdown",{on:{selectedTimelines:function(e){t.selectedTimelines=e}}}),e("br"),e("ts-sketch-explore-aggregator-list-dropdown",{on:{setActiveAggregator:t.updateAggregatorFormFields}}),e("br"),e("ts-dynamic-form",{key:t.selectedAggregator.name,ref:"vegaChart",attrs:{schema:t.schema},on:{formSubmitted:t.getVegaSpec},model:{value:t.formData,callback:function(e){t.formData=e},expression:"formData"}})],1)])])]),e("section",{directives:[{name:"show",rawName:"v-show",value:t.showChart&&0!==Object.keys(t.vegaSpec).length,expression:"showChart && Object.keys(vegaSpec).length !== 0"}],staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("span",{staticClass:"card-header-title"},[t._v("\n            "+t._s(t.selectedAggregator.display_name)+"\n          ")]),e("span",{staticClass:"card-header-icon"},[e("a",{staticClass:"button is-rounded is-small",on:{click:function(e){t.showSaveModal=!t.showSaveModal}}},[t._m(1),e("span",[t._v("Save")])])])]),e("div",{staticClass:"card-content"},[e("ts-table-chart",{directives:[{name:"show",rawName:"v-show",value:"table"===t.chartType,expression:"chartType === 'table'"}],attrs:{"table-data":t.chartData}}),e("ts-vega-lite-chart",{directives:[{name:"show",rawName:"v-show",value:"table"!==t.chartType,expression:"chartType !== 'table'"}],attrs:{vegaSpec:t.vegaSpec}})],1)])])])],1)},ga=[function(){var t=this,e=t._self._c;return e("header",{staticClass:"card-header"},[e("span",{staticClass:"card-header-title"},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-chart-bar"})]),e("span",{staticStyle:{"margin-left":"10px"}},[t._v("New Aggregation")])])])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-save"})])}],ya=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:t.vegaId}})},_a=[],ba=s("7ad3"),Ca={props:["vegaSpec"],data:function(){return{vegaId:"vega-"+this._uid}},watch:{vegaSpec:function(t,e){Object(ba["a"])("#"+this.vegaId,JSON.parse(this.vegaSpec),{actions:!1})}}},wa=Ca,ka=Object(c["a"])(wa,ya,_a,!1,null,null,null),Sa=ka.exports,xa=function(){var t=this,e=t._self._c;return t.schema.length?e("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)},keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()}}},[t._l(t.schema,(function(s,i){return e(s.type,t._b({key:i,tag:"component",attrs:{value:t.formData[s.name],display:s.display},on:{input:function(e){return t.updateForm(s.name,e)}}},"component",s,!1))})),t._m(0)],2):t._e()},Ta=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"control"},[e("input",{staticClass:"button is-info",attrs:{type:"submit",value:"Run"}})])}],Aa=function(){var t=this,e=t._self._c;return t.display?e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v(t._s(t.label))]),e("input",{staticClass:"input",staticStyle:{"max-width":"400px"},attrs:{type:"text",name:t.name,placeholder:t.placeholder},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}})]):t._e()},Oa=[],Da={props:["placeholder","label","name","value","display"]},Ea=Da,$a=Object(c["a"])(Ea,Aa,Oa,!1,null,null,null),Fa=$a.exports,Na=function(){var t=this,e=t._self._c;return t.display?e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v(t._s(t.label))]),e("div",{staticClass:"control"},[e("div",{staticClass:"select"},[e("select",{domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}},[e("option",{attrs:{disabled:"",value:""}},[t._v("Please select one")]),t._l(t.options,(function(s){return e("option",{key:s},[t._v(t._s(s))])}))],2)])])]):t._e()},Ia=[],Ma={props:["options","label","value","display"]},Pa=Ma,La=Object(c["a"])(Pa,Na,Ia,!1,null,null,null),ja=La.exports,Ra=function(){var t=this,e=t._self._c;return t.display?e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v(t._s(t.label))]),e("b-datetimepicker",{attrs:{placeholder:"Optional: Select a date...","datetime-formatter":t.dateFormatter,editable:""}})],1):t._e()},za=[],Qa={props:["placeholder","label","name","value","display"],methods:{dateFormatter:function(t){var e=new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().replace(".000Z","");return this.$emit("input",e),e}}},Ha=Qa,Ga=Object(c["a"])(Ha,Ra,za,!1,null,null,null),qa=Ga.exports,Va={components:{TsDynamicFormTextInput:Fa,TsDynamicFormSelectInput:ja,TsDynamicFormDatetimeInput:qa},props:["schema","value"],data:function(){return{formData:this.value||{}}},methods:{updateForm:function(t,e){this.$set(this.formData,t,e),this.$emit("input",this.formData)},submitForm:function(){this.$emit("formSubmitted")}}},Ua=Va,Ya=Object(c["a"])(Ua,xa,Ta,!1,null,null,null),Wa=Ya.exports,Ba=function(){var t=this,e=t._self._c;return e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v("Choose an aggregator")]),e("div",{staticClass:"control"},[e("div",{staticClass:"select"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selected=e.target.multiple?s:s[0]},function(e){return t.setActiveAggregator()}]}},[e("option",{attrs:{disabled:"",value:""}},[t._v("Please select one")]),t._l(t.meta.aggregators,(function(s,i){return e("option",{key:s.id,domProps:{value:i}},[t._v("\n          "+t._s(s.display_name)+"\n        ")])}))],2)])])])},Ja=[],Za={props:["isRounded","title"],data:function(){return{selected:"",selectedChart:""}},computed:{meta:function(){return this.$store.state.meta}},methods:{setActiveAggregator:function(){var t=JSON.parse(JSON.stringify(this.meta.aggregators[this.selected]));t.name=this.selected,this.$emit("setActiveAggregator",t)}}},Ka=Za,Xa=Object(c["a"])(Ka,Ba,Ja,!1,null,null,null),tn=Xa.exports,en=function(){var t=this,e=t._self._c;return t.tableData.length?e("div",[e("b-table",{attrs:{data:t.tableData,columns:t.getColumns(),paginated:!0,"pagination-simple":!0,"per-page":10,hoverable:!0,"icon-pack":"fas","pagination-size":"is-small"}})],1):t._e()},sn=[],an={props:["tableData"],methods:{getColumns:function(){var t=[],e=this.tableData[0];return Object.keys(e).forEach((function(e){t.push({field:e,label:e,sortable:!0})})),t}}},nn=an,rn=Object(c["a"])(nn,en,sn,!1,null,null,null),on=rn.exports,cn=function(){var t=this,e=t._self._c;return e("div",[e("ts-dropdown",{attrs:{"aria-role":"list"},scopedSlots:t._u([{key:"dropdown-trigger-element",fn:function(){return[e("b-button",{staticStyle:{width:"215.5px"},attrs:{label:t.label,"icon-right":t.active?"chevron-up":"chevron-down"}})]},proxy:!0}])},[e("b-table",{attrs:{data:t.timelines,columns:t.timelineColumns,"checked-rows":t.selected,checkable:""},on:{"update:checkedRows":function(e){t.selected=e},"update:checked-rows":function(e){t.selected=e}}})],1)],1)},ln=[],un={props:[],components:{TsDropdown:kt},data:function(){return{selected:[],timelineColumns:[{field:"name"}]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},timelines:function(){var t=this,e=[];return this.sketch.active_timelines.forEach((function(s){var i=s.id,a=t.meta.indices_metadata[s.searchindex.index_name].is_legacy;a&&(i=s.searchindex.index_name),e.push({id:i,name:s.name})})),e},label:function(){var t="Select individual timelines";return this.selected.length&&(t="Selected timelines ("+this.selected.length+"/"+this.timelines.length+")"),t}},watch:{selected:function(t){this.$emit("selectedTimelines",t.map((function(t){return t.id})))}}},dn=un,hn=Object(c["a"])(dn,cn,ln,!1,null,null,null),pn=hn.exports,mn={components:{TsDynamicForm:Wa,TsVegaLiteChart:Sa,TsSketchExploreAggregatorListDropdown:tn,TsTableChart:on,TsTimelineListDropdown:pn},data:function(){return{schema:{},formData:{},vegaSpec:{},selectedAggregator:"",showChart:!1,showSaveModal:!1,aggregationName:"",chartType:"",chartData:{},selectedTimelines:[]}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{updateAggregatorFormFields:function(t){this.showChart=!1;var e={};this.schema=t.form_fields,this.schema.forEach((function(t){e[t.name]=t.default_value})),this.formData=e,this.selectedAggregator=t},getVegaSpec:function(){var t=this;this.showChart=!0,this.formData["index"]=this.selectedTimelines;var e={aggregator_name:this.selectedAggregator.name,aggregator_parameters:this.formData};w.runAggregator(this.sketch.id,e).then((function(e){var s=e.data.meta.vega_spec;s.config.view.width=t.$refs.vegaChart.$el.offsetWidth,s.config.autosize={type:"fit",contains:"padding"},t.vegaSpec=JSON.stringify(s),t.chartType=e.data.meta.chart_type,t.chartData=s.datasets[Object.keys(s.datasets)[0]]})).catch((function(t){}))},save:function(){var t=this;this.showSaveModal=!1,w.saveAggregation(this.sketch.id,this.selectedAggregator,this.aggregationName,this.formData).then((function(e){var s=e.data.objects[0];t.$emit("newAggregation",s),t.aggregationName=""})).catch((function(t){}))}}},fn=mn,vn=Object(c["a"])(fn,va,ga,!1,null,null,null),gn=vn.exports,yn=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("span",{staticClass:"card-header-title"},[t._v("\n      "+t._s(t.aggregation.name)+"\n      "),t.aggParameters.start_time&&t.aggParameters.end_time?e("span",{staticStyle:{"margin-left":"15px","font-weight":"normal"}},[t._v("["+t._s(t.aggParameters.start_time)+"  "+t._s(t.aggParameters.end_time)+"]")]):t._e(),t._l(t.timelines,(function(t){return e("ts-timeline-chip",{key:t.id,staticStyle:{"margin-left":"10px"},attrs:{timeline:t}})}))],2)]),e("div",{ref:"vegaChart",staticClass:"card-content"},["table"===t.chartType?e("ts-table-chart",{attrs:{"table-data":t.chartData}}):t._e(),"table"!==t.chartType?e("ts-vega-lite-chart",{attrs:{vegaSpec:t.vegaSpec}}):t._e()],1)])},_n=[],bn={props:["aggregation","cardHeader"],components:{TsVegaLiteChart:Sa,TsTableChart:on,TsTimelineChip:us},data:function(){return{vegaSpec:{},title:"",chartType:"",chartData:{}}},computed:{sketch:function(){return this.$store.state.sketch},aggParameters:function(){return JSON.parse(this.aggregation.parameters)},timelines:function(){var t=this,e=[];return this.aggParameters.index&&Array.isArray(this.aggParameters.index)&&this.aggParameters.index.forEach((function(s){var i=t.sketch.active_timelines.find((function(t){return t.id===s}));e.push(i)})),e}},methods:{getVegaSpec:function(){var t=this,e={aggregator_name:this.aggregation.agg_type,aggregator_parameters:this.aggregation.parameters};w.runAggregator(this.sketch.id,e).then((function(e){var s=e.data.meta.vega_spec;s.config.view.width=t.$refs.vegaChart.offsetWidth-50,s.config.autosize={type:"fit",contains:"padding"},t.vegaSpec=JSON.stringify(s),t.title=e.data.meta.vega_chart_title,t.chartType=e.data.meta.chart_type,t.chartData=s.datasets[Object.keys(s.datasets)[0]]})).catch((function(t){}))}},mounted:function(){this.getVegaSpec()}},Cn=bn,wn=Object(c["a"])(Cn,yn,_n,!1,null,null,null),kn=wn.exports,Sn={components:{TsSketchExploreAggregation:gn,TsAggregationCompact:kn},data:function(){return{aggregations:[],aggregationGroups:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},allAggregations:function(){var t=function(){for(var t,e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return(t=[]).concat.apply(t,Object(U["a"])(s.filter(Array.isArray)))};return t(this.aggregations,this.aggregationGroups).slice().reverse()}},methods:{addAggregation:function(t){this.aggregations.push(t)}},created:function(){var t=this;w.getAggregations(this.sketch.id).then((function(e){t.aggregations=e.data.objects[0]})).catch((function(t){console.error(t)})),w.getAggregationGroups(this.sketch.id).then((function(e){t.aggregationGroups=e.data.objects})).catch((function(t){console.error(t)}))}},xn=Sn,Tn=Object(c["a"])(xn,ma,fa,!1,null,null,null),An=Tn.exports,On=function(){var t=this,e=t._self._c;return e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),e("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"analyzers"}}),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("ts-analyzer-history")],1)]),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-content"},[e("p",[t._v("Automatic analysis. Select timelines and analyzers in the lists below.")]),e("br"),e("button",{staticClass:"button is-success",attrs:{disabled:!t.analyzerCheckedRows.length||!t.timelineCheckedRows.length},on:{click:t.runAnalyzers}},[t._v("\n            Run "+t._s(t.analyzerCheckedRows.length)+" analyzers on "+t._s(t.timelineCheckedRows.length)+" timelines\n          ")]),e("br"),e("br"),t._l(t.sessions,(function(s){return e("span",{key:s.id},[e("ts-analysis-session-detail",{attrs:{session:s},on:{closeDetail:function(e){t.sessions.splice(t.sessions.indexOf(s),1)}}})],1)}))],2)])])]),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-content",staticStyle:{"max-height":"500px","overflow-y":"auto"}},[e("span",{staticClass:"title is-6 is-uppercase"},[t._v("1. Select timelines to analyze")]),e("br"),e("br"),e("b-table",{attrs:{data:t.timelines,columns:t.timelineColumns,"checked-rows":t.timelineCheckedRows,checkable:""},on:{"update:checkedRows":function(e){t.timelineCheckedRows=e},"update:checked-rows":function(e){t.timelineCheckedRows=e}}})],1)])])]),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-content"},[e("span",{staticClass:"title is-6 is-uppercase"},[t._v("2. Select analyzers to run")]),e("br"),e("br"),e("b-table",{attrs:{data:t.availableAnalyzers,columns:t.analyzerColumns,"checked-rows":t.analyzerCheckedRows,"default-sort":"display_name",checkable:""},on:{"update:checkedRows":function(e){t.analyzerCheckedRows=e},"update:checked-rows":function(e){t.analyzerCheckedRows=e}}})],1)])])]),e("br")],1)},Dn=[],En=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card card-accent-background",staticStyle:{"margin-top":"15px"}},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("\n      "+t._s(t.messageTitle)+" ["),t._l(t.timelines,(function(s){return e("span",{key:s},[t._v(t._s(s))])})),t._v("]\n    ")],2),e("span",{staticClass:"card-header-icon",attrs:{"aria-label":"close"}},[e("span",{staticClass:"delete",on:{click:function(e){return t.$emit("closeDetail")}}})])]),e("div",{staticClass:"card-content"},[e("table",{staticClass:"table is-fullwidth"},[t._m(0),e("tbody",t._l(t.tableData,(function(s,i){return e("tr",{key:i},[e("td",[e("div",{class:{pending:"PENDING"===s.status,done:"DONE"===s.status,started:"STARTED"===s.status,error:"ERROR"===s.status},staticStyle:{width:"10px",height:"10px","border-radius":"100%","margin-top":"6px","margin-left":"3px"}})]),e("td",[t._v(t._s(s.analyzer))]),e("td",[t._v(t._s(s.result))]),e("td",[t._v(t._s(s.timeline.name))])])})),0)])])])},$n=[function(){var t=this,e=t._self._c;return e("thead",[e("th"),e("th",[t._v("Analyzer")]),e("th",[t._v("Result")]),e("th",[t._v("Timeline")])])}],Fn={props:["session"],data:function(){return{analysisSession:{},analyses:[],autoRefresh:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},totalAnalyzers:function(){return this.analyses.length},finishedAnalyzers:function(){var t=0;return this.analyses.forEach((function(e){"DONE"!==e.status[0].status&&"ERROR"!==e.status[0].status||(t+=1)})),t},timelines:function(){var t=new Set;return this.analyses.forEach((function(e){t.add(e.timeline.name)})),t},tableData:function(){var t=[];return this.analyses.forEach((function(e){var s={};s.status=e.status[0].status,s.analyzer=e.analyzer_name,s.result=e.result,s.timeline=e.timeline,t.push(s)})),t},messageTitle:function(){return this.finishedAnalyzers+"/"+this.totalAnalyzers+" analyzers done"}},methods:{fetchData:function(){var t=this;w.getAnalyzerSession(this.sketch.id,this.session.id).then((function(e){t.analysisSession=e.data.objects[0],t.analyses=e.data.objects[0].analyses,t.autoRefresh=!0})).catch((function(t){}))}},beforeDestroy:function(){clearInterval(this.t),this.t=!1},created:function(){this.analysisSession=this.session,this.analyses=this.session.analyses,this.autoRefresh=!0},watch:{autoRefresh:function(t){t&&!this.t?this.t=setInterval(function(){this.fetchData(),this.finishedAnalyzers===this.totalAnalyzers&&(this.autoRefresh=!1)}.bind(this),5e3):(clearInterval(this.t),this.t=!1)}}},Nn=Fn,In=(s("7ef1"),Object(c["a"])(Nn,En,$n,!1,null,"2798acf1",null)),Mn=In.exports,Pn={props:["sketchId"],components:{TsAnalyzerHistory:gt,TsAnalysisSessionDetail:Mn},data:function(){return{availableAnalyzers:[],timelineCheckedRows:[],analyzerCheckedRows:[],sessions:[],timelineColumns:[{field:"name",label:"Timeline"}],analyzerColumns:[{field:"display_name",label:"Analyzer",sortable:!0},{field:"description",label:"Description"}]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},timelines:function(){var t=[];return this.sketch.timelines.forEach((function(e){t.push({id:e.id,name:e.name})})),t}},methods:{runAnalyzers:function(){var t=this,e=this.timelineCheckedRows.map((function(t){return t.id})),s=this.analyzerCheckedRows.map((function(t){return t.name}));this.timelineCheckedRows=[],this.analyzerCheckedRows=[],w.runAnalyzers(this.sketch.id,e,s).then((function(e){t.sessions=e.data.objects[0]})).catch((function(t){}))}},created:function(){var t=this;w.getAnalyzers(this.sketch.id).then((function(e){t.availableAnalyzers=e.data})).catch((function(t){console.error(t)}))}},Ln=Pn,jn=Object(c["a"])(Ln,On,Dn,!1,null,null,null),Rn=jn.exports,zn=function(){var t=this,e=t._self._c;return e("router-view")},Qn=[],Hn={},Gn=Object(c["a"])(Hn,zn,Qn,!1,null,null,null),qn=Gn.exports,Vn=function(){var t=this,e=t._self._c;return e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),e("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"stories"}}),e("b-modal",{attrs:{active:t.showCreateStoryModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showCreateStoryModal=e}}},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Create a new story")])]),e("div",{staticClass:"card-content"},[e("div",{staticClass:"content"},[e("ts-story-create-form",{on:{toggleModal:function(e){t.showCreateStoryModal=!t.showCreateStoryModal}}})],1)])])]),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("button",{staticClass:"button is-success",staticStyle:{"margin-right":"7px"},on:{click:function(e){t.showCreateStoryModal=!t.showCreateStoryModal}}},[t._m(0),e("span",[t._v("Create story")])]),e("div",{staticClass:"card",staticStyle:{"margin-top":"20px"}},[e("div",{staticClass:"card-content"},[t.meta.stories.length?t._e():e("div",[t._v("\n            There are no stories in this sketch yet\n          ")]),e("ts-story-list",{attrs:{controls:!0}})],1)])])])],1)},Un=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-plus-circle"})])}],Yn=function(){var t=this,e=t._self._c;return e("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v("Title")]),e("div",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"input",attrs:{type:"text",required:"",placeholder:"Title of your story",autofocus:""},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})])]),t._m(0)])},Wn=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("input",{staticClass:"button is-success",attrs:{type:"submit",value:"Create"}})])])}],Bn={data:function(){return{title:""}},methods:{clearFormData:function(){this.title=""},submitForm:function(){var t=this,e="";w.createStory(this.title,e,this.sketch.id).then((function(e){var s=e.data.objects[0].id;t.clearFormData(),t.$router.push({name:"StoryContent",params:{storyId:s}}),t.$store.dispatch("updateSketch",t.sketch.id)})).catch((function(t){}))}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}}},Jn=Bn,Zn=Object(c["a"])(Jn,Yn,Wn,!1,null,null,null),Kn=Zn.exports,Xn={components:{TsNavbarMain:N["default"],TsStoryList:qt,TsStoryCreateForm:Kn},data:function(){return{showCreateStoryModal:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}}},tr=Xn,er=Object(c["a"])(tr,Vn,Un,!1,null,null,null),sr=er.exports,ir=function(){var t=this,e=t._self._c;return e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),e("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"stories"}}),t.blocks?e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-content",staticStyle:{padding:"50px"}},[e("div",{staticClass:"markdown-body ts-markdown-body-color",staticStyle:{"margin-bottom":"20px","padding-left":"10px"}},[e("h1",[t._v(t._s(t.title))])]),t._l(t.blocks,(function(s,i){return e("div",{key:i},[s.componentName?t._e():e("div",{staticClass:"inactiveBlock",class:{activeBlock:s.isActive},staticStyle:{"padding-left":"10px","margin-top":"10px","margin-bottom":"10px"},on:{mouseover:function(t){s.isActive=!0},mouseleave:function(t){s.isActive=!1}}},[s.isActive?e("span",{staticStyle:{float:"right"}},[e("button",{staticClass:"delete",on:{click:function(e){return t.deleteBlock(i)}}})]):t._e(),s.edit?e("div",{staticClass:"columns",staticStyle:{"margin-bottom":"0"}},[e("div",{staticClass:"column"},[e("textarea",{staticClass:"textarea",staticStyle:{height:"100%"},attrs:{placeholder:"Your story starts here.."},domProps:{value:s.content},on:{input:function(e){return t.update(e,s)}}})]),e("transition",{attrs:{name:"fade"}},[s.content?e("div",{staticClass:"column"},[e("div",{staticClass:"markdown-body",staticStyle:{"max-height":"600px",overflow:"auto"},domProps:{innerHTML:t._s(t.toHtml(s.content))}})]):t._e()])],1):t._e(),s.edit?e("div",{staticClass:"field is-grouped"},[e("p",{staticClass:"control"},[e("button",{staticClass:"button is-rounded is-success",attrs:{disabled:!s.content},on:{click:function(e){return t.saveAndHide(s)}}},[t._m(0,!0),e("span",[t._v("Save")])])])]):t._e(),s.edit?t._e():e("div",{staticClass:"markdown-body",domProps:{innerHTML:t._s(t.toHtml(s.content))},on:{dblclick:function(t){s.edit=!s.edit}}})]),s.componentName?e("div",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"},on:{mouseover:function(t){s.isActive=!0},mouseleave:function(t){s.isActive=!1}}},[e("article",{staticClass:"message"},[e("div",{staticClass:"message-header"},["TsViewEventList"===s.componentName?e("p",[e("router-link",{attrs:{to:{name:"Explore",query:{view:s.componentProps.view.id}}}},[e("strong",[t._v(t._s(s.componentProps.view.name))])])],1):t._e(),"TsAggregationCompact"===s.componentName?e("p",[t._v("\n                    "+t._s(s.componentProps.aggregation.name)+"\n                  ")]):t._e(),"TsAggregationGroupCompact"===s.componentName?e("p",[t._v("\n                    "+t._s(s.componentProps.aggregation_group.name)+"\n                  ")]):t._e(),e("button",{staticClass:"delete",attrs:{"aria-label":"delete"},on:{click:function(e){return t.deleteBlock(i)}}})]),e("div",{staticClass:"message-body"},[e(s.componentName,t._b({tag:"component"},"component",s.componentProps,!1))],1)])]):t._e(),e("div",{staticStyle:{"min-height":"40px"},on:{mouseover:function(t){s.showPanel=!0},mouseleave:function(t){s.showPanel=!1}}},[i===t.blocks.length-1?e("div",{staticStyle:{"padding-top":"20px"}}):t._e(),i===t.blocks.length-1||s.showPanel||s.isActive?e("div",{staticClass:"field is-grouped"},[e("p",{staticClass:"control"},[e("button",{staticClass:"button is-rounded",on:{click:function(e){return t.addBlock(i)}}},[t._v("\n                    + Text\n                  ")])]),t.meta.views.length?e("p",{staticClass:"control"},[e("ts-view-list-dropdown",{attrs:{"is-simple":!0,"is-last":i===t.blocks.length-1,title:"+ Saved search"},on:{setActiveView:function(e){return t.addViewComponent(e,i)}}})],1):t._e(),t.allAggregations?e("p",{staticClass:"control"},[e("ts-aggregation-list-dropdown",{attrs:{"is-rounded":!0,"is-last":i===t.blocks.length-1,aggregations:t.allAggregations},on:{addAggregation:function(e){return t.addAggregationComponent(e,i)}}})],1):t._e()]):t._e()])])}))],2)])])]):t._e()],1)},ar=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-save",attrs:{"aria-hidden":"true"}})])}],nr=s("7c5c"),rr=function(){var t=this,e=t._self._c;return e("b-dropdown",{ref:"dropdown",attrs:{animation:"none","aria-role":"menu",position:t.position}},[e("a",{staticClass:"button",class:{"is-rounded":t.isRounded},attrs:{slot:"trigger"},slot:"trigger"},[e("span",[t._v("+ Aggregation")]),e("b-icon",{staticStyle:{"font-size":"0.6em"},attrs:{icon:t.active?"chevron-up":"chevron-down"}})],1),e("div",{staticClass:"modal-card",staticStyle:{width:"500px",color:"var(--font-color-dark)"}},[e("section",{staticClass:"modal-card-body"},[t.aggregations&&t.aggregations.length<1?e("span",{staticClass:"dropdown-item"},[t._v("No saved aggregations")]):t._e(),t._l(t.aggregations,(function(s){return e("a",{key:s.id,staticClass:"dropdown-item",on:{click:function(e){return t.setActiveAggregation(s)}}},[e("span",[t._v(t._s(s.name))])])}))],2)])])},or=[],cr={props:["isRounded","aggregations","isLast"],data:function(){return{position:"is-bottom-right"}},methods:{setActiveAggregation:function(t){this.$emit("addAggregation",t)}},created:function(){this.isLast&&(this.position="is-top-right")}},lr=cr,ur=Object(c["a"])(lr,rr,or,!1,null,"cbc8c600",null),dr=ur.exports,hr=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card"},[e("div",{ref:"vegaChart",staticClass:"card-content"},[e("ts-vega-lite-chart",{attrs:{vegaSpec:t.vegaSpec}})],1)])},pr=[],mr={props:["aggregation_group"],components:{TsVegaLiteChart:Sa},data:function(){return{vegaSpec:{},title:""}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{getVegaSpec:function(){var t=this;w.runAggregatorGroup(this.sketch.id,this.aggregation_group.id).then((function(e){var s=e.data.meta.vega_spec;s.config.view.width=t.$refs.vegaChart.offsetWidth-50,s.config.autosize={type:"fit",contains:"padding"},t.vegaSpec=JSON.stringify(s),t.title=e.data.meta.vega_chart_title})).catch((function(t){}))}},mounted:function(){this.getVegaSpec()}},fr=mr,vr=Object(c["a"])(fr,hr,pr,!1,null,null,null),gr=vr.exports,yr=function(){var t=this,e=t._self._c;return e("div",[e("b-modal",{attrs:{active:t.showCreateViewModal,width:640,scroll:"keep"},on:{"update:active":function(e){t.showCreateViewModal=e}}},[e("div",{staticClass:"card"},[e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Save search")])]),e("div",{staticClass:"card-content"},[e("div",{staticClass:"content"},[e("ts-create-view-form",{attrs:{sketchId:t.sketchId,currentQueryString:t.currentQueryString,currentQueryFilter:t.currentQueryFilter},on:{setActiveView:function(e){return t.setActiveView(e)}}})],1)])])]),e("b-dropdown",{ref:"dropdown",attrs:{animation:"none","aria-role":"menu",position:t.position,"append-to-body":!t.isSimple},scopedSlots:t._u([{key:"trigger",fn:function(s){var i=s.active;return e("a",{staticClass:"button",class:{"is-rounded":t.isSimple,"ts-search-dropdown":!t.isSimple}},[t.isSimple?t._e():e("b-icon",{staticStyle:{"margin-right":"7px","font-size":"0.6em"},attrs:{icon:"save"}}),t.activeView?e("span",{staticStyle:{"margin-right":"7px"}},[t._v(t._s(t.isSimple?"+ Saved search":t.activeView.name))]):t._e(),t.isSimple?e("span",[t._v("+ Saved search")]):t._e(),e("b-icon",{staticStyle:{"font-size":"0.6em"},attrs:{icon:i?"chevron-up":"chevron-down"}})],1)}}])},[e("div",{staticClass:"modal-card",staticStyle:{width:"500px",color:"var(--font-color-dark)"}},[e("section",{staticClass:"modal-card-body"},[t.isSimple?t._e():e("div",[e("p",[t._v("\n            Save search query and filters that you want to use again.\n          ")]),e("hr")]),t.meta.views.length?e("div",t._l(t.meta.views,(function(s){return e("b-dropdown-item",{key:s.id,on:{click:function(e){return t.setActiveView(s)}}},[e("span",[t._v(t._s(s.name))])])})),1):t._e()])]),t.isSimple?t._e():e("div",{staticClass:"level footer"},[e("div",{staticClass:"level-left"},[e("div",{staticClass:"level-item"},[t.activeView?e("button",{staticClass:"button is-text",staticStyle:{color:"var(--font-color-dark)","text-decoration":"none"},on:{click:t.clearSearch}},[t._v("\n            Clear\n          ")]):t._e()])]),e("div",{staticClass:"level-right"},[e("div",{staticClass:"level-item"},[t.activeView?e("button",{staticClass:"button level-item",staticStyle:{"border-radius":"5px"},attrs:{disabled:!t.currentQueryString},on:{click:t.updateView}},[t._v("\n            Save changes\n          ")]):t._e()]),e("div",{staticClass:"level-item"},[e("button",{staticClass:"button is-info level-item",staticStyle:{"border-radius":"5px"},attrs:{disabled:!t.currentQueryString},on:{click:t.saveView}},[e("b-icon",{attrs:{icon:"save",size:"is-small"}}),e("span",[t._v(t._s(t.activeView?"Save as new":"Save current search"))])],1)])])])])],1)},_r=[],br={components:{TsCreateViewForm:vi},props:["currentQueryString","currentQueryFilter","isSimple","isLast","sketchId"],data:function(){return{activeView:null,showCreateViewModal:!1,position:"is-bottom-right"}},methods:{setActiveView:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.showCreateViewModal=!1,this.activeView=t,e&&this.$emit("setActiveView",t)},clearSearch:function(){this.$emit("clearSearch"),this.activeView=null,this.$refs.dropdown.toggle()},saveView:function(){this.showCreateViewModal=!0,this.$refs.dropdown.toggle()},updateView:function(){var t=this;this.activeView&&(this.$refs.dropdown.toggle(),this.activeView.query=this.currentQueryString,this.activeView.filter=JSON.stringify(this.currentQueryFilter),w.updateView(this.sketchId,this.activeView.id,this.currentQueryString,this.currentQueryFilter).then((function(e){t.$buefy.toast.open("Saved search has been updated")})).catch((function(t){})))}},computed:{meta:function(){return this.$store.state.meta}},created:function(){this.isLast&&(this.position="is-top-right");var t=this.$route.query.view;if(t){var e=this.meta.views.filter((function(e){return e.id===parseInt(t)}));this.setActiveView(e[0],!1)}}},Cr=br,wr=(s("9a90"),Object(c["a"])(Cr,yr,_r,!1,null,"0cc60569",null)),kr=wr.exports,Sr=function(){return{componentName:"",componentProps:{},content:"",edit:!0,showPanel:!1,isActive:!1}},xr={components:{TsAggregationListDropdown:dr,TsAggregationCompact:kn,TsAggregationGroupCompact:gr,TsViewListDropdown:kr,TsViewEventList:na},props:["sketchId","storyId"],data:function(){return{blocks:[],title:"",aggregations:[],aggregationGroups:[]}},methods:{update:dt.a.debounce((function(t,e){e.content=t.target.value,this.save()}),300),addBlock:function(t){var e=t+1,s=Sr();this.blocks.splice(e,0,s)},deleteBlock:function(t){this.blocks.splice(t,1),this.blocks.length||(this.blocks=[Sr()]),this.save()},addAggregationComponent:function(t,e){var s=e+1,i=Sr();"agg_ids"in t?(i.componentName="TsAggregationGroupCompact",i.componentProps={aggregation_group:t}):(i.componentName="TsAggregationCompact",i.componentProps={aggregation:t}),this.blocks.splice(s,0,i),this.save()},addViewComponent:function(t,e){this.showPanel=!1;var s=e+1,i=Sr();i.componentName="TsViewEventList",i.componentProps={view:t},this.blocks.splice(s,0,i),this.save()},hideBlock:function(t){t.edit=!t.edit},saveAndHide:function(t){this.hideBlock(t),this.save()},save:function(){this.blocks.forEach((function(t){t.showPanel=!1,t.isActive=!1}));var t=JSON.stringify(this.blocks);w.updateStory(this.title,t,this.sketchId,this.storyId).then((function(t){})).catch((function(t){}))},toHtml:function(t){return Object(nr["marked"])(t,{sanitize:!1})}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},allAggregations:function(){var t=function(){for(var t,e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return(t=[]).concat.apply(t,Object(U["a"])(s.filter(Array.isArray)))};return t(this.aggregations,this.aggregationGroups)}},created:function(){var t=this;w.getStory(this.sketchId,this.storyId).then((function(e){t.title=e.data.objects[0].title;var s=e.data.objects[0].content;t.blocks="[]"===s?[Sr()]:JSON.parse(s)})).catch((function(t){console.error(t)})),w.getAggregations(this.sketchId).then((function(e){t.aggregations=e.data.objects[0]})).catch((function(t){console.error(t)})),w.getAggregationGroups(this.sketchId).then((function(e){t.aggregationGroups=e.data.objects})).catch((function(t){console.error(t)}))}},Tr=xr,Ar=(s("3d7f"),Object(c["a"])(Tr,ir,ar,!1,null,null,null)),Or=Ar.exports,Dr=function(){var t=this,e=t._self._c;return e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),e("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"attributes"}}),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card",staticStyle:{"min-height":"160px"}},[t._m(0),e("div",{staticClass:"card-content"},[e("b-table",{attrs:{data:t.sketchAttributes,"default-sort":"name"}},[e("b-table-column",{attrs:{field:"name",label:"Attribute name"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.name)+"\n            ")]}}])}),e("b-table-column",{attrs:{field:"ontology",label:"Ontology"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("code",[t._v(t._s(s.row.ontology))])]}}])}),e("b-table-column",{attrs:{field:"value",label:"Value"},scopedSlots:t._u([{key:"default",fn:function(s){return["object"===Object(Ts["a"])(s.row.value)?e("pre",[t._v(t._s(s.row.value))]):e("span",[t._v(t._s(s.row.value))])]}}])})],1)],1)])])])],1)},Er=[function(){var t=this,e=t._self._c;return e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Attribute list")])])}],$r={components:{},data:function(){return{}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},sketchAttributes:function(){var t=[];for(var e in this.$store.state.meta.attributes)t.push({name:e,ontology:this.$store.state.meta.attributes[e].ontology,value:this.$store.state.meta.attributes[e].value});return t}},mounted:function(){this.$store.dispatch("updateSketch",this.$store.state.sketch.id)}},Fr=$r,Nr=Object(c["a"])(Fr,Dr,Er,!1,null,null,null),Ir=Nr.exports,Mr=function(){var t=this,e=t._self._c;return e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),e("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"intelligence"}}),Object.keys(t.tagMetadata).length>0?e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"columns"},[e("div",{staticClass:"column"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("\n                Indicators of compromise\n                "),e("b-button",{staticClass:"new-ioc",attrs:{type:"is-success",size:"is-small"},on:{click:function(e){t.startIOCEdit(t.getNewIoc(),-1)}}},[e("i",{staticClass:"fas fa-plus-circle",attrs:{"aria-hidden":"true"}}),t._v("\n                  Add new\n                ")])],1)]),e("div",{staticClass:"card-content"},[t.intelligenceData.length>0?e("b-table",{attrs:{data:t.intelligenceData}},[e("b-table-column",{attrs:{field:"type",label:"IOC Type",sortable:""},scopedSlots:t._u([{key:"default",fn:function(s){return[e("code",[t._v(t._s(s.row.type))])]}}],null,!1,1591400447)}),e("b-table-column",{attrs:{field:"externalURI",label:"External ref.",sortable:""},scopedSlots:t._u([{key:"default",fn:function(s){return[t.getValidUrl(s.row.externalURI)?e("a",{attrs:{href:t.getValidUrl(s.row.externalURI),target:"_blank"}},[e("i",{staticClass:"fas fa-external-link-alt"}),t._v(" "+t._s(t.getValidUrl(s.row.externalURI).host)+"\n                  ")]):e("span",[t._v(t._s(s.row.externalURI))])]}}],null,!1,3418687168)}),e("b-table-column",{attrs:{field:"ioc",label:"",width:"10em"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:s.row.ioc,expression:"props.row.ioc",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.notifyClipboardSuccess,expression:"notifyClipboardSuccess",arg:"success"}],staticClass:"fas fa-copy",staticStyle:{cursor:"pointer"},attrs:{title:"Copy IOC to clipboard."}}),e("router-link",{staticClass:"ml-4",attrs:{to:{name:"Explore",query:t.generateOpenSearchQuery(s.row.ioc)}}},[e("i",{staticClass:"fas fa-search",attrs:{"aria-hidden":"true",title:"Search sketch for all events containing this IOC."}})]),e("explore-preview",{staticStyle:{"margin-left":"10px"},attrs:{searchQuery:t.generateOpenSearchQuery(s.row.ioc)["q"]}})]}}],null,!1,3904015794)}),e("b-table-column",{attrs:{field:"ioc",label:"Indicator data",sortable:""},scopedSlots:t._u([{key:"default",fn:function(s){return[e("code",[t._v(t._s(s.row.ioc))])]}}],null,!1,2290414082)}),e("b-table-column",{attrs:{field:"tags",label:"Tags"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("b-taglist",t._l(t.getEnrichedTags(s.row.tags),(function(s){return e("b-tag",{key:s.name,attrs:{type:"is-".concat(s.class," is-light")}},[e("router-link",{attrs:{to:{name:"Explore",query:t.generateOrOpenSearchQuery(t.tagInfo[s.name].iocs)}}},[e("i",{staticClass:"fas fa-search",attrs:{"aria-hidden":"true",title:"Search sketch for all IOCs with this tag."}})]),t._v("\n                      "+t._s(s.name)+"\n                    ")],1)})),1)]}}],null,!1,515723883)}),e("b-table-column",{attrs:{field:"edit",label:""},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{staticClass:"icon is-small",staticStyle:{cursor:"pointer"},attrs:{title:"Edit IOC"},on:{click:function(e){return t.startIOCEdit(s.row,s.index)}}},[e("i",{staticClass:"fas fa-edit"})])]}}],null,!1,662634871)}),e("b-table-column",{attrs:{field:"delete",label:""},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{staticClass:"icon is-small delete-ioc",staticStyle:{cursor:"pointer"},attrs:{title:"Delete IOC"},on:{click:function(e){return t.deleteIoc(s.row)}}},[e("i",{staticClass:"fas fa-trash"})])]}}],null,!1,2208852308)})],1):e("div",{staticClass:"card-content"},[t._v("\n                Examine events in the "),e("router-link",{attrs:{to:{name:"Explore"}}},[t._v("Explore view")]),t._v(" to add\n                intelligence locally\n              ")],1)],1)])])]),Object.keys(t.tagMetadata).length>0?e("div",{staticClass:"columns"},[e("div",{staticClass:"column"},[e("div",{staticClass:"card"},[t._m(0),e("div",{staticClass:"card-content"},[Object.keys(t.tagInfo).length>0?e("b-table",{attrs:{data:Object.values(t.tagInfo),"default-sort":"tag.weight","default-sort-direction":"desc"}},[e("b-table-column",{attrs:{field:"search",label:"",width:"1em"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("router-link",{attrs:{to:{name:"Explore",query:t.generateOrOpenSearchQuery(s.row.iocs)}}},[e("i",{staticClass:"fas fa-search",attrs:{"aria-hidden":"true",title:"Search sketch for all IOCs with this tag."}})])]}}],null,!1,3289868029)}),e("b-table-column",{attrs:{field:"tag.name",label:"Tag name",sortable:""},scopedSlots:t._u([{key:"default",fn:function(s){return[e("b-tag",{attrs:{type:"is-".concat(s.row.tag.class," is-light")}},[t._v(t._s(s.row.tag.name)+" ")])]}}],null,!1,1622658425)}),e("b-table-column",{attrs:{field:"count",label:"IOCs tagged",sortable:"",numeric:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row.count)+"\n                ")]}}],null,!1,3799711614)}),e("b-table-column",{attrs:{field:"tag.weight",label:"Weight",width:"2em",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row.tag.weight)+"\n                ")]}}],null,!1,4200456513)})],1):e("span",[t._v("No IOCs have been tagged yet.")])],1)])]),e("div",{staticClass:"column"},[e("div",{staticClass:"card"},[t._m(1),e("div",{staticClass:"card-content"},[t.sketchTags.length>0?e("b-table",{attrs:{data:t.sketchTags}},[e("b-table-column",{attrs:{field:"search",label:"",width:"1em"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("router-link",{attrs:{to:{name:"Explore",query:t.generateOpenSearchQuery(s.row.tag,"tag")}}},[e("i",{staticClass:"fas fa-search",attrs:{"aria-hidden":"true",title:"Search sketch for all events with this tag."}})])]}}],null,!1,2709630419)}),e("b-table-column",{attrs:{field:"tag",label:"Tag",sortable:""},scopedSlots:t._u([{key:"default",fn:function(s){return[e("b-tag",{attrs:{type:"is-info is-light"}},[t._v(t._s(s.row.tag)+" ")])]}}],null,!1,2294089514)}),e("b-table-column",{attrs:{field:"count",label:"Events tagged",sortable:"",numeric:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row.count)+"\n                ")]}}],null,!1,3799711614)})],1):e("span",[t._v("No events have been tagged yet.")])],1)])])]):t._e()])]):t._e(),t._m(2)],1)},Pr=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("\n                Tag list "),e("i",{staticClass:"fas fa-question-circle",attrs:{title:"Tags that have been associated with IOCs."}})]),e("p",{staticClass:"card-header-icon"},[e("span",{staticClass:"icon"})])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("\n                Event tags "),e("i",{staticClass:"fas fa-question-circle",attrs:{title:"Tags that have been applied to events."}})]),e("p",{staticClass:"card-header-icon"},[e("span",{staticClass:"icon"})])])},function(){var t=this,e=t._self._c;return e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"})])}],Lr=function(){var t=this,e=t._self._c;return t.previewData.length&&!t.displayInline?e("span",{on:{mouseenter:function(e){return t.delayDisplay(!0,0)},mouseleave:function(e){return t.delayDisplay(!1,500)}}},[e("b-tag",{attrs:{rounded:"",type:"is-success is-light"}},[e("span",{staticClass:"icon is-medium"},[e("i",{staticClass:"fas fa-eye",attrs:{"aria-hidden":"true"}})]),t._v("\n    "+t._s(t.previewData.length)+"\n  ")]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isOpen,expression:"isOpen"}],staticClass:"preview-box-floating"},[e("div",{staticClass:"preview-title"},[t._v("\n      Previewing results for "),e("code",[t._v(t._s(t.searchQuery))])]),e("event-list",{attrs:{eventList:t.previewData,order:"asc",displayOptions:{showEmojis:!1,showMillis:!1,showTags:!0},selectedFields:[{field:"message",type:"text"}],searchNode:t.previewSearchNode}})],1)],1):t.displayInline?e("span",[t._v("\n  Live preview: "+t._s(t.previewData.length||"No")+" matching events.\n  "),t.previewData.length?e("event-list",{attrs:{eventList:t.previewData,order:"asc",displayOptions:{showEmojis:!1,showMillis:!1,showTags:!0},selectedFields:[{field:"message",type:"text"}],searchNode:t.previewSearchNode}}):t._e()],1):e("b-tag",{staticStyle:{opacity:"0.5"},attrs:{rounded:"",type:"is-light"}},[e("span",{staticClass:"icon is-medium"},[e("i",{staticClass:"fas fa-eye-slash",attrs:{"aria-hidden":"true"}})]),t._v("0\n")])},jr=[],Rr={components:{EventList:ss},props:{searchQuery:[String],displayInline:{type:Boolean,default:!1}},data:function(){return{previewData:[],responseMeta:null,previewSearchNode:null,isOpen:!1,timer:null}},methods:{refreshPreview:function(){var t=this,e={query:this.searchQuery,parent:this.currentSearchNode.id};w.search(this.sketch.id,e).then((function(e){t.previewData=e.data.objects,t.previewSearchNode=e.data.meta.search_node}))},delayDisplay:function(t,e){var s=this;this.previewData.length&&(clearTimeout(this.timer),this.timer=setTimeout((function(){s.isOpen=t}),e))}},computed:{sketch:function(){return this.$store.state.sketch},currentSearchNode:function(){return this.$store.state.currentSearchNode||{id:0}}},mounted:function(){this.refreshPreview()},watch:{searchQuery:dt.a.debounce((function(t){this.refreshPreview(t)}),300)}},zr=Rr,Qr=(s("7bad"),Object(c["a"])(zr,Lr,jr,!1,null,"5fbb1a06",null)),Hr=Qr.exports,Gr=function(){var t=this,e=t._self._c;return e("div",[e("section",{staticClass:"box"},[e("h1",{staticClass:"subtitle"},[t._v("Compose IOC")]),e("b-field",{attrs:{"label-position":"on-border"}},[e("b-input",{attrs:{"custom-class":"ioc-input",type:"textarea"},model:{value:t.composeIoc.ioc,callback:function(e){t.$set(t.composeIoc,"ioc",e)},expression:"composeIoc.ioc"}})],1),e("b-field",{attrs:{grouped:""}},[e("b-field",[e("b-select",{attrs:{placeholder:"IOC type",label:"IOC type","label-position":"on-border"},model:{value:t.composeIoc.type,callback:function(e){t.$set(t.composeIoc,"type",e)},expression:"composeIoc.type"}},t._l(t.IOCTypes,(function(s){return e("option",{key:s.type,domProps:{value:s.type}},[t._v("\n            "+t._s(s.type)+"\n          ")])})),0)],1),e("b-field",[e("b-taginput",{attrs:{ellipsis:"",icon:"label",placeholder:"Add a tag","aria-close-label":"Delete this tag"},model:{value:t.editableTags,callback:function(e){t.editableTags=e},expression:"editableTags"}})],1),e("b-field",{attrs:{message:"Readonly tags"}},[e("b-taginput",{attrs:{readonly:"",ellipsis:"",closable:!1,field:"name"},model:{value:t.readonlyTags,callback:function(e){t.readonlyTags=e},expression:"readonlyTags"}})],1),e("b-field",{attrs:{grouped:"",expanded:"",position:"is-right"}},[e("p",{staticClass:"control"},[e("b-button",{attrs:{type:"is-primary"},on:{click:t.saveIoc}},[t._v("Save")])],1),e("p",{staticClass:"control"},[e("b-button",{on:{click:function(e){return t.$parent.close()}}},[t._v("Cancel")])],1)])],1),e("b-field",{attrs:{label:"External reference (URI)"}},[e("b-input",{model:{value:t.composeIoc.externalURI,callback:function(e){t.$set(t.composeIoc,"externalURI",e)},expression:"composeIoc.externalURI"}})],1),e("explore-preview",{staticStyle:{"margin-left":"10px"},attrs:{searchQuery:t.generateOpenSearchQuery(t.composeIoc.ioc)["q"],"display-inline":!0}})],1)])},qr=[],Vr={components:{ExplorePreview:Hr},props:["value"],data:function(){var t=JSON.parse(JSON.stringify(this.value));return{composeIoc:t,editableTags:t.tags.filter((function(t){return"string"===typeof t})),readonlyTags:t.tags.filter((function(t){return"object"===Object(Ts["a"])(t)})),IOCTypes:Me}},methods:{saveIoc:function(){this.$parent.close(),this.composeIoc.tags=this.editableTags.concat(this.readonlyTags),this.$emit("input",this.composeIoc)},generateOpenSearchQuery:function(t,e){if(void 0===t)return{q:""};var s='"'.concat(t,'"');return s=s.replace(/[\\\s]/g,"\\$&"),void 0!==e&&(s="".concat(e,":").concat(s)),{q:s}}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}}},Ur=Vr,Yr=(s("3d85"),Object(c["a"])(Ur,Gr,qr,!1,null,null,null)),Wr=Yr.exports;function Br(t,e){var s="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!s){if(Array.isArray(t)||(s=Jr(t))||e&&t&&"number"===typeof t.length){s&&(t=s);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r=!0,o=!1;return{s:function(){s=s.call(t)},n:function(){var t=s.next();return r=t.done,t},e:function(t){o=!0,n=t},f:function(){try{r||null==s.return||s.return()}finally{if(o)throw n}}}}function Jr(t,e){if(t){if("string"===typeof t)return Zr(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Zr(t,e):void 0}}function Zr(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}var Kr={components:{ExplorePreview:Hr},data:function(){return{sketchTags:[],tagInfo:{},tagMetadata:{},editingIoc:{},isNew:!1,showEditModal:!1,IOCTypes:Me}},methods:{deleteIoc:function(t){var e=this;if(confirm("Delete IOC?")){var s=this.intelligenceData.filter((function(e){return e.ioc!==t.ioc}));w.addSketchAttribute(this.sketch.id,"intelligence",{data:s},"intelligence").then((function(){e.loadSketchAttributes()}))}},getNewIoc:function(){return{ioc:null,type:"other",externalURI:null,tags:[]}},getValidUrl:function(t){return void 0!==t&&null!==t&&""!==t&&(t.startsWith("http")?new URL(t):!!t.includes("/")&&new URL("http://"+t))},loadSketchAttributes:function(){var t=this;this.$store.dispatch("updateSketch",this.$store.state.sketch.id),w.getTagMetadata().then((function(e){t.tagMetadata=e.data,t.buildTagInfo()}))},loadSketchTags:function(){var t=this;w.runAggregator(this.sketch.id,{aggregator_name:"field_bucket",aggregator_parameters:{field:"tag"}}).then((function(e){t.sketchTags=e.data.objects[0].field_bucket.buckets}))},notifyClipboardSuccess:function(){this.$buefy.notification.open({message:"Succesfully copied data to clipboard!",type:"is-success"})},buildTagInfo:function(){this.tagInfo={};var t,e=Br(this.intelligenceData);try{for(e.s();!(t=e.n()).done;){var s,i=t.value,a=Br(i.tags);try{for(a.s();!(s=a.n()).done;){var n=s.value,r=null;r="object"===Object(Ts["a"])(n)?n.name:n,this.tagInfo[r]||(this.tagInfo[r]={count:0,iocs:[],tag:this.enrichTag(n)}),this.tagInfo[r].count++,this.tagInfo[r].iocs.push(i.ioc)}}catch(o){a.e(o)}finally{a.f()}}}catch(o){e.e(o)}finally{e.f()}},getEnrichedTags:function(t){var e=this,s=t.map((function(t){return e.enrichTag(t)})).sort((function(t,e){return e.weight-t.weight}));return s},enrichTag:function(t){if("object"===Object(Ts["a"])(t))return t;var e={name:t};if(this.tagMetadata[t])return dt.a.extend(e,this.tagMetadata[t]);for(var s in this.tagMetadata["regexes"])if(t.match(s))return dt.a.extend(e,this.tagMetadata["regexes"][s]);return dt.a.extend(e,this.tagMetadata.default)},generateOrOpenSearchQuery:function(t){var e=t.map((function(t){return'"'.concat(t,'"')})).reduce((function(t,e){return"".concat(t," OR ").concat(e)}));return{q:e}},generateOpenSearchQuery:function(t,e){var s='"'.concat(t,'"');return s=s.replace(/[\\\s]/g,"\\$&"),void 0!==e&&(s="".concat(e,":").concat(s)),{q:s}},startIOCEdit:function(t,e){var s=this;this.$buefy.modal.open({parent:this,component:Wr,props:{value:t},events:{input:function(t){-1===e?s.intelligenceAttribute.value.data.push(t):s.intelligenceAttribute.value.data.splice(e,1,t),s.saveIntelligence()}}})},saveIntelligence:function(){var t=this;w.addSketchAttribute(this.sketch.id,"intelligence",this.intelligenceAttribute.value,"intelligence").then((function(){y["a"].open({message:"Intelligence successfully updated!",type:"is-success",position:"is-top",actionText:"Dismiss",indefinite:!1}),t.showEditModal=!1,t.buildTagInfo()})).catch((function(t){y["a"].open({message:"IOC update failed.",type:"is-danger",position:"is-top",indefinite:!1})}))}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},intelligenceAttribute:function(){return void 0===this.meta.attributes.intelligence?{ontology:"intelligence",value:{data:[]},name:"intelligence"}:this.meta.attributes.intelligence},intelligenceData:function(){return this.intelligenceAttribute.value.data}},mounted:function(){this.loadSketchAttributes(),this.loadSketchTags()}},Xr=Kr,to=(s("3df4"),Object(c["a"])(Xr,Mr,Pr,!1,null,null,null)),eo=to.exports,so=function(){var t=this,e=t._self._c;return e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),e("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:""}}),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card",staticStyle:{"min-height":"160px"}},[t._m(0),e("div",{staticClass:"card-content"},[e("ts-view-list",{attrs:{views:t.meta.views,controls:!0}})],1)])])])],1)},io=[function(){var t=this,e=t._self._c;return e("header",{staticClass:"card-header"},[e("p",{staticClass:"card-header-title"},[t._v("Manage Saved Views")])])}],ao={components:{TsViewList:jt},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}}},no=ao,ro=Object(c["a"])(no,so,io,!1,null,null,null),oo=ro.exports,co=function(){var t=this,e=t._self._c;return e("router-view")},lo=[],uo={},ho=Object(c["a"])(uo,co,lo,!1,null,null,null),po=ho.exports,mo=function(){var t=this,e=t._self._c;return e("div",[e("ts-navbar-main",{scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n      "+t._s(t.sketch.name)+"\n    ")]},proxy:!0}])}),e("ts-navbar-secondary",{attrs:{currentAppContext:"sketch",currentPage:"sigma"}}),e("section",{staticClass:"section"},[e("div",{staticClass:"container is-fluid"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-content"},[e("ts-sigma-list")],1)])])])],1)},fo=[],vo=function(){var t=this,e=t._self._c;return e("div",[e("b-modal",{attrs:{active:t.showEditModal},on:{"update:active":function(e){t.showEditModal=e}}},[e("section",{staticClass:"box"},[e("h1",{staticClass:"subtitle"},[t._v(t._s(t.save_button_text)+" Sigma Rule")]),e("div",{staticStyle:{width:"100%"}},[e("div",{staticStyle:{width:"50%",height:"80px",float:"left"}},[e("h2",[t._v("Templates")]),e("b-select",{attrs:{placeholder:"Templates",label:"Templates","label-position":"on-border"},model:{value:t.editingRule.rule_yaml,callback:function(e){t.$set(t.editingRule,"rule_yaml",e)},expression:"editingRule.rule_yaml"}},t._l(t.SigmaTemplates,(function(s){return e("option",{key:s.os,domProps:{value:s.text}},[t._v("\n              "+t._s(s.os)+"\n            ")])})),0)],1),e("div",{staticStyle:{"margin-left":"50%",height:"80px"}},[e("div",[t._v("Parsed rule Search query:\n            "),e("b",[e("code",[t._v(t._s(t.parsed["search_query"]))])]),e("explore-preview",{attrs:{searchQuery:t.parsed["search_query"]}})],1),e("div",[t._v("Parsing Status: "+t._s(t.problemString))])])]),e("b-field",{staticStyle:{"margin-top":"25px"},attrs:{label:"Edit Sigma Rule","label-position":"on-border"}},[e("b-input",{attrs:{"custom-class":"ioc-input",type:"textarea",rows:"25"},on:{input:function(e){return t.parseSigma(t.editingRule.rule_yaml)}},model:{value:t.editingRule.rule_yaml,callback:function(e){t.$set(t.editingRule,"rule_yaml",e)},expression:"editingRule.rule_yaml"}})],1),e("b-field",{attrs:{grouped:""}},[e("b-field",{attrs:{grouped:"",expanded:"",position:"is-right"}},[e("p",{staticClass:"control"},[e("b-button",{attrs:{disabled:"ok"!==t.problemString.toLowerCase(),type:"is-primary"},on:{click:function(e){return t.addOrUpdateRule(t.editingRule)}}},[t._v("\n              "+t._s(t.save_button_text)+"\n            ")])],1),e("p",{staticClass:"control"},[e("b-button",{on:{click:function(e){t.showEditModal=!1}}},[t._v("Cancel")])],1)])],1)],1)]),e("span",{staticClass:"icon is-small",staticStyle:{cursor:"pointer"},attrs:{title:"Add a rule Rule"},on:{click:function(e){return t.composeRule()}}},[e("i",{staticClass:"fas fa-plus"}),t._v("Add\n  ")]),t.sigmaRuleList?e("b-table",{key:"props.row.id",attrs:{data:t.sigmaRuleList,"current-page":t.currentPage,"per-page":t.perPage,paginated:"","pagination-simple":"","pagination-position":"bottom","default-sort-direction":"desc","sort-icon":"arrow-down","sort-icon-size":"is-small","icon-pack":"fas","icon-prev":"chevron-left","icon-next":"chevron-right","default-sort":"title"},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}},[e("b-table-column",{attrs:{field:"title",label:"Name",sortable:"",searchable:""},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{attrs:{"custom-class":"margintop-pointer"},on:{click:function(e){return t.startRuleEdit(s.row)}}},[t._v("\n        "+t._s(s.row.title)+"\n      ")])]}}],null,!1,563373269)}),e("b-table-column",{attrs:{field:"author",label:"Author",searchable:"",sortable:""},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{attrs:{"custom-class":"margintop-pointer"},on:{click:function(e){return t.startRuleEdit(s.row)}}},[t._v("\n        "+t._s(s.row.author)+"\n      ")])]}}],null,!1,1334194336)}),e("b-table-column",{attrs:{field:"status",label:"Status",sortable:"",searchable:""},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{attrs:{"custom-class":"margintop-pointer"},on:{click:function(e){return t.startRuleEdit(s.row)}}},[t._v("\n        "+t._s(s.row.status)+" "),e("span",{staticClass:"icon is-small",attrs:{"custom-class":"clickable",title:"Only stable rules are used in the Sigma Analyzer"}},["stable"!=s.row.status?e("i",{staticClass:"fas fa-info-circle"}):t._e()])])]}}],null,!1,1811379974)}),e("b-table-column",{attrs:{field:"actions",label:"Actions"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("router-link",{attrs:{to:{name:"Explore",query:{q:s.row.search_query}}}},[e("i",{staticClass:"fas fa-search",attrs:{"aria-hidden":"true",title:"Search sketch for all events with this tag."}})]),e("explore-preview",{staticStyle:{"margin-left":"10px"},attrs:{searchQuery:s.row.search_query}}),e("span",{staticClass:"icon is-small",attrs:{"custom-class":"clickable",title:"Edit Rule"},on:{click:function(e){return t.startRuleEdit(s.row)}}},[e("i",{staticClass:"fas fa-edit"})]),e("span",{staticClass:"icon is-small",attrs:{"custom-class":"clickable",title:"Delete Rule"},on:{click:function(e){return t.deleteRule(s.row)}}},[e("i",{staticClass:"fas fa-trash"})])]}}],null,!1,529716047)})],1):t._e(),e("div",{staticClass:"container is-fluid"},[t.sketchTTP.length>0?e("b-table",{attrs:{data:t.sketchTTP}},[e("b-table-column",{attrs:{field:"search",label:"",width:"1em"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("router-link",{attrs:{to:{name:"Explore",query:t.generateOpenSearchQuery(s.row.ts_ttp,"ts_ttp")}}},[e("i",{staticClass:"fas fa-search",attrs:{"aria-hidden":"true",title:"Search sketch for all events with this tag."}})])]}}],null,!1,34645619)}),e("b-table-column",{attrs:{field:"tag",label:"TTP",sortable:""},scopedSlots:t._u([{key:"default",fn:function(s){return[e("b-tag",{attrs:{type:"is-info is-light"}},[t._v(t._s(s.row.ts_ttp)+" ")])]}}],null,!1,3363046352)}),e("b-table-column",{attrs:{field:"count",label:"Events tagged",sortable:"",numeric:""},scopedSlots:t._u([{key:"default",fn:function(t){return[e("explore-preview",{staticStyle:{"margin-left":"10px"},attrs:{searchQuery:t.row.ts_ttp}})]}}],null,!1,1779333503)})],1):e("span",[t._v("No events have been tagged yet.")])],1)],1)},go=[];try{var yo=crypto.randomUUID()}catch(yl){console.log("crypto.randomUUID() not supported, using a fixed value instead"),yo="10a4fb8c-29d5-4eb6-905f-13d6a553d470"}var _o="title: Foobar\nid: ".concat(yo,"\ndescription: Detects suspicious FOOBAR\nreferences:\n  - https://\nauthor: \ndate: ").concat(new Date(Date.now()).toLocaleString("en-ZA").split(",")[0],"\nmodified: ").concat(new Date(Date.now()).toLocaleString("en-ZA").split(",")[0],"\ntags:\n    -"),bo="falsepositives:\n    - Unknown\nstatus: experimental\nlevel: medium\ndetection:\n    keywords:\n        - '*foobar*'\n    condition: keywords",Co="".concat(_o,"\nlogsource:\n    product: aws\n    service: cloudtrail\n").concat(bo,"\n"),wo="".concat(_o,"\nlogsource:\n    product: azure\n    service: activitylogs\n").concat(bo,"\n"),ko="".concat(_o,"\nlogsource:\n    product: azure\n    service: signinlogs\n").concat(bo,"\n"),So="".concat(_o,"\nlogsource:\n    product: gcp\n    service: gcp.audit\n").concat(bo,"\n"),xo="".concat(_o,"\nlogsource:\n    product: google_workspace\n    service: google_workspace.admin\n").concat(bo,"\n"),To="".concat(_o,"\nlogsource:\n    product: m365\n    service: threat_management\n").concat(bo,"\n"),Ao="".concat(_o,"\nlogsource:\n    product: okta\n    service: okta\n").concat(bo,"\n"),Oo="".concat(_o,"\nlogsource:\n    category: file_create\n    product: linux\n").concat(bo,"\n"),Do="".concat(_o,"\nlogsource:\n    category: network_connection\n    product: linux\n").concat(bo,"\n"),Eo="".concat(_o,"\nlogsource:\n    category: process_creation\n    product: linux\n").concat(bo,"\n"),$o="".concat(_o,"\nlogsource:\n    product: linux\n").concat(bo,"\n"),Fo="".concat(_o,"\nlogsource:\n    category: auditd\n    product: linux\n").concat(bo,"\n"),No="".concat(_o,"\nlogsource:\n    category: clamav\n    product: linux\n").concat(bo,"\n"),Io="".concat(_o,"\nlogsource:\n    category: cron\n    product: linux\n").concat(bo,"\n"),Mo="".concat(_o,"\nlogsource:\n    category: guacamole\n    product: linux\n").concat(bo,"\n"),Po="".concat(_o,"\nlogsource:\n    category: modsecurity\n    product: linux\n").concat(bo,"\n"),Lo="".concat(_o,"\nlogsource:\n    category: sudo\n    product: linux\n").concat(bo,"\n"),jo="".concat(_o,"\nlogsource:\n    category: sshd\n    product: linux\n").concat(bo,"\n"),Ro="".concat(_o,"\nlogsource:\n    category: syslog\n    product: linux\n").concat(bo,"\n"),zo="".concat(_o,"\nlogsource:\n    category: vsftpd\n    product: linux\n").concat(bo,"\n"),Qo="".concat(_o,"\nlogsource:\n    category: file_event\n    product: macos\n").concat(bo,"\n"),Ho="".concat(_o,"\nlogsource:\n    category: process_creation\n    product: macos\n").concat(bo,"\n"),Go="".concat(_o,"\nlogsource:\n    category: clipboard_capture\n    product: windows\n").concat(bo,"\n"),qo="".concat(_o,"\nlogsource:\n    category: create_remote_thread\n    product: windows\n").concat(bo,"\n"),Vo="".concat(_o,"\nlogsource:\n    category: create_stream_hash\n    product: windows\n").concat(bo,"\n"),Uo="".concat(_o,"\nlogsource:\n    category: dns_query\n    product: windows\n").concat(bo,"\n"),Yo="".concat(_o,"\nlogsource:\n    category: driver_load\n    product: windows\n").concat(bo,"\n"),Wo="".concat(_o,"\nlogsource:\n    category: file_change\n    product: windows\n").concat(bo,"\n"),Bo="".concat(_o,"\nlogsource:\n    category: file_delete\n    product: windows\n").concat(bo,"\n"),Jo="".concat(_o,"\nlogsource:\n    category: file_event\n    product: windows\n").concat(bo,"\n"),Zo="".concat(_o,"\nlogsource:\n    category: image_load\n    product: windows\n").concat(bo,"\n"),Ko="".concat(_o,"\nlogsource:\n    category: network_connection\n    product: windows\n").concat(bo,"\n"),Xo="".concat(_o,"\nlogsource:\n    category: pipe_created\n    product: windows\n").concat(bo,"\n"),tc="".concat(_o,"\nlogsource:\n    category: process_access\n    product: windows\n").concat(bo,"\n"),ec="".concat(_o,"\nlogsource:\n    category: process_creation\n    product: windows\n").concat(bo,"\n"),sc="".concat(_o,"\nlogsource:\n    category: process_tampering\n    product: windows\n").concat(bo,"\n"),ic="".concat(_o,"\nlogsource:\n    category: process_termination\n    product: windows\n").concat(bo,"\n"),ac="".concat(_o,"\nlogsource:\n    category: ps_classic_provider_start\n    product: windows\n").concat(bo,"\n"),nc="".concat(_o,"\nlogsource:\n    category: ps_classic_script\n    product: windows\n").concat(bo,"\n"),rc="".concat(_o,"\nlogsource:\n    category: ps_classic_start\n    product: windows\n").concat(bo,"\n"),oc="".concat(_o,"\nlogsource:\n    category: ps_module\n    product: windows\n").concat(bo,"\n"),cc="".concat(_o,"\nlogsource:\n    category: ps_script\n    product: windows\n").concat(bo,"\n"),lc="".concat(_o,"\nlogsource:\n    category: raw_access_thread\n    product: windows\n").concat(bo,"\n"),uc="".concat(_o,"\nlogsource:\n    category: registry_add\n    product: windows\n").concat(bo,"\n"),dc="".concat(_o,"\nlogsource:\n    category: registry_delete\n    product: windows\n").concat(bo,"\n"),hc="".concat(_o,"\nlogsource:\n    category: registry_event\n    product: windows\n").concat(bo,"\n"),pc="".concat(_o,"\nlogsource:\n    category: registry_rename\n    product: windows\n").concat(bo,"\n"),mc="".concat(_o,"\nlogsource:\n    category: registry_set\n    product: windows\n").concat(bo,"\n"),fc="".concat(_o,"\nlogsource:\n    category: sysmon_error\n    product: windows\n").concat(bo,"\n"),vc="".concat(_o,"\nlogsource:\n    category: sysmon_status\n    product: windows\n").concat(bo,"\n"),gc="".concat(_o,"\nlogsource:\n    category: wmi_event\n    product: windows\n").concat(bo,"\n"),yc="".concat(_o,"\nlogsource:\n    service: application\n    product: windows\n").concat(bo,"\n"),_c="".concat(_o,"\nlogsource:\n    service: applocker\n    product: windows\n").concat(bo,"\n"),bc="".concat(_o,"\nlogsource:\n    service: bits-client\n    product: windows\n").concat(bo,"\n"),Cc="".concat(_o,"\nlogsource:\n    service: codeintegrity-operational\n    product: windows\n").concat(bo,"\n"),wc="".concat(_o,"\nlogsource:\n    service: dhcp\n    product: windows\n").concat(bo,"\n"),kc="".concat(_o,"\nlogsource:\n    service:  dns-server\n    product: windows\n").concat(bo,"\n"),Sc="".concat(_o,"\nlogsource:\n    service: driver-framework\n    product: windows\n").concat(bo,"\n"),xc="".concat(_o,"\nlogsource:\n    service: firewall-as\n    product: windows\n").concat(bo,"\n"),Tc="".concat(_o,"\nlogsource:\n    service:  ldap_debug\n    product: windows\n").concat(bo,"\n"),Ac="".concat(_o,"\nlogsource:\n    service: microsoft-servicebus-client\n    product: windows\n").concat(bo,"\n"),Oc="".concat(_o,"\nlogsource:\n    service: msexchange-management\n    product: windows\n").concat(bo,"\n"),Dc="".concat(_o,"\nlogsource:\n    service: ntlm\n    product: windows\n").concat(bo,"\n"),Ec="".concat(_o,"\nlogsource:\n    service: powershell\n    product: windows\n").concat(bo,"\n"),$c="".concat(_o,"\nlogsource:\n    service: powershell-classic\n    product: windows\n").concat(bo,"\n"),Fc="".concat(_o,"\nlogsource:\n    service: printservice-admin\n    product: windows\n").concat(bo,"\n"),Nc="".concat(_o,"\nlogsource:\n    service: printservice-operational\n    product: windows\n").concat(bo,"\n"),Ic="".concat(_o,"\nlogsource:\n    service: security\n    product: windows\n").concat(bo,"\n"),Mc="".concat(_o,"\nlogsource:\n    service: security-mitigations\n    product: windows\n").concat(bo,"\n"),Pc="".concat(_o,"\nlogsource:\n    service: smbclient-security\n    product: windows\n").concat(bo,"\n"),Lc="".concat(_o,"\nlogsource:\n    service: sysmon\n    product: windows\n").concat(bo,"\n"),jc="".concat(_o,"\nlogsource:\n    service: system\n    product: windows\n").concat(bo,"\n"),Rc="".concat(_o,"\nlogsource:\n    service: taskscheduler\n    product: windows\n").concat(bo,"\n"),zc="".concat(_o,"\nlogsource:\n    service: terminalservices\n    product: windows\n").concat(bo,"\n"),Qc="".concat(_o,"\nlogsource:\n    service: windefend\n    product: windows\n").concat(bo,"\n"),Hc="".concat(_o,"\nlogsource:\n    service: wmi\n    product: windows\n").concat(bo,"\n"),Gc=[{os:"Cloud: AWS",text:Co},{os:"Cloud: Azure_activitylogs",text:wo},{os:"Cloud: Azure_signinlogs",text:ko},{os:"Cloud: GCP Audit logs",text:So},{os:"Cloud: GWorkspace",text:xo},{os:"Cloud: Microsoft 365",text:To},{os:"Cloud: Okta",text:Ao},{os:"Linux: File create",text:Oo},{os:"Linux: Network connection",text:Do},{os:"Linux: Process creation",text:Eo},{os:"Linux: Any logs",text:$o},{os:"Linux: AuditD",text:Fo},{os:"Linux: ClamAV",text:No},{os:"Linux: CRON",text:Io},{os:"Linux: Guacamole",text:Mo},{os:"Linux: Modseurity",text:Po},{os:"Linux: sudo",text:Lo},{os:"Linux: sshd",text:jo},{os:"Linux: syslog",text:Ro},{os:"Linux: VSFTPD",text:zo},{os:"MacOS: file_event",text:Qo},{os:"MacOS: process_creation",text:Ho},{os:"Windows: clipboard_capture",text:Go},{os:"Windows: create_remote_thread",text:qo},{os:"Windows: create_stream_hash",text:Vo},{os:"Windows: dns_query",text:Uo},{os:"Windows: driver_load",text:Yo},{os:"Windows: file_change",text:Wo},{os:"Windows: file_delete",text:Bo},{os:"Windows: file_event",text:Jo},{os:"Windows: image_load",text:Zo},{os:"Windows: network_connection",text:Ko},{os:"Windows: pipe_created",text:Xo},{os:"Windows: process_access",text:tc},{os:"Windows: process_creation",text:ec},{os:"Windows: process_tampering",text:sc},{os:"Windows: process_termination",text:ic},{os:"Windows: ps_classic_provider_start",text:ac},{os:"Windows: ps_classic_script",text:nc},{os:"Windows: ps_classic_start",text:rc},{os:"Windows: ps_module",text:oc},{os:"Windows: ps_script",text:cc},{os:"Windows: raw_access_thread",text:lc},{os:"Windows: registry_add",text:uc},{os:"Windows: registry_delete",text:dc},{os:"Windows: registry_event",text:hc},{os:"Windows: registry_rename",text:pc},{os:"Windows: registry_set",text:mc},{os:"Windows: sysmon_error",text:fc},{os:"Windows: sysmon_status",text:vc},{os:"Windows: wmi_event",text:gc},{os:"Windows: application",text:yc},{os:"Windows: applocker",text:_c},{os:"Windows: bits-client",text:bc},{os:"Windows: codeintegrity-operational",text:Cc},{os:"Windows: dhcp",text:wc},{os:"Windows: dns-server",text:kc},{os:"Windows: driver-framework",text:Sc},{os:"Windows: firewall-as",text:xc},{os:"Windows: ldap_debug",text:Tc},{os:"Windows: microsoft-servicebus-client",text:Ac},{os:"Windows: msexchange-management",text:Oc},{os:"Windows: ntlm",text:Dc},{os:"Windows: powershell",text:Ec},{os:"Windows: powershell-classic",text:$c},{os:"Windows: printservice-admin",text:Fc},{os:"Windows: printservice-operational",text:Nc},{os:"Windows: security",text:Ic},{os:"Windows: security-mitigations",text:Mc},{os:"Windows: smbclient-security",text:Pc},{os:"Windows: sysmon",text:Lc},{os:"Windows: system",text:jc},{os:"Windows: taskscheduler",text:Rc},{os:"Windows: terminalservices",text:zc},{os:"Windows: windefend",text:Qc},{os:"Windows: wmi",text:Hc}],qc={components:{ExplorePreview:Hr},data:function(){return{currentPage:1,ascending:!1,sortColumn:"",perPage:10,editingRule:{},showEditModal:!1,save_button_text:"Update",sketchTags:[],sketchTTP:[],SigmaTemplates:Gc,text:"",parsed:"",problemString:"Ok"}},computed:{sigmaRuleList:function(){return this.$store.state.sigmaRuleList},sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},mounted:function(){this.loadSketchSigmaTags(),this.loadSketchTTP()},methods:{parseSigma:_.debounce((function(t){var e=this;this.problemString="",w.getSigmaRuleByText(t).then((function(t){e.parsed=t.data.objects[0],e.problemString="OK"})).catch((function(t){e.problemString=t.response.data.message,e.parsed["search_query"]="PLEASE ADJUST RULE",y["a"].open({message:e.problemString,type:"is-danger",position:"is-top",indefinite:!1})}))}),300),addOrUpdateRule:function(t){var e=this;"Create"===this.save_button_text&&w.createSigmaRule(this.editingRule.rule_yaml).then((function(t){e.$buefy.notification.open({message:"Succesfully added Sigma rule!",type:"is-success"}),e.showEditModal=!1,e.sigmaRuleList.push(t.data.objects[0])})).catch((function(t){e.problemString=e.problemString=t.response.data.message,y["a"].open({message:e.problemString,type:"is-danger",position:"is-top",indefinite:!1})})),"Update"===this.save_button_text&&w.updateSigmaRule(this.editingRule.id,this.editingRule.rule_yaml).then((function(t){e.$store.state.sigmaRuleList=e.sigmaRuleList.filter((function(t){return t.rule_uuid!==e.editingRule.rule_uuid})),e.sigmaRuleList.push(t.data.objects[0]),e.$buefy.notification.open({message:"Succesfully modified Sigma rule!",type:"is-success"}),e.showEditModal=!1})).catch((function(t){}))},composeRule:function(){this.showEditModal=!0,this.create_new_rule=!0,this.save_button_text="Create",this.editingRule={rule_yaml:this.text}},startRuleEdit:function(t){null===t&&console.log("No rule given, maybe you wanna add one?"),this.save_button_text="Update",this.showEditModal=!0,this.editingRule=t},deleteRule:function(t){var e=this;confirm("Delete Rule?")&&w.deleteSigmaRule(t.rule_uuid).then((function(s){e.$store.state.sigmaRuleList=e.sigmaRuleList.filter((function(e){return e.rule_uuid!==t.rule_uuid}))})).catch((function(t){console.error(t)}))},generateOpenSearchQuery:function(t,e){var s='"'.concat(t,'"');return s=s.replace(/[\\\s]/g,"\\$&"),void 0!==e&&(s="".concat(e,": ").concat(s)),{q:s}},loadSketchSigmaTags:function(){var t=this;w.runAggregator(this.sketch.id,{aggregator_name:"field_bucket",aggregator_parameters:{field:"ts_sigma_rule"}}).then((function(e){t.sketchTags=e.data.objects[0].field_bucket.buckets}))},loadSketchTTP:function(){var t=this;w.runAggregator(this.sketch.id,{aggregator_name:"field_bucket",aggregator_parameters:{field:"ts_ttp"}}).then((function(e){t.sketchTTP=e.data.objects[0].field_bucket.buckets}))},getColorFromStatus:function(t){return"false"===t?"red":"green"},getRuleByUUID:function(t){if(Array.isArray(this.$store.state.sigmaRuleList)){var e=this.$store.state.sigmaRuleList.filter((function(e){return e.rule_uuid===t}));return{result:e}}return{result:[{rule_uuid:t}]}}}},Vc=qc,Uc=(s("aa1d"),Object(c["a"])(Vc,vo,go,!1,null,"fb1c29e0",null)),Yc=Uc.exports,Wc={props:["sketchId"],components:{TsSigmaList:Yc},computed:{sketch:function(){return this.$store.state.sketch}}},Bc=Wc,Jc=Object(c["a"])(Bc,mo,fo,!1,null,null,null),Zc=Jc.exports;i["default"].use(d["a"]);var Kc=[{name:"Home",path:"/",component:L},{path:"/sketch/:sketchId",component:G,props:!0,children:[{path:"",name:"Overview",component:ye},{path:"sigma",component:po,props:!0,children:[{path:"",name:"SigmaOverview",component:Zc,props:!0}]},{path:"explore",name:"Explore",component:Ai,props:!0},{path:"graph",component:Fi,props:!0,children:[{path:"",name:"GraphOverview",component:qi},{path:"explore",name:"GraphExplore",component:pa,props:!0}]},{path:"aggregate",name:"Aggregate",component:An,props:!0},{path:"analyzers",name:"Analyze",component:Rn,props:!0},{path:"story",component:qn,props:!0,children:[{path:"",name:"StoryOverview",component:sr},{path:":storyId",name:"StoryContent",component:Or,props:!0}]},{path:"attributes",name:"Attributes",component:Ir,props:!0},{path:"intelligence",name:"Intelligence",component:eo,props:!0},{path:"savedsearches",name:"SavedSearches",component:oo,props:!0}]}],Xc=new d["a"]({mode:"history",base:"/legacy/",routes:Kc}),tl=s("2f62");i["default"].use(tl["a"]);var el=function(t){return{sketch:{},meta:{},searchHistory:{},tags:[],dataTypes:[],count:0,currentSearchNode:null,currentUser:t}},sl=el(),il=new tl["a"].Store({state:sl,mutations:{SET_SKETCH:function(t,e){i["default"].set(t,"sketch",e.objects[0]),i["default"].set(t,"meta",e.meta)},SET_SEARCH_HISTORY:function(t,e){i["default"].set(t,"searchHistory",e.objects)},SET_TIMELINE_TAGS:function(t,e){var s=e.objects[0]["field_bucket"]["buckets"];i["default"].set(t,"tags",s)},SET_DATA_TYPES:function(t,e){var s=e.objects[0]["field_bucket"]["buckets"];i["default"].set(t,"dataTypes",s)},SET_COUNT:function(t,e){i["default"].set(t,"count",e)},SET_SEARCH_NODE:function(t,e){i["default"].set(t,"currentSearchNode",e)},SET_SIGMARULE_LIST:function(t,e){i["default"].set(t,"sigmaRuleList",e["objects"]),i["default"].set(t,"sigmaRuleList_count",e["meta"]["rules_count"])},RESET_STATE:function(t,e){w.getLoggedInUser().then((function(e){var s=e.data.objects[0].username;Object.assign(t,el(s))}))}},actions:{updateSketch:function(t,e){return w.getSketch(e).then((function(s){t.commit("SET_SKETCH",s.data),t.dispatch("updateTimelineTags",e),t.dispatch("updateDataTypes",e)})).catch((function(t){}))},updateCount:function(t,e){return w.countSketchEvents(e).then((function(e){t.commit("SET_COUNT",e.data.meta.count)})).catch((function(t){}))},resetState:function(t){t.commit("RESET_STATE")},updateSearchNode:function(t,e){t.commit("SET_SEARCH_NODE",e)},updateSearchHistory:function(t,e){return e||(e=t.state.sketch.id),w.getSearchHistory(e).then((function(e){t.commit("SET_SEARCH_HISTORY",e.data)})).catch((function(t){}))},updateTimelineTags:function(t,e){if(t.state.sketch.active_timelines.length){var s={aggregator_name:"field_bucket",aggregator_parameters:{field:"tag",limit:"1000"}};return w.runAggregator(e,s).then((function(e){t.commit("SET_TIMELINE_TAGS",e.data)})).catch((function(t){}))}},updateDataTypes:function(t,e){if(t.state.sketch.active_timelines.length){var s={aggregator_name:"field_bucket",aggregator_parameters:{field:"data_type",limit:"1000"}};return w.runAggregator(e,s).then((function(e){t.commit("SET_DATA_TYPES",e.data)})).catch((function(t){}))}},updateSigmaList:function(t){w.getSigmaRuleList().then((function(e){t.commit("SET_SIGMARULE_LIST",e.data)})).catch((function(t){}))}}}),al=s("289d"),nl=s("f13c"),rl=s.n(nl),ol=s("8e5f"),cl=s.n(ol),ll=s("3a6f"),ul=s.n(ll),dl=s("4eb5"),hl=s.n(dl),pl=s("ecee"),ml=s("c074"),fl=s("ad3d");pl["c"].add(ml["f"],ml["e"],ml["g"],ml["i"],ml["a"],ml["b"],ml["d"],ml["c"],ml["h"]),s("b383"),s("2d27"),s("56eb");var vl=new i["default"],gl=e["default"]=vl;i["default"].use(s("2ead")),i["default"].use(ul.a),i["default"].use(hl.a),i["default"].use(al["a"],{defaultIconComponent:"font-awesome-icon",defaultIconPack:"fas"}),i["default"].use(rl.a),i["default"].component("multiselect",cl.a),i["default"].component("font-awesome-icon",fl["a"]),i["default"].config.productionTip=!1,new i["default"]({router:Xc,store:il,render:function(t){return t(u)}}).$mount("#app")},"56eb":function(t,e,s){"use strict";s.r(e);s("7f7f"),s("ac6a");var i=s("2b0e"),a=s("6dde");a.keys().forEach((function(t){var e=a(t);i["default"].filter(e.default.name,e.default.filter)}))},"6b1a":function(t,e,s){},"6db3":function(t,e,s){"use strict";s("953f")},"6dde":function(t,e,s){var i={"./Capitalize.js":"76f9","./CompactBytes.js":"3d1d","./CompactNumber.js":"d3b7","./FilterChip.js":"05a2","./FormatTimestamp.js":"09ff"};function a(t){var e=n(t);return s(e)}function n(t){if(!s.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}a.keys=function(){return Object.keys(i)},a.resolve=n,t.exports=a,a.id="6dde"},"6fed":function(t,e,s){},7295:function(t,e,s){"use strict";s("76fd")},7388:function(t,e,s){},"75a6":function(t,e,s){var i={"./AppNavbarMain.vue":"f7e3","./AppNavbarSecondary.vue":"c5cc"};function a(t){var e=n(t);return s(e)}function n(t){if(!s.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}a.keys=function(){return Object.keys(i)},a.resolve=n,t.exports=a,a.id="75a6"},"76f9":function(t,e,s){"use strict";s.r(e);s("6b54");e["default"]={name:"capitalize",filter:function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""}}},"76fd":function(t,e,s){},"7bad":function(t,e,s){"use strict";s("c2dd")},"7bd1":function(t,e,s){"use strict";s("d02a")},"7ef1":function(t,e,s){"use strict";s("6b1a")},"7f02":function(t,e,s){},"85ed":function(t,e,s){},8855:function(t,e,s){"use strict";s("103a")},"953f":function(t,e,s){},9615:function(t,e,s){},"966b":function(t,e,s){"use strict";s("9e94")},"978d":function(t,e,s){},"9a90":function(t,e,s){"use strict";s("c0bf")},"9e94":function(t,e,s){},aa1d:function(t,e,s){"use strict";s("3ce4")},b383:function(t,e,s){},b5b3:function(t,e,s){"use strict";s("df3b")},bee2:function(t,e,s){},c0bf:function(t,e,s){},c2b8:function(t,e,s){},c2dd:function(t,e,s){},c5cc:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("section",{staticClass:"section",staticStyle:{"background-color":"var(--navbar-background)",padding:"0","border-bottom":"1px solid var(--navbar-border-color)"}},[e("div",{staticClass:"container is-fluid",staticStyle:{"padding-bottom":"0"}},[e("nav",{staticClass:"navbar",attrs:{role:"navigation","aria-label":"main navigation"}},["sketch"===t.currentAppContext?e("div",{staticClass:"navbar-item"},[t.activeTimelines.length?e("div",{staticClass:"tabs is-left"},[e("ul",[e("li",{class:{"is-active":"overview"===t.currentPage}},[e("router-link",{attrs:{to:{name:"Overview"}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-cubes",attrs:{"aria-hidden":"true"}})]),e("span",[t._v("Overview")])])],1),e("li",{class:{"is-active":"explore"===t.currentPage}},[e("router-link",{attrs:{to:{name:"Explore"},"data-explore-element":"true"}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-search",attrs:{"data-explore-element":"true","aria-hidden":"true"}})]),e("span",{attrs:{"data-explore-element":"true"}},[t._v("Explore")])])],1),e("li",{class:{"is-active":"graph"===t.currentPage}},[e("router-link",{attrs:{to:{name:"GraphOverview"}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-project-diagram",attrs:{"aria-hidden":"true"}})]),e("span",[t._v("Graph")])])],1),e("li",{class:{"is-active":"aggregate"===t.currentPage}},[e("router-link",{attrs:{to:{name:"Aggregate"}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-chart-bar",attrs:{"aria-hidden":"true"}})]),e("span",[t._v("Aggregate")])])],1),e("li",{class:{"is-active":"analyzers"===t.currentPage}},[e("router-link",{attrs:{to:{name:"Analyze"}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-magic",attrs:{"aria-hidden":"true"}})]),e("span",[t._v("Analyze")])])],1),e("li",{class:{"is-active":"stories"===t.currentPage}},[e("router-link",{attrs:{to:{name:"StoryOverview"}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-book",attrs:{"aria-hidden":"true"}})]),e("span",[t._v("Stories")])])],1),e("li",{class:{"is-active":"sigma"===t.currentPage}},[e("router-link",{attrs:{to:{name:"SigmaOverview"}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-file-signature",attrs:{"aria-hidden":"true"}})]),e("span",[t._v("Sigma")])])],1),t.meta?e("li",{class:{"is-active":"attributes"===t.currentPage}},[e("router-link",{attrs:{to:{name:"Attributes"}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-table",attrs:{"aria-hidden":"true"}})]),e("span",[t._v("Attributes\n                  "),e("span",{staticClass:"tag is-small",staticStyle:{"background-color":"var(--tag-background-color)",color:"var(--tag-font-color)"}},[t._v(t._s(t.attributeCount))])])])],1):t._e(),e("li",{class:{"is-active":"intelligence"===t.currentPage}},[e("router-link",{attrs:{to:{name:"Intelligence"}}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fas fa-brain",attrs:{"aria-hidden":"true"}})]),e("span",[t._v("Intelligence\n                  "),e("span",{staticClass:"tag is-small",staticStyle:{"background-color":"var(--tag-background-color)",color:"var(--tag-font-color)"}},[t._v(t._s(t.intelligenceCount))])])])],1)])]):t._e()]):t._e(),e("div",{staticClass:"navbar-end"},[e("div",{staticClass:"navbar-item"},[t._t("default")],2)])])])])},a=[],n=(s("ffc1"),s("ac6a"),s("8615"),{name:"ts-navbar-secondary",props:{currentAppContext:String,currentPage:String},methods:{hasAttributeOntology:function(t){return Object.values(this.meta.attributes).some((function(e){return e.ontology===t}))}},computed:{meta:function(){return this.$store.state.meta},activeTimelines:function(){return this.$store.state.sketch.active_timelines},attributeCount:function(){return Object.entries(this.meta.attributes).length},intelligenceCount:function(){return"intelligence"in this.meta.attributes&&"data"in this.meta.attributes.intelligence.value?this.meta.attributes.intelligence.value.data.length:0}}}),r=n,o=(s("7bd1"),s("2877")),c=Object(o["a"])(r,i,a,!1,null,"d5d3ad74",null);e["default"]=c.exports},cb41:function(t,e,s){},d02a:function(t,e,s){},d2aa:function(t,e,s){"use strict";s("6fed")},d3b7:function(t,e,s){"use strict";s.r(e),e["default"]={name:"compactNumber",filter:function(t){t||(t=0);var e="";if(t>999999999)t=Math.round(t/1e9*10)/10,e="B";else if(t>999999)t=Math.round(t/1e6*10)/10,e="M";else{if(!(t>999))return t;t=Math.round(t/1e3*10)/10,e="K"}return t+e}}},d538:function(t,e,s){"use strict";s("4fcc")},dc39:function(t,e,s){"use strict";s("9615")},df3b:function(t,e,s){},e8df:function(t,e,s){"use strict";s("85ed")},f3d2:function(t,e,s){"use strict";s("2cd0")},f7e3:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("section",{staticClass:"section",staticStyle:{"background-color":"var(--navbar-background)",padding:"0","border-bottom":"1px solid var(--navbar-border-color)"}},[e("div",{staticClass:"container is-fluid"},[e("nav",{staticClass:"navbar",attrs:{role:"navigation","aria-label":"main navigation"}},[e("div",{staticClass:"navbar-brand"},[e("router-link",{staticClass:"navbar-item",attrs:{to:"/"}},[e("div",{staticClass:"logo",staticStyle:{"margin-top":"7px"}},[e("img",{attrs:{src:"/dist/timesketch-color.png"}})]),e("span",{staticStyle:{color:"var(--default-title-font-color)","margin-left":"7px","margin-top":"1px","font-size":"var(--font-size-title)"}},[t._v("time"),e("b",[t._v("sketch")])])])],1),e("div",{staticClass:"navbar-item",staticStyle:{"margin-left":"20px","margin-top":"5px","font-size":"var(--font-size-large)"}},[t._t("left")],2),e("div",{staticClass:"navbar-item navbar-center"},[t._t("center")],2),e("div",{staticClass:"navbar-end",staticStyle:{"margin-right":"-10px"}},[e("div",{staticClass:"navbar-item"},[e("b-switch",{attrs:{size:"is-small","passive-type":"is-dark",type:"is-dark"},on:{input:t.switchTheme},model:{value:t.isDarkTheme,callback:function(e){t.isDarkTheme=e},expression:"isDarkTheme"}},[t._v("\n            Dark Mode\n          ")])],1),e("div",{staticClass:"navbar-item"},[t._v("\n          "+t._s(t.currentUser)+"\n        ")]),t._m(0)])])])])},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"navbar-item"},[e("a",{attrs:{href:"/logout"}},[t._v("Logout")])])}],n=s("56d7"),r={name:"ts-navbar-main",data:function(){return{isDarkTheme:null}},computed:{currentUser:function(){return this.$store.state.currentUser}},methods:{switchTheme:function(){var t=document.body;switch(t.dataset.theme){case"light":t.dataset.theme="dark",localStorage.theme="dark",this.isDarkTheme=!0,n["default"].$emit("isDarkTheme",!0);break;case"dark":t.dataset.theme="light",localStorage.theme="light",this.isDarkTheme=!1,n["default"].$emit("isDarkTheme",!1);break}}},created:function(){this.isDarkTheme="dark"===localStorage.theme}},o=r,c=(s("4bf5"),s("2877")),l=Object(c["a"])(o,i,a,!1,null,"6161c97c",null);e["default"]=l.exports},fdeb:function(t,e,s){}}]);
//# sourceMappingURL=chunk-common.d12c964e.js.map