(function(){var t={4311:function(t,e,i){"use strict";i.r(e);i(9868);e["default"]={name:"compactBytes",filter:function(t){t||(t=0);var e=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.min(Math.floor(Math.log(t)/Math.log(1e3)),e.length-1),n=1*(t/Math.pow(1e3,i)).toFixed(2);return n+e[i]}}},12259:function(t,e,i){"use strict";i.r(e),e["default"]={name:"formatSeconds",filter:function(t){return t>60?t/60+"m":t+"s"}}},21761:function(t,e,i){"use strict";i.r(e);i(34782),i(26099),i(38781);e["default"]={name:"capitalize",filter:function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""}}},23340:function(t,e,i){"use strict";i.r(e);var n=i(91101);e["default"]={name:"toISO8601",filter:function(t){return t<0?"No timestamp":(0,n.A)(t).toISOString()}}},24590:function(t,e,i){"use strict";i.r(e);i(2008),i(62010),i(18111),i(22489),i(7588),i(26099),i(23500),i(62953);var n=i(85471),s=i(59724);s.keys().forEach(function(t){var e=s(t);n["default"].filter(e.default.name,e.default.filter)})},27843:function(t,e,i){"use strict";i.r(e),e["default"]={name:"filterChip",filter:function(t){return"label"===t.type?"__ts_star"===t.value?"Starred":"__ts_comment"===t.value?"Commented":t.value:t.field+":"+t.value}}},33240:function(t,e,i){"use strict";i.r(e)},41649:function(t,e,i){"use strict";i.r(e);i(26099),i(38781);e["default"]={name:"initialLetter",filter:function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()):""}}},48540:function(t,e,i){"use strict";i.r(e)},59724:function(t,e,i){var n={"./Capitalize.js":21761,"./CompactBytes.js":4311,"./CompactNumber.js":69595,"./FilterChip.js":27843,"./FormatLabelText.js":92975,"./FormatSeconds.js":12259,"./FormatTimestamp.js":60550,"./Initital.js":41649,"./ToISO8601.js":23340,"./shortDateTime.js":93176,"./timeSince.js":83710};function s(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}s.keys=function(){return Object.keys(n)},s.resolve=a,t.exports=s,s.id=59724},60550:function(t,e,i){"use strict";i.r(e);i(32637),i(26099),i(38781);e["default"]={name:"formatTimestamp",filter:function(t){if("number"===typeof t&&!Number.isInteger(t))return Math.round(1e3*t);var e=parseInt(t).toString().length;return 13===e?t:(15===e||16===e?t/=1e3:10===e&&(t*=1e3),parseInt(t))}}},63105:function(t,e,i){"use strict";i.r(e);i(62010),i(18111),i(7588),i(26099),i(23500),i(62953);var n=i(85471),s=i(73583);s.keys().forEach(function(t){var e=s(t),i=e.default.name;n["default"].component(i,e.default||e)})},69595:function(t,e,i){"use strict";i.r(e),e["default"]={name:"compactNumber",filter:function(t){t||(t=0);var e="";if(t>999999999)t=Math.round(t/1e9*10)/10,e="B";else if(t>999999)t=Math.round(t/1e6*10)/10,e="M";else{if(!(t>999))return t;t=Math.round(t/1e3*10)/10,e="K"}return t+e}}},73583:function(t){function e(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=function(){return[]},e.resolve=e,e.id=73583,t.exports=e},83710:function(t,e,i){"use strict";i.r(e);var n=i(91101);e["default"]={name:"timeSince",filter:function(t){return t?n.A.utc(t).fromNow():""}}},86545:function(t,e,i){"use strict";i(50517),i(82733),i(87902),i(28704);var n=i(85471),s=function(){var t=this,e=t._self._c;return e("v-app",{attrs:{id:"app"}},[e("v-snackbar",{attrs:{timeout:t.snackbar.timeout,color:t.snackbar.color,top:""},scopedSlots:t._u([{key:"action",fn:function(i){var n=i.attrs;return[e("v-btn",t._b({attrs:{text:""},on:{click:function(e){t.snackbar.active=!1}}},"v-btn",n,!1),[t._v(" Close ")])]}}]),model:{value:t.snackbar.active,callback:function(e){t.$set(t.snackbar,"active",e)},expression:"snackbar.active"}},[t._v(" "+t._s(t.snackbar.message)+" ")]),e("router-view")],1)},a=[],r=new n["default"],o=r,l={name:"app",data:function(){return{}},computed:{snackbar:function(){return this.$store.state.snackbar}},methods:{setErrorSnackBar:function(t){var e={message:t,color:"error",timeout:7e3};this.$store.dispatch("setSnackBar",e)},setWarningSnackBar:function(t){var e={message:t,color:"warning",timeout:5e3};this.$store.dispatch("setSnackBar",e)}},mounted:function(){o.$on("errorSnackBar",this.setErrorSnackBar),o.$on("warningSnackBar",this.setWarningSnackBar);var t=localStorage.getItem("isDarkTheme");t&&(this.$vuetify.theme.dark="true"===t);var e=document.body;e.dataset.theme=this.$vuetify.theme.dark?"dark":"light"},beforeDestroy:function(){o.$off("errorSnackBar"),o.$off("warningSnackBar")}},c=l,u=i(81656),d=(0,u.A)(c,s,a,!1,null,null,null),h=d.exports,m=i(40173),v=(i(62010),function(){var t=this,e=t._self._c;return e("div",[e("v-toolbar",{attrs:{flat:"",color:"transparent"}},[e("v-avatar",{staticClass:"mt-2 ml-n3"},[e("router-link",{attrs:{to:"/"}},[e("v-img",{attrs:{src:"/dist/timesketch-color.png","max-height":"25","max-width":"25",contain:""}})],1)],1),e("span",{staticStyle:{"font-size":"1.2em"}},[t._v("timesketch")]),e("v-spacer"),e("v-avatar",{staticClass:"ml-3",attrs:{color:"grey lighten-1",size:"25"}},[e("span",{staticClass:"white--text"},[t._v(t._s(t._f("initialLetter")(t.currentUser)))])]),e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-avatar",[e("v-btn",t._g(t._b({attrs:{small:"",icon:""}},"v-btn",s,!1),n),[e("v-icon",{attrs:{title:"Timesketch Options"}},[t._v("mdi-dots-vertical")])],1)],1)]}}])},[e("v-card",[e("v-list",[e("v-list-item-group",{attrs:{color:"primary"}},[e("v-list-item",{on:{click:t.toggleTheme}},[e("v-list-item-icon",[e("v-icon",[t._v("mdi-brightness-6")])],1),e("v-list-item-content",[e("v-list-item-title",[t._v("Toggle theme")])],1)],1),e("v-list-item",{on:{click:t.switchUI}},[e("v-list-item-icon",[e("v-icon",[t._v("mdi-view-dashboard-outline")])],1),e("v-list-item-content",[e("v-list-item-title",[t._v("Use the old UI")])],1)],1),e("v-list-item",{on:{click:function(e){t.showSettingsDialog=!0}}},[e("v-list-item-icon",[e("v-icon",[t._v("mdi-cog-outline")])],1),e("v-list-item-content",[e("v-list-item-title",[t._v("Settings")])],1)],1),e("a",{staticStyle:{"text-decoration":"none",color:"inherit"},attrs:{href:"/logout/"}},[e("v-list-item",[e("v-list-item-icon",[e("v-icon",[t._v("mdi-logout")])],1),e("v-list-item-content",[e("v-list-item-title",[t._v("Logout")])],1)],1)],1)],1)],1)],1)],1)],1),e("v-main",{staticClass:"notransition"},[e("v-container",{attrs:{fluid:"","pa-0":""}},[e("v-sheet",{staticClass:"pa-5",attrs:{color:t.$vuetify.theme.dark?"grey darken-4":"grey lighten-3","min-height":"200"}},[e("h2",[t._v("Start new investigation")]),e("v-row",{staticClass:"mt-5",attrs:{"no-gutters":""}},[e("v-dialog",{attrs:{width:"500"},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({staticClass:"mr-5",attrs:{depressed:"",small:"",color:"primary"}},"v-btn",s,!1),n),[t._v(" Blank sketch ")])]}}]),model:{value:t.createSketchDialog,callback:function(e){t.createSketchDialog=e},expression:"createSketchDialog"}},[e("v-card",{staticClass:"pa-4"},[e("h3",[t._v("New sketch")]),e("br"),e("v-form",{on:{submit:function(e){return e.preventDefault(),t.createSketch()}}},[e("v-text-field",{attrs:{outlined:"",dense:"",placeholder:"Name your sketch",autofocus:"",clearable:"",rules:t.sketchNameRules},model:{value:t.sketchForm.name,callback:function(e){t.$set(t.sketchForm,"name",e)},expression:"sketchForm.name"}}),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){t.createSketchDialog=!1}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{disabled:!t.sketchForm.name||t.sketchForm.name.length>255,color:"primary",text:""},on:{click:function(e){return t.createSketch()}}},[t._v(" Create ")])],1)],1)],1)],1)],1)],1),e("div",{staticClass:"pa-5"},[e("h2",[t._v("Your recent work")]),e("ts-sketch-list")],1)],1),e("v-dialog",{attrs:{width:"700px"},model:{value:t.showSettingsDialog,callback:function(e){t.showSettingsDialog=e},expression:"showSettingsDialog"}},[e("ts-settings-dialog")],1)],1)],1)}),p=[],f=(i(44114),i(26099),i(38781),i(52675),i(89463),i(74423),i(33110),i(21699),i(27906)),g=f.A.create({baseURL:"/api/v1",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}}),y=f.A.create({baseURL:"/api/v1",responseType:"blob",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}});g.interceptors.response.use(function(t){return t},function(t){var e=t.response?t.response.status:null,i=t.config&&t.config.url?t.config.url:"",n=t.response&&t.response.data?t.response.data.message||t.response.data:"Unknown error";return i.includes("/llm/")?(o.$emit("warningSnackBar",n),Promise.reject(t)):(500===e?o.$emit("errorSnackBar","Server side error. Please contact your server administrator for troubleshooting."):o.$emit("errorSnackBar",n),Promise.reject(t))});var _={getSketchList:function(t,e,i,n){var s={params:{scope:t,page:e,per_page:i,search_query:n}};return g.get("/sketches/",s)},getSketch:function(t){return g.get("/sketches/"+t+"/")},createSketch:function(t){return g.post("/sketches/",t)},deleteSketch:function(t){return g.delete("/sketches/"+t+"/")},archiveSketch:function(t){var e={action:"archive"};return g.post("/sketches/"+t+"/archive/",e)},unArchiveSketch:function(t){var e={action:"unarchive"};return g.post("/sketches/"+t+"/archive/",e)},exportSketch:function(t){var e={action:"export"};return y.post("/sketches/"+t+"/archive/",e)},getSketchAttributes:function(t){return g.get("/sketches/"+t+"/attribute/")},addSketchAttribute:function(t,e,i,n){var s={name:e,values:[i],ontology:n,action:"post"};return g.post("/sketches/"+t+"/attribute/",s)},getSketchTimeline:function(t,e){return g.get("/sketches/"+t+"/timelines/"+e+"/")},getSketchTimelineAnalysis:function(t,e){return g.get("/sketches/"+t+"/timelines/"+e+"/analysis/")},getTimelineFields:function(t,e){return g.get("/sketches/"+t+"/timelines/"+e+"/fields/")},saveSketchTimeline:function(t,e,i,n,s){var a={name:i,description:n,color:s};return g.post("/sketches/"+t+"/timelines/"+e+"/",a)},saveSketchSummary:function(t,e,i){var n={name:e,description:i};return g.post("/sketches/"+t+"/",n)},deleteSketchTimeline:function(t,e){return g.delete("/sketches/"+t+"/timelines/"+e+"/")},createEvent:function(t,e,i,n,s,a){var r={date_string:e,message:i,timestamp_desc:n,attributes:s};return g.post("/sketches/"+t+"/event/create/",r,a)},getEvent:function(t,e,i,n){var s={params:{searchindex_id:e,event_id:i,include_processing_timelines:n}};return g.get("/sketches/"+t+"/event/",s)},countSketchEvents:function(t){return g.get("/sketches/"+t+"/count/")},saveEventAnnotation:function(t,e,i,n,s){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o={annotation:i,annotation_type:e,events:n,current_search_node_id:s?s.id:void 0,remove:a,conclusion_id:r};return g.post("/sketches/"+t+"/event/annotate/",o)},tagEvents:function(t,e,i){var n={tag_string:JSON.stringify(i),events:e,verbose:!1};return g.post("/sketches/"+t+"/event/tagging/",n)},untagEvents:function(t,e,i){var n={tags_to_remove:i,events:e};return g.post("/sketches/"+t+"/event/untag/",n)},updateEventAnnotation:function(t,e,i,n,s){var a={annotation:i,annotation_type:e,events:n,current_search_node_id:s.id};return g.put("/sketches/"+t+"/event/annotate/",a)},deleteEventAnnotation:function(t,e,i,n,s){var a={params:{annotation_id:i,annotation_type:e,event_id:n._id,searchindex_id:n._index,current_search_node_id:s.id}};return g.delete("/sketches/"+t+"/event/annotate/",a)},getStoryList:function(t){return g.get("sketches/"+t+"/stories/")},getStory:function(t,e){return g.get("/sketches/"+t+"/stories/"+e+"/")},createStory:function(t,e,i){var n={title:t,content:e};return g.post("/sketches/"+i+"/stories/",n)},updateStory:function(t,e,i,n){var s={title:t,content:e};return g.post("/sketches/"+i+"/stories/"+n+"/",s)},deleteStory:function(t,e){return g.delete("/sketches/"+t+"/stories/"+e+"/")},getView:function(t,e){return g.get("/sketches/"+t+"/views/"+e+"/")},createView:function(t,e,i,n){var s={name:e,query:i,filter:n,dsl:""};return g.post("/sketches/"+t+"/views/",s)},updateView:function(t,e,i,n){var s={query:i,filter:n};return g.post("/sketches/"+t+"/views/"+e+"/",s)},deleteView:function(t,e){return g.delete("/sketches/"+t+"/views/"+e+"/")},getSearchTemplates:function(){return g.get("/searchtemplates/")},parseSearchTemplate:function(t,e){return g.post("/searchtemplates/"+t+"/parse/",e)},search:function(t,e){return g.post("/sketches/"+t+"/explore/",e)},exportSearchResult:function(t,e){return y.post("/sketches/"+t+"/explore/",e)},getSearchHistory:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n={params:{}};return e&&(n.params.limit=e),i&&(n.params.question=i),g.get("/sketches/"+t+"/searchhistory/",n)},getSearchHistoryTree:function(t){return g.get("/sketches/"+t+"/searchhistorytree/")},getAggregations:function(t){return g.get("/sketches/"+t+"/aggregation/")},getAggregationById:function(t,e){return g.get("/sketches/"+t+"/aggregation/"+e+"/")},deleteAggregationById:function(t,e){return g.delete("/sketches/"+t+"/aggregation/"+e+"/")},getAggregationGroups:function(t){return g.get("/sketches/"+t+"/aggregation/group/")},runAggregator:function(t,e){return g.post("/sketches/"+t+"/aggregation/explore/",e)},runAggregatorGroup:function(t,e){return g.get("/sketches/"+t+"/aggregation/group/"+e+"/")},saveAggregation:function(t,e,i,n){var s={name:i,description:e.description,agg_type:e.name,chart_type:n["supported_charts"]||n["aggregator_parameters"]["chart_type"],parameters:n};return g.post("/sketches/"+t+"/aggregation/",s)},getUsers:function(){return g.get("/users/")},getGroups:function(){return g.get("/groups/")},grantSketchAccess:function(t,e,i){var n={users:e,groups:i};return g.post("/sketches/"+t+"/collaborators/",n)},revokeSketchAccess:function(t,e,i){var n={remove_users:e,remove_groups:i};return g.post("/sketches/"+t+"/collaborators/",n)},setSketchPublicAccess:function(t,e){var i={public:e};return g.post("/sketches/"+t+"/collaborators/",i)},getAnalyzers:function(t){return g.get("/sketches/"+t+"/analyzer/")},runAnalyzers:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s={timeline_ids:e,analyzer_names:i,analyzer_force_run:n};return g.post("/sketches/"+t+"/analyzer/",s)},getAnalyzerSession:function(t,e){return g.get("/sketches/"+t+"/analyzer/sessions/"+e+"/")},getActiveAnalyzerSessions:function(t){var e={params:{include_details:"true"}};return g.get("/sketches/"+t+"/analyzer/sessions/active/",e)},generateGraphFromPlugin:function(t,e,i,n,s){var a={plugin:e,config:{filter:{indices:i,timelineIds:n}},refresh:s};return n.length&&(a["timeline_ids"]=n),g.post("/sketches/"+t+"/graph/",a)},getGraphPluginList:function(){return g.get("/graphs/")},saveGraph:function(t,e,i){var n={name:e,elements:i};return g.post("/sketches/"+t+"/graphs/",n)},getSavedGraphList:function(t){return g.get("/sketches/"+t+"/graphs/")},getSavedGraph:function(t,e){var i={params:{format:"cytoscape"}};return g.get("/sketches/"+t+"/graphs/"+e+"/",i)},getSigmaRuleList:function(){return g.get("/sigmarules/")},getSigmaRuleResource:function(t){return g.get("/sigmarules/"+t+"/")},getSigmaRuleByText:function(t){var e={content:t};return g.post("/sigmarules/text/",e)},deleteSigmaRule:function(t){return g.delete("/sigmarules/"+t+"/")},createSigmaRule:function(t){var e={rule_yaml:t};return g.post("/sigmarules/",e)},updateSigmaRule:function(t,e){var i={id:t,rule_yaml:e};return g.put("/sigmarules/"+t+"/",i)},getScenarioTemplates:function(){return g.get("/scenarios/")},getSketchScenarios:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i={};return e&&(i.params={status:e}),g.get("/sketches/"+t+"/scenarios/",i)},addScenario:function(t,e,i){var n={scenario_id:e,display_name:i};return g.post("/sketches/"+t+"/scenarios/",n)},renameScenario:function(t,e,i){var n={scenario_name:i};return g.post("/sketches/"+t+"/scenarios/"+e+"/",n)},setScenarioStatus:function(t,e,i){var n={status:i};return g.post("/sketches/"+t+"/scenarios/"+e+"/status/",n)},getFacets:function(t,e){return g.get("/sketches/"+t+"/scenarios/"+e+"/facets/")},getQuestionTemplates:function(){return g.get("/questions/")},getOrphanQuestions:function(t){return g.get("/sketches/"+t+"/questions/")},getScenarioQuestions:function(t,e){return g.get("/sketches/"+t+"/scenarios/"+e+"/questions/")},getFacetQuestions:function(t,e,i){return g.get("/sketches/"+t+"/scenarios/"+e+"/facets/"+i+"/questions/")},getQuestion:function(t,e){return g.get("/sketches/"+t+"/questions/"+e+"/")},createQuestion:function(t,e,i,n,s){var a={scenario_id:e,facet_id:i,question_text:n,template_id:s};return g.post("/sketches/"+t+"/questions/",a)},createQuestionConclusion:function(t,e,i){var n={conclusionText:i};return g.post("/sketches/"+t+"/questions/"+e+"/conclusions/",n)},editQuestionConclusion:function(t,e,i,n){var s={conclusionText:n};return g.put("/sketches/"+t+"/questions/"+e+"/conclusions/"+i+"/",s)},deleteQuestionConclusion:function(t,e,i){return g.delete("/sketches/"+t+"/questions/"+e+"/conclusions/"+i+"/")},getTagMetadata:function(){return g.get("/intelligence/tagmetadata/")},uploadTimeline:function(t,e){return g.post("/upload/",t,e)},getSessions:function(t,e){return g.get("/sketches/"+t+"/explore/sessions/"+e+"/")},getLoggedInUser:function(){return g.get("/users/me/")},getContextLinkConfig:function(){return g.get("/contextlinks/")},getUnfurlGraph:function(t){var e={url:t};return g.post("/unfurl/",e)},getSystemSettings:function(){return g.get("/settings/")},getUserSettings:function(){return g.get("/users/me/settings/")},saveUserSettings:function(t){var e={settings:t};return g.post("/users/me/settings/",e)},llmRequest:function(t,e,i){return i=i||{},i.feature=e,g.post("/sketches/".concat(t,"/llm/"),i)}},b=(i(27495),i(5746),function(){var t=this,e=t._self._c;return e("div",[e("v-row",{staticClass:"mt-5",attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"9"}},[e("v-btn-toggle",{attrs:{dense:"",group:""},model:{value:t.toggleStateButton,callback:function(e){t.toggleStateButton=e},expression:"toggleStateButton"}},[e("v-btn",{staticStyle:{"border-radius":"6px"},on:{click:function(e){return t.switchScope("recent")}}},[t._v(" Recent ")]),e("v-btn",{staticStyle:{"border-radius":"6px"},on:{click:function(e){return t.switchScope("user")}}},[t._v(" My sketches ")]),e("v-btn",{staticStyle:{"border-radius":"6px"},on:{click:function(e){return t.switchScope("shared")}}},[t._v(" Shared with me ")]),e("v-btn",{staticStyle:{"border-radius":"6px"},on:{click:function(e){return t.switchScope("archived")}}},[t._v(" Archived ")])],1)],1),e("v-col",{attrs:{cols:"3"}},[e("v-text-field",{attrs:{outlined:"",flat:"",dense:"","hide-details":"","single-line":"",label:"Search","prepend-inner-icon":"mdi-magnify"},on:{change:t.search}})],1)],1),e("br"),e("v-data-table",{attrs:{headers:t.headers,items:t.sketches,"items-per-page":15,options:t.options,"server-items-length":t.numSketches,"footer-props":{"items-per-page-options":[15,30,40,50,100]},"disable-filtering":"","disable-sort":"",loading:t.loading},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.name",fn:function(i){var n=i.item;return[e("router-link",{staticStyle:{"text-decoration":"none"},attrs:{to:{name:"Overview",params:{sketchId:n.id}}}},[t._v(t._s(n.name))])]}},{key:"item.created_at",fn:function(i){var n=i.item;return[t._v(" "+t._s(t._f("shortDateTime")(n.created_at))+" "),e("small",[t._v("("+t._s(t._f("timeSince")(n.created_at))+")")])]}},{key:"item.last_activity",fn:function(e){var i=e.item;return[t._v(" "+t._s(t._f("timeSince")(i.last_activity))+" ")]}}])})],1)}),S=[],w={data:function(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Creator",value:"user"},{text:"Created at",value:"created_at"},{text:"Last active",value:"last_activity"}],sketches:[],numSketches:0,options:{},loading:!1,toggleStateButton:0,scope:"recent",searchQuery:null}},watch:{options:{handler:function(){this.getSketches()},deep:!0}},methods:{search:function(t){this.scope="search",this.searchQuery=t,this.getSketches()},switchScope:function(t){this.scope=t,this.getSketches()},getSketches:function(){var t=this;this.loading=!0,_.getSketchList(this.scope,this.options.page,this.options.itemsPerPage,this.searchQuery).then(function(e){t.sketches=e.data.objects,t.numSketches=e.data.meta.total_items,t.loading=!1}).catch(function(e){t.loading=!1,console.error(e)})}}},k=w,x=(0,u.A)(k,b,S,!1,null,"b903a6fe",null),T=x.exports,C=function(){var t=this,e=t._self._c;return e("v-card",{staticClass:"pa-4",attrs:{"min-height":"800px"}},[e("v-card-title",[t._v("Settings")]),t.settings?e("v-list",{staticClass:"px-3",attrs:{"two-line":"",subheader:"",flat:""}},[e("v-subheader",[t._v("Layout")]),e("v-list-item",[e("v-list-item-action",[e("v-switch",{attrs:{color:"primary"},on:{change:function(e){return t.saveSettings()}},model:{value:t.settings.showLeftPanel,callback:function(e){t.$set(t.settings,"showLeftPanel",e)},expression:"settings.showLeftPanel"}})],1),e("v-list-item-content",[e("v-list-item-title",[t._v("Show side panel")]),e("v-list-item-subtitle",[t._v("Select if the side panel should be expanded or collapsed by default")])],1)],1),e("v-list-item",[e("v-list-item-action",[e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("div",t._g(t._b({},"div",s,!1),t.isAnyFeatureAvailable?{}:n),[e("v-switch",{attrs:{color:"primary",disabled:!t.isAnyFeatureAvailable},on:{change:t.updateAiFeatures},model:{value:t.settings.aiPoweredFeaturesMain,callback:function(e){t.$set(t.settings,"aiPoweredFeaturesMain",e)},expression:"settings.aiPoweredFeaturesMain"}})],1)]}}],null,!1,170210909)},[e("span",[t._v("This feature requires an LLM provider to be configured. Please contact your administrator.")])])],1),e("v-list-item-content",[e("v-list-item-title",[t._v("AI powered features (experimental)")]),e("v-list-item-subtitle",[t._v("Main switch to enable or disable all experimental AI features")])],1)],1),e("v-list-item",[e("v-list-item-action",{staticClass:"ml-8"},[e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("div",t._g(t._b({},"div",s,!1),t.isFeatureAvailable("llm_summarize")?{}:n),[e("v-switch",{attrs:{color:"primary",disabled:!t.settings.aiPoweredFeaturesMain||!t.isFeatureAvailable("llm_summarize")},on:{change:function(e){return t.saveSettings()}},model:{value:t.settings.eventSummarization,callback:function(e){t.$set(t.settings,"eventSummarization",e)},expression:"settings.eventSummarization"}})],1)]}}],null,!1,670183324)},[e("span",[t._v("Event summarization requires an LLM provider to be configured. Please contact your administrator.")])])],1),e("v-list-item-content",{staticClass:"ml-8"},[e("v-list-item-title",[t._v("Event summarization")]),e("v-list-item-subtitle",[t._v("Enable AI powered summarization of events")])],1)],1),e("v-list-item",[e("v-list-item-action",{staticClass:"ml-8"},[e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("div",t._g(t._b({},"div",s,!1),t.isFeatureAvailable("nl2q")?{}:n),[e("v-switch",{attrs:{color:"primary",disabled:!t.settings.aiPoweredFeaturesMain||!t.isFeatureAvailable("nl2q")},on:{change:function(e){return t.saveSettings()}},model:{value:t.settings.generateQuery,callback:function(e){t.$set(t.settings,"generateQuery",e)},expression:"settings.generateQuery"}})],1)]}}],null,!1,3920075210)},[e("span",[t._v("AI query generation requires an LLM provider to be configured. Please contact your administrator.")])])],1),e("v-list-item-content",{staticClass:"ml-8"},[e("v-list-item-title",[t._v("AI generated queries")]),e("v-list-item-subtitle",[t._v("Enable experimental AI query suggestions for DFIQ questions")])],1)],1),t.systemSettings.SEARCH_PROCESSING_TIMELINES?e("v-list-item",[e("v-list-item-action",[e("v-switch",{attrs:{color:"primary"},on:{change:function(e){return t.saveSettings()}},model:{value:t.settings.showProcessingTimelineEvents,callback:function(e){t.$set(t.settings,"showProcessingTimelineEvents",e)},expression:"settings.showProcessingTimelineEvents"}})],1),e("v-list-item-content",[e("v-list-item-title",[t._v("Include Processing Events")]),e("v-list-item-subtitle",[t._v("Allows queries to include events from timelines still being "),e("strong",[t._v("processed")]),t._v(".")])],1)],1):t._e()],1):t._e()],1)},A=[],D=i(8643),L=(i(18111),i(13579),i(16034),{showLeftPanel:!0,aiPoweredFeaturesMain:!1,eventSummarization:!1,generateQuery:!1,showProcessingTimelineEvents:!1}),I={data:function(){return{settings:{showLeftPanel:!0,aiPoweredFeaturesMain:!1,eventSummarization:!1,generateQuery:!1,showProcessingTimelineEvents:!1}}},computed:{sketch:function(){return this.$store.state.sketch},systemSettings:function(){return this.$store.state.systemSettings},userSettings:function(){return this.$store.state.settings},llmFeatures:function(){return this.systemSettings.LLM_FEATURES_AVAILABLE||{}},isAnyFeatureAvailable:function(){return Object.values(this.llmFeatures).some(function(t){return!0===t})}},methods:{saveSettings:function(){var t=this;_.saveUserSettings(this.settings).then(function(){return t.$store.dispatch("updateUserSettings")}).then(function(){t.settings=(0,D.A)({},t.userSettings)}).catch(function(t){console.log(t)})},updateAiFeatures:function(){this.settings.aiPoweredFeaturesMain||(this.settings.eventSummarization=!1,this.settings.generateQuery=!1),this.saveSettings()},isFeatureAvailable:function(t){return!0===this.llmFeatures[t]}},mounted:function(){this.settings=(0,D.A)((0,D.A)({},L),this.userSettings),this.saveSettings()}},E=I,N=(0,u.A)(E,C,A,!1,null,null,null),z=N.exports,$={components:{TsSketchList:T,TsSettingsDialog:z},data:function(){return{sketchForm:{name:""},createSketchDialog:!1,scenarioTemplates:[],showSettingsDialog:!1,sketchNameRules:[function(t){return!!t||"Sketch name is required."},function(t){return t&&t.length<=255||"Sketch name is too long."}]}},computed:{currentUser:function(){return this.$store.state.currentUser},userSettings:function(){return this.$store.state.settings},systemSettings:function(){return this.$store.state.systemSettings}},mounted:function(){this.$store.dispatch("updateSystemSettings"),this.$store.dispatch("updateUserSettings")},methods:{toggleTheme:function(){this.$vuetify.theme.dark=!this.$vuetify.theme.dark,localStorage.setItem("isDarkTheme",this.$vuetify.theme.dark.toString())},switchUI:function(){window.location.href="/legacy/"},clearFormData:function(){this.sketchForm.name=""},createSketch:function(){var t=this;_.createSketch(this.sketchForm).then(function(e){var i=e.data.objects[0].id;t.clearFormData(),t.$router.push({name:"Overview",params:{sketchId:i}})}).catch(function(t){})}},created:function(){var t=this;this.$store.dispatch("resetState"),document.title="Timesketch",_.getScenarioTemplates().then(function(e){t.scenarioTemplates=e.data["objects"]}).catch(function(t){})}},F=$,R=(0,u.A)(F,v,p,!1,null,null,null),P=R.exports,O=function(){var t=this,e=t._self._c;return e("div",[e("div",{directives:[{name:"show",rawName:"v-show",value:"Explore"===t.currentRouteName,expression:"currentRouteName === 'Explore'"}]},[e("explore",{attrs:{"sketch-id":t.sketchId}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"Intelligence"===t.currentRouteName,expression:"currentRouteName === 'Intelligence'"}]},[e("threat-intel",{attrs:{"sketch-id":t.sketchId}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"SigmaNewRule"===t.currentRouteName,expression:"currentRouteName === 'SigmaNewRule'"}]},[e("sigma",{attrs:{"sketch-id":t.sketchId}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"SigmaEditRule"===t.currentRouteName,expression:"currentRouteName === 'SigmaEditRule'"}]},[e("sigma",{attrs:{"sketch-id":t.sketchId,"rule-id":t.ruleId}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"Graph"===t.currentRouteName,expression:"currentRouteName === 'Graph'"}]},[e("graph")],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"Story"===t.currentRouteName,expression:"currentRouteName === 'Story'"}]},[e("story",{attrs:{"sketch-id":t.sketchId,"story-id":t.storyId}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"Analyze"===t.currentRouteName,expression:"currentRouteName === 'Analyze'"}]},[e("analyze",{attrs:{"sketch-id":t.sketchId,"analyzer-timeline-id":t.analyzerTimelineId}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"VisualizationNew"===t.currentRouteName,expression:"currentRouteName === 'VisualizationNew'"}]},[e("visualization")],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"VisualizationView"===t.currentRouteName,expression:"currentRouteName === 'VisualizationView'"}]},[e("visualization",{attrs:{"aggregation-id":t.aggregationId}})],1)])},Q=[],M=(i(28706),function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-card",{staticClass:"pa-3 pt-0 mt-n3",attrs:{flat:"",color:"transparent"}},[e("v-card",{staticClass:"d-flex align-start mb-1",attrs:{outlined:""}},[e("v-sheet",{staticClass:"mt-2"},[e("ts-search-history-buttons",{on:{toggleSearchHistory:function(e){return t.toggleSearchHistory()}}})],1),e("v-menu",{attrs:{"offset-y":"",attach:"","close-on-content-click":!1,"close-on-click":!0},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-text-field",t._g(t._b({ref:"searchInput",staticClass:"pa-2",attrs:{"hide-details":"",label:"Search",placeholder:"Search","single-line":"",dense:"",flat:"",solo:"",id:"tsSearchInput"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search()},click:function(e){t.showSearchDropdown=!0}},scopedSlots:t._u([{key:"append",fn:function(){return[e("v-icon",{staticClass:"mr-3",attrs:{title:"Run search"},on:{click:function(e){return t.search()}}},[t._v("mdi-magnify")]),e("v-icon",{attrs:{title:"Show search examples"},on:{click:function(e){t.showSearchHelp=!0}}},[t._v("mdi-help-circle-outline")])]},proxy:!0}],null,!0),model:{value:t.currentQueryString,callback:function(e){t.currentQueryString=e},expression:"currentQueryString"}},"v-text-field",s,!1),n))]}}]),model:{value:t.showSearchDropdown,callback:function(e){t.showSearchDropdown=e},expression:"showSearchDropdown"}},[e("ts-search-dropdown",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onClickOutside,expression:"onClickOutside"}],attrs:{"selected-labels":t.selectedLabels,"query-string":t.currentQueryString},on:{setActiveView:t.searchView,addChip:t.addChip,updateLabelChips:function(e){return t.updateLabelChips()},"close-on-click":function(e){t.showSearchDropdown=!1},"node-click":t.jumpInHistory,setQueryAndFilter:t.setQueryAndFilter}})],1)],1),e("div",{staticClass:"mt-4"},[e("v-card",{directives:[{name:"show",rawName:"v-show",value:t.showSearchHistory,expression:"showSearchHistory"}],attrs:{outlined:""}},[e("v-toolbar",{attrs:{dense:"",flat:""}},[e("v-toolbar-title",[t._v("Search history")]),e("v-spacer"),e("v-slider",{staticClass:"mt-6",attrs:{"thumb-label":"",ticks:"","append-icon":"mdi-magnify-plus-outline","prepend-icon":"mdi-magnify-minus-outline",min:"0.1",max:"1",step:"0.1"},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var i=e.value;return[t._v(" "+t._s(100*i)+"% ")]}}]),model:{value:t.zoomLevel,callback:function(e){t.zoomLevel=e},expression:"zoomLevel"}}),e("v-btn",{staticClass:"ml-4",attrs:{icon:""},on:{click:function(e){t.showSearchHistory=!1}}},[e("v-icon",{attrs:{title:"Close search history"}},[t._v("mdi-close")])],1)],1),e("v-divider"),e("div",{directives:[{name:"dragscroll",rawName:"v-dragscroll"}],staticClass:"pa-md-4 no-scrollbars",staticStyle:{overflow:"scroll","white-space":"nowrap","max-height":"500px","min-height":"100px"}},[e("ts-search-history-tree",{staticStyle:{"transform-origin":"top left"},style:{transform:"scale("+t.zoomLevel+")"},attrs:{"show-history":t.showSearchHistory},on:{"node-click":t.jumpInHistory}})],1)],1)],1),e("v-dialog",{attrs:{"max-width":"1800",scrollable:""},model:{value:t.showSearchHelp,callback:function(e){t.showSearchHelp=e},expression:"showSearchHelp"}},[e("ts-search-help-card",{attrs:{flat:!0},on:{"close-dialog":function(e){t.showSearchHelp=!1}}})],1),e("div",[e("v-toolbar",{staticClass:"mt-n3",staticStyle:{"background-color":"transparent"},attrs:{flat:"",dense:""}},[e("v-btn",{attrs:{small:"",icon:""},on:{click:function(e){t.showTimelines=!t.showTimelines}}},[t.showTimelines?e("v-icon",{attrs:{title:"Hide Timelines"}},[t._v("mdi-chevron-up")]):e("v-icon",{attrs:{title:"Show Timelines"}},[t._v("mdi-chevron-down")])],1),e("span",{staticClass:"timeline-header"},[e("ts-upload-timeline-form-button",{attrs:{"btn-type":"small"}}),e("v-dialog",{attrs:{width:"600"},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({attrs:{small:"",text:"",rounded:"",color:"primary"}},"v-btn",s,!1),n),[e("v-icon",{attrs:{left:"",small:""}},[t._v(" mdi-plus ")]),t._v(" Add manual event ")],1)]}}]),model:{value:t.addManualEvent,callback:function(e){t.addManualEvent=e},expression:"addManualEvent"}},[e("ts-add-manual-event",{attrs:{app:"",datetimeProp:t.datetimeManualEvent},on:{cancel:function(e){t.addManualEvent=!1}}})],1),e("v-btn",{attrs:{small:"",text:"",rounded:"",color:"primary"},on:{click:function(e){return e.stopPropagation(),t.enableAllTimelines()}}},[e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-eye")]),e("span",[t._v("Select all")])],1),e("v-btn",{attrs:{small:"",text:"",rounded:"",color:"primary"},on:{click:function(e){return e.stopPropagation(),t.disableAllTimelines()}}},[e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-eye-off")]),e("span",[t._v("Unselect all")])],1)],1)],1),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.showTimelines,expression:"showTimelines"}]},[e("ts-timeline-picker",{attrs:{"current-query-filter":t.currentQueryFilter,"count-per-index":t.countPerIndex,"count-per-timeline":t.countPerTimeline}})],1)])],1),e("div",[t._l(t.timeFilterChips,function(i,n){return e("span",{key:n+i.value},[e("v-menu",{attrs:{"offset-y":"","content-class":"menu-with-gap"},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on;return[e("v-chip",t._g({attrs:{outlined:""}},s),[e("v-icon",{attrs:{left:"",small:""}},[t._v(" mdi-clock-outline ")]),e("span",{style:[i.active?"":{"text-decoration":"line-through",opacity:"50%"}]},[e("span",[t._v(t._s(i.value.split(",")[0]))]),"datetime_range"===i.type&&i.value.split(",")[0]!==i.value.split(",")[1]?e("span",[t._v(" â†’ "+t._s(i.value.split(",")[1]))]):t._e()])],1)]}}],null,!0)},[e("v-card",[e("v-list",[e("v-menu",{staticStyle:{overflow:"visible"},attrs:{"offset-y":"","close-on-content-click":!1,"close-on-click":!0,"nudge-top":"70","content-class":"menu-with-gap","allow-overflow":""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-list-item",t._g(t._b({},"v-list-item",s,!1),n),[e("v-list-item-action",[e("v-icon",[t._v("mdi-square-edit-outline")])],1),e("v-list-item-subtitle",[t._v("Edit filter")])],1)]}}],null,!0)},[e("ts-filter-menu",{attrs:{app:"","selected-chip":i},on:{updateChip:function(e){return t.updateChip(e,i)}}})],1),e("v-list-item",{on:{click:function(e){return t.copyFilterChip(i)}}},[e("v-list-item-action",[e("v-icon",[t._v("mdi-content-copy")])],1),e("v-list-item-subtitle",[t._v("Copy filter")])],1),e("v-list-item",{on:{click:function(e){return t.toggleChip(i)}}},[e("v-list-item-action",[i.active?e("v-icon",[t._v("mdi-eye-off")]):e("v-icon",[t._v("mdi-eye")])],1),e("v-list-item-subtitle",[i.active?e("span",[t._v("Temporarily disable")]):e("span",[t._v("Re-enable")])])],1),e("v-list-item",{on:{click:function(e){return t.removeChip(i)}}},[e("v-list-item-action",[e("v-icon",[t._v("mdi-delete")])],1),e("v-list-item-subtitle",[t._v("Remove filter")])],1)],1)],1)],1),n+1<t.timeFilterChips.length?e("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"2px"},attrs:{icon:"",small:""}},[t._v("OR")]):t._e()],1)}),e("span",[e("v-menu",{staticStyle:{overflow:"visible"},attrs:{"offset-y":"","close-on-content-click":!1,"close-on-click":!0,"content-class":"menu-with-gap","allow-overflow":""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({attrs:{small:"",text:"",rounded:"",color:"primary"}},"v-btn",s,!1),n),[e("v-icon",{attrs:{left:"",small:""}},[t._v(" mdi-clock-plus-outline ")]),t._v(" Add timefilter ")],1)]}}]),model:{value:t.timeFilterMenu,callback:function(e){t.timeFilterMenu=e},expression:"timeFilterMenu"}},[e("ts-filter-menu",{attrs:{app:""},on:{cancel:function(e){t.timeFilterMenu=!1},addChip:t.addChip}})],1)],1)],2),t.filterChips.length?e("div",{staticClass:"mt-1"},[e("v-chip-group",{attrs:{column:""}},t._l(t.filterChips,function(i,n){return e("span",{key:n+i.value},[e("v-tooltip",{attrs:{top:"",disabled:i.value.length<33,"open-delay":"300"},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on,a=n.attrs;return[e("v-chip",t._g(t._b({attrs:{outlined:"",close:"","close-icon":"mdi-close"},on:{"click:close":function(e){return t.removeChip(i)},click:function(e){return t.copyFilterChip(i)}}},"v-chip",a,!1),s),["__ts_star"===i.value?e("v-icon",{attrs:{left:"",small:"",color:"amber"}},[t._v("mdi-star")]):t._e(),"__ts_comment"===i.value?e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-comment-multiple-outline")]):t._e(),t.getQuickTag(i.value)?e("v-icon",{attrs:{left:"",small:"",color:t.getQuickTag(i.value).color}},[t._v(t._s(t.getQuickTag(i.value).label))]):t._e(),"must_not"===i.operator?e("span",{staticClass:"filter-chip-truncate"},[e("span",{staticStyle:{color:"red"}},[t._v("NOT ")]),t._v(" "+t._s(t._f("formatLabelText")(i.field?"".concat(i.field," : ").concat(i.value):i.value))+" ")]):e("span",{staticClass:"filter-chip-truncate"},[t._v(" "+t._s(t._f("formatLabelText")(i.field?"".concat(i.field," : ").concat(i.value):i.value))+" ")])],1)]}}],null,!0)},[e("span",[t._v(t._s(i.value))])]),n+1<t.timeFilterChips.length?e("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"2px"},attrs:{icon:"",small:""}},[t._v("AND")]):t._e()],1)}),0)],1):t._e()],1),e("v-card",{staticClass:"mt-5 mx-3",attrs:{flat:"",color:"transparent"}},[e("ts-event-list",{attrs:{"query-request":t.activeQueryRequest},on:{countPerIndex:function(e){return t.updateCountPerIndex(e)},countPerTimeline:function(e){return t.updateCountPerTimeline(e)}}})],1)],1)}),q=[],B=i(97695),V=(i(2008),i(50113),i(48980),i(62062),i(26910),i(54554),i(22489),i(20116),i(7588),i(61701),i(79432),i(11392),i(23500),i(45915)),H=function(){var t=this,e=t._self._c;return Object.keys(t.treeData).length>0?e("ul",{staticClass:"tree"},[e("tree-node",{attrs:{node:t.treeData,"handle-click":t.handleClick,"selected-node":t.selectedNode}})],1):t._e()},G=[],U=i(45929),W=function(){var t=this,e=t._self._c;return e("li",[e("span",{class:[{active:t.isSelected},{star:t.hasStar&&!t.isSelected},{dimmed:0===t.count&&!t.isSelected}],staticStyle:{"min-width":"280px"},attrs:{id:t.node.id},on:{click:function(e){return t.handleClick(t.node)}}},[t.hasStar?e("v-icon",{staticClass:"mr-1",staticStyle:{float:"left"},attrs:{title:"Added a Star to an event",color:"amber darken-2"}},[t._v("mdi-star")]):t._e(),t.hasComment?e("v-icon",{staticClass:"mr-1",staticStyle:{float:"left"},attrs:{title:"Added a Comment to an event"}},[t._v("mdi-comment-outline")]):t._e(),t.hasLabel?e("v-icon",{staticStyle:{float:"left","margin-right":"10px"},attrs:{title:"Added a Label to an event"}},[t._v("mdi-label")]):t._e(),e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("div",t._g(t._b({staticClass:"query-string",class:[{"query-string-active":t.isSelected}],staticStyle:{float:"left"}},"div",s,!1),n),[t._v(" "+t._s(t.node.query_string)+" ")])]}}])},[e("span",[t._v(t._s(t.node.query_string)+" "+t._s(t.node))])]),e("div",{staticClass:"tag is-light",staticStyle:{"margin-left":"5px",float:"right"}},[e("small",[t._v(t._s(t._f("compactNumber")(t.count)))])])],1),t.node.children&&t.node.children.length?e("ul",t._l(t.node.children,function(i){return e("node",{key:i.id,attrs:{node:i,"handle-click":t.handleClick,"selected-node":t.selectedNode}})}),1):t._e()])},j=[],Y={name:"node",props:{node:Object,handleClick:Function,selectedNode:Object},computed:{hasStar:function(){return this.node.labels.includes("__ts_star")},hasLabel:function(){return this.node.labels.includes("__ts_label")},hasComment:function(){return this.node.labels.includes("__ts_comment")},isSelected:function(){return this.selectedNode.id===this.node.id},count:function(){return this.node.query_result_count||0}}},X=Y,J=(0,u.A)(X,W,j,!1,null,"a080baf6",null),K=J.exports;function Z(t,e,i){if(t.hasOwnProperty(e)&&!0===i(e,t[e]))return t;for(var n=0;n<Object.keys(t).length;n++){var s=t[Object.keys(t)[n]];if("object"===(0,U.A)(s)&&null!=s){var a=Z(s,e,i);if(null!=a)return a}}return null}var tt={components:{TreeNode:K},data:function(){return{treeData:{},selectedNode:null,initialNode:null}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{handleClick:function(t){this.$emit("node-click",t),this.selectedNode=t},handleClickFromDropdown:function(t){var e;e="number"===typeof t?t:t.id;var i=Z(this.treeData,"id",function(t,i){return i===e});this.$emit("node-click",i),this.selectedNode=i},createBranch:function(t){if(this.selectedNode){if(this.selectedNode.id===t.id)return;return this.selectedNode.children.push(t),void(this.selectedNode=t)}this.fetchHistory();var e=Z(this.treeData,"id",function(e,i){return i===t.parent});if(e){if(e.children.some(function(e){return e.id===t.id}))return;return e.children.push(t),void(this.selectedNode=t)}var i=Z(this.treeData,"id",function(e,i){return i===t.id});i&&(this.selectedNode=i)},annotateNode:function(t){t.searchNode.labels.includes(t.type)||t.searchNode.labels.push(t.type)},scrollTo:function(){this.$nextTick(function(){document.getElementById(this.selectedNode.id.toString()).scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},fetchHistory:function(){var t=this;_.getSearchHistoryTree(this.sketch.id).then(function(e){if(t.treeData=e.data.objects[0],!t.selectedNode){var i=e.data.meta["last_node_id"];t.selectedNode=Z(t.treeData,"id",function(t,e){return e===i})}}).catch(function(t){})}},beforeDestroy:function(){o.$off("createBranch"),o.$off("eventAnnotated"),o.$off("triggerScrollTo"),o.$off("selected-node-from-dropdown")},created:function(){o.$on("createBranch",this.createBranch),o.$on("eventAnnotated",this.annotateNode),o.$on("triggerScrollTo",this.scrollTo),o.$on("selected-node-from-dropdown",this.handleClickFromDropdown),this.fetchHistory()},watch:{selectedNode:function(){this.$store.dispatch("updateSearchNode",this.selectedNode),this.scrollTo()}}},et=tt,it=(0,u.A)(et,H,G,!1,null,null,null),nt=it.exports,st=function(){var t=this,e=t._self._c;return e("span",[e("v-btn",{attrs:{icon:"",disabled:!t.hasParent},on:{click:t.searchHistoryBack}},[e("v-icon",{attrs:{title:"Go back to your last search"}},[t._v("mdi-arrow-left")])],1),e("v-btn",{attrs:{icon:"",disabled:!t.hasChild},on:{click:t.searchHistoryForward}},[e("v-icon",{attrs:{title:"Go to your next search"}},[t._v("mdi-arrow-right")])],1),e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.$emit("toggleSearchHistory")}}},[e("v-icon",{attrs:{title:"Open your search history"}},[t._v("mdi-history")])],1)],1)},at=[],rt=(i(34782),{computed:{currentSearchNode:function(){return this.$store.state.currentSearchNode},hasParent:function(){return!!this.currentSearchNode&&"number"===typeof this.currentSearchNode.parent},hasChild:function(){return!!this.currentSearchNode&&this.currentSearchNode.children.length}},methods:{searchHistoryBack:function(){o.$emit("selected-node-from-dropdown",this.currentSearchNode.parent)},searchHistoryForward:function(){if(this.currentSearchNode.children.length){var t=this.currentSearchNode.children.slice(-1).pop();o.$emit("selected-node-from-dropdown",t)}}}}),ot=rt,lt=(0,u.A)(ot,st,at,!1,null,"5fd1791a",null),ct=lt.exports,ut=function(){var t=this,e=t._self._c;return e("v-card",{staticStyle:{overflow:"hidden"},attrs:{outlined:"","min-height":"550"}},[e("v-row",[t.matches.savedSearches.length?e("v-col",{attrs:{cols:"3"}},[e("h5",{staticClass:"mt-3 ml-4"},[t._v("Saved searches")]),e("v-list",{staticClass:"overflow-y-auto",class:t.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},t._l(t.matches.savedSearches,function(i){return e("v-list-item",{key:i.id,staticStyle:{"font-size":"0.9em"},on:{click:function(e){return t.$emit("setActiveView",i)}}},[e("v-list-item-content",[t._v(" "+t._s(i.name)+" ")])],1)}),1)],1):t._e(),e("v-divider",{attrs:{vertical:""}}),t.matches.timeFilters.length?e("v-col",{attrs:{cols:"3"}},[e("h5",{staticClass:"mt-3 ml-4"},[t._v("Last time filters")]),e("v-list",{staticClass:"overflow-y-auto",class:t.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},[t._l(t.matches.timeFilters.slice(0,t.MAX_TIMELINE_ELEMENTS),function(i){return[e("v-list-item",{key:i.value,staticStyle:{"font-size":"0.9em"},on:{click:function(e){return t.setTimeFilter(i)}}},[e("v-list-item-content",[t._v(" "+t._s(i.value.split(",")[0])+" - "+t._s(i.value.split(",")[1])+" ")])],1)]})],2)],1):t._e(),e("v-divider",{attrs:{vertical:""}}),e("v-col",{attrs:{cols:"3"}},[e("h5",{staticClass:"mt-3 ml-4"},[t._v("Data types")]),e("v-list",{staticClass:"overflow-y-auto",class:t.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},t._l(t.matches.dataTypes,function(i){return e("v-list-item",{key:i.data_type,staticStyle:{"font-size":"0.9em"},on:{click:function(e){return t.searchForDataType(i.data_type)}}},[e("v-list-item-content",[e("span",[t._v(t._s(i.data_type)+" "),e("span",{staticClass:"font-weight-bold",staticStyle:{"font-size":"0.8em"}},[t._v("("+t._s(t._f("compactNumber")(i.count))+")")])])])],1)}),1)],1),e("v-divider",{attrs:{vertical:""}}),t.matches.labels.length||t.matches.tags.length?e("v-col",{attrs:{cols:"3"}},[e("h5",{staticClass:"mt-3 ml-5"},[t._v("Tags")]),e("ts-tags-list")],1):t._e()],1)],1)},dt=[],ht=function(){var t=this,e=t._self._c;return e("div",[e("div",[e("v-data-iterator",{attrs:{items:t.allTagsAndLabels,"items-per-page":t.itemsPerPage,search:t.search,"hide-default-footer":t.allTagsAndLabels.length<=t.itemsPerPage},on:{"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e}},scopedSlots:t._u([t.allTagsAndLabels.length>t.itemsPerPage?{key:"header",fn:function(){return[e("v-toolbar",{attrs:{flat:""}},[e("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for tags ..."},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]},proxy:!0}:null,{key:"default",fn:function(i){return t._l(i.items,function(i){return e("div",{key:i.tag||i.label,staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(e){return t.applyFilterChip(i.tag||i.label,i.tag?"tag":"",i.tag?"term":"label")}}},[e("v-row",{staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},["__ts_star"===i.label?e("v-icon",{attrs:{left:"",small:"",color:"amber"}},[t._v("mdi-star")]):t._e(),"__ts_comment"===i.label?e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-comment-multiple-outline")]):t._e(),t.getQuickTag(i.tag)?e("v-icon",{attrs:{small:"",left:"",color:t.getQuickTag(i.tag).color}},[t._v(t._s(t.getQuickTag(i.tag).label))]):t._e(),e("span",[t._v(" "+t._s(t._f("formatLabelText")(i.tag||i.label))+" ("),e("small",[e("strong",[t._v(t._s(t._f("compactNumber")(i.count)))])]),t._v(") ")])],1)],1)})}}],null,!0)})],1)])},mt=[],vt={props:[],data:function(){return{quickTags:[{tag:"bad",color:"red",textColor:"white",label:"mdi-alert-circle-outline"},{tag:"suspicious",color:"orange",textColor:"white",label:"mdi-help-circle-outline"},{tag:"good",color:"green",textColor:"white",label:"mdi-check-circle-outline"}],itemsPerPage:10,search:""}},computed:{meta:function(){return this.$store.state.meta},tags:function(){return this.$store.state.tags},labels:function(){return this.meta.filter_labels},customTags:function(){var t=this;return this.tags.filter(function(e){return!t.getQuickTag(e.tag)})},assignedQuickTags:function(){var t=this;return this.tags.filter(function(e){return t.getQuickTag(e.tag)})},allTagsAndLabels:function(){var t=["__ts_star","__ts_comment","bad","suspicious","good"];return[].concat((0,B.A)(this.labels),(0,B.A)(this.assignedQuickTags),(0,B.A)(this.customTags)).filter(function(t){return t.tag||t.label}).filter(function(t){return!(t.label&&t.label.startsWith("__ts_fact"))}).sort(function(e,i){var n=e.tag||e.label,s=i.tag||i.label,a=!!e.label,r=!!i.label;if(a&&!r)return-1;if(!a&&r)return 1;var o=t.indexOf(n),l=t.indexOf(s);return o>-1&&l>-1?o-l:o>-1?-1:l>-1?1:n.localeCompare(s)})}},methods:{getQuickTag:function(t){return this.quickTags.find(function(e){return e.tag===t})},applyFilterChip:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"label",n={doSearch:!0,queryString:"*"},s={field:e,value:t,type:i,operator:"must",active:!0};n.chip=s,o.$emit("setQueryAndFilter",n)}}},pt=vt,ft=(0,u.A)(pt,ht,mt,!1,null,null,null),gt=ft.exports,yt={components:{TsTagsList:gt},props:["selectedLabels","queryString"],computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},searchHistory:function(){return this.$store.state.searchHistory},tags:function(){return this.$store.state.tags},dataTypes:function(){return this.$store.state.dataTypes},filteredMetaLabels:function(){return this.meta.filter_labels.filter(function(t){return!t.label.startsWith("__ts_fact")})},all:function(){return{fields:this.meta.mappings,tags:this.tags,labels:this.filteredMetaLabels,dataTypes:this.dataTypes,savedSearches:this.meta.views,timeFilters:this.timeFilters}},timeFilters:function(){return this.$store.state.timeFilters},scrollbarTheme:function(){return this.$vuetify.theme.dark?"dark":"light"},matches:function(){var t=this,e={};return this.queryString?(e.fields=this.meta.mappings.filter(function(e){return e.field.toLowerCase().includes(t.queryString.toLowerCase())}),e.tags=this.tags.filter(function(e){return e.tag.toLowerCase().includes(t.queryString.toLowerCase())}),e.labels=this.filteredMetaLabels.filter(function(e){return e.label.toLowerCase().includes(t.queryString.toLowerCase())}),e.dataTypes=this.dataTypes.filter(function(e){return e.data_type.toLowerCase().includes(t.queryString.toLowerCase())}),e.savedSearches=this.meta.views.filter(function(e){return e.name.toLowerCase().includes(t.queryString.toLowerCase())}),Object.values(e).filter(function(t){return t.length}).length?e:this.all):this.all}},methods:{searchForDataType:function(t){var e={doSearch:!0};e.queryString='data_type:"'+t+'"',this.$emit("setQueryAndFilter",e)},searchForField:function(t){var e={},i="";""!==this.queryString&&(i=this.queryString+" "),this.queryString.includes(" ")||(i=""),e.doSearch=!1,e.queryString=i+t+":",this.$emit("setQueryAndFilter",e)},setTimeFilter:function(t){this.$emit("addChip",t)},fetchTimeFilters:function(){this.$store.dispatch("updateTimeFilters")}},created:function(){this.fetchTimeFilters()},setup:function(){return{MAX_TIMELINE_ELEMENTS:10}}},_t=yt,bt=(0,u.A)(_t,ut,dt,!1,null,"e0284ffc",null),St=bt.exports,wt=function(){var t=this,e=t._self._c;return e("span",[t._l(t.allTimelines,function(i){return e("ts-timeline-chip",{key:i.id+i.name,staticClass:"mr-2 mb-3 timeline-chip",attrs:{timeline:i,"is-selected":t.isSelected(i),"is-empty-state":t.isEmptyState,"events-count":t.getCount(i)},on:{remove:t.remove,save:t.save,toggle:t.toggleTimeline,disableAllOtherTimelines:t.disableAllOtherTimelines}})}),t.sketch.timelines.length>20?e("v-btn",{staticClass:"mt-n3 mr-5",attrs:{small:"",text:"",rounded:"",color:"primary"},on:{click:function(e){t.showAll=!t.showAll}}},[t.showAll?e("span",[t._v(" show less ")]):e("span",[t._v(" "+t._s(t.sketch.timelines.length-20)+" more.. ")])]):t._e(),e("br")],2)},kt=[],xt=function(){var t=this,e=t._self._c;return e("ts-timeline-component",{attrs:{timeline:t.timeline,eventsCount:t.eventsCount,isSelected:t.isSelected,isEmptyState:t.isEmptyState},on:{toggle:function(e){return t.$emit.apply(t,["toggle"].concat(Array.prototype.slice.call(arguments)))},disableAllOtherTimelines:function(e){return t.$emit.apply(t,["disableAllOtherTimelines"].concat(Array.prototype.slice.call(arguments)))},save:function(e){return t.$emit.apply(t,["save"].concat(Array.prototype.slice.call(arguments)))},remove:function(e){return t.$emit.apply(t,["remove"].concat(Array.prototype.slice.call(arguments)))}},scopedSlots:t._u([{key:"processing",fn:function(i){return[e("v-chip",t._g({style:t.timelineStyle(i.timelineStatus)},i.events.on),[e("span",{staticClass:"timeline-name-ellipsis"},[t._v(t._s(t.timeline.name))]),e("span",{staticClass:"ml-1"},[e("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:20,width:1}})],1)])]}},{key:"processed",fn:function(i){return[e("v-chip",{staticClass:"pr-1 timeline-chip",class:[{failed:i.timelineFailed},t.$vuetify.theme.dark?"dark-highlight":"light-highlight"],style:t.timelineStyle(i.timelineStatus),attrs:{ripple:!i.timelineFailed},on:{click:i.events.toggleTimeline}},[e("div",{staticClass:"chip-content"},[i.timelineFailed?e("v-icon",{attrs:{title:"Import failed; click for details",left:"",color:"red",size:"x-large"},on:{click:i.events.openDialog}},[t._v(" mdi-alert-circle-outline ")]):t._e(),i.timelineFailed?t._e():e("v-icon",{staticClass:"ml-n2",attrs:{title:"Toggle visibility",left:"",color:i.timelineChipColor,size:"26"}},[t._v(" mdi-circle ")]),e("v-tooltip",{attrs:{bottom:"",disabled:t.timeline.name.length<30,"open-delay":"200"},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on,a=n.attrs;return[e("span",t._g(t._b({staticClass:"timeline-name-ellipsis",class:{disabled:!t.isSelected&&("processing"===i.timelineStatus||"ready"===i.timelineStatus)}},"span",a,!1),s),[t._v(t._s(t.timeline.name))])]}}],null,!0)},[e("span",[t._v(t._s(t.timeline.name))])]),e("span",{staticClass:"right"},["processing"===i.timelineStatus?e("span",{staticClass:"ml-3"},[e("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:20,width:2}})],1):t._e(),i.timelineFailed?t._e():e("span",{staticClass:"events-count",attrs:{"x-small":""}},[t._v(" "+t._s(t._f("compactNumber")(t.eventsCount))+" ")]),e("v-btn",t._g({staticClass:"ma-1",attrs:{"x-small":"",icon:""}},i.events.menuOn),[e("v-icon",{attrs:{title:"Manage Timeline"}},[t._v(" mdi-dots-vertical ")])],1)],1)],1)])]}}])})},Tt=[],Ct=(i(33771),function(){var t=this,e=t._self._c;return e("span",[t.timelineAvailable?e("v-menu",{ref:"timelineChipMenuRef",attrs:{"offset-y":"","max-width":"385","close-on-content-click":!1,"content-class":"menu-with-gap"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[t._t("processed",null,{timelineFailed:t.timelineFailed,timelineChipColor:t.timelineChipColor,timelineStatus:t.timelineStatus,events:{toggleTimeline:t.toggleTimeline,openDialog:t.openDialog,menuOn:i}})]}}],null,!0)},[e("v-sheet",{attrs:{flat:""}},[e("v-list",{attrs:{dense:""}},[e("v-dialog",{attrs:{width:"600"},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-list-item",t._g(t._b({},"v-list-item",s,!1),n),[e("v-list-item-action",[e("v-icon",[t._v("mdi-square-edit-outline")])],1),e("v-list-item-subtitle",[t._v("Rename")])],1)]}}]),model:{value:t.dialogRename,callback:function(e){t.dialogRename=e},expression:"dialogRename"}},[e("v-card",{staticClass:"pa-4"},[e("v-form",{on:{submit:function(e){return e.preventDefault(),t.rename()}}},[e("h3",[t._v("Rename timeline")]),e("br"),e("v-text-field",{attrs:{clearable:"",outlined:"",dense:"",autofocus:"",rules:t.timelineNameRules},on:{focus:function(t){return t.target.select()}},model:{value:t.newTimelineName,callback:function(e){t.newTimelineName=e},expression:"newTimelineName"}}),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){t.dialogRename=!1}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{disabled:!t.newTimelineName||t.newTimelineName.length>255,color:"primary",text:""},on:{click:function(e){return t.rename()}}},[t._v(" Save ")])],1)],1)],1)],1),t.timelineAvailable?e("v-list-item",{on:{click:function(e){return t.$emit("toggle",t.timeline)}}},[e("v-list-item-action",[t.isSelected?e("v-icon",[t._v("mdi-eye-off")]):e("v-icon",[t._v("mdi-eye")])],1),t.isSelected?e("v-list-item-subtitle",[t._v("Temporarily disabled")]):e("v-list-item-subtitle",[t._v("Re-enable")])],1):t._e(),t.timelineAvailable?e("v-list-item",{on:{click:function(e){return t.$emit("disableAllOtherTimelines",t.timeline)}}},[e("v-list-item-action",[e("v-icon",[t._v("mdi-checkbox-marked-circle-minus-outline")])],1),e("v-list-item-subtitle",[t._v("Unselect other timelines")])],1):t._e(),e("v-dialog",{attrs:{width:"800"},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-list-item",t._g(t._b({},"v-list-item",s,!1),n),[e("v-list-item-action",[e("v-icon",{attrs:{color:"mdi-alert-circle-outline"===t.iconStatus?"red":""}},[t._v(t._s(t.iconStatus))])],1),e("v-list-item-subtitle",[t._v("Data sources ("+t._s(t.datasources.length)+")")])],1)]}}]),model:{value:t.dialogStatus,callback:function(e){t.dialogStatus=e},expression:"dialogStatus"}},[e("v-card",[e("div",{staticClass:"pa-4"},[e("ul",{staticStyle:{"list-style-type":"none"}},[e("li",[e("strong",[t._v("Timeline name: ")]),t._v(t._s(t.timeline.name))]),e("li",[e("strong",[t._v("Opensearch index: ")]),t._v(t._s(t.timeline.searchindex.index_name))]),"processing"===t.timelineStatus||"ready"===t.timelineStatus?e("li",[e("strong",[t._v("Number of events: ")]),t._v(" "+t._s(t._f("compactNumber")(t.allIndexedEvents))+" ")]):t._e(),e("li",[e("strong",[t._v("Created by: ")]),t._v(t._s(t.timeline.user.username))]),e("li",[e("strong",[t._v("Created at: ")]),t._v(t._s(t._f("shortDateTime")(t.timeline.created_at))+" "),e("small",[t._v("("+t._s(t._f("timeSince")(t.timeline.created_at))+")")])]),e("li",[e("strong",[t._v("Number of datasources: ")]),t._v(t._s(t.datasources.length))])]),t._l(t.datasources,function(i){return e("v-alert",{key:i.id,staticClass:"ma-5",attrs:{outlined:"",text:"",color:t.datasourceStatusColors(i)}},[e("ul",{staticStyle:{"list-style-type":"none"}},[e("li",[e("strong",[t._v("Original filename:")]),t._v(" "+t._s(i.original_filename))]),e("li",[e("strong",[t._v("File on disk:")]),t._v(" "+t._s(i.file_on_disk))]),e("li",[e("strong",[t._v("File size:")]),t._v(" "+t._s(t._f("compactBytes")(i.file_size)))]),e("li",[e("strong",[t._v("Uploaded by:")]),t._v(" "+t._s(i.user.username))]),e("li",[e("strong",[t._v("Provider:")]),t._v(" "+t._s(i.provider))]),e("li",[e("strong",[t._v("Context:")]),t._v(" "+t._s(i.context))]),i.data_label?e("li",[e("strong",[t._v("Data label:")]),t._v(" "+t._s(i.data_label))]):t._e(),e("li",[e("strong",[t._v("Status:")]),t._v(" "+t._s(t.dataSourceStatus(i)))]),e("li",[e("strong",[t._v("Total File Events: ")]),t._v(t._s(t._f("compactNumber")(t.totalEventsDatasource(i.file_on_disk)))+" ")]),i.error_message?e("li",[e("strong",[t._v("Error message:")]),e("code",[t._v(" "+t._s(i.error_message))])]):t._e()])])})],2),e("v-divider"),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialogStatus=!1}}},[t._v(" Close ")])],1)],1)],1),"ready"===t.timelineStatus?e("v-list-item",{staticStyle:{cursor:"pointer"},attrs:{to:{name:"Analyze",params:{sketchId:t.sketch.id,analyzerTimelineId:t.timeline.id}}},on:{click:function(e){t.$refs.timelineChipMenuRef.isActive=!1}}},[e("v-list-item-action",[e("v-icon",[t._v("mdi-auto-fix")])],1),e("v-list-item-subtitle",[t._v("Run Analyzers")])],1):t._e(),t.timelineAvailable?e("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){t.deleteConfirmation=!0}}},[e("v-list-item-action",[e("v-icon",[t._v("mdi-trash-can-outline")])],1),e("v-list-item-subtitle",[t._v("Delete")])],1):t._e(),e("v-dialog",{attrs:{"max-width":"500"},model:{value:t.deleteConfirmation,callback:function(e){t.deleteConfirmation=e},expression:"deleteConfirmation"}},[e("v-card",[e("v-card-title",[e("v-icon",{staticClass:"mr-2 ml-n3",attrs:{color:"red"}},[t._v("mdi-alert-octagon-outline")]),t._v(" Delete Timeline? ")],1),e("v-card-text",[e("ul",{staticStyle:{"list-style-type":"none"}},[e("li",[e("strong",[t._v("Name: ")]),t._v(t._s(t.timeline.name))]),e("li",[e("strong",[t._v("Status: ")]),t._v(t._s(t.timelineStatus))]),e("li",[e("strong",[t._v("Opensearch index: ")]),t._v(t._s(t.timeline.searchindex.index_name))]),"processing"===t.timelineStatus||"ready"===t.timelineStatus?e("li",[e("strong",[t._v("Number of events: ")]),t._v(" "+t._s(t._f("compactNumber")(t.allIndexedEvents))+" ")]):t._e(),e("strong",[t._v("Number of events: ")]),t._v(" "+t._s(t._f("compactNumber")(t.allIndexedEvents))+" "),e("li",[e("strong",[t._v("Created by: ")]),t._v(t._s(t.timeline.user.username))]),e("li",[e("strong",[t._v("Created at: ")]),t._v(t._s(t._f("shortDateTime")(t.timeline.created_at))+" "),e("small",[t._v("("+t._s(t._f("timeSince")(t.timeline.created_at))+")")])])])]),e("v-card-actions",[e("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.deleteConfirmation=!1}}},[t._v(" cancel ")]),e("v-spacer"),e("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){return t.remove()}}},[t._v(" delete ")])],1)],1)],1)],1),t.timelineFailed?t._e():e("div",{staticClass:"px-4"},[e("v-color-picker",{attrs:{value:t.timeline.color,"show-swatches":!t.showCustomColorPicker,swatches:t.colorPickerSwatches,"hide-canvas":!t.showCustomColorPicker,"hide-sliders":!t.showCustomColorPicker,"hide-inputs":"",mode:"hexa","dot-size":"15"},on:{"update:color":t.updateColor}}),e("v-btn",{staticClass:"mt-2",attrs:{text:"","x-small":""},on:{click:function(e){t.showCustomColorPicker=!t.showCustomColorPicker}}},[t.showCustomColorPicker?e("span",[t._v("Palette")]):e("span",[t._v("Custom color")])])],1),e("br")],1)],1):e("v-dialog",{attrs:{width:"600"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;e.attrs;return[t._t("processing",null,{timelineStatus:t.timelineStatus,events:{on:i}})]}}],null,!0),model:{value:t.dialogStatus,callback:function(e){t.dialogStatus=e},expression:"dialogStatus"}},[e("v-card",[e("v-app-bar",{attrs:{flat:"",dense:""}},[t._v('Importing events to timeline "'+t._s(t.timeline.name)+'"')]),e("div",{staticClass:"pa-5"},[e("ul",[e("li",[e("strong",[t._v("Opensearch index: ")]),t._v(t._s(t.timeline.searchindex.index_name))]),"processing"===t.timelineStatus||"ready"===t.timelineStatus?e("li",[e("strong",[t._v("Number of events: ")]),t._v(" "+t._s(t._f("compactNumber")(t.allIndexedEvents))+" ")]):t._e(),e("li",[e("strong",[t._v("Created by: ")]),t._v(t._s(t.timeline.user.username))]),e("li",[e("strong",[t._v("Created at: ")]),t._v(t._s(t._f("shortDateTime")(t.timeline.created_at))+" "),e("small",[t._v("("+t._s(t._f("timeSince")(t.timeline.created_at))+")")])])]),e("br"),e("div",{staticClass:"mb-3"},[t._v(t._s(t.datasourcesProcessing.length)+" datasource(s) in progress..")]),t._l(t.datasourcesProcessing,function(i){return e("v-alert",{key:i.id,attrs:{"colored-border":"",border:"left",elevation:"1",color:t.datasourceStatusColors(i)}},[e("ul",[e("li",[e("strong",[t._v("Original filename:")]),t._v(" "+t._s(i.original_filename))]),e("li",[e("strong",[t._v("File on disk:")]),t._v(" "+t._s(i.file_on_disk))]),e("li",[e("strong",[t._v("File size:")]),t._v(" "+t._s(t._f("compactBytes")(i.file_size)))]),e("li",[e("strong",[t._v("Uploaded by:")]),t._v(" "+t._s(i.user.username))]),e("li",[e("strong",[t._v("Provider:")]),t._v(" "+t._s(i.provider))]),e("li",[e("strong",[t._v("Context:")]),t._v(" "+t._s(i.context))]),i.data_label?e("li",[e("strong",[t._v("Data label:")]),t._v(" "+t._s(i.data_label))]):t._e(),e("li",[e("strong",[t._v("Status:")]),t._v(" "+t._s(t.dataSourceStatus(i)))]),e("li",[e("strong",[t._v("Total File Events:")]),t._v(t._s(t._f("compactNumber")(t.totalEventsDatasource(i.file_on_disk)))+" ")]),i.error_message?e("li",[e("strong",[t._v("Error message:")]),e("code",[t._v(" "+t._s(i.error_message))])]):t._e()]),e("br")])}),t.percentComplete>.1?e("v-card",{attrs:{outlined:""}},[e("v-card-title",[t._v(t._s(t.eventsPerSecond.slice(-1)[0])+" events/s")]),e("v-sparkline",{attrs:{value:t.eventsPerSecond,gradient:t.sparkline.gradient,smooth:t.sparkline.radius||!1,padding:t.sparkline.padding,"line-width":t.sparkline.width,"stroke-linecap":t.sparkline.lineCap,"gradient-direction":t.sparkline.gradientDirection,fill:t.sparkline.fill,type:t.sparkline.type,"auto-line-width":t.sparkline.autoLineWidth,"auto-draw":""}}),e("v-sheet",{staticClass:"py-4 px-3"},[e("v-progress-linear",{attrs:{color:"light-blue",height:"25",value:t.percentComplete,rounded:""}},[t._v(" "+t._s(t.percentComplete)+"% (complete "+t._s(t.processingETA())+") ")])],1)],1):e("v-card",{staticClass:"pa-3",attrs:{outlined:""}},[t._v(" Waiting for processing to begin.. ")])],2),e("v-divider"),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialogStatus=!1}}},[t._v(" Close ")])],1)],1)],1)],1)}),At=[],Dt=(i(18237),i(2543)),Lt=i.n(Dt),It=i(91101),Et=[["#222"],["#42b3f4"],["red","orange","yellow"],["purple","violet"],["#00c6ff","#F0F","#FF0"],["#f72047","#ffd200","#1feaea"]],Nt={props:["timeline","eventsCount","isSelected","isEmptyState"],data:function(){return{autoRefresh:!1,allIndexedEvents:0,totalEvents:null,dialogStatus:!1,dialogRename:!1,datasources:[],timelineStatus:null,eventsPerSecond:[],newTimelineName:(0,B.A)(this.timeline.name),sparkline:{width:2,radius:10,padding:8,lineCap:"round",gradient:Et[5],gradientDirection:"bottom",gradients:Et,fill:!1,type:"trend",autoDrawDuration:4e3,autoLineWidth:!1},showCustomColorPicker:!1,colorPickerSwatches:[["#5E75C2","#BB77C4","#FD7EAC"],["#FF9987","#FFC66A","#F9F871"],["#FFB5BC","#97D788","#9BC1AF"],["#FFC7A0","#FFDF79","#FFEAEF"],["#DEBBFF","#9AB0FB","#CFFBE2"]],deleteConfirmation:!1,timelineNameRules:[function(t){return!!t||"Timeline name is required."},function(t){return t&&t.length<=255||"Timeline name is too long."}]}},computed:{meta:function(){return this.$store.state.meta},datasourceErrors:function(){return this.timeline.datasources.filter(function(t){return t.error_message})},datasourcesProcessing:function(){var t=this;return this.datasources.filter(function(e){return"processing"===t.dataSourceStatus(e)||"queueing"===t.dataSourceStatus(e)})},sketch:function(){return this.$store.state.sketch},totalEventsToIndex:function(){var t=this;return this.datasources.filter(function(e){return"processing"===t.dataSourceStatus(e)}).map(function(t){return t.total_file_events}).reduce(function(t,e){return t+e},0)},secondsToComplete:function(){return this.totalEventsToIndex/this.avarageEventsPerSecond()},percentComplete:function(){return Math.floor(this.secondsSinceStart()/this.secondsToComplete*100)||0},iconStatus:function(){return"ready"===this.timelineStatus?"mdi-information-outline":"processing"===this.timelineStatus?"mdi-circle-slice-7":"mdi-alert-circle-outline"},timelineFailed:function(){return"fail"===this.timelineStatus},timelineAvailable:function(){return"ready"===this.timelineStatus||"fail"===this.timelineStatus||this.settings.showProcessingTimelineEvents&&"processing"===this.timelineStatus},timelineChipColor:function(){return this.timeline.color.startsWith("#")?this.timeline.color:"#"+this.timeline.color},settings:function(){return this.$store.state.settings}},methods:{openDialog:function(){this.dialogStatus=!0},rename:function(){this.dialogRename=!1,this.$emit("save",this.timeline,this.newTimelineName)},remove:function(){this.$emit("remove",this.timeline),this.deleteConfirmation=!1,this.successSnackBar("Timeline deleted")},secondsSinceStart:function(){if(!this.datasourcesProcessing.length)return 0;var t=It.A.utc(this.datasourcesProcessing[0].updated_at),e=It.A.utc(),i=e.diff(t,"second");return i},avarageEventsPerSecond:function(){var t=this.eventsPerSecond.reduce(function(t,e){return t+e},0),e=t/this.eventsPerSecond.length||0;return Math.floor(e)},processingETA:function(){var t=this.secondsToComplete-this.secondsSinceStart(),e=(0,It.A)().add(t,"second").fromNow();return e},toggleTimeline:function(){this.timelineFailed||this.$emit("toggle",this.timeline)},updateColor:Lt().debounce(function(t){n["default"].set(this.timeline,"color",t.hex.substring(1)),this.$emit("save",this.timeline)},300),fetchData:function(){var t=this;_.getSketchTimeline(this.sketch.id,this.timeline.id).then(function(e){t.timelineStatus=e.data.objects[0].status[0].status,t.datasources=e.data.objects[0].datasources;var i=t.allIndexedEvents;t.allIndexedEvents=e.data.meta.lines_indexed;var n=t.allIndexedEvents-i;n<1e4&&n>0&&t.eventsPerSecond.push(Math.floor(n/5)),"ready"!==t.timelineStatus&&"fail"!==t.timelineStatus?t.autoRefresh=!0:(t.autoRefresh=!1,t.$store.dispatch("updateSketch",t.sketch.id).then(function(){"ready"!==t.timelineStatus||t.$store.state.enabledTimelines.includes(t.timeline.id)||t.settings.showProcessingTimelineEvents||t.$emit("toggle",e.data.objects[0])}))}).catch(function(t){console.log(t)})},dataSourceStatus:function(t){return t.status[0]?t.status[0].status:"ready"},datasourceStatusColors:function(t){return t.status[0]?"ready"===t.status[0].status||t.status===[]?"success":"processing"===t.status[0].status?"info":"queueing"===t.status[0].status?"warning":"error":"ready"},totalEventsDatasource:function(t){return this.datasources.find(function(e){return e.file_on_disk===t}).total_file_events}},created:function(){this.timelineStatus=this.timeline.status[0].status,this.datasources=this.timeline.datasources;var t=this.meta.stats_per_timeline[this.timeline.id];"processing"===this.timelineStatus?this.autoRefresh=!0:(this.autoRefresh=!1,t&&(this.allIndexedEvents=t["count"])),this.newTimelineName=this.timeline.name},beforeDestroy:function(){clearInterval(this.t),this.t=!1},watch:{autoRefresh:function(t){t&&!this.t?this.t=setInterval(function(){this.fetchData()}.bind(this),5e3):(clearInterval(this.t),this.t=!1)},timeline:function(){this.timeline.datasources.length>this.datasources.length&&this.fetchData()}}},zt=Nt,$t=(0,u.A)(zt,Ct,At,!1,null,"3bd653ac",null),Ft=$t.exports,Rt={props:["timeline","eventsCount","isSelected","isEmptyState"],components:{TsTimelineComponent:Ft},methods:{timelineStyle:function(t){var e=("processing"===t||"ready"===t)&&!this.isSelected;return{opacity:e?"50%":"100%",backgroundColor:this.$vuetify.theme.dark?"#303030":"#f5f5f5"}}}},Pt=Rt,Ot=(0,u.A)(Pt,xt,Tt,!1,null,"1bcea98a",null),Qt=Ot.exports,Mt={components:{TsTimelineChip:Qt},props:["currentQueryFilter","countPerIndex","countPerTimeline"],computed:{sketch:function(){return this.$store.state.sketch},allTimelines:function(){var t=(0,B.A)(this.sketch.timelines);return t=t.sort(function(t,e){return t.name.localeCompare(e.name)}),this.showAll||(t=t.slice(0,20)),t},activeTimelines:function(){var t=(0,B.A)(this.sketch.active_timelines);return t.sort(function(t,e){return t.name.localeCompare(e.name)})},isEmptyState:function(){return void 0===this.countPerTimeline}},data:function(){return{isDarkTheme:!1,isLoading:!1,showAll:!1}},methods:{isSelected:function(t){return this.$store.state.enabledTimelines.includes(t.id)},getCount:function(t){if(this.countPerTimeline){var e=this.countPerTimeline[t.id];if("number"===typeof e)return e}return 0},remove:function(t){var e=this;this.isLoading=!0,_.deleteSketchTimeline(this.sketch.id,t.id).then(function(){e.$store.dispatch("updateSketch",e.sketch.id).then(function(){e.syncSelectedTimelines(),e.isLoading=!1})}).catch(function(t){console.error(t),e.isLoading=!1})},save:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i&&(this.isLoading=!0),_.saveSketchTimeline(this.sketch.id,t.id,i||t.name,t.description,t.color).then(function(){e.$store.dispatch("updateSketch",e.sketch.id).then(function(){e.syncSelectedTimelines(),e.isLoading=!1})}).catch(function(t){console.error(t),e.isLoading=!1})},disableAllOtherTimelines:function(t){this.$store.dispatch("updateEnabledTimelines",[t.id])},toggleTimeline:function(t){this.$store.dispatch("toggleEnabledTimeline",t.id)},toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme},syncSelectedTimelines:function(){var t=this;if(this.currentQueryFilter.indices.includes("_all"))this.updateEnabledTimelinesIfChanged(this.activeTimelines.map(function(t){return t.id}));else{var e=[];this.currentQueryFilter.indices.forEach(function(i){if("string"===typeof i){var n=t.activeTimelines.find(function(t){return t.searchindex.index_name===i});e.push(n)}else if("number"===typeof i){var s=t.activeTimelines.find(function(t){return t.id===i});e.push(s)}}),this.updateEnabledTimelinesIfChanged(e.map(function(t){return t.id}))}},updateEnabledTimelinesIfChanged:function(t){Lt().isEqual(t,this.$store.state.enabledTimelines)||this.$store.dispatch("updateEnabledTimelines",t)}},created:function(){o.$on("isDarkTheme",this.toggleTheme)},watch:{"currentQueryFilter.indices":function(t){this.syncSelectedTimelines()},deep:!0}},qt=Mt,Bt=(0,u.A)(qt,wt,kt,!1,null,"3e509ce6",null),Vt=Bt.exports,Ht=function(){var t=this,e=t._self._c;return e("v-card",{staticStyle:{overflow:"visible"},attrs:{width:"700"}},[e("v-container",{staticClass:"px-8"},[e("br"),e("v-row",[e("v-col",{attrs:{cols:"12"}},[e("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(0,"days")}}},[t._v("Today")]),e("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(7,"days")}}},[t._v("Last 7 days")]),e("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(30,"days")}}},[t._v("Last 30 days")]),e("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(90,"days")}}},[t._v("Last 90 days")]),e("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(1,"year")}}},[t._v("Last 1 year")])],1)],1),e("v-row",[e("v-col",{attrs:{cols:"6"}},[e("v-text-field",{attrs:{value:t.formatStartTime,label:"From",outlined:"","hide-details":""},on:{click:function(e){t.showPicker=!0},change:t.setStartTime}})],1),e("v-col",{attrs:{cols:"6"}},[e("v-text-field",{attrs:{value:t.formatEndTime,label:"To (optional)",outlined:"","hide-details":"","append-outer-icon":t.showPicker?"mdi-calendar-remove":"mdi-calendar"},on:{click:function(e){t.showPicker=!0},change:t.setEndTime,"click:append-outer":function(e){t.showPicker=!t.showPicker}}})],1)],1),t.showPicker?e("v-row",[e("v-col",{attrs:{cols:"12"}},[e("date-picker",{ref:"picker",attrs:{mode:"dateTime",timezone:"UTC","is-dark":t.$vuetify.theme.dark,is24hr:"","is-range":"","is-expanded":""},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)],1):t._e(),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:t.clearAndCancel}},[t._v(" Cancel ")]),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.submit()}}},[t._v(" Add filter ")])],1)],1)],1)},Gt=[],Ut=i(77642),Wt=i.n(Ut),jt={props:["selectedChip"],components:{DatePicker:Wt()},data:function(){return{range:{start:"",end:""},filterTab:null,showPicker:!1}},computed:{dateRange:{set:function(t){t&&t.start&&t.end?(this.range.start=It.A.utc(t.start).millisecond(0).toISOString(),this.range.end=It.A.utc(t.end).millisecond(0).toISOString()):(this.range.start="",this.range.end="")},get:function(){var t={start:this.range.start,end:this.range.end};return t}},formatStartTime:function(){return this.range.start},formatEndTime:function(){return this.range.start!==this.range.end&&this.range.start?this.range.end:""}},created:function(){this.selectedChip&&(this.range.start=this.selectedChip.value.split(",")[0],this.range.end=this.selectedChip.value.split(",")[1])},methods:{getDateRange:function(t,e){var i=It.A.utc(),n=i.subtract(t,e),s="datetime_range",a=n.format("YYYY-MM-DD")+","+i.format("YYYY-MM-DD"),r={field:"",type:s,value:a,operator:"must",active:!0};return this.addChip(r),this.$emit("cancel"),{start:i,end:n}},setStartTime:function(t){t?(this.range.start=It.A.utc(t).toISOString(),this.range.end||this.range.start&&(this.range.end=this.range.start||""),this.$refs.picker.focusDate(this.range.start)):this.range.start=""},setEndTime:function(t){t?(this.range.end=It.A.utc(t).toISOString(),this.$refs.picker.focusDate(this.range.start)):this.range.end=""},addDateTimeChip:function(t){var e="datetime_range",i={field:"",type:e,value:t,operator:"must",active:!0};this.addChip(i),this.range={start:null,end:null}},clearAndCancel:function(){this.range={start:"",end:""},this.$emit("cancel")},addChip:function(t){this.selectedChip?this.$emit("updateChip",t):this.$emit("addChip",t)},submit:function(){if(this.range.start){if(this.range.start===this.range.end){var t=this.range.start.split("T"),e=t[0],i=e+","+e;this.addDateTimeChip(i)}if(this.range.start,this.range.end,this.range.start!==this.range.end){var n="datetime_range",s=this.range.start+","+this.range.end,a={field:"",type:n,value:s,operator:"must",active:!0};this.addChip(a),this.range={start:"",end:""}}this.$emit("cancel")}}}},Yt=jt,Xt=(0,u.A)(Yt,Ht,Gt,!1,null,"be4e6400",null),Jt=Xt.exports,Kt=function(){var t=this,e=t._self._c;return e("ts-upload-timeline-form",{scopedSlots:t._u([{key:"default",fn:function(i){return["small"===t.btnType?e("v-btn",t._g(t._b({attrs:{small:"",text:"",rounded:"",color:"primary"}},"v-btn",i.attrs,!1),i.on),[e("v-icon",{attrs:{left:"",small:""}},[t._v(" mdi-plus ")]),t._v(" Add Timeline ")],1):e("v-btn",t._g(t._b({attrs:{rounded:"",depressed:"",color:"primary"}},"v-btn",i.attrs,!1),i.on),[e("v-icon",{attrs:{left:""}},[t._v(" mdi-plus ")]),t._v(" Add Timeline ")],1)]}}])})},Zt=[],te=(i(62953),function(){var t=this,e=t._self._c;return e("span",[e("v-dialog",{attrs:{persistent:"",width:"700"},model:{value:t.percentageFlag,callback:function(e){t.percentageFlag=e},expression:"percentageFlag"}},[e("v-card",{staticClass:"pa-5",attrs:{flat:""}},[t._v(" Uploading.. "),e("br"),e("br"),e("v-progress-linear",{attrs:{color:"light-blue",height:"25",value:t.percentCompleted}},[t._v(t._s(t.percentCompleted)+"%")]),e("v-divider")],1)],1),e("v-dialog",{attrs:{"max-width":"1000"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[t._t("default",null,{attrs:n,on:i})]}}],null,!0),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e("v-card",[e("v-container",{staticClass:"pa-4"},[e("h3",[t._v(t._s(t.title))]),e("br"),t.error.length>0?e("div",t._l(t.error,function(i,n){return e("v-alert",{key:n,attrs:{outlined:"",type:"error"}},[t._v(" "+t._s(i)+" "),e("br"),e("br"),["csv","jsonl","json"].includes(t.extension)?e("div",[t.headers.length>0?e("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[e("thead",[e("tr",t._l(t.headersTable,function(i){return e("th",{key:i.name,staticClass:"text-left",style:i.color},[t.missingHeaders.includes(i.name)?e("div",[e("v-select",{attrs:{items:t.listHeadersSelectMenu,label:i.name,multiple:"",chips:"",hint:"Mapped to","persistent-hint":""},on:{change:function(e){return t.changeHeaderMapping(e,i.name)}},model:{value:t.mandatoryHeaders.find(function(t){return t.name===i.name}).columnsSelected,callback:function(e){t.$set(t.mandatoryHeaders.find(function(t){return t.name===i.name}),"columnsSelected",e)},expression:"mandatoryHeaders.find((h) => h.name === mandatoryHeader.name).columnsSelected"}})],1):e("div",[e("span",{staticClass:"tag is-large",style:i.color},[e("label",[t._v(t._s(i.name))])])])])}),0)]),e("br"),e("strong",[t._v("Preview")]),e("tbody",t._l(t.numberRows,function(i){return e("tr",{key:i},t._l(t.headersTable,function(n){return e("td",{key:n.name},[t._v(" "+t._s(n.values[i-1])+" ")])}),0)}),0)]},proxy:!0}],null,!0)}):t._e()],1):t._e()])}),1):t._e(),t.fileName?e("div",[e("v-text-field",{attrs:{label:"Timeline Name",outlined:"",clearable:"",rules:t.timelineNameRules},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),"csv"===t.extension?e("v-radio-group",{scopedSlots:t._u([{key:"label",fn:function(){return[e("div",[t._v("Choose "),e("strong",[t._v("CSV delimiter")])])]},proxy:!0}],null,!1,3646347247),model:{value:t.CSVDelimiter,callback:function(e){t.CSVDelimiter=e},expression:"CSVDelimiter"}},t._l(t.delimitersList,function(i,n){return e("v-radio",{key:n,attrs:{value:i},on:{change:function(e){return t.changeCSVDelimiter(i)}},scopedSlots:t._u([{key:"label",fn:function(){return[e("div",[t._v(t._s(n)+" ("+t._s(i)+")")])]},proxy:!0}],null,!0)})}),1):t._e(),t.percentageFlag?t._e():e("v-list",[t._v(" File info "),e("v-simple-table",{attrs:{height:"100px"},scopedSlots:t._u([{key:"default",fn:function(){return[e("thead",[e("tr",t._l(t.fileMetaData,function(i,n){return e("th",{key:n,staticClass:"text-left"},[t._v(" "+t._s(n)+" ")])}),0)]),e("tbody",[e("tr",t._l(t.fileMetaData,function(i,n){return e("td",{key:n,staticClass:"text-left"},[t._v(" "+t._s(i)+" ")])}),0)])]},proxy:!0}],null,!1,3687523482)})],1)],1):e("div",[e("v-file-input",{attrs:{label:"Select file (Plaso/JSONL/CSV)",outlined:"",dense:"",clearable:"",multiple:"","show-size":"","truncate-length":"15",id:"datafile"},on:{change:function(e){return t.setFile(e)},"click:clear":t.clearFormData},model:{value:t.uploadedFiles,callback:function(e){t.uploadedFiles=e},expression:"uploadedFiles"}})],1)]),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){t.dialog=!1}}},[t._v(" Cancel ")]),t.fileName?e("v-btn",{attrs:{text:""},on:{click:function(e){return t.clearFormData()}}},[t._v(" Select another file ")]):t._e(),t.error.length>0||!t.fileName?t._e():e("v-btn",{attrs:{color:"primary",text:"",disabled:!t.form.name||t.form.name.length>255},on:{click:function(e){return t.submitForm()}}},[t._v(" Submit ")])],1)],1)],1)],1)}),ee=[],ie=(i(48598),i(31415),i(17642),i(58004),i(33853),i(45876),i(32475),i(15024),i(31698),i(47764),i(25440),i(79978),i(90744),i(42762),{data:function(){return{headersString:"",valuesString:[],title:"Upload Plaso/JSONL/CSV file",headersMapping:[],mandatoryHeaders:[{name:"datetime",columnsSelected:[]},{name:"message",columnsSelected:[]},{name:"timestamp_desc",columnsSelected:[]}],form:{name:"",file:""},fileName:"",timelineNameRules:[function(t){return!!t||"Timeline name is required."},function(t){return t&&t.length<=255||"Timeline name is too long."}],fileMetaData:{},error:[],percentCompleted:0,uploadedFiles:[],CSVDelimiter:",",infoMessage:"",delimitersList:{Comma:",",Semicolon:";",Pipe:"|"},showHelperFlag:!1,showPreviewFlag:!1,showAddColumnFlag:!1,checkedHeaders:[],staticNumberRows:3,dialog:!1,colors:[{name:"red",value:"background-color: #FEECF0; color:#CC0F35"},{name:"blue",value:"background-color: #EEF6FC; color:#1D72AA"},{name:"green",value:"background-color: #EFFAF3; color:#257942"}]}},computed:{headers:function(){var t=[];return"csv"===this.extension?t=this.headersString.split(this.CSVDelimiter):["json","jsonl"].includes(this.extension)&&(t=Object.keys(this.headersString)),t},missingHeaders:function(){var t=this;return this.mandatoryHeaders.filter(function(e){return t.headers.indexOf(e.name)<0}).map(function(t){return t.name})},listHeadersSelectMenu:function(){var t=new Set(this.mandatoryHeaders.map(function(t){return t.name})),e=this.headers.filter(function(e){return!t.has(e)});return e.unshift("Create New Header"),e},extension:function(){var t=this.fileName.split(".");return t.length>1?t[t.length-1].toLowerCase():null},numberRows:function(){if("csv"===this.extension){var t=this.valuesString.indexOf("");return t<0?this.staticNumberRows:t}return["json","jsonl"].includes(this.extension)?this.valuesString.length:0},percentageFlag:function(){return this.percentCompleted>0},sketch:function(){return this.$store.state.sketch},headersTable:function(){var t=this,e={};if("csv"===this.extension)for(var i=this.valuesString.map(function(e){return e.split(t.CSVDelimiter)}),n=0;n<this.headers.length;n++){for(var s=[],a=0;a<i.length;a++)s.push(i[a][n]);e[this.headers[n]]=s}else if(["json","jsonl"].includes(this.extension))for(var r=0;r<this.valuesString.length;r++)for(var o in this.valuesString[r])o in e?e[o].push(this.valuesString[r][o]):e[o]=[this.valuesString[r][o]];else console.error(this.extension+" file extension not supported for this feature");var l=this.checkedHeaders;return l.sort().map(function(i){var n="",s=[];if(t.headers.includes(i))s=e[i],n=t.colors.find(function(t){return"blue"===t.name}).value;else{var a=t.headersMapping.find(function(t){return t.target===i});if(a){if(a.source)if(1===a.source.length)s=e[a.source[0]];else for(var r=a.source,o=function(t){var i="";r.forEach(function(n){i+=n+": ",i+=JSON.stringify(e[n][t])+" | "}),s.push(i)},l=0;l<t.numberRows;l++)o(l);else s=Array(t.numberRows).fill(a.default_value);n=t.colors.find(function(t){return"green"===t.name}).value}else s=Array(t.numberRows).fill("Header not mapped"),n=t.colors.find(function(t){return"red"===t.name}).value}return{name:i,values:s,color:n}})}},methods:{showHelper:function(){this.showPreviewFlag=!1,this.showAddColumnFlag=!1,this.showHelperFlag=!this.showHelperFlag},showPreview:function(){this.showHelperFlag=!1,this.showPreviewFlag=!this.showPreviewFlag,this.showPreviewFlag||(this.showAddColumnFlag=!1)},showAddColumn:function(){this.showAddColumnFlag=!this.showAddColumnFlag},getDefaultValue:function(t){var e=this.headersMapping.find(function(e){return e["target"]===t});return e?e["default_value"]:null},changeCSVDelimiter:function(t){this.CSVDelimiter=t;for(var e=0;e<this.mandatoryHeaders.length;e++)this.mandatoryHeaders[e]["columnsSelected"]=[];this.headersMapping=[],this.validateFile()},changeHeaderMapping:function(t,e){var i=t[t.length-1],n=this.mandatoryHeaders.findIndex(function(t){return t.name===e});this.mandatoryHeaders[n].columnsSelected="Create New Header"===i?["Create New Header"]:this.mandatoryHeaders[n].columnsSelected.filter(function(t){return"Create New Header"!==t});var s=[],a=null;if("Create New Header"===i){s=null;do{a=prompt("Insert the default value for this header"),a.includes(this.CSVDelimiter)&&(alert("New header value cannot contain CSV separator (found ".concat(this.CSVDelimiter,")")),a=null)}while(!a)}else s=this.mandatoryHeaders[n].columnsSelected;this.headersMapping=this.headersMapping.filter(function(t){return t["target"]!==e}),(null===s||s.length>0)&&this.headersMapping.push({target:e,source:s,default_value:a}),this.validateFile()},clearFormData:function(){this.fileMetaData={},this.form.name="",this.form.file="",this.fileName="",this.headersMapping=[],this.infoMessage="",this.headersString="",this.valuesString=[],this.uploadedFiles=[],this.title="Upload Plaso/JSONL/CSV file",this.error=[],this.percentCompleted=0;for(var t=0;t<this.mandatoryHeaders.length;t++)this.mandatoryHeaders[t]["columnsSelected"]=[]},submitForm:function(){var t=this;if(this.validateFile()){var e=new FormData;if(e.append("file",this.form.file),e.append("name",this.form.name),e.append("provider","WebUpload"),e.append("context",this.fileName),e.append("total_file_size",this.form.file.size),e.append("sketch_id",this.sketch.id),["csv","jsonl","json"].includes(this.extension)){var i=JSON.stringify(this.headersMapping);e.append("headersMapping",i),e.append("delimiter",this.CSVDelimiter)}var n={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){this.percentCompleted=Math.round(100*t.loaded/t.total)}.bind(this)};this.dialog=!1,_.uploadTimeline(e,n).then(function(){t.clearFormData(),t.percentCompleted=0,t.$store.dispatch("updateSketch",t.sketch.id)}).catch(function(t){})}},validateFile:function(){this.error=[],this.form.file.size<=0&&this.error.push("Please select a non empty file");var t=["csv","json","jsonl","plaso"];if(t.includes(this.extension)||this.error.push("Please select a file with a valid extension: "+t.toString()),["csv","jsonl","json"].includes(this.extension)){this.headersMapping.length!==this.missingHeaders.length&&this.error.push("Missing headers: "+this.missingHeaders.toString());var e=this.headersMapping.filter(function(t){return t["source"]}).map(function(t){return t.source});e=e.filter(function(t){return 1===t.length}).map(function(t){return t[0]}),e.length>new Set(e).size&&this.error.push("New headers mapping contains duplicates (".concat(e,")"))}return 0===this.error.length?this.title="Select file to upload":this.title="Almost there... Map the "+this.missingHeaders.length+" missing headers.",0===this.error.length},setFile:function(t){if(t[0]){var e=function(t){return t/Math.pow(1024,2)};this.fileMetaData={Name:t[0].name,Size:e(t[0].size)+" MB"};var i=t[0].name;this.headersMapping=[],this.headersString="",this.valuesString=[],this.form.file=t[0],this.form.name=i.split(".").slice(0,-1).join("."),this.fileName=i,"csv"===this.extension?this.extractCSVHeader():["json","jsonl"].includes(this.extension)?this.extractJSONLHeader():this.validateFile(),this.checkedHeaders=this.mandatoryHeaders.map(function(t){return t.name})}},extractCSVHeader:function(){var t=new FileReader,e=document.getElementById("datafile").files[0],i=this;t.readAsText(e.slice(0,1e4)),t.onloadend=function(t){if(t.target.readyState===FileReader.DONE){var e=t.target.result;i.headersString=e.split("\n")[0].replaceAll('"',"").trim(),i.valuesString=e.split("\n").slice(1,i.staticNumberRows+1),i.validateFile()}}},extractJSONLHeader:function(){var t=new FileReader,e=document.getElementById("datafile").files[0],i=this;t.readAsText(e.slice(0,1e4)),t.onloadend=function(t){if(t.target.readyState===FileReader.DONE){var e=t.target.result,n=e.split("\n").filter(function(t){return""!==t}),s=Math.min(i.staticNumberRows,n.length);try{i.headersString=JSON.parse(n[0]),i.valuesString=n.slice(0,s).map(function(t){return JSON.parse(t)}),i.validateFile()}catch(r){var a=r.message;a+=". Your first lines of JSON: ",a+=n[0],a+=". Be sure to upload a JSON file in a JSONL format.",i.title="Cannot parse the JSON file",i.error.push(a)}}}}}}),ne=ie,se=(0,u.A)(ne,te,ee,!1,null,null,null),ae=se.exports,re={props:["btnType"],components:{TsUploadTimelineForm:ae}},oe=re,le=(0,u.A)(oe,Kt,Zt,!1,null,null,null),ce=le.exports,ue=function(){var t=this,e=t._self._c;return e("v-card",{staticStyle:{overflow:"visible"},attrs:{width:"700"}},[e("v-container",{staticClass:"px-8"},[e("br"),e("v-row",[e("v-col",{attrs:{cols:"12"}},[e("v-text-field",{attrs:{value:t.datetime,label:"Datetime",outlined:"","hide-details":""},on:{click:function(e){t.showPicker=!0}},model:{value:t.datetime,callback:function(e){t.datetime=e},expression:"datetime"}})],1)],1),t.showPicker?e("v-row",[e("v-col",{attrs:{cols:"12"}},[e("date-picker",{ref:"picker",attrs:{mode:"dateTime",timezone:"UTC","is-dark":t.$vuetify.theme.dark,is24hr:"","is-date":"","is-expanded":""},model:{value:t.dateFromPicker,callback:function(e){t.dateFromPicker=e},expression:"dateFromPicker"}})],1)],1):t._e(),e("v-row",[e("v-col",{attrs:{cols:"12"}},[e("v-text-field",{attrs:{value:t.message,label:"Message",outlined:"","hide-details":""},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1)],1),e("v-row",[e("v-col",{attrs:{cols:"12"}},[e("v-text-field",{attrs:{value:t.timestampDesc,label:"Timestamp Description",outlined:"","hide-details":""},model:{value:t.timestampDesc,callback:function(e){t.timestampDesc=e},expression:"timestampDesc"}})],1)],1),t._l(t.attributes,function(i,n){return e("v-row",{key:n},[e("v-col",{attrs:{cols:"6"}},[e("v-text-field",{attrs:{label:"Attribute Name",outlined:"","hide-details":""},model:{value:t.attributes[n].name,callback:function(e){t.$set(t.attributes[n],"name",e)},expression:"attributes[index].name"}})],1),e("v-col",{attrs:{cols:"6"}},[e("v-text-field",{attrs:{label:"Attribute Value",outlined:"","hide-details":""},model:{value:t.attributes[n].value,callback:function(e){t.$set(t.attributes[n],"value",e)},expression:"attributes[index].value"}})],1)],1)}),e("v-card-actions",[e("v-btn",{attrs:{text:"",color:"primary",disabled:t.isDisabled},on:{click:function(e){return t.attributes.push({name:"",value:""})}}},[e("v-icon",[t._v("mdi-plus")]),t._v(" Add Attribute ")],1),e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){return t.clearAndCancel()}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:t.submit}},[t._v(" Save ")])],1)],2)],1)},de=[],he={props:["datetimeProp"],components:{DatePicker:Wt()},data:function(){return{message:null,timestampDesc:null,filterTab:null,showPicker:!1,attributes:[],datetime:this.datetimeProp}},watch:{datetimeProp:function(t){this.datetime=t}},computed:{dateFromPicker:{set:function(t){null!==t&&(this.datetime=It.A.utc(t).millisecond(0).toISOString())},get:function(){return this.datetime}},isDisabled:function(){return this.attributes.some(function(t){return""===t.name||""===t.value})}},methods:{clearAndCancel:function(){this.datetime=null,this.message=null,this.timestampDesc=null,this.attributes=[],this.$emit("cancel")},submit:function(){var t=this;if(null!==this.datetime&&null!==this.message&&null!==this.timestampDesc){var e=this.$store.state.sketch.id,i={headers:{"Content-Type":"application/json"}},n={};this.attributes.filter(function(t){return!(""===t.name||""===t.value)}).reduce(function(t,e){n[e.name]=e.value},n),_.createEvent(e,this.datetime,this.message,this.timestampDesc,n,i).then(function(e){t.clearAndCancel()}).catch(function(t){})}}}},me=he,ve=(0,u.A)(me,ue,de,!1,null,"5d3fffad",null),pe=ve.exports,fe=function(){var t=this,e=t._self._c;return e("div",[e("v-alert",{attrs:{dense:"",dismissible:"",type:"info"},model:{value:t.showBanner,callback:function(e){t.showBanner=e},expression:"showBanner"}},[t._v(" Data may be incomplete. Some timelines are still loading. ")]),e("v-dialog",{attrs:{width:"700"},model:{value:t.exportDialog,callback:function(e){t.exportDialog=e},expression:"exportDialog"}},[e("v-card",{staticClass:"pa-5",attrs:{flat:""}},[e("v-progress-circular",{attrs:{indeterminate:"",size:"20",width:"1"}}),e("span",{staticClass:"ml-5"},[t._v("Exporting "+t._s(t.totalHits)+" events")])],1)],1),t.disableSaveSearch?t._e():e("v-dialog",{attrs:{width:"500"},model:{value:t.saveSearchMenu,callback:function(e){t.saveSearchMenu=e},expression:"saveSearchMenu"}},[e("v-card",{staticClass:"pa-4"},[e("h3",[t._v("Save Search")]),e("br"),e("v-text-field",{attrs:{clearable:"",required:"",placeholder:"Name your saved search",outlined:"",dense:"",autofocus:"",rules:t.saveSearchNameRules},on:{focus:function(t){return t.target.select()}},model:{value:t.saveSearchFormName,callback:function(e){t.saveSearchFormName=e},expression:"saveSearchFormName"}}),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){t.saveSearchMenu=!1}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{text:"",color:"primary",disabled:!t.saveSearchFormName||t.saveSearchFormName.length>255},on:{click:t.saveSearch}},[t._v(" Save ")])],1)],1)],1),t.eventList.objects.length||t.searchInProgress||t.currentQueryString?t._e():e("div",[e("ts-explore-welcome-card")],1),t.eventList.objects.length||t.searchInProgress||!t.currentQueryString?t._e():e("div",{staticClass:"ml-3"},[e("ts-search-not-found-card",{attrs:{currentQueryString:t.currentQueryString,filterChips:t.filterChips,disableSaveSearch:t.disableSaveSearch},on:{"save-search-clicked":function(e){t.saveSearchMenu=!0}}})],1),t.highlightEvent?e("div",{staticClass:"mt-4"},[e("strong",[t._v("Showing context for event:")]),e("v-sheet",{staticClass:"d-flex flex-wrap mt-1 mb-5"},[e("v-sheet",{staticClass:"flex-1-0"},[e("span",{staticClass:"datetime-table-cell pa-2",staticStyle:{width:"200px"},style:t.getTimelineColor(t.highlightEvent)},[t._v(" "+t._s(t._f("toISO8601")(t._f("formatTimestamp")(t.highlightEvent._source.timestamp)))+" ")])]),e("v-sheet",{},[e("span",{staticClass:"datetime-table-cell pa-2"},[t._v(" "+t._s(t.highlightEvent._source.message)+" ")])])],1)],1):t._e(),e("div",{staticClass:"ts-event-list-container"},[(t.eventList.objects.length>0||t.searchInProgress)&&t.userSettings.eventSummarization&&!t.eventList.meta.summaryError?e("v-card",{staticClass:"ts-ai-summary-card",attrs:{outlined:""}},[e("v-card-title",{staticClass:"ts-ai-summary-card-title"},[e("v-btn",{staticClass:"ts-ai-summary-fold-btn",attrs:{icon:"",small:""},on:{click:t.toggleSummary}},[e("v-icon",[t._v(t._s(t.summaryCollapsed?"mdi-chevron-down":"mdi-chevron-up"))])],1),e("v-icon",{staticClass:"ml-1 mr-2 ts-ai-summary-icon",attrs:{small:"",color:"primary"}},[t._v("mdi-shimmer")]),e("div",{staticClass:"ts-ai-summary-text-group"},[e("span",{staticClass:"ts-ai-summary-title"},[t._v("AI Summary")]),t.eventList.objects.length>0?e("span",{staticClass:"ts-ai-summary-subtitle"},[t._v(" (for "+t._s(t.eventList.objects.length)+" events in this view) ")]):t._e()]),e("v-btn",{staticClass:"ml-1 ts-ai-summary-info-btn",attrs:{icon:"",small:"",title:t.summaryInfoMessage}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-information-outline")])],1)],1),e("v-card-text",{directives:[{name:"show",rawName:"v-show",value:!t.summaryCollapsed,expression:"!summaryCollapsed"}],staticClass:"ts-ai-summary-text"},[t.isSummaryLoading||!t.eventList.meta.summary?e("div",[e("div",{staticClass:"ts-summary-placeholder-line shimmer"}),e("div",{staticClass:"ts-summary-placeholder-line shimmer short"}),e("div",{staticClass:"ts-summary-placeholder-line shimmer long"})]):e("div",{domProps:{innerHTML:t._s(t.eventList.meta.summary)}})])],1):t._e()],1),t.eventList.objects.length||t.searchInProgress?e("div",[e("v-data-table",{attrs:{headers:t.headers,items:t.eventList.objects,"footer-props":{"items-per-page-options":[10,40,80,100,200,500],"show-current-page":!0},loading:t.searchInProgress,options:t.tableOptions,"server-items-length":t.totalHitsForPagination,"item-key":"_id","loading-text":"Searching... Please wait","show-select":"","disable-filtering":"","must-sort":"","sort-desc":t.sortOrderAsc,"sort-by":"_source.timestamp","hide-default-footer":t.totalHits<11||t.disablePagination,expanded:t.expandedRows,dense:t.displayOptions.isCompact,"fixed-header":""},on:{"update:options":function(e){t.tableOptions=e},"update:sortDesc":function(e){t.sortOrderAsc=e},"update:sort-desc":[function(e){t.sortOrderAsc=e},t.sortEvents]},scopedSlots:t._u([{key:"top",fn:function(i){var n=i.pagination,s=i.options,a=i.updateOptions;return[e("v-toolbar",{attrs:{dense:"",flat:"",color:"transparent"}},[t.selectedEvents.length?e("div",{staticClass:"actions"},[e("small",{staticClass:"mr-2"},[t._v("Actions:")]),e("v-btn",{attrs:{"x-small":"",outlined:""},on:{click:function(e){return t.toggleMultipleStars()}}},[e("v-icon",{attrs:{left:"",color:"amber"}},[t._v("mdi-star")]),t._v(" Toggle star ")],1),e("v-menu",{attrs:{"offset-x":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({attrs:{"x-small":"",outlined:""}},"v-btn",s,!1),n),[e("v-icon",{attrs:{left:""}},[t._v("mdi-tag-plus-outline")]),t._v(" Modify Tags ")],1)]}}],null,!0),model:{value:t.showEventTagMenu,callback:function(e){t.showEventTagMenu=e},expression:"showEventTagMenu"}},[e("ts-event-tag-dialog",{attrs:{events:t.selectedEvents},on:{close:function(e){t.showEventTagMenu=!1}}})],1)],1):e("div",[e("span",{staticStyle:{display:"inline-block","min-width":"200px"}},[e("small",[t._v(t._s(t.fromEvent)+"-"+t._s(t.toEvent)+" of "+t._s(t.totalHits)+" events ("+t._s(t.totalTime)+"s)")])]),[t.disableSaveSearch?t._e():e("v-btn",{attrs:{icon:""},on:{click:function(e){t.saveSearchMenu=!0}}},[e("v-icon",{attrs:{title:"Save current search"}},[t._v("mdi-content-save-outline")])],1)],[t.disableHistogram?t._e():e("v-btn",{attrs:{icon:""},on:{click:function(e){t.showHistogram=!t.showHistogram}}},[e("v-icon",{attrs:{title:"Toggle event histogram"}},[t._v("mdi-chart-bar")])],1)],t.disableColumns?t._e():e("v-dialog",{attrs:{"max-width":"500px",scrollable:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",s,!1),n),[e("v-icon",{attrs:{title:"Modify columns"}},[t._v("mdi-view-column-outline")])],1)]}}],null,!0),model:{value:t.columnDialog,callback:function(e){t.columnDialog=e},expression:"columnDialog"}},[e("v-card",{attrs:{height:"50vh"}},[e("v-card-title",[t._v("Select columns")]),e("v-card-text",[e("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.searchColumns,callback:function(e){t.searchColumns=e},expression:"searchColumns"}}),e("br"),e("v-data-table",{attrs:{headers:t.columnHeaders,items:t.meta.mappings,search:t.searchColumns,"hide-default-footer":!0,"item-key":"field","disable-pagination":"","show-select":"",dense:""},on:{input:t.updateSelectedFields},model:{value:t.selectedFields,callback:function(e){t.selectedFields=e},expression:"selectedFields"}})],1),e("v-divider"),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){t.selectedFields=[{field:"message",type:"text"}]}}},[t._v(" Reset ")]),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.columnDialog=!1}}},[t._v(" Set columns ")])],1)],1)],1),e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.exportSearchResult()}}},[e("v-icon",{attrs:{title:"Download current view as CSV"}},[t._v("mdi-download")])],1),t.disableSettings?t._e():e("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",s,!1),n),[e("v-icon",{attrs:{title:"View settings"}},[t._v("mdi-dots-horizontal")])],1)]}}],null,!0)},[e("v-card",{staticClass:"mx-auto",attrs:{outlined:"","max-width":"475"}},[e("v-list",{attrs:{subheader:"","two-line":"",flat:"",dense:""}},[e("v-subheader",[t._v("Density")]),e("v-list-item-group",[e("v-list-item",{attrs:{ripple:!1}},[[e("v-list-item-action",[e("v-radio-group",{model:{value:t.displayOptions.isCompact,callback:function(e){t.$set(t.displayOptions,"isCompact",e)},expression:"displayOptions.isCompact"}},[e("v-radio",{attrs:{value:!1}})],1)],1),e("v-list-item-content",[e("v-list-item-title",[t._v("Comfortable")]),e("v-list-item-subtitle",[t._v("More space between rows")])],1)]],2),e("v-list-item",{attrs:{ripple:!1}},[[e("v-list-item-action",[e("v-radio-group",{model:{value:t.displayOptions.isCompact,callback:function(e){t.$set(t.displayOptions,"isCompact",e)},expression:"displayOptions.isCompact"}},[e("v-radio",{attrs:{value:!0}})],1)],1),e("v-list-item-content",[e("v-list-item-title",[t._v("Compact")]),e("v-list-item-subtitle",[t._v("Less space between rows")])],1)]],2)],1),e("v-divider"),e("v-list",{attrs:{subheader:"","two-line":"",flat:""}},[e("v-subheader",[t._v("Misc")]),e("v-list-item-group",[e("v-list-item",{attrs:{ripple:!1}},[e("v-list-item-action",[e("v-switch",{attrs:{dense:"",color:""},model:{value:t.displayOptions.showTags,callback:function(e){t.$set(t.displayOptions,"showTags",e)},expression:"displayOptions.showTags"}})],1),e("v-list-item-content",[e("v-list-item-title",[t._v("Tags")]),e("v-list-item-subtitle",[t._v("Show tags")])],1)],1)],1),e("v-list-item-group",[e("v-list-item",{attrs:{ripple:!1}},[e("v-list-item-action",[e("v-switch",{attrs:{dense:""},model:{value:t.displayOptions.showEmojis,callback:function(e){t.$set(t.displayOptions,"showEmojis",e)},expression:"displayOptions.showEmojis"}})],1),e("v-list-item-content",[e("v-list-item-title",[t._v("Emojis")]),e("v-list-item-subtitle",[t._v("Show emojis")])],1)],1)],1),e("v-list-item-group",[e("v-list-item",{attrs:{ripple:!1}},[e("v-list-item-action",[e("v-switch",{attrs:{dense:""},model:{value:t.displayOptions.showTimelineName,callback:function(e){t.$set(t.displayOptions,"showTimelineName",e)},expression:"displayOptions.showTimelineName"}})],1),e("v-list-item-content",[e("v-list-item-title",[t._v("Timeline name")]),e("v-list-item-subtitle",[t._v("Show timeline name")])],1)],1)],1)],1)],1)],1)],1)],2),e("v-spacer"),t.totalHits>11&&!t.disablePagination?e("v-data-footer",{staticClass:"mr-n3",staticStyle:{border:"0"},attrs:{pagination:n,options:s,"show-current-page":!0,"items-per-page-options":[10,40,80,100,200,500],"items-per-page-text":"Rows per page:"},on:{"update:options":a}}):t._e()],1),t.showHistogram?e("v-card",{staticClass:"my-3",attrs:{outlined:""}},[e("v-toolbar",{attrs:{dense:"",flat:"",color:"transparent"}},[e("v-spacer"),t.timeFilterChips.length?e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.removeChips(t.timeFilterChips)}}},[t._v(" reset ")]):t._e(),e("v-btn",{attrs:{icon:""},on:{click:function(e){t.showHistogram=!1}}},[e("v-icon",{attrs:{title:"Close histogram"}},[t._v("mdi-close")])],1)],1),e("ts-bar-chart",{attrs:{"chart-data":t.eventList.meta.count_over_time},on:{addChip:function(e){return t.addChipFromHistogram(e)}}})],1):t._e()]}},{key:t.expandedItemSlot,fn:function(i){var n=i.headers,s=i.item;return[e("td",{attrs:{colspan:n.length}},[s.showDetails?e("v-container",{staticClass:"mt-4",attrs:{fluid:""}},[e("ts-event-detail",{attrs:{event:s}})],1):t._e(),s.showDetails&&s.deltaDays?e("v-divider"):t._e(),s.deltaDays>0?e("div",{staticClass:"ml-7"},[e("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color",style:t.getTimeBubbleColor(s)}),e("div",{staticClass:"ts-time-bubble ts-time-bubble-color",style:t.getTimeBubbleColor(s)},[e("div",{staticClass:"ts-time-bubble-text"},[e("b",[t._v(t._s(t._f("compactNumber")(s.deltaDays)))]),t._v(" days ")])]),e("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color",style:t.getTimeBubbleColor(s)})]):t._e()],1)]}},{key:t.itemActionsSlot,fn:function(i){var n=i.item;return[e("v-btn",{attrs:{small:"",icon:""},on:{click:function(e){return t.toggleStar(n)}}},[n._source.label.includes("__ts_star")?e("v-icon",{attrs:{title:"Toggle star status",color:"amber"}},[t._v("mdi-star")]):e("v-icon",{attrs:{title:"Toggle star status"}},[t._v("mdi-star-outline")])],1),e("ts-event-tag-menu",{attrs:{event:n}}),e("ts-event-action-menu",{attrs:{event:n},on:{showContextWindow:function(e){return t.showContextWindow(e)}}})]}},{key:t.itemTimestampSlot,fn:function(i){var n=i.item;return[e("v-tooltip",{attrs:{right:"","open-delay":"700"},scopedSlots:t._u([{key:"activator",fn:function(i){var s=i.on,a=i.attrs;return[e("div",t._g(t._b({staticClass:"datetime-table-cell",style:t.getTimelineColor(n)},"div",a,!1),s),[t._v(" "+t._s(t._f("toISO8601")(t._f("formatTimestamp")(n._source.timestamp)))+" ")])]}}],null,!0)},[e("span",[t._v(t._s(t.getTimeline(n).name))])])]}},t._l(t.headers,function(i,n){return{key:t.getFieldName(i.text),fn:function(s){var a=s.item;return[e("div",{key:i.text,staticClass:"ts-event-field-container",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.toggleDetailedEvent(a)}}},[e("span",{class:{"ts-event-field-ellipsis":"message"===i.text,"ts-event-field-highlight":a._id===t.highlightEventId}},[t.displayOptions.showTags&&3===n&&"tag"in a._source&&a._source.tag.length>0?e("span",[e("ts-event-tags",{attrs:{item:a,tagConfig:t.tagConfig,showDetails:a.showDetails}})],1):t._e(),t.displayOptions.showEmojis&&3===n?e("span",t._l(a._source.__ts_emojis,function(i){return e("span",{key:i,staticClass:"mr-2",attrs:{title:t.meta.emojis[i]},domProps:{innerHTML:t._s(i+";")}})}),0):t._e(),e("span",[t._v(t._s(a._source[i.text]))])])])]}}}),{key:t.itemTimelineNameSlot,fn:function(i){var n=i.item;return[e("v-chip",{staticStyle:{"margin-top":"1px","margin-bottom":"1px","font-size":"0.8em"},attrs:{label:""}},[e("span",{staticClass:"timeline-name-ellipsis",staticStyle:{width:"130px","text-align":"center"}},[t._v(t._s(t.getTimeline(n).name))])])]}},{key:t.itemCommentSlot,fn:function(i){var n=i.item;return[e("div",{staticClass:"d-inline-block"},[n._source.comment.length?e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.toggleDetailedEvent(n)}}},[e("v-badge",{attrs:{"offset-y":10,"offset-x":10,bordered:"",content:n._source.comment.length}},[e("v-icon",{attrs:{title:n["showDetails"]?"Close event & comments":"Open event & comments",small:""}},[t._v(" mdi-comment-text-multiple-outline ")])],1)],1):t._e()],1),!n["showDetails"]||n._source.comment.length||n.showComments?t._e():e("div",{staticClass:"d-inline-block"},[e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.newComment(n)}}},[e("v-icon",{attrs:{title:"Add a comment"}},[t._v(" mdi-comment-plus-outline ")])],1)],1),n["showDetails"]&&!n._source.comment.length&&n.showComments?e("div",{staticClass:"d-inline-block"},[e("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){n.showComments=!1}}},[e("v-icon",{attrs:{title:"Close comments"}},[t._v(" mdi-comment-remove-outline ")])],1)],1):t._e()]}}],null,!0),model:{value:t.selectedEvents,callback:function(e){t.selectedEvents=e},expression:"selectedEvents"}})],1):t._e()],1)},ge=[],ye=(i(2892),i(3296),i(27208),i(48408),i(14603),i(47566),i(98721),{methods:{getTimeline:function(t){var e=this.$store.state.meta.indices_metadata[t._index].is_legacy;return e?this.$store.state.sketch.active_timelines.find(function(e){return e.searchindex.index_name===t._index}):this.$store.state.sketch.active_timelines.find(function(e){return e.id===t._source.__ts_timeline_id})}}}),_e=function(){var t=this,e=t._self._c;return e("div",[e("apexchart",{attrs:{height:"250",options:t.options,series:t.series}})],1)},be=[],Se=(i(5506),i(57588)),we=i.n(Se),ke={props:["chartData"],components:{Apexchart:we()},data:function(){var t=this;return{options:{chart:{type:"bar",zoom:{enabled:!1,type:"x",autoScaleYaxis:!0},foreColor:"#fff",animations:{enabled:!0,easing:"easeinout",speed:50,animateGradually:{enabled:!0,delay:50},dynamicAnimation:{enabled:!0,speed:50}},colors:["#4285f"],toolbar:{show:!0,tools:{download:!1,selection:!0,zoom:!0,zoomin:!0,zoomout:!0}},events:{dataPointSelection:function(e,i,n){t.emitFilterRequest(n)}}},tooltip:{enabled:!0,followCursor:!1,theme:"dark",x:{formatter:function(e){var i=t.getBucketDateTimeRange(e),n=t.$moment.duration(i.start.diff(i.end));return"".concat(i.start.format("YYYY-MM-DD HH:mm:ss")," + ").concat(n.humanize())}}},plotOptions:{bar:{columnWidth:"95%",borderRadius:4}},dataLabels:{enabled:!1},grid:{xaxis:{lines:{show:!1}},yaxis:{lines:{show:!1}}},xaxis:{type:"datetime",tickPlacement:"on"}}}},computed:{series:function(){var t={name:"Events",data:[]};return this.chartData?(t.data=Object.entries(this.chartData.data).map(function(t){return[parseInt(t[0]),t[1]]}),[t]):[t]}},methods:{getBucketDateTimeRange:function(t){var e=this.$moment.utc(t),i=this.chartData.interval.split(/(\d+)/),n=i[1],s=i[2],a=this.$moment.utc(t).add(parseInt(n),s);return{start:e,end:a}},emitFilterRequest:function(t){var e=t.selectedDataPoints[0][0],i=t.w.config.series[0]["data"];if(1!==i.length){var n=i[e][0],s=this.getBucketDateTimeRange(n),a={field:"",type:"datetime_range",value:s.start.toISOString()+","+s.end.toISOString(),operator:"must",active:!0};this.$emit("addChip",a)}},setTheme:function(){"dark"===localStorage.theme?this.options={chart:{foreColor:"#fff"},tooltip:{theme:"dark"}}:this.options={chart:{foreColor:"#333"},tooltip:{theme:"light"}}}},created:function(){o.$on("isDarkTheme",this.setTheme)},mounted:function(){this.setTheme()}},xe=ke,Te=(0,u.A)(xe,_e,be,!1,null,null,null),Ce=Te.exports,Ae=function(){var t=this,e=this,i=e._self._c;return i("div",[i("v-row",[i("v-col",{attrs:{cols:e.event.showComments?8:0}},[i("v-card",{attrs:{outlined:"",height:"100%"}},[i("v-simple-table",{attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[i("tbody",e._l(e.fullEventFiltered,function(t,n){return i("tr",{key:n,on:{mouseover:function(t){e.c_key=n},mouseleave:function(t){e.c_key=-1}}},[n==e.c_key?i("td",{staticClass:"text-right",staticStyle:{"min-width":"105px"}},[e.ignoredAggregatorFields.has(n)?e._e():i("v-btn",{staticClass:"mr-1",attrs:{icon:"","x-small":""},on:{click:function(i){return i.stopPropagation(),e.loadAggregation(n,t)}}},[i("v-icon",{attrs:{title:"Aggregation dialog"}},[e._v("mdi-chart-bar")])],1),e.ignoreFilterChips.has(n)?e._e():i("v-btn",{staticClass:"mr-1",attrs:{icon:"","x-small":""},on:{click:function(i){return i.stopPropagation(),e.applyFilterChip(n,t,"must")}}},[i("v-icon",{attrs:{title:"Filter for value"}},[e._v("mdi-filter-plus-outline")])],1),e.ignoreFilterChips.has(n)?e._e():i("v-btn",{staticClass:"mr-1",attrs:{icon:"","x-small":""},on:{click:function(i){return i.stopPropagation(),e.applyFilterChip(n,t,"must_not")}}},[i("v-icon",{attrs:{title:"Filter out value"}},[e._v("mdi-filter-minus-outline")])],1),i("v-btn",{staticClass:"pr-1",staticStyle:{cursor:"pointer"},attrs:{icon:"","x-small":""},on:{click:function(t){return e.copyToClipboard(n)}}},[i("v-icon",{attrs:{title:"Copy attribute name",small:""}},[e._v("mdi-content-copy")])],1)],1):i("td",[i("div",{staticClass:"px-12"})]),i("td",[e._v(" "+e._s(n)+" ")]),e.checkContextLinkDisplay(n,t)||n==e.c_key?i("td",{staticClass:"text-right pr-1"},[i("v-btn",{directives:[{name:"show",rawName:"v-show",value:n==e.c_key,expression:"key == c_key"}],staticStyle:{cursor:"pointer"},attrs:{icon:"","x-small":""},on:{click:function(i){return e.copyToClipboard(t)}}},[i("v-icon",{attrs:{small:"",title:"Copy attribute value"}},[e._v("mdi-content-copy")])],1),e.checkContextLinkDisplay(n,t)?i("v-menu",{attrs:{"offset-y":"",transition:"slide-y-transition"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({staticStyle:{cursor:"pointer"},attrs:{icon:"",color:"primary","x-small":""}},"v-btn",s,!1),n),[i("v-icon",{attrs:{title:"Context Lookup",small:""}},[e._v(" mdi-open-in-new ")])],1)]}}],null,!0)},[i("v-list",{attrs:{dense:""}},[i("v-dialog",{attrs:{"max-width":"515","retain-focus":!1},model:{value:e.redirectWarnDialog,callback:function(t){e.redirectWarnDialog=t},expression:"redirectWarnDialog"}},[i("ts-link-redirect-warning",{attrs:{app:"","context-value":e.contextValue,"context-url":e.contextUrl},on:{cancel:function(t){e.redirectWarnDialog=!1}}})],1),i("v-dialog",{staticClass:"asdf",attrs:{"max-width":"80%","min-width":"1000px","max-height":"80%","min-height":"600px","retain-focus":!1},model:{value:e.dfirUnfurlDialog,callback:function(t){e.dfirUnfurlDialog=t},expression:"dfirUnfurlDialog"}},[i("ts-unfurl-dialog",{attrs:{url:e.contextValue},on:{cancel:function(t){e.dfirUnfurlDialog=!1}}})],1),i("v-dialog",{model:{value:e.formatXMLString,callback:function(t){e.formatXMLString=t},expression:"formatXMLString"}},[i("ts-format-xml-string",{attrs:{xmlString:t},on:{close:function(t){e.formatXMLString=!1}}})],1),e._l(e.getContextLinkItems(n),function(s,a){return i("v-list-item",{key:a,staticStyle:{cursor:"pointer"},on:{click:function(i){return i.stopPropagation(),e.contextLinkRedirect(n,s,t)}}},[e.getContextLinkRedirectState(n,s)?i("v-list-item-title",[e._v(" "+e._s(s)+" (ext.)")]):i("v-list-item-title",[e._v(e._s(s))])],1)})],2)],1):e._e()],1):i("td",[i("div",{staticClass:"px-5"})]),i("td",{staticClass:"pl-0",attrs:{width:"100%"}},[e._v(" "+e._s(t)+" ")])])}),0)]},proxy:!0}])})],1)],1),i("v-slide-x-reverse-transition",[i("v-col",{directives:[{name:"show",rawName:"v-show",value:e.event.showComments,expression:"event.showComments"}],attrs:{cols:"4"}},[i("ts-comments",{attrs:{comments:e.comments,event:e.event,currentSearchNode:e.currentSearchNode}})],1)],1)],1),i("v-dialog",{attrs:{scrollable:""},on:{"click:outside":function(e){return t.aggregatorDialog=!1}},model:{value:e.aggregatorDialog,callback:function(t){e.aggregatorDialog=t},expression:"aggregatorDialog"}},[i("ts-aggregate-dialog",{attrs:{eventKey:e.eventKey,eventValue:e.eventValue,eventTimestamp:e.eventTimestamp,eventTimestampDesc:e.eventTimestampDesc,reloadData:e.aggregatorDialog},on:{cancel:function(t){e.aggregatorDialog=!1}}})],1),i("br")],1)},De=[],Le=i(27262),Ie=(i(1480),i(84864),i(57465),i(87745),i(90906),function(){var t=this,e=t._self._c;return e("v-card",{staticClass:"mx-auto"},[e("v-toolbar",{attrs:{dense:"",flat:""}},[e("h3",{staticClass:"ml-6",staticStyle:{"white-space":"nowrap"}},[t._v("Event Data Analytics")]),e("div",[e("v-chip",{staticClass:"ml-2",attrs:{outlined:""}},[t._v("Field:Â "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(this.eventKey))])]),e("v-chip",{staticClass:"ml-2",attrs:{outlined:""}},[t._v("Value:Â "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(this.truncateValue(this.eventValue)))])]),e("v-chip",{staticClass:"ml-2",attrs:{outlined:""}},[t._v("Event datetime:Â "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(this.eventDateTime))])])],1),e("v-spacer"),e("v-btn",{attrs:{icon:""},on:{click:t.clearAndCancel}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-card-text",[e("v-container",{attrs:{fluid:""}},[e("v-row",{attrs:{justify:"center"}},[e("v-col",[e("v-card",{attrs:{outlined:"",height:"146px",loading:!t.statsReady}},[e("v-card-title",[t._v(" Sketch statistics ")]),t.statsReady?e("v-simple-table",{staticClass:"px-2 mt-n4",attrs:{dense:""}},[e("tbody",[e("tr",[e("td",{attrs:{width:"200px"}},[t._v("Total number of events")]),e("td",[e("strong",[t._v(t._s(this.formatNumber(this.docCount)))])])]),e("tr",[e("td",{attrs:{width:"200px"}},[t._v("First event")]),e("td",{staticStyle:{"white-space":"nowrap"}},[e("strong",[t._v(t._s(this.fieldDateTimeMinimum))])])]),e("tr",[e("td",{attrs:{width:"200px"}},[t._v("Last event")]),e("td",[e("strong",[t._v(t._s(this.fieldDateTimeMaximum))])])])])]):t._e()],1),e("v-card",{staticClass:"mt-1",attrs:{outlined:"",height:"146px",loading:!t.statsReady}},[e("v-card-title",[t._v(" Field statistics ")]),t.statsReady?e("v-simple-table",{staticClass:"px-2 mt-n4",attrs:{dense:""}},[e("tbody",[e("tr",[e("td",{attrs:{width:"200px"}},[t._v("Field name")]),e("td",[e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(this.eventKey))])])]),e("tr",[e("td",{attrs:{width:"200px"}},[t._v("Total number of events")]),e("td",[e("strong",[t._v(t._s(this.fieldValueCount))])])]),e("tr",[e("td",{attrs:{width:"200px"}},[t._v("Number of unique values")]),e("td",[e("strong",[t._v(t._s(this.fieldCardinality))])])])])]):t._e()],1),e("v-card",{staticClass:"mt-1",attrs:{outlined:"",height:"180px",loading:!t.statsReady}},[e("v-card-title",[t._v(" Value statistics ")]),t.statsReady?e("v-simple-table",{staticClass:"px-2 mt-n4",attrs:{dense:""}},[e("tbody",[e("tr",[e("td",{attrs:{width:"200px"}},[t._v("Field value")]),e("td",[e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(this.eventValue))])])]),e("tr",[e("td",{attrs:{width:"200px"}},[t._v("Total number of events")]),e("td",[e("strong",[t._v(t._s(this.valueEventCount))])])]),e("tr",[e("td",{attrs:{width:"200px"}},[t._v("First event")]),e("td",[e("strong",[t._v(t._s(this.valueDateTimeMinimum))])])]),e("tr",[e("td",{attrs:{width:"200px"}},[t._v("Last event")]),e("td",[e("strong",[t._v(t._s(this.valueDateTimeMaximum))])])])])]):t._e()],1)],1),e("v-col",{attrs:{align:"center"}},[e("v-card",{attrs:{outlined:"",height:"480px",loading:!t.statsReady}},[e("v-card-title",[t._v(" Top "+t._s(Math.min(10,this.commonValues.length))+" Â "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(t.eventKey))]),t._v("Â  values "),e("v-spacer"),e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on;return[e("v-icon",t._g({attrs:{color:"primary"}},n),[t._v("mdi-information-outline")])]}}])},[e("span",[t._v("The top "+t._s(Math.min(10,this.commonValues.length))+" most common Â "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(t.eventKey))]),t._v("Â  values (out of "+t._s(this.fieldCardinality)+" unique values). ")])])],1),e("v-card-text",[e("v-data-table",{attrs:{headers:t.termHeaders,items:t.commonValues,"items-per-page":10,"hide-default-footer":t.commonValues.length<=10,dense:""}})],1)],1)],1),e("v-col",{attrs:{align:"center"}},[e("v-card",{attrs:{outlined:"",height:"480px",loading:!t.statsReady}},[e("v-card-title",[t._v(" Rare Â "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(t.eventKey))]),t._v("Â  values "),e("v-spacer"),e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on;return[e("v-icon",t._g({attrs:{color:"primary"}},n),[t._v("mdi-information-outline")])]}}])},[e("span",[t._v("Rare Â "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(t.eventKey))]),t._v("Â  events that have a maximum event count of 5 ")])])],1),e("v-card-text",[e("v-data-table",{attrs:{headers:t.termHeaders,items:t.rareValues,"items-per-page":10,"hide-default-footer":t.rareValues.length<=10,"footer-props":{disableItemsPerPage:!0},dense:""}})],1)],1)],1)],1),e("v-row",[e("v-col",{attrs:{align:"center"}},[e("v-card",{attrs:{outlined:"",height:"480px",loading:!t.statsReady}},[e("v-card-title",[t._v(" Percentage of Â "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(t.eventKey))]),t._v("Â  events "),e("v-spacer"),e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on;return[e("v-icon",t._g({attrs:{color:"primary"}},n),[t._v("mdi-information-outline")])]}}])},[e("span",[t._v("Shows the ratio of "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(this.truncateValue(t.eventValue)))]),t._v(" events to other "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(t.eventKey))]),t._v(" events. ")])])],1),t.statsReady?e("v-card-text",[e("apexchart",{attrs:{height:"350px",options:this.donutChartOptions,series:this.donutChartSeries}})],1):t._e()],1)],1),e("v-col",{attrs:{align:"center"}},[e("v-card",{attrs:{outlined:"",height:"480px",loading:!t.eventDistributionReady}},[e("v-card-title",[t._v(" Event distribution by "+t._s(this.distributionIntervals[this.selectedDistributionIntervalIndex])+" "),e("v-spacer"),e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on;return[e("v-icon",t._g({attrs:{color:"primary"}},n),[t._v("mdi-information-outline")])]}}])},[e("span",[t._v("Shows the distribution of "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(this.truncateValue(t.eventValue)))]),t._v(" events in the sketch based on the "+t._s(this.distributionIntervals[this.selectedDistributionIntervalIndex])+" of the datetime. ")])])],1),t.statsReady?e("v-card-text",[e("v-btn-toggle",{attrs:{mandatory:""},model:{value:t.selectedDistributionIntervalIndex,callback:function(e){t.selectedDistributionIntervalIndex=e},expression:"selectedDistributionIntervalIndex"}},t._l(this.distributionIntervals,function(i){return e("v-btn",{key:i,attrs:{small:""}},[t._v(" "+t._s(i)+" ")])}),1),e("apexchart",{attrs:{height:"350px",options:this.intervalChartOptions,series:this.intervalChartSeries}})],1):t._e()],1)],1),e("v-col",{attrs:{align:"center"}},[e("v-card",{attrs:{outlined:"",height:"480",loading:!t.dataReady}},[e("v-card-title",[t._v(" Surrounding events "),e("v-spacer"),e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on;return[e("v-icon",t._g({attrs:{color:"primary"}},n),[t._v("mdi-information-outline")])]}}])},[e("span",[t._v("Shows the distribution of "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(this.truncateValue(t.eventValue)))]),t._v(" events that are "+t._s(this.recentIntervals[this.selectedRecentEventsIndex])+" of "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(t.eventDateTime))])])])],1),t.dataReady?e("v-card-text",[e("v-btn-toggle",{attrs:{mandatory:""},model:{value:t.selectedRecentEventsIndex,callback:function(e){t.selectedRecentEventsIndex=e},expression:"selectedRecentEventsIndex"}},t._l(this.recentIntervals,function(i){return e("v-btn",{key:i,attrs:{small:""}},[t._v(" "+t._s(i)+" ")])}),1),e("apexchart",{attrs:{height:"350px",options:this.recentHistogramOptions,series:this.recentHistogramSeries}})],1):t._e()],1)],1)],1)],1)],1)],1)}),Ee=[],Ne=i(98744),ze=(i(23418),{components:{Apexchart:we()},props:["eventKey","eventValue","eventTimestamp","eventTimestampDesc","reloadData"],data:function(){return{distributionIntervals:["Year","Month","Day","Hour","Hour-Day"],recentIntervals:["Â± 5 years","Â± 6 months","Â± 7 days","Â± 6 hours"],recentHistogramLabels:[],recentHistogramSeries:[],selectedDistributionIntervalIndex:0,selectedRecentEventsIndex:2,dataReady:!1,data:[],monthsOfYear:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],daysOfWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hoursOfDay:["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],stats:void 0,statsReady:!1,eventDistributionReady:!1,eventDistributionData:void 0,termHeaders:[{text:"Term",sortable:!0,value:"key"},{text:"Count",sortable:!0,value:"doc_count"}]}},computed:{settings:function(){return this.$store.state.settings},sketch:function(){return this.$store.state.sketch},eventDateTime:function(){return new Date(this.eventTimestamp/1e3).toISOString()},selectedDistributionInterval:function(){return this.distributionIntervals[this.selectedDistributionIntervalIndex]},selectedRecentEvents:function(){return this.recentIntervals[this.selectedRecentEventsIndex]},intervalChartOptions:function(){if(void 0===this.eventDistributionData||!this.eventDistributionReady)return{chart:{type:"bar"}};var t=[];if("Year"===this.selectedDistributionInterval){t=[];var e,i=(0,Le.A)(this.eventDistributionData.year_histogram.buckets);try{for(i.s();!(e=i.n()).done;){var n=e.value;t.push(n.key)}}catch(s){i.e(s)}finally{i.f()}}else if("Month"===this.selectedDistributionInterval)t=this.monthsOfYear;else if("Day"===this.selectedDistributionInterval)t=this.daysOfWeek;else if("Hour"===this.selectedDistributionInterval)t=this.hoursOfDay;else if("Hour-Day"===this.selectedDistributionInterval)return this.intervalHeatmapOptions;return{chart:{type:"bar"},xaxis:{tickAmount:12,labels:{show:!0,hideOverlappingLabels:!0},categories:t}}},intervalChartSeries:function(){if(void 0===this.eventDistributionData||!this.eventDistributionReady)return[];var t=[];switch(this.selectedDistributionInterval){case"Year":t=Array(this.eventDistributionData.year_histogram.length).fill(0);var e,i=(0,Le.A)(this.eventDistributionData.year_histogram.buckets.entries());try{for(i.s();!(e=i.n()).done;){var n=(0,Ne.A)(e.value,2),s=n[0],a=n[1];t[s]=a.doc_count}}catch(p){i.e(p)}finally{i.f()}break;case"Month":t=Array(12).fill(0);var r,o=(0,Le.A)(this.eventDistributionData.month_histogram.buckets);try{for(o.s();!(r=o.n()).done;){var l=r.value;t[l.key-1]=l.doc_count}}catch(p){o.e(p)}finally{o.f()}break;case"Day":t=Array(7).fill(0);var c,u=(0,Le.A)(this.eventDistributionData.day_histogram.buckets);try{for(u.s();!(c=u.n()).done;){var d=c.value;t[d.key]=d.doc_count}}catch(p){u.e(p)}finally{u.f()}break;case"Hour":t=Array(24).fill(0);var h,m=(0,Le.A)(this.eventDistributionData.hour_histogram.buckets);try{for(m.s();!(h=m.n()).done;){var v=h.value;t[v.key]=v.doc_count}}catch(p){m.e(p)}finally{m.f()}break;case"Hour-Day":return this.intervalHeatmapSeries;default:break}return[{name:"Events by "+this.selectedDistributionInterval,data:t}]},fieldCardinality:function(){return void 0===this.stats?null:this.stats.all_values.field_cardinality.value},docCount:function(){return void 0===this.stats?null:this.stats.all_values.doc_count},fieldDateTimeMinimum:function(){return void 0===this.stats?null:this.stats.all_values.datetime_min.value_as_string},fieldDateTimeMaximum:function(){return void 0===this.stats?null:this.stats.all_values.datetime_max.value_as_string},valueDateTimeMinimum:function(){return void 0===this.stats?null:this.stats.datetime_min.value_as_string},valueDateTimeMaximum:function(){return void 0===this.stats?null:this.stats.datetime_max.value_as_string},fieldValueCount:function(){return void 0===this.stats?null:this.stats.all_values.field_count.value},valueEventCount:function(){return void 0===this.stats?null:this.stats.value_count.value},commonValues:function(){return void 0===this.stats?[]:this.stats.all_values.top_terms.buckets},rareValues:function(){return void 0===this.stats?[]:this.stats.all_values.rare_terms.buckets},donutChartOptions:function(){return{chart:{type:"donut"},dataLabels:{enabled:!0},labels:[this.truncateValue(this.eventValue)+" ("+this.valueEventCount+")","Other "+this.eventKey+" ("+(this.fieldValueCount-this.valueEventCount)+")"],legend:{position:"bottom"}}},donutChartSeries:function(){return[this.valueEventCount,this.fieldValueCount-this.valueEventCount]},minEvent:function(){return this.raw_data[0]},maxEvent:function(){return this.raw_data[this.raw_data.length-1]},intervalHeatmapOptions:function(){return{chart:{type:"heatmap"},colors:["#008FFB"],tooltip:{enabled:!0,x:{show:!0}},xaxis:{labels:{show:!0,hideOverlappingLabels:!0},tickPlacement:"between",categories:this.hoursOfDay}}},intervalHeatmapSeries:function(){var t=[];if(void 0===this.eventDistributionData)return t;var e,i=(0,Le.A)(Array.from({length:7}).keys());try{for(i.s();!(e=i.n()).done;){var n,s=e.value,a=[],r=(0,Le.A)(Array.from({length:24}).keys());try{for(r.s();!(n=r.n()).done;){var o=n.value,l=this.eventDistributionData.hour_of_week_histogram.buckets[24*s+o].doc_count;a.push({x:this.hoursOfDay[o],y:l})}}catch(c){r.e(c)}finally{r.f()}t.push({name:this.daysOfWeek[s],data:a})}}catch(c){i.e(c)}finally{i.f()}return t},recentHistogramOptions:function(){return this.dataReady?{chart:{type:"bar"},xaxis:{labels:{show:!0,hideOverlappingLabels:!0},categories:this.recentHistogramLabels}}:{chart:{type:"bar"}}}},watch:{reloadData:function(t,e){!0===t&&(this.loadSummaryData(),this.loadEventDistribution(),this.loadAggregationData())},selectedDistributionInterval:function(t,e){t!==e&&this.loadEventDistribution()},selectedRecentEvents:function(t,e){t!==e&&this.loadAggregationData()}},methods:{truncateValue:function(t){return t.length>45?t.substring(0,45).trim()+"...":t},formatNumber:function(t){return(new Intl.NumberFormat).format(t)},loadSummaryData:function(){var t=this;this.statsReady=!1,this.stats=void 0,_.runAggregator(this.sketch.id,{aggregator_name:"field_summary",aggregator_parameters:{field:this.eventKey,field_query_string:this.eventValue},include_processing_timelines:!!this.settings.showProcessingTimelineEvents}).then(function(e){t.stats=e.data.objects[0].field_summary.buckets[0],t.statsReady=!0})},loadEventDistribution:function(){var t=this;this.eventDistributionReady=!1,this.eventDistributionData=[],_.runAggregator(this.sketch.id,{aggregator_name:"datefield_summary",aggregator_parameters:{field:this.eventKey,date_interval:this.selectedDistributionInterval},include_processing_timelines:!!this.settings.showProcessingTimelineEvents}).then(function(e){t.eventDistributionData=e.data.objects[0].datefield_summary.buckets[0],t.eventDistributionReady=!0})},loadAggregationData:function(){var t=this;this.dataReady=!1,this.data=[];var e,i,n,s=new Date(this.eventTimestamp/1e3);switch(this.selectedRecentEvents){case"Â± 5 years":e=new Date(this.eventTimestamp/1e3),e.setUTCFullYear(s.getUTCFullYear()-5),i=new Date(this.eventTimestamp/1e3),i.setUTCFullYear(s.getUTCFullYear()+5),n="year";break;case"Â± 6 months":e=new Date(this.eventTimestamp/1e3),e.setUTCMonth(s.getUTCMonth()-6),i=new Date(this.eventTimestamp/1e3),i.setUTCMonth(s.getUTCMonth()+6),n="month";break;case"Â± 7 days":e=new Date(this.eventTimestamp/1e3),e.setUTCDate(s.getUTCDate()-7),i=new Date(this.eventTimestamp/1e3),i.setUTCDate(s.getUTCDate()+7),n="day";break;case"Â± 6 hours":e=new Date(this.eventTimestamp/1e3),e.setUTCHours(s.getUTCHours()-6),i=new Date(this.eventTimestamp/1e3),i.setUTCHours(s.getUTCHours()+6),n="hour";break;default:return}_.runAggregator(this.sketch.id,{aggregator_name:"date_histogram",aggregator_parameters:{field:this.eventKey,field_query_string:this.eventValue,supported_intervals:n,start_time:e.toISOString().slice(0,-1),end_time:i.toISOString().slice(0,-1)},include_processing_timelines:!!this.settings.showProcessingTimelineEvents}).then(function(e){t.data=e.data.objects[0].date_histogram.buckets[0],t.recentHistogramSeries=[{data:[],name:"Events"}],t.recentHistogramLabels=[];var i,n=(0,Le.A)(e.data.objects[0].date_histogram.buckets[0].entries());try{for(n.s();!(i=n.n()).done;){var s=(0,Ne.A)(i.value,2),a=s[0],r=s[1];t.recentHistogramSeries[0].data[a]=r.count,t.recentHistogramLabels[a]=r.datetime.slice(0,-5)}}catch(o){n.e(o)}finally{n.f()}t.dataReady=!0})},clearAndCancel:function(){this.$emit("cancel")}},mounted:function(){this.loadSummaryData(),this.loadEventDistribution(),this.loadAggregationData()}}),$e=ze,Fe=(0,u.A)($e,Ie,Ee,!1,null,null,null),Re=Fe.exports,Pe=function(){var t=this,e=t._self._c;return e("v-card",[e("div",{staticClass:"pa-8"},[e("pre",{staticStyle:{"font-size":"0.9em"},attrs:{lang:"xml"}},[t._v(t._s(t.xmlString))])]),e("v-divider"),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.close()}}},[t._v(" Close ")])],1)],1)},Oe=[],Qe={props:["xmlString"],methods:{close:function(){this.$emit("close")}}},Me=Qe,qe=(0,u.A)(Me,Pe,Oe,!1,null,"25ba8c42",null),Be=qe.exports,Ve=function(){var t=this,e=t._self._c;return e("v-card",[e("v-card-title",[e("v-icon",{attrs:{large:"",color:"red"}},[t._v("mdi-shield-alert-outline")]),e("span",{staticClass:"text-h6 ml-2"},[t._v("External redirect warning!")])],1),e("v-card-text",[t.contextValue?e("div",{staticClass:"mb-2"},[t._v(" This action will open the link below in a new tab! Do you really want to send the following value to this external service? ")]):e("div",{staticClass:"mb-2"},[t._v(" This action will open the link below in a new tab! Do you really want to visit this external website? ")]),t.contextValue?e("div",[e("b",[t._v("Value:")]),e("br"),e("code",{staticClass:"code"},[t._v(" "+t._s(t.getContextValue)+" ")])]):t._e(),e("div",[e("b",[t._v("External website:")]),e("br"),e("code",{staticClass:"code"},[t._v(" "+t._s(t.getContextUrl)+" ")])])]),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{color:"primary",text:""},on:{click:t.clearAndCancel}},[t._v(" cancel ")]),e("v-btn",{attrs:{color:"primary",text:"",href:t.contextUrl,target:"_blank"},on:{click:t.clearAndCancel}},[t._v(" continue ")])],1)],1)},He=[],Ge=i(99418),Ue={props:["contextValue","contextUrl"],methods:{clearAndCancel:function(){this.$emit("cancel")}},computed:{getContextValue:function(){return Ge.A.sanitize(this.contextValue)},getContextUrl:function(){return Ge.A.sanitize(this.contextUrl)}}},We=Ue,je=(0,u.A)(We,Ve,He,!1,null,"5096e762",null),Ye=je.exports,Xe=function(){var t=this,e=t._self._c;return e("v-card",{attrs:{outlined:""}},[e("v-toolbar",{attrs:{dense:"",flat:""}},[e("v-toolbar-title",{staticStyle:{"font-size":"1.2em"}},[t._v("Comments")])],1),e("v-list",{attrs:{"three-line":""}},t._l(t.comments,function(i,n){return e("v-list-item",{key:i.id,on:{mouseover:function(e){return t.selectComment(i)},mouseleave:function(e){return t.unSelectComment()}}},[e("v-list-item-avatar",[e("v-avatar",{attrs:{color:"grey lighten-1"}},[e("span",{staticClass:"white--text"},[t._v(t._s(t._f("initialLetter")(i.user.username)))])])],1),e("v-list-item-content",[e("v-list-item-title",[t._v(" "+t._s(i.user.username)+" ")]),e("v-list-item-subtitle",[t._v(" "+t._s(t._f("shortDateTime")(i.created_at))+" ("+t._s(t._f("timeSince")(i.created_at))+") ")]),i.editable?e("v-card",{staticClass:"mt-5",attrs:{flat:""}},[e("v-textarea",{attrs:{"hide-details":"","auto-grow":"",filled:""},model:{value:t.comments[n].comment,callback:function(e){t.$set(t.comments[n],"comment",e)},expression:"comments[index].comment"}}),i.editable?e("v-card-actions",[e("v-spacer"),i.editable?e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.editComment(n,!1)}}},[t._v(" Cancel ")]):t._e(),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.updateComment(i,n)}}},[t._v(" Save ")])],1):t._e()],1):e("p",{staticClass:"body-2",staticStyle:{"max-width":"90%"}},[t._v(t._s(i.comment))])],1),i===t.selectedComment&&t.meta.permissions.write&&t.currentUser==i.user.username?e("v-list-item-action",{staticStyle:{position:"absolute",right:"0"}},[e("v-chip",{staticStyle:{"margin-right":"10px"},attrs:{outlined:""}},[e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.editComment(n)}}},[e("v-icon",{attrs:{title:"Edit comment",small:""}},[t._v("mdi-square-edit-outline")])],1),e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.deleteComment(i.id,n)}}},[e("v-icon",{attrs:{title:"Delete comment",small:""}},[t._v("mdi-trash-can-outline")])],1)],1)],1):t._e()],1)}),1),t.meta.permissions.write?e("v-card-actions",[e("v-textarea",{staticClass:"mx-2 mb-2",attrs:{"hide-details":"","auto-grow":"",filled:"",label:"Add comment",rows:"1"},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),e("v-btn",{attrs:{icon:""},on:{click:t.postComment}},[e("v-icon",{attrs:{title:"Submit comment"}},[t._v("mdi-send")])],1)],1):t._e()],1)},Je=[],Ke={props:["comments","event","currentSearchNode"],data:function(){return{comment:"",selectedComment:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},currentUser:function(){return this.$store.state.currentUser}},methods:{postComment:function(){var t=this;o.$emit("eventAnnotated",{type:"__ts_comment",event:this.event,searchNode:this.currentSearchNode}),_.saveEventAnnotation(this.sketch.id,"comment",this.comment,[this.event],this.currentSearchNode).then(function(e){t.comments.push(e.data.objects[0][0]),t.event._source.comment.push(t.comment),t.comment="",t.$store.dispatch("updateEventLabels",{label:"__ts_comment",num:1})}).catch(function(t){})},updateComment:function(t,e){var i=this;_.updateEventAnnotation(this.sketch.id,"comment",t,[this.event],this.currentSearchNode).then(function(n){i.comments.splice(e,1,t),t.editable=!1}).catch(function(t){console.error(t)})},deleteComment:function(t,e){var i=this;confirm("Are you sure?")&&_.deleteEventAnnotation(this.sketch.id,"comment",t,this.event,this.currentSearchNode).then(function(t){i.comments.splice(e,1),i.event._source.comment.splice(e,1),i.$store.dispatch("updateEventLabels",{label:"__ts_comment",num:-1})}).catch(function(t){console.error(t)})},editComment:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.comments[t];i.editable=e,this.comments.splice(t,1,i)},selectComment:function(t){this.selectedComment=t},unSelectComment:function(){this.selectedComment=!1}}},Ze=Ke,ti=(0,u.A)(Ze,Xe,Je,!1,null,null,null),ei=ti.exports,ii=function(){var t=this,e=t._self._c;return e("v-card",[e("v-toolbar",{attrs:{flat:"",color:"transparent"}},[e("v-img",{staticClass:"ml-2",attrs:{position:"left",src:t.getUnfurlLogo,"max-height":"24",contain:""}})],1),e("v-card-subtitle",{staticClass:"pt-1"},[e("div",{staticClass:"mb-2"},[e("b",[t._v("Input: ")]),e("code",{staticClass:"code"},[t._v(t._s(t.url))])]),t.unfurlReady?e("div",[e("b",[t._v("Selected node info: ")]),e("code",{staticClass:"code",domProps:{innerHTML:t._s(t.sanitizeHtml(t.nodeContext))}})]):t._e()]),e("v-card-text",[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.unfurlReady,expression:"!unfurlReady"}]},[e("v-progress-linear",{attrs:{color:"primary",indeterminate:""}})],1),e("v-toolbar",{directives:[{name:"show",rawName:"v-show",value:t.unfurlReady,expression:"unfurlReady"}],staticClass:"mt-n8",attrs:{dense:"",flat:"",color:"transparent"}},[e("v-spacer"),e("div",[e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.resizeCanvas()}}},[e("v-icon",{attrs:{title:"fit graph to canvas"}},[t._v("mdi-fit-to-page-outline")])],1),e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.zoomGraph("plus")}}},[e("v-icon",{attrs:{title:"zoom-in"}},[t._v("mdi-plus")])],1),e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.zoomGraph("minus")}}},[e("v-icon",{attrs:{title:"zoom-out"}},[t._v("mdi-minus")])],1)],1)],1),e("v-card",{directives:[{name:"show",rawName:"v-show",value:t.unfurlReady,expression:"unfurlReady"}],attrs:{outlined:""}},[e("div",{ref:"graphContainer",style:{height:t.canvasHeight,width:"100%"}},[e("div",{ref:"cy",staticClass:"pa-2",style:{"min-height":t.canvasHeight},attrs:{width:"100%"}})])]),e("small",[t._v("Powered by "),e("a",{attrs:{href:"https://github.com/obsidianforensics/unfurl",target:"_blank"}},[t._v("dfir-unfurl")])])],1),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{color:"primary",text:""},on:{click:t.clearAndCancel}},[t._v(" close ")])],1)],1)},ni=[],si=i(90165),ai=i(65111),ri=i.n(ai),oi=i(60023);si.A.use(ri());var li={props:["url"],data:function(){return{unfurlReady:!1,unfurlData:{},canvasHeight:"400px",nodeContext:"",nodeContextDefault:"Select a node in the graph below to get more information.",config:{style:[{selector:"node",style:{shape:"roundrectangle",width:"data(labelWidth)",height:"data(labelHeight)",label:"data(label)","font-size":"10","text-outline-width":"0px",padding:"7px","background-color":"#e0e0e0","text-outline-color":"#e0e0e0","text-wrap":"wrap","text-max-width":"12em","text-halign":"center","text-valign":"center",color:"#000000"}},{selector:"node:selected",style:{"border-color":" #000","border-width":"2px"}},{selector:"edge",style:{width:1,"curve-style":"bezier","control-point-step-size":70,"target-arrow-shape":"triangle","font-size":11,"text-rotation":"autorotate","text-outline-width":3,"text-outline-color":"#FFFFFF",label:"data(label)"}},{selector:"edge.highlight",style:{lineColor:"grey",width:3}}],layout:{name:"dagre",animated:!1,prelayout:!1,spacingFactor:1}}}},computed:{getUnfurlLogo:function(){return this.$vuetify.theme.dark?"/unfurl-logo-dark.png":"/unfurl-logo.png"}},methods:{sanitizeHtml:function(t){return Ge.A.sanitize((0,oi.xI)(t))},clearAndCancel:function(){this.$emit("cancel")},getUnfurlData:function(t){var e=this;_.getUnfurlGraph(t).then(function(t){e.unfurlData=t.data,e.unfurlReady=!0,e.buildUnfurlGraph(e.unfurlData)}).catch(function(t){console.error("getting unfurl error: ",t)})},resizeCanvasWithDelay:function(){var t=this;this.resizeTimeout=setTimeout(function(){t.resizeCanvas()},250)},resizeCanvas:function(){if(this.$refs.graphContainer){var t=this.$refs.graphContainer.style.height,e=this.$refs.graphContainer.style.width,i=this.$refs.cy;i.style.minHeight=t+"px",i.style.height=t+"px",i.style.minWidth=e+"px",i.style.width=e+"px",this.cy.resize(),this.cy.fit()}},zoomGraph:function(t){var e=this.cy.zoom();"plus"===t&&this.cy.zoom({level:e+.2}),"minus"===t&&this.cy.zoom({level:e-.2})},buildUnfurlGraph:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cy.elements().remove();var e=[];t.nodes.forEach(function(t){e.push({group:"nodes",data:{id:t.id,label:t.label,labelWidth:6*t.label.length,labelHeight:13,context:t.title}})}),t.edges.forEach(function(t){e.push({group:"edges",data:{id:"e".concat(t.from).concat(t.to),source:t.from,target:t.to,label:t.label,context:t.title}})}),this.cy.style(this.config.style),this.cy.add(e),this.cy.layout(this.config.layout).run(),this.resizeCanvasWithDelay()},nodeSelection:function(t){this.cy.edges().removeClass("highlight"),t.target.outgoers("edge").addClass("highlight"),this.nodeContext=t.target.data().context?t.target.data().context:"No context available for this node.",this.resizeCanvas()}},mounted:function(){var t=this;window.addEventListener("resize",this.resizeCanvasWithDelay),this.unfurlReady=!1,this.nodeContext=this.nodeContextDefault,this.getUnfurlData(this.url),this.cy=(0,si.A)((0,D.A)({container:this.$refs.cy},this.config)),this.cy.on("select","node",function(e){t.nodeSelection(e)}),this.cy.on("unselect","node",function(e){t.cy.elements().removeClass("highlight"),t.nodeContext=t.nodeContextDefault})}},ci=li,ui=(0,u.A)(ci,ii,ni,!1,null,"405cbb74",null),di=ui.exports,hi={components:{TsAggregateDialog:Re,TsFormatXmlString:Be,TsLinkRedirectWarning:Ye,TsComments:ei,TsUnfurlDialog:di},props:["event"],data:function(){return{fullEvent:{},comments:[],aggregatorDialog:!1,ignoredAggregatorFields:new Set(["datetime","message","path_spec","strings","timestamp","xml_string"]),ignoreFilterChips:new Set(["datetime","tag"]),eventKey:"",eventValue:"",eventTimestamp:0,eventTimestampDesc:"",formatXMLString:!1,redirectWarnDialog:!1,dfirUnfurlDialog:!1,contextUrl:"",contextValue:"",c_key:-1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},currentUser:function(){return this.$store.state.currentUser},currentSearchNode:function(){return this.$store.state.currentSearchNode},fullEventFiltered:function(){var t=this;return Object.getOwnPropertyNames(this.fullEvent).forEach(function(e){e.startsWith("__ts")&&delete t.fullEvent[e]}),this.fullEvent},contextLinkConf:function(){return this.$store.state.contextLinkConf},settings:function(){return this.$store.state.settings}},methods:{getEvent:function(){var t=this,e=this.event._index,i=this.event._id,n=!!this.settings.showProcessingTimelineEvents;_.getEvent(this.sketch.id,e,i,n).then(function(e){t.fullEvent=e.data.objects,t.comments=e.data.meta.comments,t.eventTimestamp=e.data.objects.timestamp,t.eventTimestampDesc=e.data.objects.timestamp_desc,t.comments.length>0&&(t.event.showComments=!0)}).catch(function(t){})},getContextLinkItems:function(t){var e=this.contextLinkConf[t.toLowerCase()]?this.contextLinkConf[t.toLowerCase()]:[],i=e.map(function(t){return t.short_name});return i},checkContextLinkDisplay:function(t,e){var i,n=this.contextLinkConf[t.toLowerCase()]?this.contextLinkConf[t.toLowerCase()]:[],s=(0,Le.A)(n);try{for(s.s();!(i=s.n()).done;){var a=i.value;if(""!==a["validation_regex"]&&void 0!==a["validation_regex"]){var r=a["validation_regex"],o=r.slice(r.lastIndexOf("/")+1),l=r.slice(r.indexOf("/")+1,r.lastIndexOf("/")),c=new RegExp(l,o);return!!c.test(e)}return!0}}catch(u){s.e(u)}finally{s.f()}return!1},contextLinkRedirect:function(t,e,i){var n,s=this.contextLinkConf[t.toLowerCase()]?this.contextLinkConf[t.toLowerCase()]:[],a=(0,Le.A)(s);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r["short_name"]===e)if("hardcoded_modules"===r["type"]){if("xml_formatter"===r["module"])return this.formatXMLString=!0,void(this.contextValue=i);if("unfurl_graph"===r["module"])return this.dfirUnfurlDialog=!0,void(this.contextValue=i);if("threat_intel"===r["module"])return void o.$emit("addIndicator",i)}else r["redirect_warning"]?(this.redirectWarnDialog=!0,this.contextValue=i,this.contextUrl=r["context_link"].replace("<ATTR_VALUE>",encodeURIComponent(i))):(window.open(r["context_link"].replace("<ATTR_VALUE>",encodeURIComponent(i)),"_blank"),this.redirectWarnDialog=!1)}}catch(l){a.e(l)}finally{a.f()}},getContextLinkType:function(t,e){var i,n=this.contextLinkConf[t.toLowerCase()]?this.contextLinkConf[t.toLowerCase()]:[],s=(0,Le.A)(n);try{for(s.s();!(i=s.n()).done;){var a=i.value;if(a["short_name"]===e)return a["type"]}}catch(r){s.e(r)}finally{s.f()}},getContextLinkRedirectState:function(t,e){var i,n=this.contextLinkConf[t.toLowerCase()]?this.contextLinkConf[t.toLowerCase()]:[],s=(0,Le.A)(n);try{for(s.s();!(i=s.n()).done;){var a=i.value;if(a["short_name"]===e)return!!a["redirect_warning"]&&a["redirect_warning"]}}catch(r){s.e(r)}finally{s.f()}},loadAggregation:function(t,e){this.eventKey=t,this.eventValue=e,this.aggregatorDialog=!0},copyToClipboard:function(t){try{navigator.clipboard.writeText(t),this.infoSnackBar("copied")}catch(e){this.errorSnackBar("Failed copying to the clipboard!"),console.error(e)}},applyFilterChip:function(t,e,i){var n={doSearch:!0},s={field:t,value:e,type:"term",operator:i,active:!0};n.chip=s,o.$emit("setQueryAndFilter",n)}},created:function(){this.getEvent()}},mi=hi,vi=(0,u.A)(mi,Ae,De,!1,null,null,null),pi=vi.exports,fi=function(){var t=this,e=t._self._c;return e("v-menu",{attrs:{"offset-x":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[t.assignedTags.length>0?e("v-icon",t._g(t._b({staticClass:"ml-1",attrs:{title:"Modify tags"}},"v-icon",s,!1),n),[t._v("mdi-tag-plus")]):e("v-icon",t._g(t._b({staticClass:"ml-1",attrs:{title:"Modify tags"}},"v-icon",s,!1),n),[t._v("mdi-tag-plus-outline")])]}}]),model:{value:t.showMenu,callback:function(e){t.showMenu=e},expression:"showMenu"}},[e("ts-event-tag-dialog",{attrs:{events:[t.event]},on:{close:function(e){t.showMenu=!1}}})],1)},gi=[],yi=function(){var t=this,e=t._self._c;return e("v-card",{staticClass:"mx-auto",attrs:{"min-width":"500px","max-width":"500px","min-height":"260px"}},[e("v-btn",{staticClass:"float-right mr-1 mt-1",attrs:{icon:""},on:{click:function(e){return t.$emit("close")}}},[e("v-icon",{attrs:{title:"Close dialog"}},[t._v("mdi-close")])],1),e("v-card-text",[e("strong",[t._v("Quick tags")]),e("v-chip-group",t._l(t.quickTags,function(i){return e("v-chip",{key:i.tag,staticClass:"text-center",attrs:{color:i.color,"text-color":i.textColor,disabled:!!t.tagsAssignedToAll.includes(i.tag),small:"",title:"Add quick tag"},on:{click:[function(e){return t.addTags(i.tag)},function(e){return e.stopPropagation(),t.$emit("close")}]}},[e("v-icon",{attrs:{small:"",left:""}},[t._v(" "+t._s(i.label)+" ")]),t._v(" "+t._s(i.tag)+" ")],1)}),1),e("strong",[t._v("Assigned tags")]),e("v-chip-group",{attrs:{column:""}},t._l(t.assignedTags,function(i){return e("v-chip",{key:i,staticClass:"text-center",attrs:{color:t.getQuickTag(i)?t.getQuickTag(i).color:"","text-color":t.getQuickTag(i)?t.getQuickTag(i).textColor:"",small:"",close:"",title:"Remove "},on:{"click:close":function(e){return t.removeTags(i)}}},[t.getQuickTag(i)?e("v-icon",{attrs:{small:"",left:""}},[t._v(t._s(t.getQuickTag(i).label))]):t._e(),t._v(" "+t._s(i)+" ")],1)}),1),e("br"),e("v-combobox",{attrs:{"hide-no-data":!t.search,items:t.customTags,"search-input":t.search,"hide-selected":"",label:"Add tags ...","small-chips":"",outlined:""},on:{"update:searchInput":function(e){t.search=e},"update:search-input":function(e){t.search=e},change:function(e){return t.addTags(t.selectedTags)}},scopedSlots:t._u([{key:"no-data",fn:function(){return[e("v-list-item",[e("span",{staticClass:"subheading"},[t._v("Create new tag: ")]),e("v-chip",{staticClass:"ml-1",attrs:{small:""}},[t._v(" "+t._s(t.search)+" ")])],1)]},proxy:!0},{key:"item",fn:function(i){var n=i.item;return[e("v-chip",{attrs:{small:""}},[t._v(" "+t._s(n)+" ")])]}}]),model:{value:t.selectedTags,callback:function(e){t.selectedTags=e},expression:"selectedTags"}})],1)],1)},_i=[],bi=(i(81148),{props:["events"],data:function(){return{listItems:[],selectedTags:null,quickTags:[{tag:"bad",color:"red",textColor:"white",label:"mdi-alert-circle-outline"},{tag:"suspicious",color:"orange",textColor:"white",label:"mdi-help-circle-outline"},{tag:"good",color:"green",textColor:"white",label:"mdi-check-circle-outline"}],search:null}},computed:{sketch:function(){return this.$store.state.sketch},tags:function(){return this.$store.state.tags.map(function(t){return t.tag})},event:function(){return this.events[0]},assignedTags:function(){var t,e=new Set,i=(0,Le.A)(this.events);try{for(i.s();!(t=i.n()).done;){var n=t.value;n._source.tag&&n._source.tag.forEach(function(t){return e.add(t)})}}catch(s){i.e(s)}finally{i.f()}return(0,B.A)(e)},tagsAssignedToAll:function(){var t=this;return this.quickTags.filter(function(e){return t.events.every(function(t){var i=t._source.tag||[];return i.includes(e.tag)})}).map(function(t){return t.tag})},customTags:function(){var t=this;if(!this.events.every(function(t){return!t._source.tag}))return[];var e=this.tags.filter(function(e){return!t.getQuickTag(e)});return e=e.filter(function(e){return!t.assignedTags.includes(e)}),e.sort(function(t,e){return t.localeCompare(e)}),e}},methods:{getQuickTag:function(t){return this.quickTags.find(function(e){return e.tag===t})},removeTags:function(t){var e=this;_.untagEvents(this.sketch.id,this.events,[t]).then(function(i){var n,s=(0,Le.A)(e.events);try{for(s.s();!(n=s.n()).done;){var a=n.value,r=a._source.tag.indexOf(t);-1!==r&&a._source.tag.splice(r,1)}}catch(o){s.e(o)}finally{s.f()}e.$store.dispatch("updateTimelineTags",{sketchId:e.sketch.id,tag:t,num:-1})}).catch(function(t){console.error(t)})},addTags:function(t){var e,i=this,n=(0,Le.A)(this.events);try{for(n.s();!(e=n.n()).done;){var s=e.value;s._source.hasOwnProperty("tag")||this.$set(s._source,"tag",[])}}catch(r){n.e(r)}finally{n.f()}var a=this.events.filter(function(e){return!e._source.tag.includes(t)});_.tagEvents(this.sketch.id,a,[t]).then(function(e){var n,s=(0,Le.A)(a);try{for(s.s();!(n=s.n()).done;){var o=n.value;i.$set(o._source.tag,o._source.tag.length,t)}}catch(r){s.e(r)}finally{s.f()}i.$store.dispatch("updateTimelineTags",{sketchId:i.sketch.id,tag:t,num:1})}).catch(function(t){console.error("Cannot tag event! Error:"+t)}),this.$nextTick(function(){i.selectedTags=null,i.search=null})}}}),Si=bi,wi=(0,u.A)(Si,yi,_i,!1,null,"1dd7136a",null),ki=wi.exports,xi={components:{TsEventTagDialog:ki},props:["event"],data:function(){return{showMenu:!1,selectedTags:null,quickTags:[{tag:"bad",color:"red",textColor:"white",label:"mdi-alert-circle-outline"},{tag:"suspicious",color:"orange",textColor:"white",label:"mdi-help-circle-outline"},{tag:"good",color:"green",textColor:"white",label:"mdi-check-circle-outline"}],search:null}},computed:{assignedTags:function(){return this.event._source.tag?this.event._source.tag:[]}}},Ti=xi,Ci=(0,u.A)(Ti,fi,gi,!1,null,"5523dd62",null),Ai=Ci.exports,Di=function(){var t=this,e=t._self._c;return e("span",[e("v-menu",{attrs:{"offset-y":"",transition:"slide-y-transition"},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-icon",t._g(t._b({staticClass:"ml-1",attrs:{title:"Event Action Menu"}},"v-icon",s,!1),n),[t._v("mdi-dots-vertical")])]}}]),model:{value:t.showMenu,callback:function(e){t.showMenu=e},expression:"showMenu"}},[e("v-list",{staticClass:"mx-auto",attrs:{dense:""}},[e("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.copyEventUrlToClipboard()}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-link-variant")])],1),e("v-list-item-title",[t._v("Copy link to event")])],1),e("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.copyEventAsJSON()}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-code-json")])],1),e("v-list-item-title",[t._v("Copy event data as JSON")])],1),e("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.showContextWindow()}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-magnify-plus-outline")])],1),e("v-list-item-title",[t._v("Context search")])],1),e("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.focusOnTimeline()}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-eye")])],1),e("v-list-item-title",[t._v("Unselect other timelines")])],1),e("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.filterOutTimeline()}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-eye-off")])],1),e("v-list-item-title",[t._v("Unselect this timeline")])],1)],1)],1)],1)},Li=[],Ii={props:["event"],data:function(){return{showMenu:!1,originalContext:!1}},mixins:[ye],computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},settings:function(){return this.$store.state.settings}},methods:{showContextWindow:function(){o.$emit("showContextWindow",this.event)},copyEventAsJSON:function(){var t=this;_.getEvent(this.sketch.id,this.event._index,this.event._id,!!this.settings.showProcessingTimelineEvents).then(function(e){var i=e.data.objects,n=JSON.stringify(i,null,3);navigator.clipboard.writeText(n),t.infoSnackBar("Event JSON copied to clipboard")}).catch(function(e){t.errorSnackBar("Failed to load JSON into the clipboard"),console.error(e)})},copyEventUrlToClipboard:function(){try{var t=window.location.origin+this.$route.path+'?q=_id:"'+this.event._id+'"';navigator.clipboard.writeText(t),this.infoSnackBar("Event URL copied to clipboard")}catch(e){this.errorSnackBar("Failed to load Event URL into the clipboard"),console.error(e)}},focusOnTimeline:function(){var t=this.getTimeline(this.event);t&&this.$store.dispatch("updateEnabledTimelines",[t.id])},filterOutTimeline:function(){var t=this.getTimeline(this.event);if(t){var e=this.$store.state.enabledTimelines||[],i=e.filter(function(e){return e!==t.id});this.$store.dispatch("updateEnabledTimelines",i)}}}},Ei=Ii,Ni=(0,u.A)(Ei,Di,Li,!1,null,"0a95dea8",null),zi=Ni.exports,$i=function(){var t=this,e=t._self._c;return e("span",[t._l(t.sortedTags,function(i){return e("span",{key:i},[e("v-chip",{staticClass:"mr-1",attrs:{small:"",color:t.tagColor(i).color,"text-color":t.tagColor(i).textColor}},[i in t.tagConfig?e("v-icon",{attrs:{left:"",small:""}},[t._v(t._s(t.tagConfig[i].label))]):t._e(),t._v(" "+t._s(i)+" ")],1)],1)}),t._l(t.item._source.label,function(i){return e("span",{key:i},[i.startsWith("__ts")?t._e():e("v-chip",{staticClass:"mr-2",attrs:{small:"",outlined:""}},[t._v(" "+t._s(i)+" ")])],1)})],2)},Fi=[],Ri={props:["item","tagConfig","showDetails"],computed:{sketch:function(){return this.$store.state.sketch},sortedTags:function(){if(!this.item._source.tag)return[];var t=this.item._source.tag;return t.sort(function(t,e){return"bad"===t?-1:"bad"===e?1:"suspicious"===t?-1:"suspicious"===e?1:"good"===t?-1:"good"===e?1:t.localeCompare(e)}),t}},methods:{tagColor:function(t){return this.tagConfig[t]?this.tagConfig[t]:"lightgrey"}}},Pi=Ri,Oi=(0,u.A)(Pi,$i,Fi,!1,null,null,null),Qi=Oi.exports,Mi=function(){var t=this,e=t._self._c;return e("ts-search-guide-card",{attrs:{flat:t.inDialog,"show-tags":t.showTags,"show-data-types":t.showDataTypes,"show-saved-searches":t.showSavedSearches},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"pa-4 pb-0"},[e("v-card-title",[e("v-icon",{attrs:{large:"",left:""}},[t._v("mdi-file-search-outline")]),t._v(" Start Exploring "),e("v-spacer"),t.inDialog?e("v-btn",{attrs:{icon:"",title:"Close dialog"},on:{click:function(e){return t.$emit("close-dialog")}}},[e("v-icon",[t._v("mdi-close")])],1):t._e()],1),e("v-card-subtitle",{staticClass:"mt-1"},[t._v(" Find below some examples on how to explore your data. ")]),e("v-divider")],1)]},proxy:!0}])})},qi=[],Bi=(i(46449),i(93514),function(){var t=this,e=t._self._c;return e("v-card",{class:{"ma-4":!t.flat},attrs:{outlined:!t.flat}},[t._t("header"),e("v-card-text",[e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{staticStyle:{"min-width":"250px","flex-basis":"25%"}},[e("div",{staticClass:"pa-2"},[e("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[e("thead",[e("tr",[e("th",{staticClass:"text-left"},[t._v("Description")]),e("th",{staticClass:"text-left"},[t._v("Example Query")])])]),e("tbody",[e("tr",[e("td",[t._v("Search for all events")]),e("td",[e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.emitSetQueryAndFilter("*")}}},[e("code",[t._v("*")])])])]),e("tr",[e("td",[t._v("Search a word in the message field")]),e("td",[e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.emitSetQueryAndFilter("message:error")}}},[e("code",[t._v('message:"error"')])])])]),e("tr",[e("td",[t._v("Search filenames ending with "),e("code",[t._v(".exe")])]),e("td",[e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.emitSetQueryAndFilter("filename:*.exe")}}},[e("code",[t._v("filename:*.exe")])])])]),e("tr",[e("td",[t._v(" Search on the "),e("a",{attrs:{href:"https://docs.opensearch.org/docs/2.19/field-types/supported-field-types/keyword/"}},[t._v("keyword field type")]),e("br"),t._v("(exact matches & substring search) ")]),e("td",[e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.emitSetQueryAndFilter("filename.keyword:malicious.exe")}}},[e("code",[t._v("filename.keyword:malicious.exe")])]),e("br"),e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.emitSetQueryAndFilter("message.keyword:*System32*")}}},[e("code",[t._v("message.keyword:*System32*")])])])]),e("tr",[e("td",[t._v("Search using regex (between "),e("code",[t._v("//")]),t._v(")")]),e("td",[e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.emitSetQueryAndFilter("url.keyword:/.*\\/sketch\\/[1-100]\\/.*/")}}},[e("code",[t._v("url.keyword:/.*\\/sketch\\/[1-100]\\/.*/")])])])]),e("tr",[e("td",[t._v("Combine searches with AND, OR, NOT")]),e("td",[e("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.emitSetQueryAndFilter("event_identifier:(4624 OR 4625) AND LogonType:3")}}},[e("code",[t._v("event_identifier:(4624 OR 4625) AND NOT LogonType:3")])])])]),e("tr",[e("td",[t._v("Search events that have an url field")]),e("td",[e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.emitSetQueryAndFilter("_exists_:url")}}},[e("code",[t._v("_exists_:url")])]),e("br"),e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.emitSetQueryAndFilter("url:*")}}},[e("code",[t._v("url:*")])])])]),e("tr",[e("td",[t._v("Search for a range of numbers")]),e("td",[e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.emitSetQueryAndFilter("http_status_code:[200 TO 204] AND bytes_transferred:>10000")}}},[e("code",[t._v("status_code:[200 TO 204] AND transferred:>10000")])])])]),e("tr",[e("td",[t._v("Filter by a specific date/time range (UTC)")]),e("td",[e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.emitSetQueryAndFilter("datetime:[".concat(t.firstOfCurrentMonth," TO ").concat(t.nowDateTimeUTC,"]"))}}},[e("code",[t._v("datetime:["+t._s(t.firstOfCurrentMonth)+" TO "+t._s(t.nowDateTimeUTC)+"]")])])])]),e("tr",[e("td",[t._v("Filter for events before or after a date (UTC)")]),e("td",[e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.emitSetQueryAndFilter("datetime:[".concat(t.firstOfCurrentMonth," TO *]"))}}},[e("code",[t._v("datetime:["+t._s(t.firstOfCurrentMonth)+" TO *]")])]),e("br"),e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.emitSetQueryAndFilter("datetime:[* TO ".concat(t.firstOfCurrentMonth,"]"))}}},[e("code",[t._v("datetime:[* TO "+t._s(t.firstOfCurrentMonth)+"]")])])])])])]},proxy:!0}])})],1)]),t.showTags?e("v-col",{staticStyle:{"border-left":"1px solid rgba(0, 0, 0, 0.12)"}},[e("div",{staticClass:"pa-4"},[e("h5",[e("v-icon",{attrs:{left:""}},[t._v("mdi-tag-multiple-outline")]),t._v(" Tags")],1),e("ts-tags-list")],1)]):t._e(),t.showDataTypes?e("v-col",{staticStyle:{"border-left":"1px solid rgba(0, 0, 0, 0.12)"}},[e("div",{staticClass:"pa-4"},[e("h5",[e("v-icon",{attrs:{left:""}},[t._v("mdi-database-outline")]),t._v(" Data Types")],1),e("ts-data-types-list")],1)]):t._e(),t.showSavedSearches?e("v-col",{staticStyle:{"border-left":"1px solid rgba(0, 0, 0, 0.12)"}},[e("div",{staticClass:"pa-4"},[e("h5",[e("v-icon",{attrs:{left:""}},[t._v("mdi-content-save-outline")]),t._v(" Saved Searches")],1),e("ts-saved-searches-list")],1)]):t._e()],1)],1),e("v-divider"),e("v-card-actions",[e("v-btn",{attrs:{text:"",color:"primary",href:"https://timesketch.org/guides/user/search-query-guide/",target:"_blank"}},[t._v(" Full Search Guide "),e("v-icon",{attrs:{right:""}},[t._v("mdi-open-in-new")])],1)],1)],2)}),Vi=[],Hi=(i(68156),function(){var t=this,e=t._self._c;return e("div",[e("v-data-iterator",{attrs:{items:t.dataTypes,"items-per-page":t.itemsPerPage,search:t.search,"hide-default-footer":t.dataTypes.length<=t.itemsPerPage},on:{"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e}},scopedSlots:t._u([t.dataTypes.length>t.itemsPerPage?{key:"header",fn:function(){return[e("v-toolbar",{attrs:{flat:""}},[e("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for a data type.."},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]},proxy:!0}:null,{key:"default",fn:function(i){return t._l(i.items,function(i){return e("div",{key:i.data_type,staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(e){return t.setQueryAndFilter(i.data_type)}}},[e("v-row",{staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[e("span",[t._v(t._s(i.data_type)+" ("),e("small",[e("strong",[t._v(t._s(t._f("compactNumber")(i.count)))])]),t._v(")")])])],1)})}}],null,!0)})],1)}),Gi=[],Ui={props:[],data:function(){return{itemsPerPage:10,search:""}},computed:{dataTypes:function(){return(0,B.A)(this.$store.state.dataTypes).sort(function(t,e){return t.data_type.localeCompare(e.data_type)})}},methods:{setQueryAndFilter:function(t){var e={doSearch:!0};e.queryString='data_type:"'+t+'"',o.$emit("setQueryAndFilter",e)}}},Wi=Ui,ji=(0,u.A)(Wi,Hi,Gi,!1,null,"9e6a7a38",null),Yi=ji.exports,Xi=function(){var t=this,e=t._self._c;return e("div",t._l(t.meta.views,function(i,n){return e("div",{key:n,staticStyle:{"font-size":"0.9em"},on:{mouseover:function(e){t.c_key=n},mouseleave:function(e){t.c_key=-1}}},[e("v-row",{staticClass:"py-1 pl-5 pr-3",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[e("v-col",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.setView(i)}}},[e("div",{staticClass:"mt-1"},[t._v(t._s(i.name))])]),e("v-col",{attrs:{cols:"auto"}},[e("v-btn",{staticStyle:{cursor:"pointer"},attrs:{icon:"","x-small":""},on:{click:function(e){return t.copySavedSearchUrlToClipboard(i.id)}}},[e("v-icon",{directives:[{name:"show",rawName:"v-show",value:n==t.c_key,expression:"key == c_key"}],attrs:{title:"Copy link to this search",small:""}},[t._v("mdi-link-variant")])],1),e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({staticClass:"mr-1",attrs:{small:"",icon:""}},"v-btn",s,!1),n),[e("v-icon",{attrs:{title:"More actions",small:""}},[t._v("mdi-dots-vertical")])],1)]}}],null,!0)},[e("v-list",{staticClass:"mx-auto",attrs:{dense:""}},[e("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.copySavedSearchIdToClipboard(i.id)}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-identifier")])],1),e("v-list-item-title",[t._v("Copy saved search ID")])],1),e("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.copySavedSearchUrlToClipboard(i.id)}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-link-variant")])],1),e("v-list-item-title",[t._v("Copy link to this search")])],1)],1)],1)],1)],1)],1)}),0)},Ji=[],Ki={props:[],data:function(){return{c_key:-1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{setView:function(t){o.$emit("setActiveView",t)},copySavedSearchIdToClipboard:function(t){try{navigator.clipboard.writeText(t),this.infoSnackBar("Saved Search ID copied to clipboard")}catch(e){this.errorSnackBar("Failed to load Saved Search ID into the clipboard!"),console.error(e)}},copySavedSearchUrlToClipboard:function(t){try{var e=window.location.origin+this.$route.path+"?view="+t;navigator.clipboard.writeText(e),this.infoSnackBar("Saved Search URL copied to clipboard")}catch(i){this.errorSnackBar("Failed to load Saved Search URL into the clipboard!"),console.error(i)}}}},Zi=Ki,tn=(0,u.A)(Zi,Xi,Ji,!1,null,"3b7709bd",null),en=tn.exports,nn={name:"TsSearchGuideCard",props:{flat:{type:Boolean,default:!1},showTags:{type:Boolean,default:!1},showDataTypes:{type:Boolean,default:!1},showSavedSearches:{type:Boolean,default:!1}},components:{TsTagsList:gt,TsDataTypesList:Yi,TsSavedSearchesList:en},computed:{firstOfCurrentMonth:function(){var t=new Date,e=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0");return"".concat(e,"-").concat(i,"-01")},nowDateTimeUTC:function(){var t=new Date;return t.toISOString().slice(0,19)}},methods:{emitSetQueryAndFilter:function(t){var e={doSearch:!0};e.queryString=t,o.$emit("setQueryAndFilter",e),this.$emit("search-triggered")}}},sn=nn,an=(0,u.A)(sn,Bi,Vi,!1,null,"fa2a8da6",null),rn=an.exports,on={name:"TsExploreWelcomeCard",props:{inDialog:{type:Boolean,default:!1}},components:{TsSearchGuideCard:rn},computed:{showTags:function(){if(!this.$store.state.tags||!this.$store.state.meta.filter_labels)return!1;var t=this.$store.state.meta.filter_labels.filter(function(t){return!t.label.startsWith("__ts_fact")});return[].concat((0,B.A)(this.$store.state.tags),(0,B.A)(t)).length>0},showDataTypes:function(){return this.$store.state.dataTypes.length>0},showSavedSearches:function(){return this.$store.state.meta.views.length>0}}},ln=on,cn=(0,u.A)(ln,Mi,qi,!1,null,null,null),un=cn.exports,dn=function(){var t=this,e=t._self._c;return e("ts-search-guide-card",{attrs:{flat:t.inDialog,"show-tags":t.showTags,"show-data-types":t.showDataTypes,"show-saved-searches":t.showSavedSearches},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"pa-4 pb-0"},[e("v-card-title",[e("v-icon",{attrs:{large:"",left:""}},[t._v("mdi-alert-circle-outline")]),t._v(" No Results Found "),e("v-spacer"),t.inDialog?e("v-btn",{attrs:{icon:"",title:"Close dialog"},on:{click:function(e){return t.$emit("close-dialog")}}},[e("v-icon",[t._v("mdi-close")])],1):t._e()],1),e("v-card-subtitle",{staticClass:"mt-1"},[e("p",[t._v(" Your search "),t.currentQueryString?e("code",[t._v("'"+t._s(t.currentQueryString)+"'")]):t._e(),t.filterChips.length?e("span",[t._v("in combination with the selected filter chips "),e("code",[t._v("'"+t._s(t.filterChips.map(function(t){return t.value}).join(", "))+"'")])]):t._e(),t._v(" did not match any events. ")]),t.disableSaveSearch?t._e():e("p",[e("v-btn",{attrs:{small:"",depressed:"",title:"Save Search"},on:{click:function(e){return t.$emit("save-search-clicked")}}},[e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-content-save-outline")]),t._v(" Save search ")],1)],1),e("p",[t._v("Suggestions:")]),e("ul",[e("li",[t._v("Try different keywords"),t.filterChips.length?e("span",[t._v(" or filter terms")]):t._e(),t._v(".")]),e("li",[t._v("Try more general keywords.")]),e("li",[t._v("Try fewer keywords"),t.filterChips.length?e("span",[t._v(" or filter terms")]):t._e(),t._v(".")]),e("li",[t._v("Try some of the search examples below.")])])]),e("v-divider")],1)]},proxy:!0}])})},hn=[],mn={name:"TsSearchNotFoundCard",props:{inDialog:{type:Boolean,default:!1},currentQueryString:{type:String,default:""},filterChips:{type:Array,default:function(){return[]}},disableSaveSearch:{type:Boolean,default:!1}},components:{TsSearchGuideCard:rn},computed:{showTags:function(){if(!this.$store.state.tags||!this.$store.state.meta.filter_labels)return!1;var t=this.$store.state.meta.filter_labels.filter(function(t){return!t.label.startsWith("__ts_fact")});return[].concat((0,B.A)(this.$store.state.tags),(0,B.A)(t)).length>0},showDataTypes:function(){return this.$store.state.dataTypes.length>0},showSavedSearches:function(){return this.$store.state.meta.views.length>0}}},vn=mn,pn=(0,u.A)(vn,dn,hn,!1,null,null,null),fn=pn.exports,gn=function(){return{from:0,terminate_after:40,size:40,indices:["_all"],order:"asc",chips:[]}},yn=function(){return{meta:{count_per_index:{},count_per_timeline:{}},objects:[]}},_n={components:{TsBarChart:Ce,TsEventDetail:pi,TsEventTagMenu:Ai,TsEventTagDialog:ki,TsEventActionMenu:zi,TsEventTags:Qi,TsExploreWelcomeCard:un,TsSearchNotFoundCard:fn},mixins:[ye],props:{queryRequest:{type:Object,default:function(){}},itemsPerPage:{type:Number,default:40},disableSaveSearch:{type:Boolean,default:!1},disableHistogram:{type:Boolean,default:!1},disableColumns:{type:Boolean,default:!1},disableSettings:{type:Boolean,default:!1},disablePagination:{type:Boolean,default:!1},highlightEvent:{type:Object,default:function(){}}},data:function(){return{expandedItemSlot:"expanded-item",itemActionsSlot:"item.actions",itemTimestampSlot:"item._source.timestamp",itemTimelineNameSlot:"item.timeline_name",itemCommentSlot:"item._source.comment",showEventTagMenu:!1,columnHeaders:[{text:"",value:"field"}],tableOptions:{itemsPerPage:this.itemsPerPage},isSummaryLoading:!1,currentItemsPerPage:this.itemsPerPage,expandedRows:[],selectedFields:[{field:"message",type:"text"}],searchColumns:"",columnDialog:!1,saveSearchMenu:!1,saveSearchFormName:"",saveSearchNameRules:[function(t){return!!t||"Name is required."},function(t){return t&&t.length<=255||"Name is too long."}],selectedEventTags:[],tagConfig:{good:{color:"green",textColor:"white",label:"mdi-check-circle-outline"},bad:{color:"red",textColor:"white",label:"mdi-alert-circle-outline"},suspicious:{color:"orange",textColor:"white",label:"mdi-help-circle-outline"}},searchInProgress:!1,exportDialog:!1,currentPage:1,eventList:{meta:{},objects:[]},currentQueryString:"",currentQueryFilter:gn(),selectedEvents:[],displayOptions:{isCompact:!1,showTags:!0,showEmojis:!0,showMillis:!1,showTimelineName:"true"===localStorage.getItem("showTimelineName")},showHistogram:!1,branchParent:null,sortOrderAsc:!0,summaryCollapsed:!1,showBanner:!1}},computed:{summaryInfoMessage:function(){var t=this.eventList.meta.summary_event_count,e=this.eventList.meta.summary_unique_event_count;return"[experimental] This summary is based on the message field on your current page (".concat(t," rows, ").concat(e," unique message fields).")},sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},highlightEventId:function(){return this.highlightEvent?this.highlightEvent._id:null},totalHits:function(){return this.eventList.meta.es_total_count>0&&0===this.eventList.meta.es_total_count_complete?this.eventList.meta.es_total_count:this.eventList.meta.es_total_count_complete||0},totalHitsForPagination:function(){return this.eventList.meta.es_total_count||0},totalTime:function(){return this.eventList.meta.es_time/1e3||0},fromEvent:function(){return this.currentQueryFilter.from||1},toEvent:function(){if(!(this.totalHits<this.currentQueryFilter.size))return parseInt(this.currentQueryFilter.from)+parseInt(this.currentQueryFilter.size)},timeFilterChips:function(){return this.currentQueryFilter.chips.filter(function(t){return t.type.startsWith("datetime")})},currentSearchNode:function(){return this.$store.state.currentSearchNode},userSettings:function(){return this.$store.state.settings},headers:function(){var t=[{text:"",value:"data-table-select",sortable:!1},{value:"actions",width:"105",sortable:!1},{text:"Datetime (UTC) ",align:"start",value:"_source.timestamp",width:"200",sortable:!0},{value:"_source.comment",width:"40",sortable:!1}],e=[];return this.selectedFields.forEach(function(t){var i={text:t.field,align:"start",value:"_source."+t.field,sortable:!1};"message"===t.field?(i.width="100%",e.unshift(i)):e.push(i)}),t.splice.apply(t,[3,0].concat(e)),this.displayOptions.showTimelineName&&t.push({value:"timeline_name",align:"end",sortable:!1}),t},activeContext:function(){return this.$store.state.activeContext},settings:function(){return this.$store.state.settings},filterChips:function(){return this.currentQueryFilter.chips.filter(function(t){return"label"===t.type||"term"===t.type})}},methods:{toggleSummary:function(){this.summaryCollapsed=!this.summaryCollapsed,localStorage.setItem("aiSummaryCollapsed",String(this.summaryCollapsed))},sortEvents:function(t){this.currentQueryFilter.order=t?"asc":"desc",this.search(!0,!0,!1)},getFieldName:function(t){return"item._source."+t},toggleDetailedEvent:function(t){var e=this.expandedRows.findIndex(function(e){return e._id===t._id});if(this.expandedRows.some(function(e){return e._id===t._id})){if(!t.showDetails)return t["showDetails"]=!0,this.expandedRows.splice(e,1),void this.expandedRows.push(t);t["showDetails"]=!1,this.expandedRows.splice(e,1),this.$set(t,"showComments",!1),t.deltaDays&&(this.expandedRows.splice(e,1),this.expandedRows.push(t))}else t["showDetails"]=!0,this.expandedRows.push(t)},newComment:function(t){t.showDetails?this.$set(t,"showComments",!0):(this.$set(t,"showComments",!0),this.toggleDetailedEvent(t))},addTimeBubbles:function(){var t=this;this.expandedRows=[],this.eventList.objects.forEach(function(e,i){if(!(i<1)){var n=t.eventList.objects[i-1],s=t.$options.filters.formatTimestamp(e._source.timestamp),a=t.$options.filters.formatTimestamp(n._source.timestamp),r=Math.floor(s/1e3),o=Math.floor(a/1e3),l=Math.floor(r-o);"desc"===t.order&&(l=Math.floor(o-r));var c=Math.floor(l/60/60/24);c>0&&(n["deltaDays"]=c,t.expandedRows.push(n))}})},getTimelineColor:function(t){var e=this.getTimeline(t),i=e.color;return i.startsWith("#")||(i="#"+i),this.$vuetify.theme.dark?{"background-color":i,filter:"grayscale(25%)",color:"#333"}:{"background-color":i}},getTimeBubbleColor:function(){var t="#f5f5f5";return this.$vuetify.theme.dark&&(t="#333"),{"background-color":t}},getAllIndices:function(){var t=this,e=[];return this.sketch.active_timelines.forEach(function(i){var n=t.meta.indices_metadata[i.searchindex.index_name].is_legacy;n?e.push(i.searchindex.index_name):e.push(i.id)}),e},search:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isSummaryLoading=!0,this.currentQueryFilter.indices&&!this.currentQueryFilter.indices.length)return this.eventList=yn(),void(this.isSummaryLoading=!1);if("_all"!==this.currentQueryFilter.indices[0]&&"_all"!==this.currentQueryFilter.indices||(this.currentQueryFilter.indices=this.getAllIndices()),this.currentQueryString||this.currentQueryDsl){this.searchInProgress=!0,this.selectedEvents=[],this.eventList=yn(),e&&(this.tableOptions.page=1,this.currentPage=1,this.currentItemsPerPage=this.tableOptions.itemsPerPage,this.currentQueryFilter.size=this.tableOptions.itemsPerPage,this.currentQueryFilter.from=0),this.currentQueryFilter.fields=this.selectedFields;var s={};this.currentQueryDsl&&(s.dsl=this.currentQueryDsl,s.filter=this.currentQueryFilter),this.currentQueryString&&(s.query=this.currentQueryString,s.filter=this.currentQueryFilter),i&&(s["incognito"]=!0),n&&(s["parent"]=n),n&&i&&(this.branchParent=n),this.branchParent&&(s["parent"]=this.branchParent),s["scenario"]=this.activeContext.scenarioId,s["facet"]=this.activeContext.facetId,s["question"]=this.activeContext.questionId,s["include_processing_timelines"]=this.settings.showProcessingTimelineEvents,_.search(this.sketch.id,s).then(function(e){t.eventList.objects=e.data.objects,t.eventList.meta=e.data.meta,t.updateShowBanner(),t.searchInProgress=!1,o.$emit("updateCountPerTimeline",e.data.meta.count_per_timeline),t.$emit("countPerTimeline",e.data.meta.count_per_timeline),t.$emit("countPerIndex",e.data.meta.count_per_index),t.addTimeBubbles(),i||(o.$emit("createBranch",t.eventList.meta.search_node),t.$store.dispatch("updateSearchHistory"),t.$store.dispatch("updateTimeFilters"),t.branchParent=t.eventList.meta.search_node.id),t.userSettings.eventSummarization&&t.eventList.objects.length>0&&t.fetchEventSummary()}).catch(function(e){var i='Sorry, there was a problem fetching your search results. Error: "'+e.response.data.message+'"';e.response.data.message.includes("too_many_nested_clauses")||e.response.data.message.includes("query_shard_exception")?(i='Sorry, your query is too complex. Use field-specific search (like "message:(<query terms>)") and try again.',t.warningSnackBar(i)):t.errorSnackBar(i),console.error("Error message: "+i),console.error(e)})}},fetchEventSummary:function(){var t=this,e={query:this.currentQueryString,filter:this.currentQueryFilter};_.llmRequest(this.sketch.id,"llm_summarize",e).then(function(e){t.$set(t.eventList.meta,"summary",e.data.response),t.$set(t.eventList.meta,"summary_event_count",e.data.summary_event_count),t.$set(t.eventList.meta,"summary_unique_event_count",e.data.summary_unique_event_count),t.isSummaryLoading=!1}).catch(function(e){console.error("Error fetching event summary:",e),t.$set(t.eventList.meta,"summaryError",!0),t.isSummaryLoading=!1})},exportSearchResult:function(){var t=this;this.exportDialog=!0;var e=new Date,i="timesketch_export_"+e.toISOString()+".zip",n={query:this.currentQueryString,filter:this.currentQueryFilter,file_name:i};_.exportSearchResult(this.sketch.id,n).then(function(e){var n=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=n,s.setAttribute("download",i),document.body.appendChild(s),s.click(),t.exportDialog=!1}).catch(function(e){console.error(e),t.exportDialog=!1})},addChip:function(t){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.push(t),this.search()},removeChip:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.currentQueryFilter.chips.findIndex(function(e){return e.value===t.value});this.currentQueryFilter.chips.splice(i,1),e&&this.search()},removeChips:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Array.isArray(t)?(t.forEach(function(t){e.removeChip(t,!1)}),i&&this.search()):this.errorSnackBar("Not an array of chips")},addChipFromHistogram:function(t){var e=this;this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.forEach(function(t){"datetime_range"===t.type&&e.removeChip(t,!1)}),this.addChip(t)},paginate:function(){if(this.tableOptions.itemsPerPage!==this.currentItemsPerPage)return this.tableOptions.page=1,this.currentPage=1,this.currentItemsPerPage=this.tableOptions.itemsPerPage,this.currentQueryFilter.size=this.tableOptions.itemsPerPage,void this.search(!0,!0);this.currentPage!==this.tableOptions.page&&(this.currentQueryFilter.from=this.tableOptions.page*this.currentQueryFilter.size-this.currentQueryFilter.size,this.currentPage=this.tableOptions.page,this.search(!1,!0))},updateSelectedFields:function(t){var e=this;t.forEach(function(t){!e.headers.filter(function(e){return e.field===t.field}).length>0&&e.search(!0,!0)})},removeField:function(t){this.selectedFields.splice(t,1)},toggleStar:function(t){var e=this,i=0;t._source.label.includes("__ts_star")?(t._source.label.splice(t._source.label.indexOf("__ts_star"),1),i=-1):(t._source.label.push("__ts_star"),i=1),_.saveEventAnnotation(this.sketch.id,"label","__ts_star",t,this.currentSearchNode).then(function(t){e.$store.dispatch("updateEventLabels",{label:"__ts_star",num:i})}).catch(function(t){console.error(t)})},toggleMultipleStars:function(){var t=this,e=0;this.selectedEvents.forEach(function(t){t._source.label.includes("__ts_star")?(t._source.label.splice(t._source.label.indexOf("__ts_star"),1),e--):(t._source.label.push("__ts_star"),e++)}),_.saveEventAnnotation(this.sketch.id,"label","__ts_star",this.selectedEvents,this.currentSearchNode).then(function(i){t.$store.dispatch("updateEventLabels",{label:"__ts_star",num:e}),t.selectedEvents=[]}).catch(function(t){})},saveSearch:function(){var t=this;_.createView(this.sketch.id,this.saveSearchFormName,this.currentQueryString,this.currentQueryFilter).then(function(e){t.saveSearchFormName="",t.saveSearchMenu=!1;var i=e.data.objects[0];t.$store.state.meta.views.push(i)}).catch(function(t){})},updateShowBanner:function(){var t=this;this.showBanner=!!this.settings.showProcessingTimelineEvents&&this.sketch.active_timelines.filter(function(e){return t.$store.state.enabledTimelines.includes(e.id)}).some(function(t){return t.status&&"processing"===t.status[0].status})}},watch:{tableOptions:{handler:function(t,e){void 0!==e.sortDesc&&t.sortDesc[0]===e.sortDesc[0]&&this.paginate()},deep:!0},queryRequest:{handler:function(t,e){if(t!==e&&t){this.currentQueryString=t.queryString||"",this.currentQueryFilter=t.queryFilter||gn(),this.currentQueryDsl=t.queryDsl||null;var i=t["resetPagination"]||!1,n=t["incognito"]||!1,s=t["parent"]||!1;this.currentQueryFilter.fields&&(this.selectedFields=this.currentQueryFilter.fields),this.sortOrderAsc?this.currentQueryFilter.order="asc":this.currentQueryFilter.order="desc",this.search(i,n,s)}},deep:!0},"settings.showProcessingTimelineEvents":{handler:function(){this.updateShowBanner()}},"displayOptions.showTimelineName":function(t){localStorage.setItem("showTimelineName",String(t))}},created:function(){if(Object.keys(this.queryRequest).length){this.currentQueryString=this.queryRequest.queryString,this.currentQueryFilter=(0,D.A)({},this.queryRequest.queryFilter)||gn(),this.currentQueryDsl=(0,D.A)({},this.queryRequest.queryDsl),this.currentQueryFilter.fields&&(this.selectedFields=this.currentQueryFilter.fields);var t=localStorage.getItem("aiSummaryCollapsed");"true"===t&&(this.summaryCollapsed=!0),this.search()}}},bn=_n,Sn=(0,u.A)(bn,fe,ge,!1,null,null,null),wn=Sn.exports,kn=function(){var t=this,e=t._self._c;return e("ts-search-guide-card",{attrs:{flat:t.flat,"show-tags":!1,"show-data-types":!1,"show-saved-searches":!1},on:{"search-triggered":function(e){return t.$emit("close-dialog")}},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"pa-4 pb-0"},[e("v-card-title",[e("v-icon",{attrs:{large:"",left:""}},[t._v("mdi-file-search-outline")]),t._v(" Search Examples and Query Guide "),e("v-spacer"),t.flat?e("v-btn",{attrs:{icon:"",title:"Close dialog"},on:{click:function(e){return t.$emit("close-dialog")}}},[e("v-icon",[t._v("mdi-close")])],1):t._e()],1),e("v-card-subtitle",{staticClass:"mt-1"},[t._v(" Find below some examples on how to explore your data. ")]),e("v-divider")],1)]},proxy:!0}])})},xn=[],Tn={name:"TsSearchHelpCard",props:{flat:{type:Boolean,default:!1}},components:{TsSearchGuideCard:rn}},Cn=Tn,An=(0,u.A)(Cn,kn,xn,!1,null,null,null),Dn=An.exports,Ln=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},In={directives:{dragscroll:V.S7},components:{TsSearchHistoryTree:nt,TsSearchHistoryButtons:ct,TsSearchDropdown:St,TsTimelinePicker:Vt,TsFilterMenu:Jt,TsUploadTimelineFormButton:ce,TsAddManualEvent:pe,TsEventList:wn,TsSearchHelpCard:Dn},props:["sketchId"],data:function(){return{countPerIndex:{},countPerTimeline:{},currentItemsPerPage:40,timeFilterMenu:!1,selectedFields:[{field:"message",type:"text"}],showRightSidePanel:!1,addManualEvent:!1,datetimeManualEvent:"",params:{},contextEvent:!1,originalContext:!1,showSearchDropdown:!1,activeQueryRequest:{},currentQueryString:"",currentQueryFilter:Ln(),selectedLabels:[],showSearchHistory:!1,showSearchHelp:!1,zoomLevel:.7,zoomOrigin:{x:0,y:0},quickTags:[{tag:"bad",color:"red",textColor:"white",label:"mdi-alert-circle-outline"},{tag:"suspicious",color:"orange",textColor:"white",label:"mdi-help-circle-outline"},{tag:"good",color:"green",textColor:"white",label:"mdi-check-circle-outline"}],showTimelines:!0}},computed:{sketch:function(){return this.$store.state.sketch},enabledTimelines:function(){return this.$store.state.enabledTimelines},meta:function(){return this.$store.state.meta},filterChips:function(){return this.currentQueryFilter.chips.filter(function(t){return"label"===t.type||"term"===t.type})},timeFilterChips:function(){return this.currentQueryFilter.chips.filter(function(t){return t.type.startsWith("datetime")})},filteredLabels:function(){return this.$store.state.meta.filter_labels.filter(function(t){return!t.label.startsWith("__")})},currentSearchNode:function(){return this.$store.state.currentSearchNode},activeContext:function(){return this.$store.state.activeContext},activeTimelines:function(){var t=(0,B.A)(this.sketch.active_timelines);return t.sort(function(t,e){return t.name.localeCompare(e.name)})}},watch:{enabledTimelines:function(){this.updateEnabledTimelines(this.enabledTimelines)}},methods:{getQuickTag:function(t){return this.quickTags.find(function(e){return e.tag===t})},updateCountPerIndex:function(t){this.countPerIndex=t},updateCountPerTimeline:function(t){this.countPerTimeline=t},toggleSearchHistory:function(){this.showSearchHistory=!this.showSearchHistory,this.showSearchHistory&&this.triggerScrollTo()},setQueryAndFilter:function(t){if("Explore"!==this.$route.name&&this.$router.push({name:"Explore",params:{sketchId:this.sketch.id}}),t.queryString&&(this.currentQueryString=t.queryString),t.queryFilter||(t.queryFilter=this.currentQueryFilter),this.currentQueryFilter=t.queryFilter,t.chip){var e=this.currentQueryFilter.chips.find(function(e){return e.value===t.chip.value});e||this.currentQueryFilter.chips.push(t.chip)}this.currentQueryFilter.size=this.currentItemsPerPage,this.currentQueryFilter.terminate_after=this.currentItemsPerPage,t.doSearch&&(t.incognito?this.search(!0,!0):this.search())},search:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n={};n["queryString"]=this.currentQueryString,n["queryFilter"]=this.currentQueryFilter,n["resetPagination"]=t,n["incognito"]=e,n["parent"]=i,this.activeQueryRequest=n,this.showSearchDropdown=!1},searchView:function(t){var e=this;this.showSearchDropdown=!1,"Explore"!==this.$route.name&&this.$router.push({name:"Explore",params:{sketchId:this.sketch.id}}),t!==parseInt(t,10)&&"string"!==typeof t&&(t=t.id),_.getView(this.sketchId,t).then(function(t){var i=t.data.objects[0];e.currentQueryString=i.query_string,e.currentQueryFilter=JSON.parse(i.query_filter),e.currentQueryFilter.fields&&e.currentQueryFilter.fields.length||(e.currentQueryFilter.fields=[{field:"message",type:"text"}]),e.selectedFields=e.currentQueryFilter.fields;var n=e.currentQueryFilter.chips;if(n)for(var s=0;s<n.length;s++)"label"===n[s].type&&e.selectedLabels.push(n[s].value);e.contextEvent=!1,e.search()}).catch(function(t){})},searchContext:function(t){var e=300,i=500;if(this.contextEvent=t,!this.originalContext){var n=JSON.parse(JSON.stringify(this.currentQueryString)),s=JSON.parse(JSON.stringify(this.currentQueryFilter));this.originalContext={queryString:n,queryFilter:s}}var a="YYYY-MM-DDTHH:mm:ss",r=this.$moment.utc(this.contextEvent._source.datetime),o=r.clone().subtract(e,"s").format(a),l=r.clone().add(e,"s").format(a),c={field:"",value:o+","+r.format(a),type:"datetime_range",operator:"must",active:!0},u={field:"",value:r.format(a)+","+l,type:"datetime_range",operator:"must",active:!0};this.currentQueryString="* OR _id:"+this.contextEvent._id,this.currentQueryFilter.chips=[c,u];var d=this.meta.indices_metadata[this.contextEvent._index].is_legacy;this.currentQueryFilter.indices=d?[this.contextEvent._index]:[this.contextEvent._source.__ts_timeline_id],this.currentQueryFilter.size=i,this.search()},removeContext:function(){this.contextEvent=!1,this.currentQueryString=JSON.parse(JSON.stringify(this.originalContext.queryString)),this.currentQueryFilter=JSON.parse(JSON.stringify(this.originalContext.queryFilter)),this.search()},updateEnabledTimelines:function(t){this.currentQueryFilter.indices=t,this.search()},toggleChip:function(t){void 0===t.active&&(t.active=!0),t.active=!t.active,this.search()},copyFilterChip:function(t){var e=this,i="";i=t.type.startsWith("datetime")?t.value:"must_not"===t.operator?"NOT ".concat(t.field?"".concat(t.field,":"):"",'"').concat(t.value,'"'):"".concat(t.field?"".concat(t.field,":"):"",'"').concat(t.value,'"'),navigator.clipboard.writeText(i).then(function(){e.infoSnackBar("Copied to clipboard!")}).catch(function(t){e.errorSnackBar("Failed to copy to clipboard."),console.error(t)})},removeChip:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.currentQueryFilter.chips.findIndex(function(e){return e.value===t.value});this.currentQueryFilter.chips.splice(i,1),"label"===t.type&&(this.selectedLabels=this.selectedLabels.filter(function(e){return e!==t.value})),e&&this.search()},updateChip:function(t,e){var i=this.currentQueryFilter.chips.findIndex(function(t){return t.value===e.value&&t.type===e.type});this.currentQueryFilter.chips.splice(i,1,t),this.search()},addChip:function(t){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.push(t),this.search()},addChipFromHistogram:function(t){var e=this;this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.forEach(function(t){"datetime_range"===t.type&&e.removeChip(t,!1)}),this.addChip(t)},toggleLabelChip:function(t){var e={field:"",value:t,type:"label",operator:"must",active:!0},i=this.currentQueryFilter.chips;if(i)for(var n=0;n<i.length;n++)if(i[n].value===t)return void this.removeChip(n);this.addChip(e)},updateLabelChips:function(){var t=this;this.currentQueryFilter.chips=this.currentQueryFilter.chips.filter(function(t){return"label"!==t.type}),this.selectedLabels.forEach(function(e){var i={field:"",value:e,type:"label",operator:"must",active:!0};t.addChip(i),t.showSearchDropdown=!1})},updateLabelList:function(t){-1===this.meta.filter_labels.indexOf(t)&&this.meta.filter_labels.push(t)},jumpInHistory:function(t){var e=this;if(this.currentQueryString=t.query_string,this.currentQueryFilter=JSON.parse(t.query_filter),this.currentQueryFilter.fields&&this.currentQueryFilter.fields.length||(this.currentQueryFilter.fields=[{field:"message",type:"text"}]),this.selectedFields=this.currentQueryFilter.fields,"_all"===this.currentQueryFilter.indices[0]||"_all"===this.currentQueryFilter.indices){var i=[];this.sketch.active_timelines.forEach(function(t){var n=e.meta.indices_metadata[t.searchindex.index_name].is_legacy;n?i.push(t.searchindex.index_name):i.push(t.id)}),this.currentQueryFilter.indices=i}var n=this.currentQueryFilter.chips;if(n)for(var s=0;s<n.length;s++)"label"===n[s].type&&this.selectedLabels.push(n[s].value);this.contextEvent=!1,this.search(!0,!0,t.id)},triggerScrollTo:function(){o.$emit("triggerScrollTo")},zoomWithMouse:function(t){this.zoomOrigin.x=t.pageX,this.zoomOrigin.y=t.pageY,t.deltaY<0?this.zoomLevel+=.07:t.deltaY>0&&(this.zoomLevel-=.07)},closeSearchDropdown:function(t){t!==this.$refs.searchInput&&null===t.getAttribute("data-explore-element")&&(this.showSearchDropdown=!1)},onClickOutside:function(t){"tsSearchInput"!==t.target.id&&(this.showSearchDropdown=!1)},enableAllTimelines:function(){this.$store.dispatch("updateEnabledTimelines",this.activeTimelines.map(function(t){return t.id}))},disableAllTimelines:function(){this.$store.dispatch("updateEnabledTimelines",[])}},mounted:function(){this.$refs.searchInput.focus(),o.$on("setQueryAndFilter",this.setQueryAndFilter),o.$on("setActiveView",this.searchView)},beforeDestroy:function(){o.$off("setQueryAndFilter"),o.$off("setActiveView")},created:function(){var t=this,e=!1;if(this.params={viewId:this.$route.query.view,indexName:this.$route.query.timeline,resultLimit:this.$route.query.limit,queryString:this.$route.query.q},this.params.viewId)this.searchView(this.params.viewId);else{if(this.params.queryString&&(this.currentQueryString=this.params.queryString,e=!0),this.params.indexName){this.params.queryString||(this.currentQueryString="*");var i=this.sketch.active_timelines.find(function(e){return e.id===parseInt(t.params.indexName,10)}),n=this.meta.indices_metadata[i.searchindex.index_name].is_legacy;this.currentQueryFilter.indices=n?[i.searchindex.index_name]:[i.id],e=!0}this.currentQueryString||(this.currentQueryFilter.indices=["_all"]),e&&(this.currentQueryFilter.indices.length||(this.currentQueryFilter.indices=["_all"]),this.search())}}},En=In,Nn=(0,u.A)(En,M,q,!1,null,null,null),zn=Nn.exports,$n=function(){var t=this,e=t._self._c;return e("div",[e("ts-indicator-dialog",{attrs:{dialog:t.indicatorDialog,index:t.currentIndex,"tag-info":t.tagInfo,ioc:t.indicator},on:{"update:dialog":function(e){t.indicatorDialog=e},"open-dialog":function(e){t.indicatorDialog=!0},"close-dialog":function(e){t.indicatorDialog=!1,t.currentIndex=-1},save:function(e){t.saveIntelligence(e),t.indicatorDialog=!1}}}),e("v-container",{attrs:{fluid:""}},[e("v-btn",{staticClass:"mt-n1 ml-3",attrs:{text:"",color:"primary"},on:{click:t.addIndicator}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-plus")]),t._v(" Add Indicator ")],1),e("v-card",{staticClass:"mt-3 mx-3",attrs:{outlined:""}},[e("v-data-table",{attrs:{headers:t.headers,items:t.intelligenceData,"footer-props":{"items-per-page-options":[10,40,80,100,200,500],"show-current-page":!0},"items-per-page":40,selectable:""},scopedSlots:t._u([{key:"item.search",fn:function(i){var n=i.item;return[e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.generateSearchQuery(n.ioc)}}},[e("v-icon",{attrs:{title:"Search this indicator",small:""}},[t._v("mdi-magnify")])],1)]}},{key:"item.externalURI",fn:function(i){var n=i.item;return[n.externalURI?e("v-icon",{attrs:{title:"Open link","x-small":""}},[t._v("mdi-open-in-new")]):t._e(),t.getValidUrl(n.externalURI)?e("a",{staticStyle:{"text-decoration":"none"},attrs:{href:t.getValidUrl(n.externalURI),target:"_blank"}},[t._v(" "+t._s(t.getValidUrl(n.externalURI).host))]):t._e()]}},{key:"item.type",fn:function(e){var i=e.item;return[t._v(" "+t._s(t.getIocTypeMetadata(i).humanReadable)+" ")]}},{key:"item.tags",fn:function(i){var n=i.item;return[e("v-chip-group",t._l(t.augmentedTags(n.tags).sort(function(t,e){return e.weight-t.weight}),function(i){return e("v-chip",{key:i.name,attrs:{small:"",color:i.color,"text-color":i.textColor,outlined:"outlined"===i.style},on:{click:function(e){return t.searchForIOC(i)}}},[t._v(" "+t._s(i.name)+" ")])}),1)]}},{key:"item.actions",fn:function(i){var n=i.item;return[e("v-btn",{attrs:{small:"",icon:""},on:{click:function(e){return t.editIndicator(n.index)}}},[e("v-icon",{attrs:{small:"",title:"Edit indicator"}},[t._v("mdi-pencil")])],1),e("v-btn",{attrs:{small:"",icon:""},on:{click:function(e){return t.deleteIndicator(n.index)}}},[e("v-icon",{attrs:{small:"",title:"Delete indicator"}},[t._v("mdi-trash-can-outline")])],1)]}}])})],1)],1)],1)},Fn=[],Rn=(i(71761),function(){var t=this,e=t._self._c;return e("v-dialog",{attrs:{value:t.dialog,"max-width":"600px"},on:{input:function(e){return t.$emit("input",e)},"click:outside":function(e){return t.closeDialog()}}},[e("v-card",{staticClass:"pa-4"},[e("h3",[t._v(t._s(t.title))]),e("br"),e("v-text-field",{attrs:{outlined:"",label:"Indicator data"},on:{input:function(e){return t.autoSelectIndicatorType(e)}},model:{value:t.newIndicator.ioc,callback:function(e){t.$set(t.newIndicator,"ioc",e)},expression:"newIndicator.ioc"}}),e("v-select",{attrs:{outlined:"",label:"Indicator type",items:t.indicatorTypes},model:{value:t.newIndicator.type,callback:function(e){t.$set(t.newIndicator,"type",e)},expression:"newIndicator.type"}}),e("v-combobox",{attrs:{items:Object.keys(this.tagInfo),label:"Add tags.. (optional)",outlined:"",chips:"","small-chips":"",multiple:""},model:{value:t.newIndicator.tags,callback:function(e){t.$set(t.newIndicator,"tags",e)},expression:"newIndicator.tags"}}),e("v-text-field",{attrs:{outlined:"",label:"External reference (optional)"},model:{value:t.newIndicator.externalURI,callback:function(e){t.$set(t.newIndicator,"externalURI",e)},expression:"newIndicator.externalURI"}}),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){return t.closeDialog()}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{text:"",color:"primary",disabled:!t.newIndicator.ioc},on:{click:t.saveIndicator}},[t._v(" Save ")])],1)],1)],1)}),Pn=[],On=[{regex:/^(\/[\S]+)+$/i,type:"fs_path",humanReadable:"Filesystem path"},{regex:/^([-\w]+\.)+[a-z]{2,}$/i,type:"hostname",humanReadable:"Hostname"},{regex:/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g,type:"ipv4"},{regex:/^[0-9a-f]{64}$/i,type:"hash_sha256",humanReadable:"SHA256"},{regex:/^[0-9a-f]{40}$/i,type:"hash_sha1",humanReadable:"SHA1"},{regex:/^[0-9a-f]{32}$/i,type:"hash_md5",humanReadable:"MD5"},{regex:/./g,type:"other",humanReadable:"Other"}],Qn=function(){return{ioc:"",type:"other",externalURI:"",tags:[]}},Mn={props:["dialog","tagInfo","index","ioc"],data:function(){return{IOCTypes:On,newIndicator:Qn()}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},intelligenceAttribute:function(){return void 0===this.meta.attributes.intelligence?{ontology:"intelligence",value:{data:[]},name:"intelligence"}:this.meta.attributes.intelligence},indicatorTypes:function(){return this.IOCTypes.map(function(t){return t.type})},title:function(){return this.index<0?"Create new indicator":"Edit indicator"}},methods:{closeDialog:function(){this.index<0&&(this.newIndicator.ioc=""),this.$emit("close-dialog")},autoSelectIndicatorType:function(t){var e,i=(0,Le.A)(this.IOCTypes);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(n.regex.test(t))return void(this.newIndicator.type=n.type)}}catch(s){i.e(s)}finally{i.f()}},saveIndicator:function(){this.$emit("save",this.newIndicator),this.newIndicator=Qn()}},watch:{index:function(){this.index<0?this.newIndicator=Qn():this.newIndicator=this.intelligenceAttribute.value.data[this.index]},ioc:function(){""!==this.ioc&&(this.newIndicator.ioc=this.ioc,this.autoSelectIndicatorType(this.ioc))}}},qn=Mn,Bn=(0,u.A)(qn,Rn,Pn,!1,null,"303f7a96",null),Vn=Bn.exports,Hn=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},Gn={props:[],components:{TsIndicatorDialog:Vn},data:function(){return{headers:[{text:"",value:"search",align:"start"},{text:"Indicator data",value:"ioc"},{text:"Indicator type",value:"type"},{text:"Tags",value:"tags"},{text:"External reference",value:"externalURI"},{text:"",value:"actions"}],tagInfo:{},indicatorDialog:!1,currentIndex:-1,indicator:"",tagMetadata:{default:{weight:0,type:"default"}},tagColorDefinitions:{danger:{color:"red",textColor:"white"},warning:{color:"orange",textColor:"white"},legit:{color:"green",textColor:"white"},default:{color:"default",textColor:null},info:{color:"blue",textColor:null,style:"outlined"}}}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},intelligenceAttribute:function(){return void 0===this.meta.attributes.intelligence?{ontology:"intelligence",value:{data:[]},name:"intelligence"}:this.meta.attributes.intelligence},intelligenceData:function(){return this.intelligenceAttribute.value.data.map(function(t,e){return(0,D.A)((0,D.A)({},t),{},{index:e})})}},methods:{addIndicator:function(){this.indicatorDialog=!0},loadTagMetadata:function(){var t=this;_.getTagMetadata().then(function(e){t.tagMetadata=e.data})},metadataForTag:function(t){var e=this.tagMetadata["default"];if(this.tagMetadata[t])e=this.tagMetadata[t];else for(var i in this.tagMetadata["regexes"])t.match(i)&&(e=this.tagMetadata["regexes"][i]);return(0,D.A)((0,D.A)({},this.tagColorDefinitions[e.type]),{},{name:t,weight:e.weight})},augmentedTags:function(t){var e=this;return t.map(function(t){return e.metadataForTag(t)})},getIocTypeMetadata:function(t){var e=On.find(function(e){return e.type===t.type});return void 0!==e?e:On.find(function(t){return"other"===t.type})},deleteIndicator:function(t){var e=this;confirm("Delete indicator?")&&(this.intelligenceAttribute.value.data.splice(t,1),_.addSketchAttribute(this.sketch.id,"intelligence",this.intelligenceAttribute.value,"intelligence").then(function(){e.successSnackBar("Indicator deleted"),e.buildTagInfo()}).catch(function(t){e.errorSnackBar("Failed to save indicator"),console.error(t)}))},editIndicator:function(t){this.currentIndex=t,this.indicatorDialog=!0},getValidUrl:function(t){return void 0!==t&&null!==t&&""!==t&&(t.startsWith("http")?new URL(t):!!t.includes("/")&&new URL("http://"+t))},buildTagInfo:function(){this.tagInfo={};var t,e=(0,Le.A)(this.intelligenceData);try{for(e.s();!(t=e.n()).done;){var i,n=t.value,s=(0,Le.A)(n.tags);try{for(s.s();!(i=s.n()).done;){var a=i.value,r=null;r="object"===(0,U.A)(a)?a.name:a,this.tagInfo[r]||(this.tagInfo[r]={iocs:[]}),this.tagInfo[r].iocs.push(n.ioc)}}catch(o){s.e(o)}finally{s.f()}}}catch(o){e.e(o)}finally{e.f()}},generateSearchQuery:function(t,e){var i='"'.concat(t,'"');i=i.replace(/[\\\s]/g,"\\$&"),void 0!==e&&(i="".concat(e,":").concat(i));var n={doSearch:!0};n.queryString=i,n.queryFilter=Hn(),o.$emit("setQueryAndFilter",n)},searchForIOC:function(t){var e=this.tagInfo[t]||{},i=e.iocs.map(function(t){return'"'.concat(t,'"')}).reduce(function(t,e){return"".concat(t," OR ").concat(e)}),n={doSearch:!0};n.queryString=i,n.queryFilter=Hn(),o.$emit("setQueryAndFilter",n)},saveIntelligence:function(t){var e=this;this.currentIndex<0&&this.intelligenceAttribute.value.data.push(t),_.addSketchAttribute(this.sketch.id,"intelligence",this.intelligenceAttribute.value,"intelligence").then(function(){e.successSnackBar("Indicator saved"),e.buildTagInfo()}).catch(function(t){e.errorSnackBar("Failed to save indicator"),console.error(t)})},showIndicatorDialog:function(t){this.indicator=t,this.indicatorDialog=!0}},mounted:function(){o.$on("addIndicator",this.showIndicatorDialog),this.buildTagInfo(),this.loadTagMetadata()},beforeDestroy:function(){o.$off("addIndicator")}},Un=Gn,Wn=(0,u.A)(Un,$n,Fn,!1,null,null,null),jn=Wn.exports,Yn=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-card",{staticClass:"mx-3",attrs:{flat:""}},[e("ts-sigma-editor",{attrs:{"rule-id":t.ruleId}})],1)],1)},Xn=[],Jn=function(){var t=this,e=t._self._c;return e("div",[e("v-toolbar",{staticClass:"mt-n3 ml-n4",attrs:{dense:"",flat:"",color:"transparent"}},[t.editingRule.title?e("v-toolbar-title",[t._v(" "+t._s(t.editingRule.title))]):e("v-toolbar-title",[t._v(" Create new rule")])],1),t.ruleId?t._e():e("v-autocomplete",{staticClass:"mb-4 mt-2",staticStyle:{width:"300px"},attrs:{align:"left",dense:"",outlined:"","hide-details":"",items:t.SigmaTemplates,"item-text":"title",label:"Choose template"},on:{change:t.selectTemplate}}),t.editingRule.search_query?e("div",[!t.isParsingSuccesful&&t.status_text?e("v-alert",{attrs:{type:"error",outlined:"",dense:""}},[t._v(" "+t._s(t.status_text)+" ")]):e("v-alert",{attrs:{type:"success",outlined:"",dense:""}},[t._v(" Preview: "),e("span",{staticStyle:{"font-family":"monospace"}},[t._v(t._s(t.editingRule.search_query))])])],1):t._e(),e("v-card",{attrs:{outlined:""}},[e("v-textarea",{staticClass:"editSigmaRule",attrs:{solo:"",flat:"","hide-details":"",rows:"25",autofocus:"",placeholder:"Get started by choosing a template above..",color:this.isParsingSuccesful?"success":"error"},on:{input:function(e){return t.parseSigma(t.ruleYamlTextArea)}},model:{value:t.ruleYamlTextArea,callback:function(e){t.ruleYamlTextArea=e},expression:"ruleYamlTextArea"}}),e("v-divider"),e("v-card-actions",[e("v-btn",{attrs:{disabled:!t.isParsingSuccesful,text:"",color:"primary"},on:{click:function(e){return t.saveRule()}}},[t._v(" Save ")]),e("v-btn",{staticStyle:{"margin-left":"10px"},attrs:{text:"",to:{name:"Explore"}}},[t._v(" Cancel ")])],1)],1)],1)},Kn=[];try{var Zn=crypto.randomUUID()}catch(gd){console.log("crypto.randomUUID() not supported, using a fixed value instead"),Zn="10a4fb8c-29d5-4eb6-905f-13d6a553d470"}var ts="title: SigmaRuleTemplateTitle\nid: ".concat(Zn,"\ndescription: Detects suspicious activity\nreferences:\n  - https://\nauthor: Timesketch\ndate: ").concat(new Date(Date.now()).toLocaleString("en-ZA").split(",")[0],"\nmodified: ").concat(new Date(Date.now()).toLocaleString("en-ZA").split(",")[0],"\nstatus: experimental\nfalsepositives: unknown\nlevel: informational\ntags:\n    - attack.defense_evasion"),es="falsepositives:\n    - Unknown\nstatus: experimental\nlevel: medium\ndetection:\n    keywords:\n        - '*foobar*'\n    condition: keywords",is="".concat(ts,"\nlogsource:\n    product: aws\n    service: cloudtrail\n").concat(es,"\n"),ns="".concat(ts,"\nlogsource:\n    product: azure\n    service: activitylogs\n").concat(es,"\n"),ss="".concat(ts,"\nlogsource:\n    product: azure\n    service: signinlogs\n").concat(es,"\n"),as="".concat(ts,"\nlogsource:\n    product: gcp\n    service: gcp.audit\n").concat(es,"\n"),rs="".concat(ts,"\nlogsource:\n    product: google_workspace\n    service: google_workspace.admin\n").concat(es,"\n"),os="".concat(ts,"\nlogsource:\n    product: m365\n    service: threat_management\n").concat(es,"\n"),ls="".concat(ts,"\nlogsource:\n    product: okta\n    service: okta\n").concat(es,"\n"),cs="".concat(ts,"\nlogsource:\n    category: file_create\n    product: linux\n").concat(es,"\n"),us="".concat(ts,"\nlogsource:\n    category: network_connection\n    product: linux\n").concat(es,"\n"),ds="".concat(ts,"\nlogsource:\n    category: process_creation\n    product: linux\n").concat(es,"\n"),hs="".concat(ts,"\nlogsource:\n    product: linux\n").concat(es,"\n"),ms="".concat(ts,"\nlogsource:\n    category: auditd\n    product: linux\n").concat(es,"\n"),vs="".concat(ts,"\nlogsource:\n    category: clamav\n    product: linux\n").concat(es,"\n"),ps="".concat(ts,"\nlogsource:\n    category: cron\n    product: linux\n").concat(es,"\n"),fs="".concat(ts,"\nlogsource:\n    category: guacamole\n    product: linux\n").concat(es,"\n"),gs="".concat(ts,"\nlogsource:\n    category: modsecurity\n    product: linux\n").concat(es,"\n"),ys="".concat(ts,"\nlogsource:\n    category: sudo\n    product: linux\n").concat(es,"\n"),_s="".concat(ts,"\nlogsource:\n    category: sshd\n    product: linux\n").concat(es,"\n"),bs="".concat(ts,"\nlogsource:\n    category: syslog\n    product: linux\n").concat(es,"\n"),Ss="".concat(ts,"\nlogsource:\n    category: vsftpd\n    product: linux\n").concat(es,"\n"),ws="".concat(ts,"\nlogsource:\n    category: file_event\n    product: macos\n").concat(es,"\n"),ks="".concat(ts,"\nlogsource:\n    category: process_creation\n    product: macos\n").concat(es,"\n"),xs="".concat(ts,"\nlogsource:\n    category: clipboard_capture\n    product: windows\n").concat(es,"\n"),Ts="".concat(ts,"\nlogsource:\n    category: create_remote_thread\n    product: windows\n").concat(es,"\n"),Cs="".concat(ts,"\nlogsource:\n    category: create_stream_hash\n    product: windows\n").concat(es,"\n"),As="".concat(ts,"\nlogsource:\n    category: dns_query\n    product: windows\n").concat(es,"\n"),Ds="".concat(ts,"\nlogsource:\n    category: driver_load\n    product: windows\n").concat(es,"\n"),Ls="".concat(ts,"\nlogsource:\n    category: file_change\n    product: windows\n").concat(es,"\n"),Is="".concat(ts,"\nlogsource:\n    category: file_delete\n    product: windows\n").concat(es,"\n"),Es="".concat(ts,"\nlogsource:\n    category: file_event\n    product: windows\n").concat(es,"\n"),Ns="".concat(ts,"\nlogsource:\n    category: image_load\n    product: windows\n").concat(es,"\n"),zs="".concat(ts,"\nlogsource:\n    category: network_connection\n    product: windows\n").concat(es,"\n"),$s="".concat(ts,"\nlogsource:\n    category: pipe_created\n    product: windows\n").concat(es,"\n"),Fs="".concat(ts,"\nlogsource:\n    category: process_access\n    product: windows\n").concat(es,"\n"),Rs="".concat(ts,"\nlogsource:\n    category: process_creation\n    product: windows\n").concat(es,"\n"),Ps="".concat(ts,"\nlogsource:\n    category: process_tampering\n    product: windows\n").concat(es,"\n"),Os="".concat(ts,"\nlogsource:\n    category: process_termination\n    product: windows\n").concat(es,"\n"),Qs="".concat(ts,"\nlogsource:\n    category: ps_classic_provider_start\n    product: windows\n").concat(es,"\n"),Ms="".concat(ts,"\nlogsource:\n    category: ps_classic_script\n    product: windows\n").concat(es,"\n"),qs="".concat(ts,"\nlogsource:\n    category: ps_classic_start\n    product: windows\n").concat(es,"\n"),Bs="".concat(ts,"\nlogsource:\n    category: ps_module\n    product: windows\n").concat(es,"\n"),Vs="".concat(ts,"\nlogsource:\n    category: ps_script\n    product: windows\n").concat(es,"\n"),Hs="".concat(ts,"\nlogsource:\n    category: raw_access_thread\n    product: windows\n").concat(es,"\n"),Gs="".concat(ts,"\nlogsource:\n    category: registry_add\n    product: windows\n").concat(es,"\n"),Us="".concat(ts,"\nlogsource:\n    category: registry_delete\n    product: windows\n").concat(es,"\n"),Ws="".concat(ts,"\nlogsource:\n    category: registry_event\n    product: windows\n").concat(es,"\n"),js="".concat(ts,"\nlogsource:\n    category: registry_rename\n    product: windows\n").concat(es,"\n"),Ys="".concat(ts,"\nlogsource:\n    category: registry_set\n    product: windows\n").concat(es,"\n"),Xs="".concat(ts,"\nlogsource:\n    category: sysmon_error\n    product: windows\n").concat(es,"\n"),Js="".concat(ts,"\nlogsource:\n    category: sysmon_status\n    product: windows\n").concat(es,"\n"),Ks="".concat(ts,"\nlogsource:\n    category: wmi_event\n    product: windows\n").concat(es,"\n"),Zs="".concat(ts,"\nlogsource:\n    service: application\n    product: windows\n").concat(es,"\n"),ta="".concat(ts,"\nlogsource:\n    service: applocker\n    product: windows\n").concat(es,"\n"),ea="".concat(ts,"\nlogsource:\n    service: bits-client\n    product: windows\n").concat(es,"\n"),ia="".concat(ts,"\nlogsource:\n    service: codeintegrity-operational\n    product: windows\n").concat(es,"\n"),na="".concat(ts,"\nlogsource:\n    service: dhcp\n    product: windows\n").concat(es,"\n"),sa="".concat(ts,"\nlogsource:\n    service:  dns-server\n    product: windows\n").concat(es,"\n"),aa="".concat(ts,"\nlogsource:\n    service: driver-framework\n    product: windows\n").concat(es,"\n"),ra="".concat(ts,"\nlogsource:\n    service: firewall-as\n    product: windows\n").concat(es,"\n"),oa="".concat(ts,"\nlogsource:\n    service:  ldap_debug\n    product: windows\n").concat(es,"\n"),la="".concat(ts,"\nlogsource:\n    service: microsoft-servicebus-client\n    product: windows\n").concat(es,"\n"),ca="".concat(ts,"\nlogsource:\n    service: msexchange-management\n    product: windows\n").concat(es,"\n"),ua="".concat(ts,"\nlogsource:\n    service: ntlm\n    product: windows\n").concat(es,"\n"),da="".concat(ts,"\nlogsource:\n    service: powershell\n    product: windows\n").concat(es,"\n"),ha="".concat(ts,"\nlogsource:\n    service: powershell-classic\n    product: windows\n").concat(es,"\n"),ma="".concat(ts,"\nlogsource:\n    service: printservice-admin\n    product: windows\n").concat(es,"\n"),va="".concat(ts,"\nlogsource:\n    service: printservice-operational\n    product: windows\n").concat(es,"\n"),pa="".concat(ts,"\nlogsource:\n    service: security\n    product: windows\n").concat(es,"\n"),fa="".concat(ts,"\nlogsource:\n    service: security-mitigations\n    product: windows\n").concat(es,"\n"),ga="".concat(ts,"\nlogsource:\n    service: smbclient-security\n    product: windows\n").concat(es,"\n"),ya="".concat(ts,"\nlogsource:\n    service: sysmon\n    product: windows\n").concat(es,"\n"),_a="".concat(ts,"\nlogsource:\n    service: system\n    product: windows\n").concat(es,"\n"),ba="".concat(ts,"\nlogsource:\n    service: taskscheduler\n    product: windows\n").concat(es,"\n"),Sa="".concat(ts,"\nlogsource:\n    service: terminalservices\n    product: windows\n").concat(es,"\n"),wa="".concat(ts,"\nlogsource:\n    service: windefend\n    product: windows\n").concat(es,"\n"),ka="".concat(ts,"\nlogsource:\n    service: wmi\n    product: windows\n").concat(es,"\n"),xa="".concat(ts,"\n").concat(es,"\n"),Ta=[{os:"General",title:"Default template",text:xa},{os:"Cloud",title:"Cloud: AWS",text:is},{os:"Cloud",title:"Cloud: Azure_activitylogs",text:ns},{os:"Cloud",title:"Cloud: Azure_signinlogs",text:ss},{os:"Cloud",title:"Cloud: GCP Audit logs",text:as},{os:"Cloud",title:"Cloud: GWorkspace",text:rs},{os:"Cloud",title:"Cloud: Microsoft 365",text:os},{os:"Cloud",title:"Cloud: Okta",text:ls},{os:"Linux",title:"Linux: File create",text:cs},{os:"Linux",title:"Linux: Network connection",text:us},{os:"Linux",title:"Linux: Process creation",text:ds},{os:"Linux",title:"Linux: Any logs",text:hs},{os:"Linux",title:"Linux: AuditD",text:ms},{os:"Linux",title:"Linux: ClamAV",text:vs},{os:"Linux",title:"Linux: CRON",text:ps},{os:"Linux",title:"Linux: Guacamole",text:fs},{os:"Linux",title:"Linux: Modseurity",text:gs},{os:"Linux",title:"Linux: sudo",text:ys},{os:"Linux",title:"Linux: sshd",text:_s},{os:"Linux",title:"Linux: syslog",text:bs},{os:"Linux",title:"Linux: VSFTPD",text:Ss},{os:"MacOS",title:"MacOS: file_event",text:ws},{os:"MacOS",title:"MacOS: process_creation",text:ks},{os:"Windows",title:"Windows: clipboard_capture",text:xs},{os:"Windows",title:"Windows: create_remote_thread",text:Ts},{os:"Windows",title:"Windows: create_stream_hash",text:Cs},{os:"Windows",title:"Windows: dns_query",text:As},{os:"Windows",title:"Windows: driver_load",text:Ds},{os:"Windows",title:"Windows: file_change",text:Ls},{os:"Windows",title:"Windows: file_delete",text:Is},{os:"Windows",title:"Windows: file_event",text:Es},{os:"Windows",title:"Windows: image_load",text:Ns},{os:"Windows",title:"Windows: network_connection",text:zs},{os:"Windows",title:"Windows: pipe_created",text:$s},{os:"Windows",title:"Windows: process_access",text:Fs},{os:"Windows",title:"Windows: process_creation",text:Rs},{os:"Windows",title:"Windows: process_tampering",text:Ps},{os:"Windows",title:"Windows: process_termination",text:Os},{os:"Windows",title:"Windows: ps_classic_provider_start",text:Qs},{os:"Windows",title:"Windows: ps_classic_script",text:Ms},{os:"Windows",title:"Windows: ps_classic_start",text:qs},{os:"Windows",title:"Windows: ps_module",text:Bs},{os:"Windows",title:"Windows: ps_script",text:Vs},{os:"Windows",title:"Windows: raw_access_thread",text:Hs},{os:"Windows",title:"Windows: registry_add",text:Gs},{os:"Windows",title:"Windows: registry_delete",text:Us},{os:"Windows",title:"Windows: registry_event",text:Ws},{os:"Windows",title:"Windows: registry_rename",text:js},{os:"Windows",title:"Windows: registry_set",text:Ys},{os:"Windows",title:"Windows: sysmon_error",text:Xs},{os:"Windows",title:"Windows: sysmon_status",text:Js},{os:"Windows",title:"Windows: wmi_event",text:Ks},{os:"Windows",title:"Windows: application",text:Zs},{os:"Windows",title:"Windows: applocker",text:ta},{os:"Windows",title:"Windows: bits-client",text:ea},{os:"Windows",title:"Windows: codeintegrity-operational",text:ia},{os:"Windows",title:"Windows: dhcp",text:na},{os:"Windows",title:"Windows: dns-server",text:sa},{os:"Windows",title:"Windows: driver-framework",text:aa},{os:"Windows",title:"Windows: firewall-as",text:ra},{os:"Windows",title:"Windows: ldap_debug",text:oa},{os:"Windows",title:"Windows: microsoft-servicebus-client",text:la},{os:"Windows",title:"Windows: msexchange-management",text:ca},{os:"Windows",title:"Windows: ntlm",text:ua},{os:"Windows",title:"Windows: powershell",text:da},{os:"Windows",title:"Windows: powershell-classic",text:ha},{os:"Windows",title:"Windows: printservice-admin",text:ma},{os:"Windows",title:"Windows: printservice-operational",text:va},{os:"Windows",title:"Windows: security",text:pa},{os:"Windows",title:"Windows: security-mitigations",text:fa},{os:"Windows",title:"Windows: smbclient-security",text:ga},{os:"Windows",title:"Windows: sysmon",text:ya},{os:"Windows",title:"Windows: system",text:_a},{os:"Windows",title:"Windows: taskscheduler",text:ba},{os:"Windows",title:"Windows: terminalservices",text:Sa},{os:"Windows",title:"Windows: windefend",text:wa},{os:"Windows",title:"Windows: wmi",text:ka}],Ca={props:{ruleId:{type:String,default:null}},data:function(){return{editingRule:{},status_text:"",ruleYamlTextArea:"",SigmaTemplates:Ta,search:"",isParsingSuccesful:!1}},methods:{selectTemplate:function(t){var e=this.SigmaTemplates.find(function(e){return e.title===t});this.ruleYamlTextArea=e.text,this.parseSigma(e.text)},parseSigma:Lt().debounce(function(t){var e=this;t?_.getSigmaRuleByText(t).then(function(t){var i=t.data.objects[0];i.tags.length>0&&null==i.tags[0]?(e.status_text="Please specify at least one tag if you use the tags field",e.isParsingSuccesful=!1):i.author?(e.editingRule=i,e.isParsingSuccesful=!0,e.status_text=""):(e.status_text="No author specified",e.isParsingSuccesful=!1)}).catch(function(t){e.status_text=t.response.data.message,e.isParsingSuccesful=!1}):this.editingRule.search_query=""},300),getRuleByUUID:function(t){var e=this;t&&_.getSigmaRuleResource(t).then(function(t){e.editingRule=t.data.objects[0],e.ruleYamlTextArea=e.editingRule.rule_yaml,e.isParsingSuccesful=!0}).catch(function(t){console.error(t),e.isParsingSuccesful=!1,e.ruleYamlTextArea=xa,e.parseSigma(e.ruleYamlTextArea)})},deleteRule:function(t){var e=this;confirm("Delete Rule?")&&_.deleteSigmaRule(t).then(function(t){e.$store.dispatch("updateSigmaList"),e.successSnackBar("Rule deleted!")}).catch(function(i){e.errorSnackBar("Error deleting rule: "+t),console.error(i)})},saveRule:function(){var t=this;this.ruleId?_.updateSigmaRule(this.editingRule.id,this.ruleYamlTextArea).then(function(){t.$store.dispatch("updateSigmaList"),t.successSnackBar("Rule updated: "+t.editingRule.title)}).catch(function(e){t.errorSnackBar("Error updating rule: "+t.editingRule.title),console.error(e)}):_.createSigmaRule(this.ruleYamlTextArea).then(function(){t.$store.dispatch("updateSigmaList"),t.successSnackBar("Rule created: "+t.editingRule.title)}).catch(function(e){t.errorSnackBar("Error creating rule: "+t.editingRule.title),console.error(e)})}},mounted:function(){this.ruleId&&this.getRuleByUUID(this.ruleId)},watch:{ruleId:function(t){t&&this.getRuleByUUID(t)}}},Aa=Ca,Da=(0,u.A)(Aa,Jn,Kn,!1,null,"9d5365e0",null),La=Da.exports,Ia={props:["ruleId"],components:{TsSigmaEditor:La}},Ea=Ia,Na=(0,u.A)(Ea,Yn,Xn,!1,null,null,null),za=Na.exports,$a=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("div",{ref:"graphContainer"},[t.currentGraphPlugin||t.currentSavedGraph?e("ts-cytoscape",{attrs:{"graph-plugin-name":t.currentGraphPlugin,"saved-graph-id":t.currentSavedGraph,"canvas-height":"70vh"}}):t._e()],1)])},Fa=[],Ra=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-card",{staticClass:"pt-0 mt-n6",attrs:{flat:"",color:"transparent"}},[e("v-card",{staticClass:"d-flex align-start mb-1",attrs:{outlined:""}},[e("v-text-field",{staticClass:"pa-2",attrs:{placeholder:"Filter nodes and edges",label:"Filter nodes and edges","append-icon":"mdi-magnify","hide-details":"","single-line":"",dense:"",flat:"",solo:""},on:{input:t.filterGraphByInput},model:{value:t.filterString,callback:function(e){t.filterString=e},expression:"filterString"}})],1),e("v-toolbar",{attrs:{dense:"",flat:"",color:"transparent"}},[e("div",[e("span",{staticClass:"mr-2"},[e("small",[t._v(t._s(t.nodes.length)+" nodes and "+t._s(t.edges.length)+" edges")])]),e("v-btn",{attrs:{icon:"",disabled:!t.edgeQuery},on:{click:function(e){t.saveGraphDialog=!0}}},[e("v-icon",{attrs:{title:"Save selected graph"}},[t._v("mdi-content-save-outline")])],1),e("v-dialog",{attrs:{width:"500"},model:{value:t.saveGraphDialog,callback:function(e){t.saveGraphDialog=e},expression:"saveGraphDialog"}},[e("v-card",{staticClass:"pa-4"},[e("h3",[t._v("Save selected elements")]),e("br"),e("v-text-field",{attrs:{required:"",placeholder:"Name your graph",outlined:"",dense:"",autofocus:""},on:{focus:function(t){return t.target.select()}},model:{value:t.saveAsName,callback:function(e){t.saveAsName=e},expression:"saveAsName"}}),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){t.saveGraphDialog=!1}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{color:"primary",depressed:"",disabled:!t.saveAsName},on:{click:t.saveGraph}},[t._v(" Save ")])],1)],1)],1),e("v-btn",{attrs:{icon:"",disabled:!t.currentGraph},on:{click:function(e){return t.resizeCanvas()}}},[e("v-icon",{attrs:{title:"Fit to canvas"}},[t._v("mdi-fit-to-page-outline")])],1),e("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1,"close-on-click":!0,"content-class":"menu-with-gap"},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({attrs:{icon:"",disabled:!t.currentGraph||!t.graphPluginName}},"v-btn",s,!1),n),[e("v-icon",{attrs:{title:"Graph settings"}},[t._v("mdi-cog-outline")])],1)]}}])},[e("v-card",{staticClass:"pa-4 pt-5",attrs:{width:"600"}},[e("h5",[t._v("Layout type")]),e("v-radio-group",{attrs:{row:""},model:{value:t.layoutName,callback:function(e){t.layoutName=e},expression:"layoutName"}},t._l(t.layouts,function(i){return e("v-radio",{key:i,attrs:{label:i,value:i},on:{click:function(e){return t.buildGraph(t.currentGraph)}}})}),1),e("h5",[t._v("Edge style")]),e("v-radio-group",{attrs:{row:""},model:{value:t.edgeStyle,callback:function(e){t.edgeStyle=e},expression:"edgeStyle"}},t._l(t.edgeStyles,function(i){return e("v-radio",{key:i,attrs:{label:i,value:i},on:{click:function(e){return t.buildGraph(t.currentGraph)}}})}),1),e("h5",[t._v("Transparency for unselected elements")]),e("v-slider",{attrs:{max:100,min:0,"thumb-label":""},on:{change:t.changeOpacity},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var i=e.value;return[t._v(" "+t._s(i)+"% ")]}}]),model:{value:t.fadeOpacity,callback:function(e){t.fadeOpacity=e},expression:"fadeOpacity"}})],1)],1)],1),e("v-spacer"),Object.keys(t.currentGraphCache).length?e("div",[e("i",[e("small",[t._v("Generated "+t._s(t._f("timeSince")(t.currentGraphCache.updated_at)))])]),e("v-btn",{staticClass:"ml-1",attrs:{icon:"",title:"Refresh graph",disabled:!t.currentGraph},on:{click:function(e){return t.buildGraph({name:t.currentGraph},!0)}}},[e("v-icon",{attrs:{title:"Refresh graph"}},[t._v("mdi-refresh")])],1)],1):t._e()],1)],1),t.isLoading?e("div",{staticClass:"pa-4"},[e("v-progress-linear",{attrs:{indeterminate:"",color:"primary"}})],1):t._e(),t.elements.length||t.isLoading?t._e():e("v-card",{staticClass:"pa-4",attrs:{flat:""}},[t._v(" No data to generate graph ")]),e("div",{ref:"graphContainer",style:{height:t.canvasHeight}},[e("div",{ref:"cy",style:{"min-height":t.canvasHeight},attrs:{width:"100%"}})]),e("v-bottom-sheet",{attrs:{"hide-overlay":"",persistent:"","no-click-animation":"",scrollable:""},model:{value:t.showTimelineView,callback:function(e){t.showTimelineView=e},expression:"showTimelineView"}},[e("v-card",[e("v-toolbar",{attrs:{dense:"",flat:""}},[e("strong",[t._v("Timeline for "+t._s(t.selectedEdgesCount)+" selected edge(s)")]),e("v-spacer"),e("v-btn",{attrs:{icon:"",disabled:t.timelineViewHeight>40},on:{click:function(e){return t.increaseTimelineViewHeight()}}},[e("v-icon",{attrs:{title:"enlarge"}},[t._v("mdi-chevron-up")])],1),e("v-btn",{attrs:{icon:"",disabled:0===t.timelineViewHeight},on:{click:function(e){return t.decreaseTimelineViewHeight()}}},[e("v-icon",{attrs:{title:"condense"}},[t._v("mdi-chevron-down")])],1),e("v-btn",{attrs:{icon:""},on:{click:function(e){t.showTimelineView=!1}}},[e("v-icon",{attrs:{title:"close"}},[t._v("mdi-close")])],1)],1),e("v-divider"),e("v-expand-transition",[e("v-card-text",{directives:[{name:"show",rawName:"v-show",value:!t.minimizeTimelineView,expression:"!minimizeTimelineView"}],style:{height:t.timelineViewHeight+"vh"}},[e("ts-event-list",{attrs:{"query-request":t.queryRequest,"items-per-page":t.maxEvents,"disable-save-search":""}})],1)],1)],1)],1)],1)},Pa=[],Oa=i(27595),Qa=i.n(Oa);si.A.use(Qa()),si.A.use(ri());var Ma={props:{graphPluginName:{type:String,default:null},savedGraphId:{type:Number,default:null},canvasHeight:{type:String,default:"85vh"},disableZoom:{type:Boolean,default:!1}},components:{TsEventList:wn},data:function(){return{saveGraphDialog:!1,showTimelineView:!1,timelineViewHeight:40,minimizeTimelineView:!1,isLoading:!1,filterString:"",graphs:{},currentGraph:"",currentGraphCache:{},currentGraphCacheConfig:{},fadeOpacity:7,elements:[],selectedEdgesCount:0,edgeQuery:"",maxEvents:40,queryFilter:{from:0,terminate_after:40,size:this.maxEvents,indices:["_all"],order:"asc",chips:[]},saveAsName:"",layouts:["spread","dagre","circle","concentric","breadthfirst"],layoutName:"spread",edgeStyles:["bezier","taxi"],edgeStyle:"bezier",config:{style:[{selector:"node",style:{shape:"roundrectangle",width:"label",height:"label","compound-sizing-wrt-labels":"include","text-halign":"center","text-valign":"center",color:"#FFFFFF","font-size":"10","font-weight":"bold","text-outline-width":"0px",padding:"7px","background-color":"gray","text-outline-color":"gray","text-wrap":"wrap","text-max-width":"12em",label:"data(label)"}},{selector:"node:selected",style:{"overlay-color":"black","overlay-opacity":"0.3","overlay-padding":"7px"}},{selector:"node[type = 'user']",style:{"background-color":"#FF756E","text-outline-color":"#FF756E"}},{selector:"node[type = 'computer']",style:{"background-color":"#6992f3","text-outline-color":"#ffffff"}},{selector:"node[type = 'file']",style:{"background-color":"#82b578","text-outline-color":"#2b2b2b"}},{selector:"node[type = 'winservice']",style:{"background-color":"#9d8f35","text-outline-color":"#2b2b2b"}},{selector:"edge",style:{width:1,"curve-style":"bezier","control-point-step-size":70,"target-arrow-shape":"triangle","font-size":11,"text-rotation":"autorotate","text-outline-width":3,"text-outline-color":"#FFFFFF",label:"data(label)"}},{selector:"edge:selected",style:{width:2,"line-color":"#333333","source-arrow-color":"#333333","target-arrow-color":"#333333"}},{selector:".faded",style:{opacity:.07,color:"#333333"}}],layout:{name:"spread",animate:!1,prelayout:!1,spacingFactor:2},minZoom:.1,maxZoom:1.5,zoomingEnabled:!0,userZoomingEnabled:!this.disableZoom,panningEnabled:!0,userPanningEnabled:!0,boxSelectionEnabled:!0,selectionType:"single",touchTapThreshold:8,desktopTapThreshold:4,autolock:!1,autoungrabify:!1,autounselectify:!1,headless:!1,styleEnabled:!0,hideEdgesOnViewport:!1,hideLabelsOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.2,pixelRatio:"auto"}}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},nodes:function(){return this.elements.filter(function(t){return"nodes"===t.group})},edges:function(){return this.elements.filter(function(t){return"edges"===t.group})},queryRequest:function(){if(this.edgeQuery)return{queryDsl:this.edgeQuery,queryFilter:this.queryFilter,incognito:!0}}},methods:{increaseTimelineViewHeight:function(){this.minimizeTimelineView=!1,this.timelineViewHeight>70||(this.timelineViewHeight+=30)},decreaseTimelineViewHeight:function(){if(this.minimizeTimelineView=!1,this.timelineViewHeight<50)return this.minimizeTimelineView=!0,void(this.timelineViewHeight=0);this.timelineViewHeight-=30},buildSavedGraph:function(t){var e=this;this.cy.elements().remove(),this.isLoading=!0,this.config.layout.name="preset",this.currentGraph=t.name,this.currentGraphCache={},this.elements=[],this.edgeQuery="";var i="";i="object"===(0,U.A)(t)?t.id:t,_.getSavedGraph(this.sketch.id,i).then(function(t){e.currentGraph=t.data["objects"][0].name;var i=JSON.parse(t.data["objects"][0].graph_elements),n=i.filter(function(t){return"nodes"===t.group}),s=i.filter(function(t){return"edges"===t.group}),a=[];n.forEach(function(t){t.selected=!1,a.push(t)}),s.forEach(function(t){t.selected=!1,a.push(t)}),clearTimeout(e.loadingTimeout),e.elements=a,e.isLoading=!1,e.updateCytoscape(i),e.resizeCanvas()}).catch(function(t){console.error(t)})},buildGraph:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.cy.elements().remove(),this.isLoading=!0,this.showTimelineView=!1,this.config.layout.name=this.layoutName;var n=this.config.style.filter(function(t){return"edge"===t.selector});n[0].style["curve-style"]=this.edgeStyle,"object"===(0,U.A)(t)?this.currentGraph=t.name:this.currentGraph=t,this.elements=[],this.edgeQuery="";var s=[],a=[];this.$route.query.timeline?(a.push(parseInt(this.$route.query.timeline)),i=!0):this.sketch.timelines.forEach(function(t){s.push(t.searchindex.index_name)}),_.generateGraphFromPlugin(this.sketch.id,this.currentGraph,s,a,i).then(function(t){var i,n,s=t.data["objects"][0],a=JSON.parse(s.graph_elements),r=JSON.parse(s.graph_config),o=[];"elements"in a?(i=a["elements"]["nodes"],n=a["elements"]["edges"]):(i=a["nodes"],n=a["edges"]),i.forEach(function(t){o.push({data:t.data,group:"nodes"})}),n.forEach(function(t){o.push({data:t.data,group:"edges"})}),delete s.graph_elements,e.currentGraphCache=s,e.currentGraphCacheConfig=r,e.elements=o,clearTimeout(e.loadingTimeout),e.isLoading=!1,e.updateCytoscape(o),e.resizeCanvas()}).catch(function(t){console.error(t)})},updateCytoscape:function(t){this.cy.style(this.config.style),this.cy.elements().remove(),this.cy.add(t),this.cy.layout(this.config.layout).run(),this.setTheme()},saveGraph:function(){var t=this,e=this.cy.filter(":selected"),i=this.buildNeighborhood(e),n=i.jsons();this.elements=n,this.currentGraph=this.saveAsName,_.saveGraph(this.sketch.id,this.saveAsName,n).then(function(e){t.$store.dispatch("updateSavedGraphs",t.sketch.id),t.$router.push({name:"Graph",query:{graph:e.data.objects[0].id}})}).catch(function(e){t.errorSnackBar("Unable to save graph"),console.error(e)}),this.saveAsName="",this.saveGraphDialog=!1},filterGraphByInput:function(){var t=this;this.cy.elements().unselect();var e=this.cy.elements().filter(function(e){return e.data("label").toLowerCase().includes(t.filterString.toLowerCase())});this.showNeighborhood(e,!1)},filterGraphBySelection:function(t){var e=this.cy.filter(":selected");this.showNeighborhood(e),this.showTimelineView=!0},unSelectAllElements:function(t){this.cy.elements().removeClass("faded"),this.edgeQuery=null,this.showTimelineView=!1,this.selectedEdgesCount=0},buildNeighborhood:function(t){var e=this.cy.collection();return e=e.add(t.filter("node").neighborhood()),e=e.add(t.filter("edge").connectedNodes()),e=e.add(t),e},showNeighborhood:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.buildNeighborhood(t);if(0!==t.length){if(this.cy.elements().addClass("faded"),n.removeClass("faded"),i){var s={query:{bool:{should:[]}}};n.forEach(function(t){"edges"===t.group()&&Object.keys(t.data().events).forEach(function(i){e.selectedEdgesCount++;var n={bool:{must:[{ids:{values:t.data().events[i]}},{term:{_index:{value:i}}}]}};s.query.bool.should.push(n)})}),this.edgeQuery=s}}else this.cy.elements().removeClass("faded")},resizeCanvas:function(){if(this.$refs.graphContainer){var t=this.$refs.graphContainer.clientHeight,e=this.$refs.graphContainer.clientWidth,i=this.$refs.cy;i.style.minHeight=t+"px",i.style.height=t+"px",i.style.minWidth=e+"px",i.style.width=e+"px",this.cy.resize(),this.cy.fit()}},resizeCanvasWithDelay:function(){var t=this;this.resizeTimeout=setTimeout(function(){t.resizeCanvas()},250)},changeOpacity:function(){this.cy&&this.cy.style().selector(".faded").style({opacity:this.fadeOpacity/100}).update()},setTheme:function(){this.cy&&(this.$vuetify.theme.dark?this.cy.style().selector("edge").style({color:"#f5f5f5","text-outline-color":"#25272c"}).update():this.cy.style().selector("edge").style({color:"#333333","text-outline-color":"#FFFFFF"}).update())}},mounted:function(){var t=this;window.addEventListener("resize",this.resizeCanvasWithDelay),o.$on("toggleLeftPanel",this.resizeCanvasWithDelay),this.cy=(0,si.A)((0,D.A)({container:this.$refs.cy},this.config)),this.cy.on("select",function(e){t.filterGraphBySelection(e)}),this.cy.on("unselect",function(e){t.unSelectAllElements(e)}),this.graphPluginName&&this.buildGraph(this.graphPluginName),this.savedGraphId&&this.buildSavedGraph(this.savedGraphId)},beforeDestroy:function(){o.$off("toggleLeftPanel")},watch:{"$vuetify.theme.dark":function(){this.setTheme()},graphPluginName:function(){this.graphPluginName&&this.buildGraph(this.graphPluginName)},savedGraphId:function(){this.savedGraphId&&this.buildSavedGraph(this.savedGraphId)},$route:function(t,e){e!==t&&(this.showTimelineView=!1)}}},qa=Ma,Ba=(0,u.A)(qa,Ra,Pa,!1,null,null,null),Va=Ba.exports,Ha={props:[],components:{TsCytoscape:Va},data:function(){return{currentGraphPlugin:null,currentSavedGraph:null}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{setSavedGraph:function(t){"Graph"!==this.$route.name&&this.$router.push({name:"Graph",params:{graph:t}}),this.currentGraphPlugin=null,this.currentSavedGraph=t},setGraphPlugin:function(t){"Graph"!==this.$route.name&&this.$router.push({name:"Graph",params:{graphPlugin:t}}),this.currentSavedGraph=null,this.currentGraphPlugin=t}},mounted:function(){o.$on("setGraphPlugin",this.setGraphPlugin),o.$on("setSavedGraph",this.setSavedGraph),this.params={graphId:this.$route.query.graph,pluginName:this.$route.query.plugin,timelineId:this.$route.query.timeline},this.params.graphId&&this.setSavedGraph(Number(this.params.graphId)),this.params.pluginName&&this.setGraphPlugin(this.params.pluginName)},beforeDestroy:function(){o.$off("setGraphPlugin"),o.$off("setSavedGraph")}},Ga=Ha,Ua=(0,u.A)(Ga,$a,Fa,!1,null,null,null),Wa=Ua.exports,ja=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-dialog",{attrs:{width:"600"},model:{value:t.renameStoryDialog,callback:function(e){t.renameStoryDialog=e},expression:"renameStoryDialog"}},[e("v-card",{staticClass:"pa-4"},[e("h3",[t._v("Rename story")]),e("br"),e("v-form",{on:{submit:function(e){return e.preventDefault(),t.rename()}}},[e("v-text-field",{attrs:{outlined:"",dense:"",autofocus:""},on:{focus:function(t){return t.target.select()}},model:{value:t.titleDraft,callback:function(e){t.titleDraft=e},expression:"titleDraft"}}),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){t.renameStoryDialog=!1}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){return t.rename()}}},[t._v(" Save ")])],1)],1)],1)],1),e("v-dialog",{attrs:{"max-width":"300"},model:{value:t.deleteStoryDialog,callback:function(e){t.deleteStoryDialog=e},expression:"deleteStoryDialog"}},[e("v-card",[e("v-card-title",{staticClass:"headline"},[t._v("Delete Story")]),e("v-card-text",[t._v(" Are you sure you want to delete this story? ")]),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){t.deleteStoryDialog=!1}}},[t._v("Cancel")]),e("v-btn",{attrs:{color:"error",text:""},on:{click:t.deleteStory}},[t._v("Delete")])],1)],1)],1),e("v-hover",{scopedSlots:t._u([{key:"default",fn:function(i){var n=i.hover;return[e("v-toolbar",{staticClass:"mt-n3",attrs:{dense:"",flat:"",color:"transparent"}},[e("v-toolbar-title",{on:{dblclick:function(e){t.renameStoryDialog=!0}}},[t._v(" "+t._s(t.title))]),n?e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){t.renameStoryDialog=!0}}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-pencil")])],1):t._e(),n?e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){t.deleteStoryDialog=!0}}},[e("v-icon",{attrs:{small:"",title:"Delete Story"}},[t._v("mdi-trash-can-outline")])],1):t._e()],1)]}}])}),e("div",{staticClass:"pa-4"},t._l(t.blocks,function(i,n){return e("div",{key:n},[i.componentName?t._e():e("div",[e("v-hover",{scopedSlots:t._u([{key:"default",fn:function(s){var a=s.hover;return[e("div",{staticStyle:{"min-height":"30px"},on:{dblclick:function(e){return t.editTextBlock(i)},keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;i.edit=!1}}},[a&&!i.edit?e("v-card",{staticClass:"float-right px-2",attrs:{outlined:""}},[e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.editTextBlock(i)}}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-pencil")])],1),e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.deleteBlock(n)}}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1)],1):t._e(),i.edit?t._e():e("div",{staticClass:"markdown-body",domProps:{innerHTML:t._s(t.toHtml(i.content))}}),i.edit?e("v-card",{staticClass:"mb-2",attrs:{flat:"",outlined:""}},[e("v-toolbar",{attrs:{flat:"",dense:""}},[e("v-tabs",{model:{value:i.currentTab,callback:function(e){t.$set(i,"currentTab",e)},expression:"block.currentTab"}},[e("v-tab",[t._v("Edit")]),e("v-tab",[t._v("Preview")])],1),e("v-spacer"),t.hasContent?e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.deleteBlock(n)}}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1):t._e()],1),e("v-divider"),e("v-tabs-items",{model:{value:i.currentTab,callback:function(e){t.$set(i,"currentTab",e)},expression:"block.currentTab"}},[e("v-tab-item",{attrs:{transition:!1}},[e("v-textarea",{attrs:{solo:"",flat:"",value:i.draft,placeholder:"Your story starts here..",rows:"5","auto-grow":"",autofocus:""},on:{input:function(e){return t.updateDraft(e,i)}}})],1),e("v-tab-item",{attrs:{transition:!1}},[e("div",{staticClass:"markdown-body pa-4",domProps:{innerHTML:t._s(t.toHtml(i.draft))}})])],1),i.edit?e("v-divider"):t._e(),i.edit?e("v-card-actions",[e("v-btn",{attrs:{text:"",color:"primary",disabled:!i.draft},on:{click:function(e){return t.save()}}},[t._v("Save")]),e("v-btn",{attrs:{text:"",disabled:!t.hasContent},on:{click:function(t){i.edit=!1}}},[t._v("Cancel")])],1):t._e()],1):t._e()],1)]}}],null,!0)})],1),i.componentName?e("div",[e("div",["TsEventList"===i.componentName?e("v-card",{staticClass:"mb-2",attrs:{outlined:""}},[e("v-toolbar",{attrs:{dense:"",flat:""}},[e("router-link",{staticStyle:{cursor:"pointer","text-decoration":"none"},attrs:{to:{name:"Explore",query:{view:i.componentProps.view.id}}}},[e("span",{on:{click:function(e){return t.setActiveView(i.componentProps.view)}}},[t._v(t._s(i.componentProps.view.name))])]),e("v-spacer"),e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.deleteBlock(n)}}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1)],1),e("v-divider"),e("v-card-text",[e(i.componentName,t._b({tag:"component"},"component",t.formatComponentProps(i),!1))],1)],1):t._e(),"TsAggregationGroupCompact"===i.componentName?e("v-card",{staticClass:"mb-2",attrs:{outlined:""}},[e("v-toolbar",{attrs:{dense:"",flat:""}},[t._v(t._s(i.componentProps.aggregation_group.name)+" "),e("v-spacer"),e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.deleteBlock(n)}}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1)],1),e("v-divider"),e("v-card-text",[t._v("Legacy group Aggregations are not supported. Please view this Story in the old UI or update your analyzer.")])],1):t._e(),"TsAggregationCompact"===i.componentName?e("v-card",{staticClass:"mb-2",attrs:{outlined:""}},[e("v-toolbar",{attrs:{dense:"",flat:""}},[t._v(t._s(i.componentProps.aggregation.name)+" "),e("v-spacer"),e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.deleteBlock(n)}}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1)],1),e("v-divider"),e("v-card-text",[t._v("Legacy aggregations are not supported. Please view this Story in the old UI or update your analyzer.")])],1):t._e(),"TsCytoscapePlugin"===i.componentName?e("v-card",{staticClass:"mb-2",attrs:{outlined:""}},[e("v-toolbar",{attrs:{dense:"",flat:""}},[e("router-link",{staticStyle:{cursor:"pointer","text-decoration":"none"},attrs:{to:{name:"Graph",query:{plugin:i.componentProps.graphPluginName}}}},[e("span",{on:{click:function(e){return t.setActiveGraph(i.componentProps.graphPluginName)}}},[t._v(t._s(i.componentProps.graphPluginName))])]),e("v-spacer"),e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.deleteBlock(n)}}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1)],1),e("v-divider"),e("v-card-text",[e("TsCytoscape",t._b({tag:"component"},"component",t.formatComponentProps(i),!1))],1)],1):t._e(),"TsCytoscapeSavedGraph"===i.componentName?e("v-card",{staticClass:"mb-2",attrs:{outlined:""}},[e("v-toolbar",{attrs:{dense:"",flat:""}},[e("router-link",{staticStyle:{cursor:"pointer","text-decoration":"none"},attrs:{to:{name:"Graph",query:{graph:i.componentProps.graph}}}},[e("span",{on:{click:function(e){return t.setActiveGraph(i.componentProps.savedGraphId)}}},[t._v(t._s(i.graphName))])]),e("v-spacer"),e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.deleteBlock(n)}}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1)],1),e("v-divider"),e("v-card-text",[e("TsCytoscape",t._b({tag:"component"},"component",t.formatComponentProps(i),!1))],1)],1):t._e(),"TsSavedVisualization"===i.componentName?e("v-card",{staticClass:"mb-2",attrs:{outlined:""}},[e("v-toolbar",{attrs:{dense:"",flat:""}},[e("router-link",{staticStyle:{cursor:"pointer","text-decoration":"none"},attrs:{to:{name:"VisualizationView",params:{aggregationId:i.componentProps.savedVisualizationId}}}},[t._v(" "+t._s(i.componentProps.name)+" ")]),e("v-spacer"),e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.deleteBlock(n)}}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1)],1),e("v-divider"),e("v-card-text",[e("TsSavedVisualization",{attrs:{aggregationId:i.componentProps.savedVisualizationId}})],1)],1):t._e(),"TsInvestigativeQuestion"===i.componentName?e("v-card",{staticClass:"mb-2",attrs:{outlined:""}},[e("v-toolbar",{attrs:{dense:"",flat:""}},[e("span",[t._v(t._s(i.componentProps.questionName))]),e("v-spacer"),e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.deleteBlock(n)}}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1)],1),e("v-divider"),e("v-card-text",{staticClass:"pa-0"},[e("TsQuestionCard",{key:i.componentProps.questionId+"-"+i.componentProps.questionName,attrs:{questionId:i.componentProps.questionId,initialTab:2}})],1)],1):t._e()],1)]):t._e(),e("v-hover",{scopedSlots:t._u([{key:"default",fn:function(s){var a=s.hover;return[e("div",{staticClass:"mb-2 mt-2"},[e("div",{class:{hidden:!a&&!i.isActive&&!i.showGraphMenu&&!i.showSavedSearchMenu&&!i.showSavedVisualizationMenu&&!i.showQuestionMenu&&t.hasContent}},[t.hasContent?e("v-btn",{staticClass:"mr-2",attrs:{rounded:"",outlined:"",small:""},on:{click:function(e){return t.addTextBlock(n)}}},[e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-plus")]),t._v(" Text ")],1):t._e(),e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({staticClass:"mr-2",attrs:{rounded:"",outlined:"",small:"",disabled:!t.meta.views.length}},"v-btn",s,!1),n),[e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-plus")]),t._v(" Saved Search ")],1)]}}],null,!0),model:{value:i.showSavedSearchMenu,callback:function(e){t.$set(i,"showSavedSearchMenu",e)},expression:"block.showSavedSearchMenu"}},[e("v-card",{attrs:{width:"475"}},[e("v-list",[e("v-list-item-group",{attrs:{color:"primary"}},t._l(t.meta.views,function(i){return e("v-list-item",{key:i.id},[e("v-list-item-content",{on:{click:function(e){return t.addEventListBlock(i,n)}}},[t._v(" "+t._s(i.name)+" ")])],1)}),1)],1)],1)],1),e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({staticClass:"mr-2",attrs:{rounded:"",outlined:"",small:"",disabled:!t.graphPlugins.length}},"v-btn",s,!1),n),[e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-plus")]),t._v(" Graphs ")],1)]}}],null,!0),model:{value:i.showGraphMenu,callback:function(e){t.$set(i,"showGraphMenu",e)},expression:"block.showGraphMenu"}},[e("v-card",{attrs:{width:"475"}},[e("v-list",[e("v-list-item-group",{attrs:{color:"primary"}},[e("v-subheader",[t._v("Saved Graphs")]),t._l(t.savedGraphs,function(i){return e("v-list-item",{key:i.id},[e("v-list-item-content",{on:{click:function(e){return t.addSavedGraphBlock(i,n)}}},[t._v(" "+t._s(i.name)+" ")])],1)}),e("v-subheader",[t._v("Plugins")]),t._l(t.graphPlugins,function(i){return e("v-list-item",{key:i.name},[e("v-list-item-content",{on:{click:function(e){return t.addGraphPluginBlock(i,n)}}},[t._v(" "+t._s(i.name)+" ")])],1)})],2)],1)],1)],1),e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({staticClass:"mr-2",attrs:{rounded:"",outlined:"",small:"",disabled:!t.savedVisualizations.length}},"v-btn",s,!1),n),[e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-plus")]),t._v(" Visualizations ")],1)]}}],null,!0),model:{value:i.showSavedVisualizationMenu,callback:function(e){t.$set(i,"showSavedVisualizationMenu",e)},expression:"block.showSavedVisualizationMenu"}},[e("v-card",[e("v-list",[e("v-list-item-group",{attrs:{color:"primary"}},[e("v-subheader",[t._v("Saved Visualizations")]),t._l(t.savedVisualizations,function(i){return e("v-list-item",{key:i.id},[e("v-list-item-content",{on:{click:function(e){return t.addSavedVisualization(i,n)}}},[t._v(" "+t._s(i.name)+" ")])],1)})],2)],1)],1)],1),e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({attrs:{rounded:"",outlined:"",small:"",disabled:!t.availableSketchQuestions.length}},"v-btn",s,!1),n),[e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-plus")]),t._v(" Investigative Question ")],1)]}}],null,!0),model:{value:i.showQuestionMenu,callback:function(e){t.$set(i,"showQuestionMenu",e)},expression:"block.showQuestionMenu"}},[e("v-card",{attrs:{width:"475"}},[e("v-list",[e("v-list-item-group",{attrs:{color:"primary"}},t._l(t.availableSketchQuestions,function(i){return e("v-list-item",{key:i.id},[e("v-list-item-content",{on:{click:function(e){return t.addQuestionBlock(i,n)}}},[t._v(" "+t._s(i.name)+" ")])],1)}),1)],1)],1)],1)],1)])]}}],null,!0)})],1)}),0)],1)},Ya=[],Xa=i(20748),Ja=i(24634),Ka=function(){var t=this,e=t._self._c;return e("v-card",{staticClass:"mx-3",attrs:{outlined:""}},[t.aggregationId?e("ts-chart-card",{attrs:{chartSeries:t.chartSeries,chartLabels:t.chartLabels,chartTitle:t.chartTitle,chartType:t.chartType,fieldName:t.fieldName,height:t.height,isTimeSeries:t.isTimeSeries,metricName:t.metricName,showDataLabels:t.showDataLabels,showXLabels:t.showXLabels,showYLabels:t.showYLabels,width:t.width,xTitle:t.xTitle,yTitle:t.yTitle}}):t._e()],1)},Za=[],tr=function(){var t=this,e=t._self._c;return e("v-card",{attrs:{flat:"","min-height":t.height,"min-width":t.width}},[e("v-card-text",[null!=t.chartSeries&&"bar"===t.chartType?e("TsBarChart",{attrs:{fieldName:t.fieldName,metricName:t.metricName,"is-time-series":t.isTimeSeries,chartSeries:t.chartSeries,chartLabels:t.chartLabels,chartTitle:t.chartTitle,height:t.height,width:t.width,xTitle:t.xTitle,showXLabels:t.showXLabels,yTitle:t.yTitle,showYLabels:t.showYLabels,showDataLabels:t.showDataLabels}}):t._e(),null!=t.chartSeries&&"column"===t.chartType?e("TsColumnChart",{attrs:{fieldName:t.fieldName,metricName:t.metricName,"is-time-series":t.isTimeSeries,chartSeries:t.chartSeries,chartLabels:t.chartLabels,chartTitle:t.chartTitle,height:t.height,width:t.width,xTitle:t.xTitle,showXLabels:t.showXLabels,yTitle:t.yTitle,showYLabels:t.showYLabels,showDataLabels:t.showDataLabels}}):t._e(),null!=t.chartSeries&&"donut"===t.chartType?e("TsDonutChart",{attrs:{fieldName:t.fieldName,metricName:t.metricName,"is-time-series":t.isTimeSeries,chartSeries:t.chartSeries,chartLabels:t.chartLabels,chartTitle:t.chartTitle,height:t.height,width:t.width,xTitle:t.xTitle,showXLabels:t.showXLabels,yTitle:t.yTitle,showYLabels:t.showYLabels,showDataLabels:t.showDataLabels}}):t._e(),null!=t.chartSeries&&"heatmap"===t.chartType?e("TsHeatmapChart",{attrs:{fieldName:t.fieldName,metricName:t.metricName,"is-time-series":t.isTimeSeries,chartSeries:t.chartSeries,chartLabels:t.chartLabels,chartTitle:t.chartTitle,height:t.height,width:t.width,xTitle:t.xTitle,showXLabels:t.showXLabels,yTitle:t.yTitle,showYLabels:t.showYLabels,showDataLabels:t.showDataLabels}}):t._e(),null!=t.chartSeries&&"line"===t.chartType?e("TsLineChart",{attrs:{fieldName:t.fieldName,metricName:t.metricName,"is-time-series":t.isTimeSeries,chartSeries:t.chartSeries,chartLabels:t.chartLabels,chartTitle:t.chartTitle,height:t.height,width:t.width,xTitle:t.xTitle,showXLabels:t.showXLabels,yTitle:t.yTitle,showYLabels:t.showYLabels,showDataLabels:t.showDataLabels}}):t._e(),null!=t.chartSeries&&"table"===t.chartType?e("TsTableChart",{attrs:{fieldName:t.fieldName,metricName:t.metricName,"is-time-series":t.isTimeSeries,chartSeries:t.chartSeries,chartLabels:t.chartLabels,chartTitle:t.chartTitle,height:t.height,width:t.width}}):t._e()],1)],1)},er=[],ir=function(){var t=this,e=t._self._c;return e("div",[e("apexchart",{attrs:{options:t.options,series:t.series,width:t.width,height:t.height}})],1)},nr=[],sr={props:{fieldName:{type:String,default:"Unknown field"},metricName:{type:String,default:"unknown metric"},chartSeries:{type:Object,default:function(){return{}}},chartLabels:{type:Array,default:function(){return[]}},chartType:{type:String,default:void 0},chartTitle:{type:String,default:void 0},height:{type:Number,default:640},isTimeSeries:{type:Boolean,default:!1},showDataLabels:{type:Boolean,default:!0},showTooltips:{type:Boolean,default:!0},showXLabels:{type:Boolean,default:!0},showYLabels:{type:Boolean,default:!0},width:{type:Number,default:800},xTitle:{type:String,default:void 0},xType:{type:String,default:"category"},yTitle:{type:String,default:void 0}},components:{Apexchart:we()},computed:{options:{get:function(){var t=this;return{chart:{animations:{enabled:!0,easing:"easeinout",speed:50,animateGradually:{enabled:!0,delay:50},dynamicAnimation:{enabled:!0,delay:50}},events:{dataPointSelection:function(e,i,n){t.filterDataPoint(n)}},type:"bar",zoom:{enabled:!1,type:"x",autoScaleYaxis:!0},height:this.height,width:this.width},labels:this.chartLabels,dataLabels:{enabled:this.showDataLabels},noData:{text:"Loading..."},plotOptions:{bar:{horizontal:!0,dataLabels:{position:"top"}}},title:{text:this.chartTitle},tooltip:{enabled:this.showTooltips,followCursor:!1},xaxis:{tickPlacement:"on",labels:{show:this.showXLabels,hideOverlappingLabels:!0},title:{text:this.xTitle},tooltip:{enabled:!0}},yaxis:{labels:{show:this.showYLabels},title:{text:this.yTitle}}}},set:function(t){}},series:function(){if(void 0===this.fieldName||void 0===this.metricName)return[];var t={name:this.fieldName,data:this.chartSeries[this.metricName]};return[t]}},methods:{setTheme:function(){localStorage.isDarkTheme?this.options={chart:{foreColor:"#fff"},tooltip:{theme:"dark"}}:this.options={chart:{foreColor:"#333"},tooltip:{theme:"light"}}},filterDataPoint:function(t){var e={doSearch:!0},i=t.dataPointIndex;if(this.isTimeSeries){var n=this.chartLabels[i],s=i+1<this.chartLabels.length?this.chartLabels[i+1]:"";if(""===s)return;e.doSearch=!0,e.queryString=this.fieldName+":*",e.chip={field:"",type:"datetime_range",value:n+","+s,operator:"must",active:!0},o.$emit("setQueryAndFilter",e)}else e.chip={field:this.fieldName,value:t.w.config.labels[i],type:"term",operator:"must",active:!0},o.$emit("setQueryAndFilter",e)}},created:function(){o.$on("isDarkTheme",this.setTheme)},mounted:function(){this.setTheme()}},ar=sr,rr=(0,u.A)(ar,ir,nr,!1,null,null,null),or=rr.exports,lr=function(){var t=this,e=t._self._c;return e("div",[e("apexchart",{attrs:{options:t.options,series:t.series,width:t.width,height:t.height}})],1)},cr=[],ur={props:{fieldName:{type:String,default:"Unknown field"},metricName:{type:String,default:"unknown metric"},chartSeries:{type:Object,default:function(){return{}}},chartLabels:{type:Array,default:function(){return[]}},chartType:{type:String,default:void 0},chartTitle:{type:String,default:void 0},height:{type:Number,default:640},isTimeSeries:{type:Boolean,default:!1},showDataLabels:{type:Boolean,default:!0},showTooltips:{type:Boolean,default:!0},showXLabels:{type:Boolean,default:!0},showYLabels:{type:Boolean,default:!0},width:{type:Number,default:800},xTitle:{type:String,default:void 0},xType:{type:String,default:"category"},yTitle:{type:String,default:void 0}},components:{Apexchart:we()},data:function(){return{}},computed:{options:{get:function(){var t=this;return{chart:{animations:{enabled:!0,easing:"easeinout",speed:50,animateGradually:{enabled:!0,delay:50},dynamicAnimation:{enabled:!0,delay:50}},events:{dataPointSelection:function(e,i,n){t.filterDataPoint(n)}},type:"bar",zoom:{enabled:!1,type:"x",autoScaleYaxis:!0},height:this.height,width:this.width},labels:this.chartLabels,dataLabels:{enabled:this.showDataLabels},noData:{text:"Loading..."},plotOptions:{bar:{dataLabels:{position:"top"}}},title:{text:this.chartTitle},tooltip:{enabled:this.showTooltips,followCursor:!1},xaxis:{tickPlacement:"on",labels:{show:this.showXLabels,hideOverlappingLabels:!0},title:{text:this.xTitle},tooltip:{enabled:!0}},yaxis:{labels:{show:this.showYLabels},title:{text:this.yTitle}}}},set:function(t){}},series:function(){if(void 0===this.fieldName||void 0===this.metricName)return[];var t={name:this.fieldName,data:this.chartSeries[this.metricName]};return[t]}},methods:{setTheme:function(){localStorage.isDarkTheme?this.options={chart:{foreColor:"#fff"},tooltip:{theme:"dark"}}:this.options={chart:{foreColor:"#333"},tooltip:{theme:"light"}}},filterDataPoint:function(t){var e={doSearch:!0},i=t.dataPointIndex;if(this.isTimeSeries){var n=this.chartLabels[i],s=i+1<this.chartLabels.length?this.chartLabels[i+1]:"";if(""===s)return;e.doSearch=!0,e.queryString=this.fieldName+":*",e.chip={field:"",type:"datetime_range",value:n+","+s,operator:"must",active:!0},o.$emit("setQueryAndFilter",e)}else e.chip={field:this.fieldName,value:t.w.config.labels[i],type:"term",operator:"must",active:!0},o.$emit("setQueryAndFilter",e)}},created:function(){o.$on("isDarkTheme",this.setTheme)},mounted:function(){this.setTheme()}},dr=ur,hr=(0,u.A)(dr,lr,cr,!1,null,null,null),mr=hr.exports,vr=function(){var t=this,e=t._self._c;return e("div",[e("apexchart",{attrs:{options:t.options,series:t.series,width:t.width,height:t.height}})],1)},pr=[],fr={props:{fieldName:{type:String,default:"Unknown field"},metricName:{type:String,default:"unknown metric"},chartSeries:{type:Object,default:function(){return{}}},chartLabels:{type:Array,default:function(){return[]}},chartType:{type:String,default:void 0},chartTitle:{type:String,default:void 0},height:{type:Number,default:640},isTimeSeries:{type:Boolean,default:!1},showDataLabels:{type:Boolean,default:!0},showTooltips:{type:Boolean,default:!0},showXLabels:{type:Boolean,default:!0},showYLabels:{type:Boolean,default:!0},width:{type:Number,default:800},xTitle:{type:String,default:void 0},xType:{type:String,default:"category"},yTitle:{type:String,default:void 0}},components:{Apexchart:we()},computed:{options:{get:function(){var t=this;return{chart:{animations:{enabled:!0,easing:"easeinout",speed:50,animateGradually:{enabled:!0,delay:50},dynamicAnimation:{enabled:!0,delay:50}},events:{dataPointSelection:function(e,i,n){t.filterDataPoint(n)}},type:"donut",zoom:{enabled:!1,type:"x",autoScaleYaxis:!0},height:this.height,width:this.width},labels:this.chartLabels,dataLabels:{enabled:this.showDataLabels},noData:{text:"Loading..."},plotOptions:{bar:{horizontal:!0,dataLabels:{position:"top"}}},title:{text:this.chartTitle},tooltip:{enabled:this.showTooltips,followCursor:!1},xaxis:{tickPlacement:"on",labels:{show:this.showXLabels,hideOverlappingLabels:!0},title:{text:this.xTitle},tooltip:{enabled:!0}},yaxis:{labels:{show:this.showYLabels},title:{text:this.yTitle}}}},set:function(t){}},series:function(){return void 0===this.fieldName||void 0===this.metricName?[]:this.chartSeries[this.metricName]}},methods:{setTheme:function(){localStorage.isDarkTheme?this.options={chart:{foreColor:"#fff"},tooltip:{theme:"dark"}}:this.options={chart:{foreColor:"#333"},tooltip:{theme:"light"}}},filterDataPoint:function(t){if(!this.isTimeSeries){var e=t.dataPointIndex,i={doSearch:!0},n={field:this.fieldName,value:t.w.config.labels[e],type:"term",operator:"must",active:!0};i.chip=n,o.$emit("setQueryAndFilter",i)}}},created:function(){o.$on("isDarkTheme",this.setTheme)},mounted:function(){this.setTheme()}},gr=fr,yr=(0,u.A)(gr,vr,pr,!1,null,null,null),_r=yr.exports,br=function(){var t=this,e=t._self._c;return e("div",[e("apexchart",{attrs:{options:t.options,series:t.series,width:t.width,height:t.height}})],1)},Sr=[],wr={props:{fieldName:{type:String,default:"Unknown field"},metricName:{type:String,default:"unknown metric"},chartSeries:{type:Object,default:function(){return{}}},chartLabels:{type:Array,default:function(){return[]}},chartType:{type:String,default:void 0},chartTitle:{type:String,default:void 0},isTimeSeries:{type:Boolean,default:!1},showDataLabels:{type:Boolean,default:!0},showTooltips:{type:Boolean,default:!0},showXLabels:{type:Boolean,default:!0},showYLabels:{type:Boolean,default:!0},xTitle:{type:String,default:void 0},xType:{type:String,default:"category"},yTitle:{type:String,default:void 0},height:{type:Number,default:250},width:{type:Number,default:400}},components:{Apexchart:we()},data:function(){return{}},computed:{options:{get:function(){var t=this;return{chart:{animations:{enabled:!0,easing:"easeinout",speed:50,animateGradually:{enabled:!0,delay:50},dynamicAnimation:{enabled:!0,delay:50}},events:{dataPointSelection:function(e,i,n){t.filterDataPoint(n)}},type:"heatmap",zoom:{enabled:!1,type:"x",autoScaleYaxis:!0},height:this.height,width:this.width},labels:this.chartLabels,dataLabels:{enabled:this.showDataLabels},noData:{text:"Loading..."},plotOptions:{bar:{horizontal:!1,dataLabels:{position:"top"}}},title:{text:this.chartTitle},tooltip:{enabled:this.showTooltips,followCursor:!1},xaxis:{tickPlacement:"on",labels:{show:this.showXLabels,hideOverlappingLabels:!0},title:{text:this.xTitle},tooltip:{enabled:!0}},yaxis:{labels:{show:this.showYLabels},title:{text:this.yTitle}}}},set:function(t){}},series:function(){if(void 0===this.fieldName||void 0===this.metricName)return[];var t={name:this.fieldName,data:this.chartSeries[this.metricName]};return[t]}},methods:{setTheme:function(){localStorage.isDarkTheme?this.options={chart:{foreColor:"#fff"},tooltip:{theme:"dark"}}:this.options={chart:{foreColor:"#333"},tooltip:{theme:"light"}}},filterDataPoint:function(t){var e={doSearch:!0},i=t.dataPointIndex;if(this.isTimeSeries){var n=this.chartLabels[i],s=i+1<this.chartLabels.length?this.chartLabels[i+1]:"";if(""===s)return;e.chip={field:"",type:"datetime_range",value:n+","+s,operator:"must",active:!0}}else e.chip={field:this.fieldName,value:t.w.config.labels[i],type:"term",operator:"must",active:!0};o.$emit("setQueryAndFilter",e)}},created:function(){o.$on("isDarkTheme",this.setTheme)},mounted:function(){this.setTheme()}},kr=wr,xr=(0,u.A)(kr,br,Sr,!1,null,null,null),Tr=xr.exports,Cr=function(){var t=this,e=t._self._c;return e("div",[e("apexchart",{attrs:{options:t.options,series:t.series,height:t.height,width:t.width}})],1)},Ar=[],Dr={props:{fieldName:{type:String,default:"Unknown field"},metricName:{type:String,default:"unknown metric"},chartSeries:{type:Object,default:function(){return{}}},chartLabels:{type:Array,default:function(){return[]}},chartType:{type:String,default:void 0},chartTitle:{type:String,default:void 0},height:{type:Number,default:640},isTimeSeries:{type:Boolean,default:!1},showDataLabels:{type:Boolean,default:!0},showTooltips:{type:Boolean,default:!0},showXLabels:{type:Boolean,default:!0},showYLabels:{type:Boolean,default:!0},width:{type:Number,default:800},xTitle:{type:String,default:void 0},xType:{type:String,default:"category"},yTitle:{type:String,default:void 0}},components:{Apexchart:we()},computed:{options:{get:function(){var t=this;return{chart:{animations:{enabled:!0,easing:"easeinout",speed:50,animateGradually:{enabled:!0,delay:50},dynamicAnimation:{enabled:!0,delay:50}},events:{dataPointSelection:function(e,i,n){t.filterDataPoint(n)}},type:"line",zoom:{enabled:!1,type:"x",autoScaleYaxis:!0},height:this.height,width:this.width},labels:this.chartLabels,dataLabels:{enabled:this.showDataLabels},noData:{text:"Loading..."},plotOptions:{bar:{dataLabels:{position:"top"}}},title:{text:this.chartTitle},tooltip:{enabled:this.showTooltips,followCursor:!1},xaxis:{tickPlacement:"on",labels:{show:this.showXLabels,hideOverlappingLabels:!0},title:{text:this.xTitle},tooltip:{enabled:!0}},yaxis:{labels:{show:this.showYLabels},title:{text:this.yTitle}}}},set:function(t){}},series:function(){if(void 0===this.fieldName||void 0===this.metricName)return[];var t={name:this.fieldName,data:this.chartSeries[this.metricName]};return[t]}},methods:{setTheme:function(){localStorage.isDarkTheme?this.options={chart:{foreColor:"#fff"},tooltip:{theme:"dark"}}:this.options={chart:{foreColor:"#333"},tooltip:{theme:"light"}}},filterDataPoint:function(t){var e={doSearch:!0},i=t.dataPointIndex;if(this.isTimeSeries){var n=this.chartLabels[i],s=i+1<this.chartLabels.length?this.chartLabels[i+1]:"";if(""===s)return;e.chip={field:"",type:"datetime_range",value:n+","+s,operator:"must",active:!0}}else e.chip={field:this.fieldName,value:t.w.config.labels[i],type:"term",operator:"must",active:!0};o.$emit("setQueryAndFilter",e)}},created:function(){o.$on("isDarkTheme",this.setTheme)},mounted:function(){this.setTheme()}},Lr=Dr,Ir=(0,u.A)(Lr,Cr,Ar,!1,null,null,null),Er=Ir.exports,Nr=function(){var t=this,e=t._self._c;return e("v-card",{attrs:{flat:""}},[void 0!==t.chartTitle?e("v-card-title",[t._v(" "+t._s(t.chartTitle)+" ")]):t._e(),e("v-card-text",[e("v-data-table",{attrs:{headers:t.headers,items:t.items,dense:""},scopedSlots:t._u([{key:"header.field",fn:function(e){var i=e.header;return[t._v(" "+t._s(i.text)+" ")]}},{key:"item.field",fn:function(i){var n=i.item;return[e("v-container",{staticClass:"pl-0",on:{mouseover:function(e){t.c_key=n.field},mouseleave:function(e){t.c_key=-1}}},[t._v(" "+t._s(n.field)+" "),n.field!=t.c_key||t.isTimeSeries?t._e():e("v-btn",{staticClass:"mr-1",attrs:{icon:"","x-small":""},on:{click:function(e){return e.stopPropagation(),t.applyFilterChip(t.fieldName,n.field,"must")}}},[e("v-icon",{attrs:{title:"Filter for value "+n.field}},[t._v(" mdi-filter-plus-outline ")])],1),n.field!=t.c_key||t.isTimeSeries?t._e():e("v-btn",{staticClass:"mr-1",attrs:{icon:"","x-small":""},on:{click:function(e){return e.stopPropagation(),t.applyFilterChip(t.fieldName,n.field,"must_not")}}},[e("v-icon",{attrs:{title:"Filter out value "+n.field}},[t._v(" mdi-filter-minus-outline ")])],1),n.field==t.c_key?e("v-btn",{staticClass:"pr-1",staticStyle:{cursor:"pointer"},attrs:{icon:"","x-small":""},on:{click:function(e){return t.copyToClipboard(n.field)}}},[e("v-icon",{attrs:{title:"Copy value "+n.field,small:""}},[t._v(" mdi-content-copy ")])],1):t._e()],1)]}},{key:"item.metric",fn:function(i){var n=i.item;return[e("v-container",{staticClass:"pl-0",on:{mouseover:function(e){t.c_key=n.field},mouseleave:function(e){t.c_key=-1}}},[t._v(" "+t._s(n.metric)+" "),n.field==t.c_key?e("v-btn",{staticClass:"pr-1",staticStyle:{cursor:"pointer"},attrs:{icon:"","x-small":""},on:{click:function(e){return t.copyToClipboard(n.metric)}}},[e("v-icon",{attrs:{title:"Copy value "+n.metric,small:""}},[t._v(" mdi-content-copy ")])],1):t._e()],1)]}}])})],1)],1)},zr=[],$r={props:{chartSeries:{type:Object,default:function(){return{}}},chartLabels:{type:Array,default:function(){return[]}},chartTitle:{type:String,default:void 0},fieldName:{type:String,default:"Unknown field"},height:{type:Number,default:640},isTimeSeries:{type:Boolean,default:!1},metricName:{type:String,default:"unknown metric"},width:{type:Number,default:800}},data:function(){return{c_key:-1}},computed:{items:function(){var t=[];if(this.metricName in this.chartSeries)for(var e=0,i=this.chartLabels.length;e<i;e++){var n={field:this.chartLabels[e],metric:this.chartSeries[this.metricName][e]};t.push(n)}return t},headers:function(){return[{text:this.fieldName,value:"field",width:"80%"},{text:this.metricName,value:"metric"}]}},methods:{copyToClipboard:function(t){try{navigator.clipboard.writeText(t),this.infoSnackBar("Copied "+t+" to the clipboard")}catch(e){this.errorSnackBar("Failed copying to the clipboard!"),console.error(e)}},applyFilterChip:function(t,e,i){if(!this.isTimeSeries){var n={doSearch:!0},s={field:t,value:e,type:"term",operator:i,active:!0};n.chip=s,o.$emit("setQueryAndFilter",n)}}}},Fr=$r,Rr=(0,u.A)(Fr,Nr,zr,!1,null,null,null),Pr=Rr.exports,Or={components:{TsBarChart:or,TsColumnChart:mr,TsDonutChart:_r,TsHeatmapChart:Tr,TsLineChart:Er,TsTableChart:Pr},props:{chartLabels:{type:Array},chartSeries:{type:Object},chartTitle:{type:String,default:void 0},chartType:{type:String},fieldName:{type:String},height:{type:Number},isTimeSeries:{type:Boolean},metricName:{type:String},showDataLabels:{type:Boolean},showXLabels:{type:Boolean},showYLabels:{type:Boolean},width:{type:Number},xTitle:{type:String},yTitle:{type:String}}},Qr=Or,Mr=(0,u.A)(Qr,tr,er,!1,null,null,null),qr=Mr.exports,Br={components:{TsChartCard:qr},props:["aggregationId"],data:function(){return{response:null,parameters:null,aggregationType:"",chartSeries:{},chartLabels:[],chartTitle:"",chartType:"",fieldName:"",height:0,isTimeSeries:!1,metricName:"",showDataLabels:!1,showXLabels:!1,showYLabels:!1,width:0,xTitle:"",yTitle:""}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{loadAggregationData:function(t){var e=this;_.getAggregationById(this.sketch.id,this.aggregationId).then(function(t){var i=t.data.objects[0];e.aggregationType=i.agg_type,e.parameters=JSON.parse(i.parameters),_.runAggregator(e.sketch.id,e.parameters).then(function(t){var i=t.data.objects[0][e.aggregationType];e.chartSeries=i.buckets,e.chartLabels=i.labels,e.chartTitle=i.chart_options.chartTitle,e.chartType=i.chart_type,e.fieldName=e.parameters.aggregator_parameters.fields[0].field,e.height=i.chart_options.height,e.isTimeSeries=i.chart_options.isTimeSeries,e.metricName=e.parameters.aggregator_parameters.aggregator_options.metric,e.showDataLabels=i.chart_options.showDataLabels,e.showXLabels=i.chart_options.showXLabels,e.showYLabels=i.chart_options.showYLabels,e.width=i.chart_options.width,e.xTitle=i.chart_options.xTitle,e.yTitle=i.chart_options.yTitle}).catch(function(t){console.error("Error requesting aggregation data: "+t)})}).catch(function(t){console.error("Error requesting aggregation parameters: "+t)})}},watch:{aggregationId:function(t){t&&this.loadAggregationData()}},mounted:function(){this.aggregationId&&this.loadAggregationData()}},Vr=Br,Hr=(0,u.A)(Vr,Ka,Za,!1,null,null,null),Gr=Hr.exports,Ur=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-card",{staticClass:"mx-3 mt-3 mb-3",class:t.$vuetify.theme.dark?"":"context-card-light-grey-background",attrs:{outlined:""}},[e("v-toolbar",{staticStyle:{"background-color":"transparent"},attrs:{flat:"",dense:""}},[t.isLoading?e("span",[e("v-progress-circular",{staticClass:"mr-3",attrs:{size:20,width:1,indeterminate:"",color:"primary"}})],1):t._e(),t.activeQuestion.display_name?e("span",{staticStyle:{cursor:"pointer","font-size":"1.1em"},attrs:{id:"questionDropdownButton"}},[e("span",{on:{click:function(e){t.expanded=!t.expanded}}},[t.expanded?e("v-icon",[t._v("mdi-chevron-down")]):e("v-icon",[t._v("mdi-chevron-right")]),e("strong",[e("span",{staticClass:"ml-2 mr-3"},[e("span",[t._v(t._s(t.activeQuestion.display_name)+" ")])])])],1),e("v-btn",{staticClass:"text-none",attrs:{small:"",depressed:"",color:"primary"},on:{click:function(e){t.showDropdown=!t.showDropdown}}},[t._v(" Change question "),e("v-icon",{attrs:{small:"",right:""}},[t._v("mdi-chevron-down")])],1)],1):t._e(),t.showEmptySelect&&!t.isLoading?e("span",[e("v-btn",{staticClass:"text-none ml-n2",attrs:{depressed:"",color:"primary"},on:{click:function(e){t.showDropdown=!t.showDropdown}}},[t._v(" Select or create an investigative question ")])],1):t._e()]),t.showDropdown&&!t.isLoading?e("v-card",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onClickOutside,expression:"onClickOutside"}],staticStyle:{position:"absolute","z-index":"1000"},attrs:{elevation:"10",outlined:"",width:"50%"}},[e("v-row",[e("v-col",{attrs:{cols:"12"}},[e("v-card",{staticClass:"ma-2",attrs:{outlined:""}},[e("v-text-field",{staticClass:"mx-2 mb-1",attrs:{placeholder:"Find a question, or create a new one..",autofocus:"","hide-details":"",dense:"","single-line":"",flat:"",solo:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.createQuestion()}},scopedSlots:t._u([{key:"append",fn:function(){return[e("v-btn",{staticClass:"text-none mt-1 mr-n3",attrs:{depressed:"",small:"",disabled:!t.queryString,color:"primary"},on:{click:function(e){return t.createQuestion()}}},[e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-plus")]),t._v(" Create new question ")],1)]},proxy:!0}],null,!1,3746051682),model:{value:t.queryString,callback:function(e){t.queryString=e},expression:"queryString"}})],1)],1)],1),e("v-row",{attrs:{"no-gutters":""}},[t.matches.questions&&t.matches.questions.length?e("v-col",{attrs:{cols:"12"}},[e("v-toolbar",{attrs:{dense:"",flat:""}},[e("strong",[t._v("Assigned questions for this sketch "),e("span",{staticStyle:{"font-size":"0.7em"}},[t._v("("+t._s(t.matches.questions.length)+")")])])]),e("v-list",{staticClass:"overflow-y-auto",staticStyle:{"max-height":"300px"}},[e("v-list-item-group",t._l(t.matches.questions,function(i,n){return e("v-list-item",{key:n,on:{click:function(e){return t.setActiveQuestion(i)}}},[e("v-icon",{staticClass:"mr-2",attrs:{small:"",disabled:!i.conclusions.length,color:i.conclusions.length?"success":""}},[t._v("mdi-check-circle")]),e("v-list-item-title",[t._v(t._s(i.name))])],1)}),1)],1)],1):t._e()],1),e("v-row",{attrs:{"no-gutters":""}},[t.matches.templates.length?e("v-col",{attrs:{cols:"12"}},[e("v-toolbar",{attrs:{dense:"",flat:""}},[e("strong",[t._v("Add DFIQ question "),e("span",{staticStyle:{"font-size":"0.7em"}},[t._v("("+t._s(t.matches.templates.length)+")")])])]),e("v-list",{staticClass:"overflow-y-auto",staticStyle:{height:"300px"}},[e("v-list-item-group",t._l(t.matches.templates,function(i,n){return e("v-list-item",{key:n,on:{click:function(e){return t.createQuestion(i)}}},[e("v-icon",{staticClass:"mr-2",attrs:{small:""}},[t._v("mdi-plus")]),e("v-list-item-content",[e("v-list-item-title",[t._v(" "+t._s(i.name))])],1)],1)}),1)],1)],1):t._e()],1)],1):t._e(),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded&&t.activeQuestion,expression:"expanded && activeQuestion"}]},[e("v-divider"),e("v-row",{attrs:{"no-gutters":""}},[e("v-col",[e("v-tabs",{attrs:{"background-color":"transparent"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("v-tab",{staticClass:"text-none",attrs:{disabled:0===t.allSuggestedQueries.length&&!t.userSettings.generateQuery}},[t._v(" Suggested queries "),e("span",{staticClass:"ml-1"},[e("small",[e("strong",[t._v("("+t._s(t.allSuggestedQueries.length)+")")])])])]),e("v-tab",{staticClass:"text-none",attrs:{disabled:!t.activeQuestion.approaches.length}},[t._v(" Approaches "),e("span",{staticClass:"ml-1"},[e("small",[e("strong",[t._v("("+t._s(t.activeQuestion.approaches.length)+")")])])])]),e("v-tab",{staticClass:"text-none"},[t._v(" Conclusions "),t.activeQuestion.conclusions.length?e("span",{staticClass:"ml-1"},[e("small",[e("strong",[t._v("("+t._s(t.activeQuestion.conclusions.length)+")")])])]):t._e()])],1),e("v-tabs-items",{staticStyle:{"background-color":"transparent"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("v-tab-item",{staticClass:"mb-2",attrs:{transition:!1}},[t.allSuggestedQueries.length?e("div",[e("div",{staticClass:"mt-4",staticStyle:{"background-color":"transparent"}},t._l(t.allSuggestedQueries,function(t){return e("ts-search-chip",{key:t.value,attrs:{searchchip:t,icon:"mdi-magnify",type:"link"}})}),1)]):t._e(),t.isNl2qAvailable?e("div",{staticClass:"mt-1"},[t.suggestedQueryLoading?e("div",{staticClass:"pa-2 pl-4"},[e("v-skeleton-loader",{attrs:{type:"sentences",width:"200"}})],1):t._e(),Object.keys(t.suggestedQuery).length&&!t.suggestedQueryLoading?e("div",[e("ts-search-chip",{staticClass:"mb-1",attrs:{searchchip:t.suggestedQuery,type:"link",icon:"mdi-shimmer"}})],1):t._e(),Object.keys(t.suggestedQuery).length||t.suggestedQueryLoading?t._e():e("div",{staticClass:"pl-4"},[e("v-btn",{staticClass:"text-none mt-2 mb-4 btn-gradient",attrs:{small:"",depressed:"",light:""},on:{click:t.getSuggestedQuery}},[e("v-icon",{attrs:{small:"",left:""}},[t._v("mdi-shimmer")]),t._v(" Generate query")],1)],1)]):t._e()]),e("v-tab-item",{attrs:{transition:!1}},[t.activeQuestion.approaches&&t.activeQuestion.approaches.length?e("div",[e("div",{staticClass:"pa-4 markdown-body",staticStyle:{"background-color":"transparent","font-size":"0.9em"},domProps:{innerHTML:t._s(t.toHtml(t.activeQuestion.description))}}),e("v-expansion-panels",{attrs:{flat:"",accordion:"",hover:""}},t._l(t.activeQuestion.approaches,function(i,n){return e("v-expansion-panel",{key:n,staticStyle:{"background-color":"transparent"}},[e("v-expansion-panel-header",{attrs:{"expand-icon":""},scopedSlots:t._u([{key:"default",fn:function(n){var s=n.open;return[e("div",{staticClass:"ml-2"},[e("v-icon",{staticClass:"mr-2 ml-n4"},[s?[t._v("mdi-chevron-down")]:[t._v("mdi-chevron-right")]],2),e("strong",[t._v(t._s(i.display_name))])],1)]}}],null,!0)}),e("v-expansion-panel-content",[e("ts-question-approach",{attrs:{approachJSON:i}})],1)],1)}),1)],1):t._e()]),e("v-tab-item",{attrs:{transition:!1}},[e("div",{staticClass:"pa-4 markdown-body",staticStyle:{"background-color":"transparent"}},[t._l(t.activeQuestion.conclusions,function(i){return e("v-sheet",{key:i.id,staticClass:"pa-3",staticStyle:{"max-width":"500px"},attrs:{outlined:"",rounded:""}},[e("ts-question-conclusion",{attrs:{question:t.activeQuestion,conclusion:i},on:{delete:function(e){return t.deleteConclusion(i)},"save-conclusion":function(e){return t.refreshActiveQuestion()}}})],1)}),t.currentUserConclusion?t._e():e("div",{staticStyle:{"font-size":"0.9em","max-width":"500px"}},[e("v-textarea",{class:t.$vuetify.theme.dark?"":"textfield-light-background",staticStyle:{"font-size":"0.9em"},attrs:{outlined:"",flat:"","hide-details":"","auto-grow":"",rows:"3",clearable:"",placeholder:"Add your conclusion..."},model:{value:t.conclusionText,callback:function(e){t.conclusionText=e},expression:"conclusionText"}}),e("v-btn",{staticClass:"mt-2",attrs:{small:"",text:"",color:"primary",disabled:!t.conclusionText},on:{click:function(e){return t.createConclusion()}}},[t._v(" Save ")])],1)],2)])],1)],1)],1)],1)])],1)],1)},Wr=[],jr=function(){var t=this,e=t._self._c;return e("div",["chip"===t.type?e("v-chip",{attrs:{small:""},on:{click:function(e){return t.search(t.queryString)}}},[e("v-icon",{staticClass:"mr-1",attrs:{small:""}},[t._v("mdi-magnify")]),t._v(" "+t._s(t.displayName)+" ")],1):t._e(),"link"===t.type?e("div",{class:t.searchchip.error?"":"enabled",on:{click:function(e){return t.search(t.queryString)}}},[e("div",{staticClass:"pb-1 pl-1",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{"font-size":"0.9em"}},[e("span",[e("v-icon",{staticClass:"mr-2 ml-2",attrs:{small:""}},[t._v(t._s(t.icon))]),e("strong",[t._v(t._s(t.displayName))]),e("br"),t.searchchip.error?e("small",{staticClass:"ml-8",staticStyle:{"font-size":"0.8em"}},[t._v(t._s(t.searchchip.error))]):e("div",{staticClass:"truncate-with-ellipsis",staticStyle:{width:"90%"}},[e("small",{staticClass:"ml-8",staticStyle:{"font-size":"0.8em"}},[t._v(t._s(t.queryString))])])],1)])]):t._e()],1)},Yr=[],Xr=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},Jr={props:["searchchip","type","icon"],computed:{displayName:function(){return this.searchchip.name||this.searchchip.description},queryString:function(){return this.searchchip.query_string||this.searchchip.value}},methods:{search:function(t){if(!this.searchchip.error){var e={doSearch:!0};e.queryString=t,e.queryFilter=Xr(),o.$emit("setQueryAndFilter",e)}}}},Kr=Jr,Zr=(0,u.A)(Kr,jr,Yr,!1,null,"3453ec85",null),to=Zr.exports,eo=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"font-size":"0.9em"}},[e("div",{staticClass:"pb-4 markdown-body",staticStyle:{"font-size":"1em","background-color":"transparent"},domProps:{innerHTML:t._s(t.toHtml(t.approach.description))}}),t.opensearchQueries.length?e("div",{staticClass:"pb-4"},[e("strong",[t._v("Suggested queries")]),t._l(t.opensearchQueries,function(t){return e("ts-search-chip",{key:t.value,staticClass:"mb-1 mt-2",attrs:{searchchip:t,type:"link"}})})],2):t._e(),e("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){t.showDetails=!t.showDetails}}},[t.showDetails?e("v-icon",{attrs:{small:""}},[t._v("mdi-chevron-down")]):e("v-icon",{attrs:{color:"primary",small:""}},[t._v("mdi-chevron-right")]),e("small",{staticStyle:{color:"#1976d2"}},[t._v("More info..")])],1),e("v-expand-transition",[t.showDetails?e("div",{staticClass:"mt-3"},[t.approach.references&&t.approach.references.length?e("div",[e("v-icon",{staticClass:"mr-2"},[t._v("mdi-link-variant")]),e("strong",[t._v("References")]),e("ul",{staticClass:"mb-4 mt-2 markdown-body",staticStyle:{"line-height":"70%","background-color":"transparent"}},t._l(t.approach.references,function(i){return e("li",{key:i},[e("div",{staticStyle:{"font-size":"0.9em"},domProps:{innerHTML:t._s(t.toHtml(i))}})])}),0)],1):t._e(),e("v-sheet",{staticClass:"mb-3",staticStyle:{"max-width":"80%","background-color":"transparent"}},[e("v-icon",{staticClass:"mr-2",attrs:{color:"success"}},[t._v("mdi-check")]),e("strong",[t._v("Covered")]),e("ul",{staticClass:"mt-2"},t._l(t.approach.notes.covered,function(i){return e("li",{key:i},[t._v(t._s(i))])}),0)],1),e("v-sheet",{staticStyle:{"max-width":"80%","background-color":"transparent"}},[e("v-icon",{staticClass:"mr-2",attrs:{color:"error"}},[t._v("mdi-close")]),e("strong",[t._v("Not covered")]),e("ul",{staticClass:"mt-2"},t._l(t.approach.notes.not_covered,function(i){return e("li",{key:i},[t._v(t._s(i))])}),0)],1)],1):t._e()])],1)},io=[],no={props:["approachJSON"],components:{TsSearchChip:to},data:function(){return{showDetails:!1}},computed:{approach:function(){return JSON.parse(this.approachJSON.spec_json)},opensearchQueries:function(){var t=[];return this.approach.steps&&this.approach.steps.forEach(function(e){"opensearch-query"===e.type&&t.push(e)}),t}},methods:{toHtml:function(t){return Ge.A.sanitize((0,oi.xI)(t))}}},so=no,ao=(0,u.A)(so,eo,io,!1,null,null,null),ro=ao.exports,oo=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{position:"relative"},on:{mouseover:function(e){t.showControls=!0},mouseleave:function(e){t.showControls=!1}}},[e("div",{staticClass:"mb-4",staticStyle:{"font-size":"0.9em"}},[e("strong",[t._v(t._s(t.conclusion.user.username))]),e("small",{staticClass:"ml-3"},[t._v(t._s(t._f("shortDateTime")(t.conclusion.created_at))+" ("+t._s(t._f("timeSince")(t.conclusion.created_at))+")")])]),t.editable?e("div",[e("v-textarea",{staticStyle:{"font-size":"0.9em"},attrs:{outlined:"",flat:"","hide-details":"","auto-grow":"",rows:"3",clearable:"",value:t.conclusion.conclusion},model:{value:t.conclusionText,callback:function(e){t.conclusionText=e},expression:"conclusionText"}}),e("v-card-actions",[e("v-btn",{attrs:{small:"",text:"",color:"primary",disabled:!t.conclusionText},on:{click:function(e){return t.saveConclusion()}}},[t._v(" Save ")]),e("v-btn",{attrs:{small:"",text:""},on:{click:function(e){t.editable=!1}}},[t._v(" Cancel ")])],1)],1):e("div",{staticStyle:{"font-size":"0.9em"}},[t._v(t._s(t.conclusion.conclusion))]),t.showControls&&t.currentUser==t.conclusion.user.username?e("div",{staticStyle:{position:"absolute",top:"0",right:"0"}},[e("v-chip",{staticStyle:{"margin-right":"10px"},attrs:{outlined:""}},[e("v-btn",{attrs:{icon:"",small:""}},[e("v-icon",{attrs:{small:""},on:{click:function(e){return t.editConclusion()}}},[t._v("mdi-square-edit-outline")])],1),e("v-btn",{attrs:{icon:"",small:""}},[e("v-icon",{attrs:{small:""},on:{click:function(e){return t.deleteConclusion()}}},[t._v("mdi-trash-can-outline")])],1)],1)],1):t._e()])},lo=[],co={props:["question","conclusion"],data:function(){return{conclusionText:"",editable:!1,showControls:!1}},computed:{sketch:function(){return this.$store.state.sketch},currentUser:function(){return this.$store.state.currentUser}},methods:{saveConclusion:function(){var t=this;this.editable=!1,this.showControls=!1,_.editQuestionConclusion(this.sketch.id,this.question.id,this.conclusion.id,this.conclusionText).then(function(e){t.$emit("save-conclusion")}).catch(function(e){t.editable=!0,t.errorSnackBar(e),console.error(e)})},editConclusion:function(){this.conclusionText=this.conclusion.conclusion,this.editable=!0},deleteConclusion:function(){confirm("Are you sure?")&&this.$emit("delete")}}},uo=co,ho=(0,u.A)(uo,oo,lo,!1,null,"0cd171b2",null),mo=ho.exports,vo={components:{TsQuestionApproach:ro,TsQuestionConclusion:mo,TsSearchChip:to},props:{questionId:{type:[String,Number],default:null},initialTab:{type:Number,default:0,validator:function(t){return t>=0&&t<=2}}},data:function(){return{isLoading:!1,expanded:!1,questionTemplates:[],sketchQuestions:[],activeQuestion:{approaches:[],conclusions:[]},searchHistory:[],conclusionText:"",activeTab:0,currentTitle:"",queryString:"",showDropdown:!1,showEmptySelect:!1,suggestedQuery:{},suggestedQueryLoading:!1}},computed:{sketch:function(){return this.$store.state.sketch},currentUser:function(){return this.$store.state.currentUser},systemSettings:function(){return this.$store.state.systemSettings},userSettings:function(){return this.$store.state.settings},isNl2qAvailable:function(){return this.userSettings.generateQuery&&this.systemSettings.LLM_FEATURES_AVAILABLE&&this.systemSettings.LLM_FEATURES_AVAILABLE.nl2q},matches:function(){var t=this;if(!this.queryString)return{questions:this.sketchQuestions,templates:this.questionTemplates};var e={};return this.sketchQuestions&&(e["questions"]=this.sketchQuestions.filter(function(e){return e.name.toLowerCase().includes(t.queryString.toLowerCase())})),this.questionTemplates&&(e["templates"]=this.questionTemplates.filter(function(e){return e.name.toLowerCase().includes(t.queryString.toLowerCase())})),e},allSuggestedQueries:function(){if(!this.activeQuestion.approaches.length)return[];var t=[],e=this.activeQuestion.approaches.map(function(t){return JSON.parse(t.spec_json)});return e&&e.forEach(function(e){e.steps&&e.steps.forEach(function(e){"opensearch-query"===e.type&&t.push(e)})}),t},currentUserConclusion:function(){var t=this;return!!this.activeQuestion.conclusions&&this.activeQuestion.conclusions.filter(function(e){return e.user.username===t.currentUser}).length}},methods:{getSuggestedQuery:function(){var t=this;this.suggestedQueryLoading=!0;var e={question:this.activeQuestion.display_name};_.llmRequest(this.sketch.id,"nl2q",e).then(function(e){t.suggestedQuery=e.data,t.suggestedQueryLoading=!1}).catch(function(t){console.error(t)})},getQuestionTemplates:function(){var t=this;this.isLoading=!0,_.getQuestionTemplates().then(function(e){t.questionTemplates=e.data.objects,t.isLoading=!1}).catch(function(t){console.error(t)})},getSketchQuestions:function(){var t=this;return this.isLoading=!0,_.getOrphanQuestions(this.sketch.id).then(function(e){t.sketchQuestions=e.data.objects[0],t.isLoading=!1}).catch(function(t){console.error(t)})},createQuestion:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.queryString,n=null;null!==e&&(i=e.name,n=e.id),_.createQuestion(this.sketch.id,null,null,i,n).then(function(e){var i=e.data.objects[0];t.setActiveQuestion(i),t.$emit("new-question",i),t.getSketchQuestions()}).catch(function(t){console.error(t)})},getSearchHistory:function(){var t=this;_.getSearchHistory(this.sketch.id,5,this.activeQuestion.id).then(function(e){e.data.objects.length?t.searchHistory=e.data.objects.reverse():t.searchHistory=[]}).catch(function(t){console.error(t)})},refreshActiveQuestion:function(){var t=this;_.getQuestion(this.sketch.id,this.activeQuestion.id).then(function(e){t.activeQuestion=e.data.objects[0]}).catch(function(t){console.error(t)})},createConclusion:function(){var t=this;_.createQuestionConclusion(this.sketch.id,this.activeQuestion.id,this.conclusionText).then(function(e){t.conclusionText="",t.refreshActiveQuestion(),t.getSketchQuestions()}).catch(function(t){console.error(t)})},deleteConclusion:function(t){var e=this;_.deleteQuestionConclusion(this.sketch.id,this.activeQuestion.id,t.id).then(function(t){e.refreshActiveQuestion(),e.getSketchQuestions()}).catch(function(t){console.error(t)})},setActiveQuestion:function(t){this.activeQuestion=t,this.showDropdown=!1,this.showEmptySelect=!1,this.queryString="",this.currentTitle=t.name,this.expanded=!0,this.suggestedQuery={},this.isNl2qAvailable?this.activeQuestion.conclusions.length?this.activeTab=2:this.activeTab=0:this.activeQuestion.conclusions.length?this.activeTab=2:this.allSuggestedQueries.length?this.activeTab=0:this.activeQuestion.approaches.length?this.activeTab=1:this.activeTab=2;var e={scenarioId:null,facetId:null,questionId:t.id};this.$store.dispatch("setActiveContext",e)},toHtml:function(t){if(t)return Ge.A.sanitize((0,oi.xI)(t))},onClickOutside:function(t){"questionDropdownButton"!==t.target.id&&(this.showDropdown=!1)},search:function(t){var e={doSearch:!0};e.queryString=t.query_string,e.queryFilter=JSON.parse(t.query_filter),e.incognito=!0,o.$emit("setQueryAndFilter",e)},fetchQuestion:function(t){var e=this;return this.isLoading=!0,new Promise(function(i,n){_.getQuestion(e.sketch.id,t).then(function(t){var e=t.data.objects[0];i(e)}).catch(function(t){console.error("Error fetching question:",t),e.isLoading=!1,e.activeQuestion=null,e.$emit("error","Failed to load question."),n(t)}).finally(function(){e.isLoading=!1})})}},beforeDestroy:function(){o.$off("createBranch")},mounted:function(){var t=this;if(o.$on("createBranch",this.getSearchHistory),this.questionId)this.fetchQuestion(this.questionId).then(function(e){e?(t.activeQuestion=e,t.expanded=!0,t.initialTab?t.activeTab=t.initialTab:t.activeTab=2):console.error("No question found with ID: ",t.questionId)}).catch(function(t){console.error("Error in mounted:",t)});else{var e=this.$route.query.question_uuid;if(this.getQuestionTemplates(),this.getSketchQuestions().then(function(){if(e){var i=t.sketchQuestions.find(function(t){return t.uuid===e});if(!i)return t.errorSnackBar("No question found with that UUID"),void(t.showEmptySelect=!0);t.setActiveQuestion(i)}}),!e){var i="sketchContext"+this.sketch.id.toString(),n=localStorage.getItem(i),s={};n&&(s=JSON.parse(n)),Object.keys(s).length?(this.isLoading=!0,_.getQuestion(this.sketch.id,s.questionId).then(function(e){t.setActiveQuestion(e.data.objects[0]),t.isLoading=!1}).catch(function(t){console.error(t)})):this.showEmptySelect=!0}}}},po=vo,fo=(0,u.A)(po,Ur,Wr,!1,null,null,null),go=fo.exports,yo=function(){return{componentName:"",componentProps:{},content:"",draft:"",edit:!0,isActive:!1,showGraphMenu:!1,showSavedSearchMenu:!1,showSavedVisualizationMenu:!1,showQuestionMenu:!1}},_o=function(){return{TsViewEventList:"TsEventList"}},bo={props:["sketchId","storyId"],components:{TsEventList:wn,TsCytoscape:Va,TsSavedVisualization:Gr,TsQuestionCard:go,TsQuestionConclusion:mo},data:function(){return{title:"",titleDraft:"",blocks:[],renameStoryDialog:!1,deleteStoryDialog:!1,sketchQuestions:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},hasContent:function(){return!!this.blocks.length&&!(this.blocks.length<2&&!this.blocks[0].componentName&&!this.blocks[0].content)},graphPlugins:function(){return this.$store.state.graphPlugins},savedGraphs:function(){return this.$store.state.savedGraphs},savedVisualizations:function(){return this.$store.state.savedVisualizations?this.$store.state.savedVisualizations.filter(function(t){return"apex"===JSON.parse(t.parameters)["aggregator_class"]}):[]},availableSketchQuestions:function(){var t=this.blocks.filter(function(t){return"TsInvestigativeQuestion"===t.componentName}).map(function(t){return t.componentProps.questionId}),e=Array.isArray(this.sketchQuestions)?this.sketchQuestions:[];return e.filter(function(e){return!t.includes(e.id)})}},methods:{updateDraft:Lt().debounce(function(t,e){e.draft=t},300),fetchStory:function(){var t=this;return(0,Ja.A)((0,Xa.A)().m(function e(){return(0,Xa.A)().w(function(e){while(1)switch(e.n){case 0:_.getStory(t.sketchId,t.storyId).then(function(e){t.title=e.data.objects[0].title,t.titleDraft=t.title;var i=e.data.objects[0].content;t.blocks="[]"===i?[yo()]:JSON.parse(i),t.formatBlocks(t.blocks),t.blocks.length<2&&!t.blocks[0].componentName&&!t.blocks[0].content&&(t.blocks[0].edit=!0)}).catch(function(t){console.error(t)});case 1:return e.a(2)}},e)}))()},formatBlocks:function(t){var e=_o();return t.forEach(function(t){t.componentName in e&&(t.componentName=e[t.componentName])}),t},formatComponentProps:function(t){if("TsEventList"===t.componentName||"TsViewEventList"===t.componentName){var e=10,i=t.componentProps.view.query_string||t.componentProps.view.query,n=t.componentProps.view.query_filter||t.componentProps.view.filter,s={};return n=n&&void 0!==n?JSON.parse(n):{},n.size=e,n.terminate_after=e,s["queryString"]=i,s["queryFilter"]=n,s["incognito"]=!0,{queryRequest:s,disableSaveSearch:!0,itemsPerPage:e}}return t.componentProps},toHtml:function(t){return Ge.A.sanitize((0,oi.xI)(t))},addTextBlock:function(t){var e=t+1,i=yo();this.blocks.splice(e,0,i)},addEventListBlock:function(t,e){var i=e+1,n=yo();n.componentName="TsEventList",n.componentProps={view:t},this.blocks.splice(i,0,n),this.save()},addGraphPluginBlock:function(t,e){var i=e+1,n=yo();n.componentName="TsCytoscapePlugin",n.componentProps={graphPluginName:t.name,canvasHeight:"500px",disableZoom:!0},this.blocks.splice(i,0,n),this.save()},addSavedGraphBlock:function(t,e){var i=e+1,n=yo();n.componentName="TsCytoscapeSavedGraph",n.componentProps={savedGraphId:t.id,canvasHeight:"400px",disableZoom:!0},n.graphName=t.name,this.blocks.splice(i,0,n),this.save()},addSavedVisualization:function(t,e){var i=e+1,n=yo();n.componentName="TsSavedVisualization",n.componentProps={name:t.name,savedVisualizationId:t.id},this.blocks.splice(i,0,n),this.save()},addQuestionBlock:function(t,e){var i=this;return(0,Ja.A)((0,Xa.A)().m(function n(){var s,a;return(0,Xa.A)().w(function(n){while(1)switch(n.n){case 0:return s=e+1,a=yo(),a.componentName="TsInvestigativeQuestion",a.componentProps={questionName:t.name,questionId:t.id},i.blocks.splice(s,0,a),n.n=1,i.save();case 1:return n.n=2,i.fetchStory();case 2:return n.a(2)}},n)}))()},editTextBlock:function(t){t.edit||(t.edit=!0,t.draft=t.content)},deleteBlock:function(t){confirm("Delete block?")&&(this.blocks.splice(t,1),this.blocks.length||(this.blocks=[yo()]),this.save())},setActiveView:function(t){o.$emit("setActiveView",t)},setActiveGraph:function(t){"string"===typeof t?o.$emit("setGraphPlugin",t):"number"===typeof t&&o.$emit("setSavedGraph",t)},save:function(){var t=this;return(0,Ja.A)((0,Xa.A)().m(function e(){var i;return(0,Xa.A)().w(function(e){while(1)switch(e.n){case 0:t.blocks.forEach(function(t){t.isActive=!1,t.showGraphMenu=!1,t.showSavedSearchMenu=!1,t.showSavedVisualizationMenu=!1,t.showQuestionMenu=!1,t.edit=!1,t.draft&&(t.content=t.draft,t.draft="")}),t.hasContent?i=JSON.stringify(t.blocks):(i=JSON.stringify([]),t.blocks=[yo()]),_.updateStory(t.title,i,t.sketchId,t.storyId).then(function(e){t.$store.dispatch("updateSketch",t.sketchId)}).catch(function(t){});case 1:return e.a(2)}},e)}))()},rename:function(){this.renameStoryDialog=!1,this.title=this.titleDraft,this.save()},deleteStory:function(){var t=this;this.deleteStoryDialog=!1,_.deleteStory(this.sketchId,this.storyId).then(function(e){t.blocks=[],_.getStoryList(t.sketchId).then(function(e){var i=e.data.objects[0];if(i&&i.length>0){var n=i[0].id;t.$router.push({name:"Story",params:{sketchId:t.sketchId,storyId:n}})}else t.$router.push({name:"Overview",params:{sketchId:t.sketchId}})}).catch(function(e){console.error("Error getStoryList",e),t.$router.push({name:"Sketches"})}),t.$store.dispatch("updateSketch",t.sketchId)}).catch(function(e){console.error("Error deleting story:",e),t.$router.push({name:"Sketches"})})},getSketchQuestions:function(){var t=this;return(0,Ja.A)((0,Xa.A)().m(function e(){var i,n;return(0,Xa.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,_.getOrphanQuestions(t.sketch.id);case 1:i=e.v,t.sketchQuestions=i.data.objects[0],e.n=3;break;case 2:e.p=2,n=e.v,console.error(n);case 3:return e.a(2)}},e,null,[[0,2]])}))()}},mounted:function(){this.storyId&&this.fetchStory(),this.getSketchQuestions()},watch:{storyId:function(t){this.storyId&&this.fetchStory()}}},So=bo,wo=(0,u.A)(So,ja,Ya,!1,null,null,null),ko=wo.exports,xo=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-card",{staticClass:"pa-3 pt-0 mt-n3",attrs:{flat:"",color:"transparent"}},[e("div",{staticClass:"mt-2"},[e("ts-timeline-search",{attrs:{componentName:"analysis",includeProcessingTimelines:!1,"analyzer-timeline-id":t.analyzerTimelineId},on:{selectedTimelines:function(e){t.timelineSelection=e}}})],1),e("v-divider"),e("div",[e("ts-analyzer-list",{attrs:{timelineSelection:t.timelineSelection}})],1),e("v-divider")],1)],1)},To=[],Co=function(){var t=this,e=t._self._c;return e("div",[e("v-btn",{staticClass:"mb-1",attrs:{small:"",text:"",color:"primary"},on:{click:function(e){return t.selectAll()}}},[e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-plus")]),e("span",[t._v("Select all")])],1),e("v-btn",{staticClass:"mb-1",attrs:{small:"",text:"",color:"primary"},on:{click:function(e){return t.unselectAll()}}},[e("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-minus")]),e("span",[t._v("Unselect all")])],1),e("v-autocomplete",{staticClass:"center-label-height",attrs:{items:t.allReadyTimelines,outlined:"",label:"Select timelines for ".concat(t.componentName),"item-text":"name","item-value":"id",multiple:""},scopedSlots:t._u([{key:"selection",fn:function(i){return[e("ts-analyzer-timeline-chip",{staticClass:"mr-1",attrs:{timeline:i.item,close:!0},on:{"click:close":function(e){return t.remove(i.item)}}})]}},{key:"item",fn:function(i){return[e("v-list-item-content",[e("div",[e("ts-analyzer-timeline-chip",{attrs:{timeline:i.item,close:t.selectedTimelines.includes(i.item.id)},on:{"click:close":function(e){return t.remove(i.item)}}})],1)])]}}]),model:{value:t.selectedTimelines,callback:function(e){t.selectedTimelines=e},expression:"selectedTimelines"}})],1)},Ao=[],Do=function(){var t=this,e=t._self._c;return e("ts-timeline-component",{attrs:{timeline:t.timeline},scopedSlots:t._u([{key:"processed",fn:function(i){return[e("v-chip",{staticClass:"timeline-chip",style:t.timelineStyle,attrs:{ripple:!1,close:t.close},on:{"click:close":function(e){return t.$emit("click:close")}}},[e("div",{staticClass:"chip-content"},[e("v-icon",{staticClass:"ml-n2",attrs:{left:"",color:i.timelineChipColor,size:"26"}},[t._v(" mdi-circle ")]),e("v-tooltip",{attrs:{bottom:"",disabled:t.timeline.name.length<30,"open-delay":"200"},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("span",t._g(t._b({staticClass:"timeline-name-ellipsis"},"span",s,!1),n),[t._v(t._s(t.timeline.name))])]}}],null,!0)},[e("span",[t._v(t._s(t.timeline.name))])]),"processing"===t.timeline.status[0].status?e("span",{staticClass:"ml-3 mr-3"},[e("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:17,width:2}})],1):t._e()],1)])]}}])})},Lo=[],Io={props:{timeline:Object,close:{type:Boolean,default:!1}},components:{TsTimelineComponent:Ft},computed:{timelineStyle:function(){return{backgroundColor:this.$vuetify.theme.dark?"#4d4d4d":"#e6e6e6"}}}},Eo=Io,No=(0,u.A)(Eo,Do,Lo,!1,null,"20923ce0",null),zo=No.exports,$o={components:{TsAnalyzerTimelineChip:zo},props:["analyzerTimelineId","componentName","includeProcessingTimelines"],data:function(){return{selectedTimelines:[]}},computed:{sketch:function(){return this.$store.state.sketch},allReadyTimelines:function(){var t=this,e=this.sketch.timelines.filter(function(e){return"ready"===e.status[0].status||t.includeProcessingTimelines&&"processing"===e.status[0].status});return e.sort(function(t,e){return t.name.localeCompare(e.name)}),e}},watch:{selectedTimelines:{handler:function(t){this.$emit("selectedTimelines",t)},deep:!0},analyzerTimelineId:{handler:function(t){Array.isArray(t)?this.selectedTimelines=t:t?this.selectedTimelines.push(t):this.selectedTimelines=[]}}},methods:{remove:function(t){this.selectedTimelines=this.selectedTimelines.filter(function(e){return e!==t.id})},selectAll:function(){this.selectedTimelines=(0,B.A)(this.allReadyTimelines.map(function(t){return t.id}))},unselectAll:function(){this.selectedTimelines=[]}}},Fo=$o,Ro=(0,u.A)(Fo,Co,Ao,!1,null,"c1388c6c",null),Po=Ro.exports,Oo=function(){var t=this,e=t._self._c;return e("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[e("thead",[e("tr",[e("th"),e("th",{staticClass:"text-left"},[t._v(" Name ")]),e("th",{staticClass:"text-left"},[t._v(" Description ")])])]),e("tbody",t._l(t.sortedAnalyzerList,function(i){return e("tr",{key:i.analyzerName},[e("td",[e("v-tooltip",{attrs:{right:"","open-delay":"500"},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on;return[e("div",t._g({staticClass:"d-inline-block d-flex justify-center pr-4"},s),[t.isLoading(i.analyzerName)?e("v-progress-circular",{attrs:{size:20,width:2,indeterminate:"",color:"primary"}}):t._e(),t.isLoading(i.analyzerName)?t._e():e("v-btn",{attrs:{icon:"",color:"primary",disabled:!(t.timelineSelection.length>0)},on:{click:function(e){t.showRerunIcon(i.analyzerName)?t.handleReRunDialog(i.analyzerName,i.info.display_name):t.runAnalyzer(i.analyzerName)}}},[t.showRerunIcon(i.analyzerName)?e("v-icon",[t._v("mdi-replay")]):e("v-icon",[t._v(" mdi-play-circle-outline ")])],1)],1)]}}],null,!0)},[0===t.timelineSelection.length?e("span",[t._v("Please select a timeline above first.")]):t.showRerunIcon(i.analyzerName)?e("span",[t._v('Re-run analyzer: "'+t._s(i.info.display_name)+'"')]):e("span",[t._v('Run analyzer: "'+t._s(i.info.display_name)+'"')])])],1),e("td",[t._v(t._s(i.info.display_name))]),e("td",[t._v(t._s(i.info.description))])])}),0),e("v-dialog",{attrs:{"max-width":"515","retain-focus":!1},model:{value:t.reRunDialog,callback:function(e){t.reRunDialog=e},expression:"reRunDialog"}},[e("v-card",[e("v-card-title",[e("v-icon",{attrs:{large:""}},[t._v("mdi-replay")]),e("span",{staticClass:"text-h6 ml-2"},[t._v('Run "'+t._s(t.reRunDialogAnalyzerDisplayName)+'" again?')])],1),e("v-card-text",[e("div",{staticClass:"mb-2"},[t._v(' The "'+t._s(t.reRunDialogAnalyzerDisplayName)+'" analyzer was already run on the selected timelines. Do you really want to run it again? ')])]),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.reRunDialog=!1}}},[t._v(" cancel ")]),e("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.runAnalyzer(t.reRunDialogAnalyzerName,!0),t.reRunDialog=!1}}},[t._v(" continue ")])],1)],1)],1)]},proxy:!0}])})},Qo=[],Mo=(i(36033),3e3),qo={props:["timelineSelection"],data:function(){return{triggeredAnalyzers:[],loadingAnalyzers:[],reRunDialog:!1,reRunDialogAnalyzerName:"",reRunDialogAnalyzerDisplayName:""}},computed:{sketch:function(){return this.$store.state.sketch},analyzerList:function(){return this.$store.state.sketchAnalyzerList},analyzerResults:function(){return this.$store.state.analyzerResults},analyzersAlreadyRun:function(){var t,e=new Set(this.timelineSelection),i=this.analyzerResults.filter(function(t){return e.has(t.timeline.id)}),n=new Map,s=(0,Le.A)(i);try{for(s.s();!(t=s.n()).done;){var a=t.value;n.has(a.analyzer_name)||n.set(a.analyzer_name,new Set),n.get(a.analyzer_name).add(a.timeline.id)}}catch(h){s.e(h)}finally{s.f()}var r,o=new Set,l=(0,Le.A)(n);try{for(l.s();!(r=l.n()).done;){var c=(0,Ne.A)(r.value,2),u=c[0],d=c[1];d.size===e.size&&o.add(u)}}catch(h){l.e(h)}finally{l.f()}return this.triggered.forEach(function(t){return o.has(t)?null:o.add(t)}),this.resetTriggeredAnalyzers(),o},activeAnalyzerTimelinesMap:function(){var t,e=new Map,i=(0,Le.A)(this.$store.state.activeAnalyses);try{for(i.s();!(t=i.n()).done;){var n=t.value;e.has(n.analyzer_name)||e.set(n.analyzer_name,new Set),e.get(n.analyzer_name).add(n.timeline.id)}}catch(s){i.e(s)}finally{i.f()}return e},sortedAnalyzerList:function(){var t=Object.entries(this.analyzerList).map(function(t){var e=(0,Ne.A)(t,2),i=e[0],n=e[1];return{analyzerName:i,info:n}}),e=(0,B.A)(t);return e.sort(function(t,e){return t.info.display_name.localeCompare(e.info.display_name)}),e},triggered:function(){return this.triggeredAnalyzers},loading:function(){return this.loadingAnalyzers}},methods:{handleReRunDialog:function(t,e){this.reRunDialogAnalyzerName=t,this.reRunDialogAnalyzerDisplayName=e,this.reRunDialog=!0},isLoading:function(t){return this.loading.includes(t)},showRerunIcon:function(t){return this.analyzersAlreadyRun.has(t)},activeTimelinesCount:function(t){var e=this.activeAnalyzerTimelinesMap.get(t);return e?e.size:0},runAnalyzer:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.triggeredAnalyzers=[].concat((0,B.A)(this.triggeredAnalyzers),[t]),this.loadingAnalyzers=[].concat((0,B.A)(this.loadingAnalyzers),[t]),setTimeout(function(){e.removeFromLoading(t)},Mo);var n=(new Date).getTime();_.runAnalyzers(this.sketch.id,this.timelineSelection,[t],i).then(function(i){var s,a=[],r=[],o=(0,Le.A)(i.data.objects[0]);try{for(o.s();!(s=o.n()).done;){var l=s.value;r.push(l.id),a=a.concat(l.analyses)}}catch(c){o.e(c)}finally{o.f()}e.$store.dispatch("addActiveAnalyses",a),(new Date).getTime()-n>=Mo&&e.removeFromLoading(t)}).catch(function(t){console.log(t)})},removeFromLoading:function(t){this.loadingAnalyzers=this.loadingAnalyzers.filter(function(e){return t!==e})},resetTriggeredAnalyzers:function(){this.triggeredAnalyzers=[]}}},Bo=qo,Vo=(0,u.A)(Bo,Oo,Qo,!1,null,null,null),Ho=Vo.exports,Go={components:{TsTimelineSearch:Po,TsAnalyzerList:Ho},props:["sketchId","analyzerTimelineId"],data:function(){return{timelineSelection:[]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}}},Uo=Go,Wo=(0,u.A)(Uo,xo,To,!1,null,null,null),jo=Wo.exports,Yo=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[t.aggregationId?t._e():e("ts-visualization-editor"),t.aggregationId?e("ts-saved-visualization",{attrs:{aggregationId:t.aggregationId}}):t._e()],1)},Xo=[],Jo=(i(99449),function(){var t=this,e=t._self._c;return e("div",[e("v-dialog",{attrs:{width:"600"},model:{value:t.renameVisualDialog,callback:function(e){t.renameVisualDialog=e},expression:"renameVisualDialog"}},[e("v-card",{staticClass:"pa-4"},[e("h3",[t._v("Rename Visualization")]),e("br"),e("v-form",{on:{submit:function(e){return e.preventDefault(),t.rename()}}},[e("v-text-field",{attrs:{outlined:"",dense:"",autofocus:""},on:{focus:function(t){return t.target.select()}},model:{value:t.selectedChartTitleDraft,callback:function(e){t.selectedChartTitleDraft=e},expression:"selectedChartTitleDraft"}}),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){t.renameVisualDialog=!1}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){return t.rename()}}},[t._v(" Save ")])],1)],1)],1)],1),e("v-toolbar",{staticClass:"mt-n3",attrs:{dense:"",flat:"",color:"transparent"}},[e("v-toolbar-title",{on:{dblclick:function(e){t.renameVisualDialog=!0}}},[t._v(" "+t._s(t.selectedChartTitle))]),e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){t.renameVisualDialog=!0}}},[e("v-icon",{attrs:{small:""}},[t._v("mdi-pencil")])],1)],1),e("v-divider",{staticClass:"mx-3"}),e("v-row",{staticClass:"mt-3"},[e("v-col",[e("TsAggregationEventSelect",{attrs:{timelineIDs:t.selectedTimelineIDs,queryString:t.selectedQueryString,queryChips:t.selectedQueryChips},on:{updateTimelineIDs:function(e){t.selectedTimelineIDs=e},updateQueryString:function(e){t.selectedQueryString=e},updateQueryChips:function(e){t.selectedQueryChips=e}}}),e("TsAggregationConfig",{attrs:{field:t.selectedField,aggregator:t.selectedAggregator,metric:t.selectedMetric,maxItems:t.selectedMaxItems,interval:t.selectedInterval,intervalQuantity:t.selectedIntervalQuantity,splitByTimeline:t.selectedSplitByTimeline},on:{updateField:function(e){t.selectedField=e},updateAggregator:function(e){t.selectedAggregator=e},updateMetric:function(e){t.selectedMetric=e},updateMaxItems:function(e){t.selectedMaxItems=e},updateInterval:function(e){t.selectedInterval=e},updateIntervalQuantity:function(e){t.selectedIntervalQuantity=e},updateSplitByTimeline:function(e){t.selectedSplitByTimeline=e}}}),e("TsChartConfig",{attrs:{aggregatorType:t.selectedAggregator,chartType:t.selectedChartType,title:t.selectedChartTitle,height:t.selectedHeight,width:t.selectedWidth,xTitle:t.selectedXTitle,showXLabels:t.selectedShowXLabels,yTitle:t.selectedYTitle,showYLabels:t.selectedShowYLabels,showDataLabels:t.selectedShowDataLabels},on:{updateChartType:function(e){t.selectedChartType=e},updateTitle:function(e){t.selectedChartTitle=e},updateHeight:function(e){t.selectedHeight=e},updateWidth:function(e){t.selectedWidth=e},updateXTitle:function(e){t.selectedXTitle=e},updateShowXLabels:function(e){t.selectedShowXLabels=e},updateYTitle:function(e){t.selectedYTitle=e},updateShowYLabels:function(e){t.selectedShowYLabels=e},updateShowDataLabels:function(e){t.selectedShowDataLabels=e}}})],1),e("v-col",{class:null==t.chartSeries?"d-flex justify-center align-center":"",attrs:{cols:"8"}},[null==t.chartSeries?e("v-img",{attrs:{src:"/dist/vis_placeholder.png","max-width":"600","max-height":"500",contain:""}}):t._e(),t.chartSeries&&t.selectedChartType?e("TsChartCard",{attrs:{fieldName:t.selectedField.field,metricName:t.selectedMetric,"is-time-series":!!t.selectedAggregator&&t.selectedAggregator.endsWith("date_histogram"),chartSeries:t.chartSeries,chartLabels:t.chartLabels,chartType:t.selectedChartType,height:t.selectedHeight,width:t.selectedWidth,xTitle:t.selectedXTitle,showXLabels:t.selectedShowXLabels,yTitle:t.selectedYTitle,showYLabels:t.selectedShowYLabels,showDataLabels:t.selectedShowDataLabels}}):t._e()],1)],1),e("v-divider",{staticClass:"mx-3"}),e("div",{staticClass:"mt-4"},[e("v-btn",{staticClass:"ml-3",attrs:{color:"primary",disabled:0==t.selectedTimelineIDs.length||null==t.response||!t.selectedChartTitle},on:{click:t.saveVisualization}},[t._v(" Save ")]),e("v-btn",{attrs:{text:"",color:"primary",disabled:!t.validAggregation||!(t.selectedField&&t.selectedAggregator&&t.selectedChartType)},on:{click:t.loadAggregationData}},[t.chartSeries&&t.selectedChartType?e("span",[t._v("refresh data")]):e("span",[t._v("Load data")])]),e("v-btn",{attrs:{text:"",disabled:!t.validAggregation||!(t.selectedField&&t.selectedAggregator&&t.selectedChartType)},on:{click:t.clear}},[t._v(" Clear ")]),e("v-btn",{attrs:{text:"",to:{name:"Explore"}},on:{click:t.clear}},[t._v(" Cancel ")])],1)],1)}),Ko=[],Zo=function(){var t=this,e=t._self._c;return e("v-container",{staticClass:"ma-0"},[e("v-row",[e("v-col",{attrs:{cols:"12",md:"12"}},[e("TsEventFieldSelect",{attrs:{field:t.selectedField,rules:[t.rules.required]},on:{selectedField:function(e){t.selectedField=e}}})],1)],1),e("v-row",[e("v-col",[e("v-autocomplete",{attrs:{outlined:"",disabled:t.disableAggregator,items:t.aggregators,label:"Aggregate events by",rules:[t.rules.required],"append-icon":"mdi-question"},scopedSlots:t._u([{key:"item",fn:function(i){return[e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on,a=n.attrs;return[e("v-layout",t._g(t._b({attrs:{wrap:""}},"v-layout",a,!1),s),[e("v-list-item-content",[e("v-list-item-title",[t._v(t._s(i.item.text))])],1)],1)]}}],null,!0)},[e("span",[t._v(t._s(i.item.tooltip))])])]}}]),model:{value:t.selectedAggregator,callback:function(e){t.selectedAggregator=e},expression:"selectedAggregator"}})],1)],1),t.disableMetric?t._e():e("v-row",{staticClass:"mt-n10"},[e("v-col",[e("v-autocomplete",{attrs:{outlined:"",items:t.metrics,label:"Aggregation Metric"},model:{value:t.selectedMetric,callback:function(e){t.selectedMetric=e},expression:"selectedMetric"}})],1)],1),t.disableMaxItems?t._e():e("v-row",{staticClass:"mt-n10"},[e("v-col",[e("v-text-field",{attrs:{label:t.labelMaxItems,outlined:"",type:"number",oninput:"if(this.value < 1) this.value = 1;"},model:{value:t.selectedMaxItems,callback:function(e){t.selectedMaxItems=t._n(e)},expression:"selectedMaxItems"}})],1)],1),t.disableInterval?t._e():e("v-row",{staticClass:"mt-n10"},[e("v-col",[e("v-autocomplete",{attrs:{outlined:"",items:t.allCalendarIntervals,label:"Calendar interval"},model:{value:t.selectedInterval,callback:function(e){t.selectedInterval=e},expression:"selectedInterval"}})],1)],1)],1)},tl=[],el=function(){var t=this,e=t._self._c;return e("v-autocomplete",{attrs:{outlined:"",items:t.allNonTimestampFields,label:"Field name to aggregate"},on:{input:function(e){return t.$emit("selectedField",e)}},scopedSlots:t._u([{key:"item",fn:function(i){var n=i.item,s=i.on,a=i.attrs;return[e("v-list-item",t._g(t._b({},"v-list-item",a,!1),s),[e("v-list-item-avatar",[e("v-icon",[t._v(" "+t._s("text"===n.value.type?"mdi-code-string":"mdi-pound-box")+" ")])],1),e("v-list-item-content",[t._v(" "+t._s(n.text)+" ")])],1)]}},{key:"selection",fn:function(i){var n=i.item;return[e("v-icon",[t._v(" "+t._s("text"===n.value.type?"mdi-code-string":"mdi-pound-box")+" ")]),t._v(" Â  Â  "+t._s(n.text)+" ")]}}]),model:{value:t.selectedField,callback:function(e){t.selectedField=e},expression:"selectedField"}})},il=[],nl={props:{field:{type:Object}},data:function(){return{selectedField:this.field}},computed:{allNonTimestampFields:function(){var t=this.$store.state.meta.mappings.filter(function(t){return"datetime"!==t["field"]&&"timestamp"!==t["field"]}).map(function(t){return{text:t["field"],value:t}});return t}},watch:{field:function(){this.selectedField=this.field}}},sl=nl,al=(0,u.A)(sl,el,il,!1,null,null,null),rl=al.exports,ol={components:{TsEventFieldSelect:rl},props:{aggregator:{type:String},field:{type:Object},interval:{type:Object},intervalQuantity:{type:Number},maxItems:{type:Number},metric:{type:String},splitByTimeline:{type:Boolean}},data:function(){return{enableCalendarInterval:!1,selectedAggregator:this.aggregator,selectedField:this.field,selectedInterval:this.interval,selectedIntervalQuantity:this.intervalQuantity,selectedMaxItems:this.maxItems,selectedMetric:this.metric,selectedSplitByTimeline:this.splitByTimeline,rules:{required:function(t){return!!t||"Required."}},intMetrics:[{text:"Average",value:"avg"},{text:"Count",value:"value_count"},{text:"Minimum",value:"min"},{text:"Maximum",value:"max"},{text:"Sum",value:"sum"},{text:"Unique",value:"cardinality"}],stringAggregators:[{text:"Auto Date Histogram",value:"auto_date_histogram",tooltip:"Aggregates events into a set number of intervals by datetime."},{text:"Rare Terms",value:"rare_terms",tooltip:"Aggregates by unique and infrequent terms."},{text:"Date Histogram",value:"calendar_date_histogram",tooltip:"Aggregates events by calendar intervals."},{text:"Top Terms",value:"top_terms",tooltip:"Aggregates by the most common and unique terms."}],allAggregators:[{text:"Auto Date Histogram",value:"auto_date_histogram",tooltip:"Aggregates events into a set number of intervals by datetime."},{text:"Rare terms",value:"rare_terms",tooltip:"Aggregates by unique and infrequent terms."},{text:"Date Histogram",value:"calendar_date_histogram",tooltip:"Aggregates events by calendar intervals."},{text:"Top Terms",value:"top_terms",tooltip:"Aggregates by the most common and unique terms."}],stringMetrics:[{text:"Count",value:"value_count"},{text:"Unique",value:"cardinality"}],allCalendarIntervals:[{text:"Year",value:{interval:"year",max:10}},{text:"Quarter",value:{interval:"quarter",max:4}},{text:"Month",value:{interval:"month",max:12}},{text:"Week",value:{interval:"week",max:52}},{text:"Day",value:{interval:"day",max:31}},{text:"Hour",value:{interval:"hour",max:24}},{text:"Minute",value:{interval:"minute",max:60}}]}},computed:{labelMaxItems:function(){return"rare_terms"===this.selectedAggregator?"Maximum document count for rare items":"auto_date_histogram"===this.selectedAggregator?"Maximum number of intervals":"Maximum number of items (K)"},aggregators:function(){return null==this.selectedField?[]:"text"===this.selectedField.type?this.stringAggregators:this.allAggregators},disableAggregator:function(){return null==this.selectedField},disableInterval:function(){return!(this.selectedAggregator&&"calendar_date_histogram"===this.selectedAggregator)},disableTimelineSplit:function(){return!(this.selectedAggregator&&this.selectedAggregator.endsWith("date_histogram"))},disableMaxItems:function(){return!(this.selectedAggregator&&("top_terms"===this.selectedAggregator||"significant_terms"===this.selectedAggregator||"auto_date_histogram"===this.selectedAggregator||"rare_terms"===this.selectedAggregator))},disableMetric:function(){return!(this.selectedAggregator&&("auto_date_histogram"===this.selectedAggregator||"calendar_date_histogram"===this.selectedAggregator||"single_metric"===this.selectedAggregator))},metrics:function(){return null==this.selectedField?[]:"text"===this.selectedField.type?this.stringMetrics:this.intMetrics},intervalQuantities:function(){return null==this.selectedInterval?[]:(0,B.A)(Array(this.selectedInterval.max-1).keys()).map(function(t,e){return e+1})}},watch:{aggregator:function(){this.selectedAggregator=this.aggregator,("top_terms"===this.selectedAggregator||"rare_terms"===this.selectedAggregator||null==this.selectedMetric)&&(this.selectedMetric="value_count")},field:function(){this.selectedField=this.field},interval:function(){this.selectedInterval=this.interval},intervalQuantity:function(){this.selectedIntervalQuantity=this.intervalQuantity},maxItems:function(){this.selectedMaxItems=this.maxItems},metric:function(){this.selectedMetric=this.metric},selectedAggregator:function(){this.$emit("updateAggregator",this.selectedAggregator)},selectedField:function(){this.$emit("updateField",this.selectedField)},selectedInterval:function(){this.$emit("updateInterval",this.selectedInterval)},selectedIntervalQuantity:function(){this.$emit("updateIntervalQuantity",this.selectedIntervalQuantity)},selectedMaxItems:function(){this.$emit("updateMaxItems",this.selectedMaxItems)},selectedMetric:function(){this.$emit("updateMetric",this.selectedMetric)},selectedSplitByTimeline:function(){this.$emit("updateSplitByTimeline",this.splitByTimeline)}}},ll=ol,cl=(0,u.A)(ll,Zo,tl,!1,null,null,null),ul=cl.exports,dl=function(){var t=this,e=t._self._c;return e("v-container",{staticClass:"ma-0"},[e("v-row",[e("v-col",[e("TsChartTypeSelect",{attrs:{aggregator:t.aggregatorType,chart:t.selectedChartType,required:"",rules:[t.rules.required]},on:{selectedChartType:function(e){t.selectedChartType=e}}})],1)],1),e("v-row",{staticClass:"my-4"},[e("v-btn",{staticClass:"ml-2",attrs:{small:"",icon:""},on:{click:function(e){t.selectedShowOptions=!t.selectedShowOptions}}},[t.selectedShowOptions?e("v-icon",{attrs:{title:"Hide Chart Options"}},[t._v("mdi-chevron-up")]):e("v-icon",{attrs:{title:"Show Chart Options"}},[t._v("mdi-chevron-down")])],1),t.selectedShowOptions?e("span",{staticClass:"chart-options-trigger",on:{click:function(e){t.selectedShowOptions=!t.selectedShowOptions}}},[t._v("Hide Chart Options")]):e("span",{staticClass:"chart-options-trigger",on:{click:function(e){t.selectedShowOptions=!t.selectedShowOptions}}},[t._v("Show Chart Options")])],1),e("v-expand-transition",[t.selectedShowOptions?e("div",[e("v-row",[e("v-col",[e("v-text-field",{attrs:{outlined:"",label:"Height",type:"number"},model:{value:t.selectedHeight,callback:function(e){t.selectedHeight=t._n(e)},expression:"selectedHeight"}})],1),e("v-col",[e("v-text-field",{attrs:{outlined:"",label:"Width",type:"number"},model:{value:t.selectedWidth,callback:function(e){t.selectedWidth=t._n(e)},expression:"selectedWidth"}})],1)],1),e("v-row",{staticClass:"mt-n10"},[e("v-col",[e("v-text-field",{attrs:{outlined:"",label:"Y-axis title"},model:{value:t.selectedYTitle,callback:function(e){t.selectedYTitle=e},expression:"selectedYTitle"}})],1),e("v-col",[e("v-text-field",{attrs:{outlined:"",label:"X-axis title"},model:{value:t.selectedXTitle,callback:function(e){t.selectedXTitle=e},expression:"selectedXTitle"}})],1)],1),e("v-row",{staticClass:"mt-n14"},[e("v-col",[e("v-checkbox",{attrs:{label:"Show data labels"},model:{value:t.selectedDataLabels,callback:function(e){t.selectedDataLabels=e},expression:"selectedDataLabels"}})],1),e("v-col",[e("v-checkbox",{attrs:{label:"Show y-axis labels"},model:{value:t.selectedShowYLabels,callback:function(e){t.selectedShowYLabels=e},expression:"selectedShowYLabels"}})],1),e("v-col",[e("v-checkbox",{attrs:{label:"Show x-axis labels"},model:{value:t.selectedShowXLabels,callback:function(e){t.selectedShowXLabels=e},expression:"selectedShowXLabels"}})],1)],1)],1):t._e()])],1)},hl=[],ml=function(){var t=this,e=t._self._c;return e("v-btn-toggle",{attrs:{mandatory:""},model:{value:t.chartSelector,callback:function(e){t.chartSelector=e},expression:"chartSelector"}},t._l(t.chartByAggregator,function(i,n){return e("v-btn",{key:n,attrs:{title:i.text,disabled:t.chartSelectorDisabled},on:{click:function(e){return t.$emit("selectedChartType",i.text)}}},[e("v-icon",[t._v(t._s(i.icon))])],1)}),1)},vl=[],pl={props:{aggregator:{type:String},chart:{type:String}},data:function(){return{chartSelector:0,selectedChartType:this.chart,chartTypes:[{text:"bar",icon:"mdi-poll mdi-rotate-90"},{text:"column",icon:"mdi-chart-bar"},{text:"line",icon:"mdi-chart-line"},{text:"table",icon:"mdi-table"},{text:"heatmap",icon:"mdi-blur-linear"},{text:"donut",icon:"mdi-chart-donut"}],seriesChartTypes:[{text:"bar",icon:"mdi-poll mdi-rotate-90"},{text:"column",icon:"mdi-chart-bar"},{text:"line",icon:"mdi-chart-line"},{text:"table",icon:"mdi-table"},{text:"heatmap",icon:"mdi-blur-linear"}],singleMetricChartTypes:[]}},computed:{allChartTypes:function(){for(var t=new Set,e=[],i=0,n=[].concat((0,B.A)(this.chartTypes),(0,B.A)(this.seriesChartTypes),(0,B.A)(this.singleMetricChartTypes));i<n.length;i++){var s=n[i];t.has(s.text)||(t.add(s.text),e.push(s))}return e},chartByAggregator:function(){return"top_terms"===this.aggregator?this.chartTypes:"rare_terms"===this.aggregator||"auto_date_histogram"===this.aggregator||"calendar_date_histogram"===this.aggregator?this.seriesChartTypes:"single_metric"===this.aggregator?this.singleMetricChartTypes:this.allChartTypes},chartSelectorDisabled:function(){return!this.aggregator}},watch:{aggregator:function(){this.chartByAggregator&&(this.selectedChartType=this.chartByAggregator[0].text,this.$emit("selectedChartType",this.selectedChartType))},chart:function(){this.selectedChartType=this.chart}}},fl=pl,gl=(0,u.A)(fl,ml,vl,!1,null,null,null),yl=gl.exports,_l={components:{TsChartTypeSelect:yl},props:{aggregatorType:{type:String},chartType:{type:String},height:{type:Number,default:640},showDataLabels:{type:Boolean,default:!0},showOptions:{type:Boolean,default:!1},showXLabels:{type:Boolean,default:!0},showYLabels:{type:Boolean,default:!0},title:{type:String},width:{type:Number,default:800},xTitle:{type:String},yTitle:{type:String}},data:function(){return{rules:{required:function(t){return!!t||"Required."}},selectedChartType:this.chartType,selectedChartTitle:this.title,selectedDataLabels:this.showDataLabels,selectedHeight:this.height,selectedShowOptions:this.showOptions,selectedShowXLabels:this.showXLabels,selectedShowYLabels:this.showYLabels,selectedWidth:this.width,selectedXTitle:this.xTitle,selectedYTitle:this.yTitle}},watch:{aggregatorType:function(){this.selectedAggregator=this.aggregatorType},chartType:function(){this.selectedChartType=this.chartType},height:function(){this.selectedHeight=this.height},selectedChartType:function(){this.$emit("updateChartType",this.selectedChartType)},selectedChartTitle:function(){this.$emit("updateTitle",this.selectedChartTitle)},selectedDataLabels:function(){this.$emit("updateShowDataLabels",this.selectedDataLabels)},selectedHeight:function(){this.$emit("updateHeight",this.selectedHeight)},selectedShowXLabels:function(){this.$emit("updateShowXLabels",this.selectedShowXLabels)},selectedShowYLabels:function(){this.$emit("updateShowYLabels",this.selectedShowYLabels)},selectedWidth:function(){this.$emit("updateWidth",this.selectedWidth)},selectedXTitle:function(){this.$emit("updateXTitle",this.selectedXTitle)},selectedYTitle:function(){this.$emit("updateYTitle",this.selectedYTitle)},showDataLabels:function(){this.selectedDataLabels=this.showDataLabels},showXLabels:function(){this.selectedShowXLabels=this.showXLabels},showYLabels:function(){this.selectedShowYLabels=this.showYLabels},title:function(){this.selectedChartTitle=this.title},width:function(){this.selectedWidth=this.width},xTitle:function(){this.selectedXTitle=this.xTitle},yTitle:function(){this.selectedYTitle=this.yTitle}}},bl=_l,Sl=(0,u.A)(bl,dl,hl,!1,null,null,null),wl=Sl.exports,kl=function(){var t=this,e=t._self._c;return e("v-container",{staticClass:"ma-0"},[e("v-row",{staticClass:"mt-3"},[e("v-col",[e("ts-timeline-search",{attrs:{componentName:"visualization",includeProcessingTimelines:this.settings.showProcessingTimelineEvents,"analyzer-timeline-id":t.timelineIDs},on:{selectedTimelines:function(e){t.selectedTimelineIDs=e}}})],1)],1),e("v-row",{staticClass:"mt-n10"},[e("v-col",[e("v-text-field",{attrs:{outlined:"",autofocus:"",label:"Event query"},model:{value:t.selectedQueryString,callback:function(e){t.selectedQueryString=e},expression:"selectedQueryString"}})],1)],1),e("v-row",{staticClass:"mt-n10"},[e("v-col",[e("v-select",t._b({attrs:{items:t.allRecentSearches,clearable:"",solo:"",dense:"",label:"Recent search",disabled:!!t.selectedSavedSearch},model:{value:t.selectedRecentSearch,callback:function(e){t.selectedRecentSearch=e},expression:"selectedRecentSearch"}},"v-select",t.$attrs,!1))],1),e("v-col",[e("v-select",t._b({attrs:{items:t.allSavedSearches,clearable:"",solo:"",dense:"",label:"Saved search",disabled:!!t.selectedRecentSearch},model:{value:t.selectedSavedSearch,callback:function(e){t.selectedSavedSearch=e},expression:"selectedSavedSearch"}},"v-select",t.$attrs,!1))],1)],1)],1)},xl=[],Tl={components:{TsTimelineSearch:Po},props:{queryString:{type:String},queryChips:{type:Array},recentSearch:{type:Object},timelineIDs:{type:Array,default:function(){return[]}}},data:function(){return{selectedFilter:"",selectedRecentSearch:null,selectedSavedSearch:null,selectedTimelineIDs:this.timelineIDs,selectedQueryString:this.queryString,selectedQueryChips:this.queryChips}},computed:{settings:function(){return this.$store.state.settings},sketch:function(){return this.$store.state.sketch},allReadyTimelines:function(){var t=this.sketch.timelines.filter(function(t){return"ready"===t.status[0].status});return t.sort(function(t,e){return t.name.localeCompare(e.name)}),t},allRecentSearches:function(){var t=this.$store.state.searchHistory;if(Array.isArray(t)){var e=this.$store.state.searchHistory.map(function(t){return{text:"".concat(t["query_string"]," (").concat(t["query_result_count"],")"),value:t}});return e}return[]},allSavedSearches:function(){var t=this.$store.state.meta.views.map(function(t){return{text:t["name"],value:t}});return t}},watch:{queryString:function(){console.log(this.queryString),this.queryString||(this.selectedRecentSearch=null,this.selectedSavedSearch=null)},selectedSavedSearch:function(){if(this.selectedSavedSearch){this.selectedQueryString=this.selectedSavedSearch.query;var t=JSON.parse(this.selectedSavedSearch.filter),e=t.indices;this.selectedTimelineIDs="_all"===e?this.allReadyTimelines.map(function(t){return t.id}):e,this.selectedQueryChips=t.chips.filter(function(t){return"label"===t.type||"term"===t.type||"datetime_range"===t.type})}else this.selectedQueryString="",this.selectedTimelineIDs=[],this.selectedQueryChips=null},selectedRecentSearch:function(){if(this.selectedRecentSearch){this.selectedQueryString=this.selectedRecentSearch.query_string;var t=JSON.parse(this.selectedRecentSearch.query_filter),e=t.indices;this.selectedTimelineIDs="_all"===e?this.allReadyTimelines.map(function(t){return t.id}):e,this.selectedQueryChips=t.chips.filter(function(t){return"label"===t.type||"term"===t.type||"datetime_range"===t.type})}else this.selectedQueryString="",this.selectedTimelineIDs=[],this.selectedQueryChips=null},selectedTimelineIDs:function(){this.$emit("updateTimelineIDs",this.selectedTimelineIDs)},selectedQueryString:function(){this.$emit("updateQueryString",this.selectedQueryString)},selectedQueryChips:function(){this.$emit("updateQueryChips",this.selectedQueryChips)}}},Cl=Tl,Al=(0,u.A)(Cl,kl,xl,!1,null,null,null),Dl=Al.exports,Ll={components:{TsAggregationConfig:ul,TsChartConfig:wl,TsChartCard:qr,TsAggregationEventSelect:Dl},props:{aggregator:{type:String},bucket:{type:Number},chartTitle:{type:String,default:"New Visualization"},chartType:{type:String,default:"bar"},field:{type:String},height:{type:Number,default:600},interval:{type:Object,default:function(){return{interval:"year",max:10}}},intervalQuantity:{type:Number},metric:{type:String},queryChips:{type:Array},queryString:{type:String,default:"*"},range:{type:Object,default:function(){return{start:"",end:""}}},savedSearch:{type:Boolean,default:!0},searchHistory:{type:Boolean,default:!0},showDataLabels:{type:Boolean,default:!0},showXLabels:{type:Boolean,default:!0},showYLabels:{type:Boolean,default:!0},timelineIDs:{type:Array,default:function(){return[]}},width:{type:Number,default:800},xTitle:{type:String},yTitle:{type:String}},data:function(){return{currentStep:1,responseMeta:null,response:null,selectedAggregator:this.aggregator,selectedChartTitle:this.chartTitle,selectedChartType:this.chartType,selectedMaxItems:10,selectedField:this.field,selectedHeight:this.height,selectedInterval:this.interval,selectedIntervalQuantity:this.intervalQuantity,selectedMetric:this.metric,selectedQueryString:this.queryString,selectedQueryChips:this.queryChips,selectedRange:this.range,selectedSavedSearch:this.savedSearch,selectedSearchHistory:this.searchHistory,selectedShowDataLabels:this.showDataLabels,selectedShowXLabels:this.showXLabels,selectedShowYLabels:this.showYLabels,selectedSplitByTimeline:this.splitByTimeline,selectedTimelineIDs:this.timelineIDs,selectedWidth:this.width,selectedXTitle:this.xTitle,selectedYTitle:this.yTitle,renameVisualDialog:!1,selectedChartTitleDraft:this.selectedChartTitleDraft}},computed:{validAggregation:function(){return this.selectedTimelineIDs.length>0&&this.selectedQueryString},sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},chartSeries:function(){if(null!==this.response&&null!==this.response.buckets)return this.response.buckets},chartLabels:function(){if(null!==this.response&&null!==this.response.labels)return this.response.labels},settings:function(){return this.$store.state.settings}},methods:{rename:function(){this.renameVisualDialog=!1,this.selectedChartTitle=this.selectedChartTitleDraft},loadCurrentSearch:function(){var t=this.$store.state.currentSearchNode;if(t){var e=JSON.parse(t["query_filter"]);this.selectedQueryString=t["query_string"],this.selectedTimelineIDs=e.indices,this.selectedQueryChips=e.chips.filter(function(t){return"label"===t.type||"term"===t.type||"datetime_range"===t.type})}else console.log("no current search...")},loadRecentSearch:function(){if(this.selectedRecentSearch){var t=JSON.parse(this.selectedRecentSearch["query_filter"]);this.selectedQueryString=this.selectedRecentSearch["query_string"],this.selectedTimelineIDs=t.indices,this.selectedQueryChips=t.chips.filter(function(t){return"label"===t.type||"term"===t.type||"datetime_range"===t.type})}else console.log("no search history")},loadSavedSearch:function(){if(this.selectedSavedSearch){this.selectedQueryString=this.selectedSavedSearch.query;var t=JSON.parse(this.selectedSavedSearch.filter);this.selectedTimelineIDs=t.indices,this.selectedQueryChips=t.chips.filter(function(t){return"label"===t.type||"term"===t.type||"datetime_range"===t.type})}else console.log("no saved search")},clear:function(){this.currentStep=1,this.responseMeta=null,this.response=null,this.selectedAggregator=this.aggregator,this.selectedChartTitle=this.chartTitle,this.selectedChartType=this.chartType,this.selectedMaxItems=10,this.selectedField=this.field,this.selectedHeight=this.height,this.selectedInterval=this.interval,this.selectedIntervalQuantity=this.intervalQuantity,this.selectedMetric=this.metric,this.selectedQueryString=this.queryString,this.selectedQueryChips=this.queryChips,this.selectedRange=this.range,this.selectedSavedSearch=this.savedSearch,this.selectedSearchHistory=this.searchHistory,this.selectedShowDataLabels=this.showDataLabels,this.selectedShowXLabels=this.showXLabels,this.selectedShowYLabels=this.showYLabels,this.selectedSplitByTimeline=this.splitByTimeline,this.selectedTimelineIDs=this.timelineIDs,this.selectedWidth=this.width,this.selectedXTitle=this.xTitle,this.selectedYTitle=this.yTitle},saveVisualization:function(){var t=this;if(!this.selectedChartTitle||"New Visualization"===this.selectedChartTitle){var e=prompt("Please enter a name for the visualization:");if(!e)return void this.errorSnackBar("New visualization name is empty.");this.selectedChartTitle=e}null!=this.response&&_.saveAggregation(this.sketch.id,this.responseMeta,this.selectedChartTitle,this.getAggregatorParameters()).then(function(){t.$store.dispatch("updateSavedVisualizationList",t.sketch.id),t.successSnackBar("Visualization added: "+t.selectedChartTitle)}).catch(function(e){t.errorSnackBar("Error adding visualization: "+t.selectedChartTitle)})},getAggregatorParameters:function(){return{aggregator_name:this.selectedAggregator,aggregator_class:"apex",aggregator_parameters:{fields:[this.selectedField],aggregator_options:{query_string:this.selectedQueryString,start_time:this.selectedRange.start,end_time:this.selectedRange.end,query_chips:this.selectedQueryChips,timeline_ids:this.selectedTimelineIDs,metric:this.selectedMetric,max_items:this.selectedMaxItems,calendar_interval:this.selectedInterval.interval},chart_type:this.selectedChartType,chart_options:{chartTitle:this.selectedChartTitle,height:this.selectedHeight,isTimeSeries:this.selectedAggregator.endsWith("date_histogram"),showDataLabels:this.selectedShowDataLabels,showXLabels:this.selectedShowXLabels,showYLabels:this.selectedShowYLabels,width:this.selectedWidth,xTitle:this.selectedXTitle,yTitle:this.selectedYTitle}},include_processing_timelines:!!this.settings.showProcessingTimelineEvents}},loadAggregationData:function(){var t=this,e=this.getAggregatorParameters();_.runAggregator(this.sketch.id,e).then(function(e){t.responseMeta=e.data.meta,t.response=e.data.objects[0][t.selectedAggregator]}).catch(function(t){console.error("Error running aggregator: "+t)})}}},Il=Ll,El=(0,u.A)(Il,Jo,Ko,!1,null,"4143b998",null),Nl=El.exports,zl={props:["aggregationId"],components:{TsVisualizationEditor:Nl,TsSavedVisualization:Gr}},$l=zl,Fl=(0,u.A)($l,Yo,Xo,!1,null,null,null),Rl=Fl.exports,Pl={props:["sketchId","storyId","ruleId","analyzerTimelineId","aggregationId"],components:{Explore:zn,ThreatIntel:jn,Sigma:za,Graph:Wa,Story:ko,Analyze:jo,Visualization:Rl},computed:{currentRouteName:function(){return this.$route.name}}},Ol=Pl,Ql=(0,u.A)(Ol,O,Q,!1,null,null,null),Ml=Ql.exports,ql=function(){var t=this,e=this,i=e._self._c;return i("div",[e.loadingSketch?i("v-progress-linear",{attrs:{indeterminate:"",color:"primary"}}):e._e(),e.sketchAccessDenied&&!e.loadingSketch?i("ts-access-denied"):e._e(),!e.sketch.id||e.loadingSketch||e.sketchAccessDenied?e._e():i("div",{staticStyle:{height:"70vh"}},[e.hasTimelines||e.loadingSketch||e.isArchived||e.sketchAccessDenied?e._e():i("v-container",{attrs:{"fill-height":"",fluid:""}},[i("v-row",{attrs:{align:"center",justify:"center"}},[i("v-sheet",{staticClass:"pa-4",staticStyle:{background:"transparent"}},[i("center",[i("v-img",{attrs:{src:"/dist/empty-state.png","max-height":"100","max-width":"300"}}),i("div",{staticClass:"mb-3 mt-3",staticStyle:{"font-size":"2em"}},[e._v("It's empty around here")]),i("ts-upload-timeline-form-button",{attrs:{"btn-size":"normal","btn-type":"rounded"}})],1)],1)],1)],1),e.isArchived&&!e.loadingSketch?i("v-container",{attrs:{"fill-height":"",fluid:""}},[i("v-row",{attrs:{align:"center",justify:"center"}},[i("v-sheet",{staticClass:"pa-4"},[i("center",[i("v-img",{attrs:{src:"/dist/empty-state.png","max-height":"100","max-width":"300"}}),i("div",{staticClass:"mb-3 mt-3",staticStyle:{"font-size":"2em"}},[e._v("This sketch is archived")]),i("v-btn",{attrs:{rounded:"",depressed:"",color:"primary"},on:{click:function(t){return e.unArchiveSketch()}}},[e._v(" Bring it back ")])],1)],1)],1)],1):e._e(),i("v-dialog",{attrs:{width:"600"},model:{value:e.renameSketchDialog,callback:function(t){e.renameSketchDialog=t},expression:"renameSketchDialog"}},[i("v-card",{staticClass:"pa-4"},[i("ts-rename-sketch",{on:{close:function(t){e.renameSketchDialog=!1}}})],1)],1),i("v-dialog",{attrs:{width:"700px"},model:{value:e.showSettingsDialog,callback:function(t){e.showSettingsDialog=t},expression:"showSettingsDialog"}},[i("ts-settings-dialog")],1),e.loadingSketch?e._e():i("v-app-bar",{style:[e.$vuetify.theme.dark?{"border-bottom":"1px solid hsla(0,0%,100%,.12) !important"}:{"border-bottom":"1px solid rgba(0,0,0,.12) !important"}],attrs:{app:"","clipped-left":"",flat:"",color:e.$vuetify.theme.dark?"#121212":"white"}},[!e.hasTimelines||e.loadingSketch||e.isArchived?e._e():i("v-btn",{attrs:{icon:""},on:{click:function(t){return t.stopPropagation(),e.toggleDrawer()}}},[i("v-icon",{attrs:{title:"Toggle left panel"}},[e._v("mdi-menu")])],1),i("v-avatar",{staticClass:"ml-n2 mt-1"},[i("router-link",{attrs:{to:"/"}},[i("v-img",{attrs:{src:"/dist/timesketch-color.png","max-height":"25","max-width":"25",contain:""}})],1)],1),i("v-hover",{scopedSlots:e._u([{key:"default",fn:function(t){var n=t.hover;return[i("div",{staticClass:"d-flex flex-wrap"},[i("div",{staticClass:"flex-1-0",staticStyle:{"font-size":"1.1em",cursor:"pointer","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","max-width":"900px"},attrs:{title:e.sketch.name},on:{dblclick:function(t){e.renameSketchDialog=!0}}},[e._v(" "+e._s(e.sketch.name)+" ")]),i("div",[n?i("v-icon",{staticClass:"ml-1",attrs:{title:"Rename sketch",small:""},on:{click:function(t){e.renameSketchDialog=!0}}},[e._v("mdi-pencil")]):e._e()],1)])]}}],null,!1,4267224485)}),i("v-spacer"),i("v-dialog",{attrs:{width:"500"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"mr -2",attrs:{small:"",rounded:"",depressed:"",color:"primary"}},"v-btn",s,!1),n),[i("v-icon",{attrs:{small:"",left:""}},[e._v("mdi-account-multiple-plus")]),e._v(" Share ")],1)]}}],null,!1,4220674446),model:{value:e.shareDialog,callback:function(t){e.shareDialog=t},expression:"shareDialog"}},[i("ts-share-card",{on:{"close-dialog":function(t){e.shareDialog=!1}}})],1),i("v-avatar",{staticClass:"ml-2",attrs:{color:"grey lighten-1",size:"25"}},[i("span",{staticClass:"white--text"},[e._v(e._s(e._f("initialLetter")(e.currentUser)))])]),i("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-avatar",[i("v-btn",e._g(e._b({attrs:{small:"",icon:""}},"v-btn",s,!1),n),[i("v-icon",{attrs:{title:"Sketch Options"}},[e._v("mdi-dots-vertical")])],1)],1)]}}],null,!1,2415256737)},[i("v-card",[i("v-list",{attrs:{"two-line":""}},[e.sketch.user?i("v-list-item",[i("v-list-item-content",[i("v-list-item-title",[i("strong",[e._v("Created:")]),e._v(" "+e._s(e._f("shortDateTime")(e.sketch.created_at))+" ")]),i("v-list-item-subtitle",[i("small",[e._v(e._s(e._f("timeSince")(e.sketch.created_at))+" by "+e._s(e.sketch.user.username))])])],1)],1):e._e(),i("v-list-item",[i("v-list-item-content",[i("v-list-item-title",[i("strong",[e._v("Access: ")]),e.meta.permissions&&e.meta.permissions.public?i("span",[e._v("Public")]):i("span",[e._v("Restricted")])]),i("v-list-item-subtitle",[e.meta.permissions&&e.meta.permissions.public?i("small",[e._v("Visible to all users on this server")]):i("small",[e._v("Only people with access can open")])])],1)],1)],1),i("v-list",[i("v-list-item-group",{attrs:{color:"primary"}},[i("v-list-item",{on:{click:e.toggleTheme}},[i("v-list-item-icon",[i("v-icon",[e._v("mdi-brightness-6")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Toggle theme")])],1)],1),i("v-list-item",{on:{click:function(t){e.renameSketchDialog=!0}}},[i("v-list-item-icon",[i("v-icon",[e._v("mdi-pencil")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Rename sketch")])],1)],1),i("v-list-item",{attrs:{disabled:e.isArchived},on:{click:function(t){return e.archiveSketch()}}},[i("v-list-item-icon",[i("v-icon",[e._v("mdi-archive")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Archive sketch")])],1)],1),e.meta.permissions&&e.meta.permissions.delete?i("v-list-item",{on:{click:function(t){return e.deleteSketch()}}},[i("v-list-item-icon",[i("v-icon",[e._v("mdi-trash-can-outline")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Delete sketch")])],1)],1):e._e(),i("v-list-item",{on:{click:e.switchUI}},[i("v-list-item-icon",[i("v-icon",[e._v("mdi-view-dashboard-outline")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Use the old UI")])],1)],1),i("v-list-item",{on:{click:function(t){e.showSettingsDialog=!0}}},[i("v-list-item-icon",[i("v-icon",[e._v("mdi-cog-outline")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Settings")])],1)],1),i("a",{staticStyle:{"text-decoration":"none",color:"inherit"},attrs:{href:"/logout/"}},[i("v-list-item",[i("v-list-item-icon",[i("v-icon",[e._v("mdi-logout")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Logout")])],1)],1)],1)],1)],1)],1)],1)],1),i("v-navigation-drawer",{attrs:{app:"",clipped:"","disable-resize-watcher":"",stateless:"","hide-overlay":"",width:e.navigationDrawer.width},model:{value:e.showLeftPanel,callback:function(t){e.showLeftPanel=t},expression:"showLeftPanel"}},[e.systemSettings.ENABLE_V3_INVESTIGATION_VIEW&&(e.systemSettings.DFIQ_ENABLED||e.systemSettings.LLM_FEATURES_AVAILABLE&&e.systemSettings.LLM_FEATURES_AVAILABLE.log_analyzer)?i("ts-investigation",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}):e._e(),i("ts-search",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),i("ts-timelines-table",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),e.meta.views?i("ts-saved-searches",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}):e._e(),i("ts-data-types",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),i("ts-tags",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),i("ts-graphs",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),i("ts-stories",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),i("ts-search-templates",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),i("ts-sigma-rules",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),i("ts-intelligence",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),i("ts-analyzer-results",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),i("ts-visualizations",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}})],1),e.showRightSidePanel?i("v-navigation-drawer",{staticStyle:{"box-shadow":"0 10px 15px -3px #888"},attrs:{fixed:"",right:"",width:"600"},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("v-toolbar",{attrs:{flat:""}},[i("v-toolbar-title",[e._v("Right Side Panel")]),i("v-spacer"),i("v-btn",{attrs:{icon:""},on:{click:function(t){e.showRightSidePanel=!1}}},[i("v-icon",{attrs:{title:"Close sidepanel"}},[e._v("mdi-close")])],1)],1)]},proxy:!0}],null,!1,3158214288)},[i("v-container",[e._v(" TODO: Add content here ")])],1):e._e(),i("v-main",{staticClass:"notransition"},[e.sketch.status&&e.hasTimelines&&!e.isArchived&&e.systemSettings.DFIQ_ENABLED&&!e.questionCardExclusionRoutes.includes(e.currentRouteName)?i("ts-question-card"):e._e(),e.sketch.status&&e.hasTimelines&&!e.isArchived?i("router-view",{staticClass:"mt-4",on:{setTitle:function(e){return t.title=e}}}):e._e()],1),i("v-bottom-sheet",{attrs:{"hide-overlay":"",persistent:"","no-click-animation":"",scrollable:""},on:{"click:outside":function(t){e.showTimelineView=!1}},model:{value:e.showTimelineView,callback:function(t){e.showTimelineView=t},expression:"showTimelineView"}},[i("v-card",[i("v-toolbar",{attrs:{dense:"",flat:""}},[i("strong",[e._v("Context search")]),i("v-btn-toggle",{staticClass:"ml-10",attrs:{rounded:""},model:{value:e.contextTimeWindowSeconds,callback:function(t){e.contextTimeWindowSeconds=t},expression:"contextTimeWindowSeconds"}},e._l([1,5,10,60,300,600,1800,3600],function(t){return i("v-btn",{key:t,attrs:{value:t,small:"",outlined:""},on:{click:function(i){return e.updateContextQuery(t)}}},[e._v(" "+e._s(e._f("formatSeconds")(t))+" ")])}),1),i("v-btn",{staticClass:"ml-5",attrs:{small:"",text:""},on:{click:function(t){return e.contextToSearch()}}},[e._v("Replace search")]),i("v-spacer"),i("v-btn",{attrs:{icon:"",disabled:e.timelineViewHeight>40},on:{click:function(t){return e.increaseTimelineViewHeight()}}},[i("v-icon",[e._v("mdi-chevron-up")])],1),i("v-btn",{attrs:{icon:"",disabled:0===e.timelineViewHeight},on:{click:function(t){return e.decreaseTimelineViewHeight()}}},[i("v-icon",[e._v("mdi-chevron-down")])],1),i("v-btn",{attrs:{icon:""},on:{click:function(t){e.showTimelineView=!1}}},[i("v-icon",[e._v("mdi-close")])],1)],1),i("v-divider"),i("v-expand-transition",[i("v-card-text",{directives:[{name:"show",rawName:"v-show",value:!e.minimizeTimelineView,expression:"!minimizeTimelineView"}],style:{height:e.timelineViewHeight+"vh"}},[e.showTimelineView?i("ts-event-list",{attrs:{"query-request":e.queryRequest,"highlight-event":e.currentContextEvent}}):e._e()],1)],1)],1)],1)],1)],1)},Bl=[],Vl=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(e){t.$emit("toggleDrawer"),t.expanded=!0}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-content-save-outline")]),e("div",{staticStyle:{height:"1px"}})],1):e("div",[e("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",style:t.meta.views&&t.meta.views.length?"cursor: pointer":"",on:{click:function(e){t.expanded=!t.expanded}}},[e("span",[e("v-icon",{attrs:{left:""}},[t._v("mdi-content-save-outline")]),t._v(" Saved Searches ")],1),e("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[e("small",[e("strong",[t._v(t._s(t.meta.views.length))])])])]),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded&&t.meta.views.length,expression:"expanded && meta.views.length"}]},[e("ts-saved-searches-list")],1)]),e("v-divider")],1)},Hl=[],Gl={props:{iconOnly:Boolean},components:{TsSavedSearchesList:en},data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{}},Ul=Gl,Wl=(0,u.A)(Ul,Vl,Hl,!1,null,null,null),jl=Wl.exports,Yl=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(e){t.$emit("toggleDrawer"),t.expanded=!0}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-database-outline")]),e("div",{staticStyle:{height:"1px"}})],1):e("div",[e("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",style:t.dataTypes&&t.dataTypes.length?"cursor: pointer":"",on:{click:function(e){t.expanded=!t.expanded}}},[e("span",[e("v-icon",{attrs:{left:""}},[t._v("mdi-database-outline")]),t._v(" Data Types ")],1),e("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[t.dataTypes?e("small",[e("strong",[t._v(t._s(t.dataTypes.length))])]):t._e()])]),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded&&t.dataTypes.length,expression:"expanded && dataTypes.length"}]},[e("ts-data-types-list")],1)]),e("v-divider")],1)},Xl=[],Jl={props:{iconOnly:Boolean},components:{TsDataTypesList:Yi},data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},dataTypes:function(){return this.$store.state.dataTypes}},methods:{}},Kl=Jl,Zl=(0,u.A)(Kl,Yl,Xl,!1,null,"7cfc7831",null),tc=Zl.exports,ec=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(e){t.$emit("toggleDrawer"),t.expanded=!0}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-tag-multiple-outline")]),e("div",{staticStyle:{height:"1px"}})],1):e("div",[e("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",style:t.tags&&t.tags.length||t.filteredLabels&&t.filteredLabels.length?"cursor: pointer":"",on:{click:function(e){t.expanded=!t.expanded}}},[e("span",[e("v-icon",{attrs:{left:""}},[t._v("mdi-tag-multiple-outline")]),t._v(" Tags ")],1),e("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[e("small",[t.tags&&t.filteredLabels?e("strong",[t._v(t._s(t.tags.length+t.filteredLabels.length))]):t._e()])])]),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded&&(t.tags.length||t.filteredLabels.length),expression:"expanded && (tags.length || filteredLabels.length)"}]},[e("ts-tags-list")],1)]),e("v-divider")],1)},ic=[],nc={props:{iconOnly:Boolean},components:{TsTagsList:gt},data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},tags:function(){return this.$store.state.tags},filteredLabels:function(){return this.meta.filter_labels?this.meta.filter_labels.filter(function(t){return!t.label.startsWith("__ts_fact")}):[]}}},sc=nc,ac=(0,u.A)(sc,ec,ic,!1,null,null,null),rc=ac.exports,oc=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(e){t.$emit("toggleDrawer"),t.expanded=!0}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-text-box-search-outline")]),e("div",{staticStyle:{height:"1px"}})],1):e("div",[e("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",style:t.searchtemplates&&t.searchtemplates.length?"cursor: pointer":"",on:{click:function(e){t.expanded=!t.expanded}}},[e("span",[e("v-icon",{attrs:{left:""}},[t._v("mdi-text-box-search-outline")]),t._v(" Search Templates ")],1),e("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[e("small",[e("strong",[t._v(t._s(t.searchtemplates.length))])])])]),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded&&t.searchtemplates.length,expression:"expanded && searchtemplates.length"}]},[e("v-data-iterator",{attrs:{items:t.searchtemplates,"items-per-page":t.itemsPerPage,search:t.search},on:{"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e}},scopedSlots:t._u([{key:"header",fn:function(){return[e("v-toolbar",{attrs:{flat:""}},[e("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for a template.."},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]},proxy:!0},{key:"default",fn:function(i){return t._l(i.items,function(t){return e("ts-search-template",{key:t.id,attrs:{searchtemplate:t}})})}}])})],1)]),e("v-divider")],1)},lc=[],cc=function(){var t=this,e=t._self._c;return e("div",[t.parameters.length?e("v-row",{staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer","font-size":"0.9em"},attrs:{"no-gutters":""},on:{click:function(e){t.expanded=!t.expanded}}},[t._v(" "+t._s(t.searchtemplate.name)+" ")]):e("v-row",{staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer","font-size":"0.9em"},attrs:{"no-gutters":""},on:{click:function(e){return t.search(t.searchtemplate.query_string)}}},[t._v(" "+t._s(t.searchtemplate.name)+" ")]),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],staticClass:"px-4"},[t._l(t.parameters,function(i){return e("div",{key:i.name,staticClass:"mt-2"},[e("v-text-field",{attrs:{hint:i.description,label:i.description,outlined:"",dense:"","hide-details":""},model:{value:t.params[i.name],callback:function(e){t.$set(t.params,i.name,e)},expression:"params[parameter.name]"}})],1)}),e("v-card-actions",{staticClass:"pl-0"},[e("v-btn",{attrs:{small:"",depressed:"",color:"primary",disabled:!t.filledOut},on:{click:function(e){return t.parseQueryAndSearch()}}},[t._v(" Search ")])],1)],2)])],1)},uc=[],dc={props:["searchtemplate"],data:function(){return{expanded:!1,params:{}}},computed:{sketch:function(){return this.$store.state.sketch},parameters:function(){return JSON.parse(this.searchtemplate.template_json).parameters},filledOut:function(){return Object.keys(this.params).length===this.parameters.length},searchTemplateSpec:function(){return JSON.parse(this.searchtemplate.template_json)}},methods:{search:function(t){var e={doSearch:!0};e.queryString=t,o.$emit("setQueryAndFilter",e)},parseQueryAndSearch:function(){var t,e=this;_.parseSearchTemplate(this.searchtemplate.id,this.params).then(function(i){t=i.data.objects[0].query_string,e.search(t)}).catch(function(t){})}}},hc=dc,mc=(0,u.A)(hc,cc,uc,!1,null,"2b44f333",null),vc=mc.exports,pc={props:{iconOnly:Boolean},components:{TsSearchTemplate:vc},data:function(){return{searchtemplates:[],expanded:!1,itemsPerPage:10,search:""}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},created:function(){var t=this;_.getSearchTemplates().then(function(e){t.searchtemplates=e.data.objects[0],"undefined"===typeof t.searchtemplates&&(t.searchtemplates=[])}).catch(function(t){})}},fc=pc,gc=(0,u.A)(fc,oc,lc,!1,null,"d76a8c36",null),yc=gc.exports,_c=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(e){t.$emit("toggleDrawer"),t.expanded=!0}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-sigma-lower")]),e("div",{staticStyle:{height:"1px"}})],1):e("div",[e("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",style:t.sigmaRules&&t.sigmaRules.length?"cursor: pointer":"",on:{click:function(e){t.expanded=!t.expanded}}},[e("span",[e("v-icon",{attrs:{left:""}},[t._v("mdi-sigma-lower")]),t._v(" Sigma Rules ")],1),t.expanded||t.sigmaRules&&!t.sigmaRules.length?e("v-btn",{staticClass:"float-right mt-n1 mr-n1",attrs:{icon:"",text:"",to:{name:"SigmaNewRule",params:{sketchId:t.sketch.id}}},on:{click:function(t){t.stopPropagation()}}},[e("v-icon",{attrs:{title:"Add Sigma rules"}},[t._v("mdi-plus")])],1):t._e(),t.expanded?t._e():e("span",{staticClass:"float-right",staticStyle:{"margin-right":"3px"}},[t.isLoading?e("v-progress-circular",{attrs:{size:24,width:1,indeterminate:""}}):t._e()],1),t.expanded?t._e():e("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[t.sigmaRules&&t.sigmaRules.length?e("small",[e("strong",[t._v(t._s(t.ruleCount))])]):t._e()])],1),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},[t.sigmaRules&&t.sigmaRules.length?e("div",[t.ruleCount<=t.itemsPerPage?e("v-data-iterator",{attrs:{items:t.sigmaRules,"hide-default-footer":""},scopedSlots:t._u([{key:"default",fn:function(i){return t._l(i.items,function(t){return e("ts-sigma-rule",{key:t.rule_uuid,attrs:{"sigma-rule":t}})})}}],null,!1,2506010555)}):e("v-data-iterator",{attrs:{items:t.sigmaRules,"items-per-page":t.itemsPerPage,search:t.search},on:{"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e}},scopedSlots:t._u([{key:"header",fn:function(){return[e("v-toolbar",{attrs:{flat:""}},[e("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for a rule.."},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]},proxy:!0},{key:"default",fn:function(i){return t._l(i.items,function(t){return e("ts-sigma-rule",{key:t.rule_uuid,attrs:{"sigma-rule":t}})})}}],null,!1,1881113905)})],1):t._e()])]),e("v-divider")],1)},bc=[],Sc=function(){var t=this,e=t._self._c;return e("div",[e("v-row",{staticClass:"pa-3 pl-1",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer","font-size":"0.9em"},attrs:{"no-gutters":""},on:{click:function(e){return t.getSigmaRuleResource(t.sigmaRule.rule_uuid)}}},[e("v-col",{staticClass:"pl-1",attrs:{cols:"1"}},[t.expanded?e("v-icon",{attrs:{title:"Close details"}},[t._v("mdi-chevron-down")]):e("v-icon",{attrs:{title:"Show details"}},[t._v("mdi-chevron-right")])],1),e("v-col",{attrs:{cols:"10"}},[t._v(" "+t._s(t.sigmaRule.title)+" ")]),e("v-col",{attrs:{cols:"1"}},[e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({attrs:{small:"",icon:""}},"v-btn",s,!1),n),[e("v-icon",{attrs:{title:"Manage Sigma rule",small:""}},[t._v("mdi-dots-vertical")])],1)]}}])},[e("v-card",[e("v-list",{attrs:{dense:""}},[e("v-list-item-group",[e("v-list-item",{attrs:{to:{name:"SigmaEditRule",params:{ruleId:t.sigmaRule.rule_uuid}}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-pencil")])],1),e("v-list-item-title",[t._v("Edit Rule")])],1),e("v-list-item",{on:{click:function(e){return t.downloadSigmaRule(t.sigmaRule.rule_uuid)}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-download")])],1),e("v-list-item-title",[t._v("Download Rule")])],1),e("v-list-item",{on:{click:function(e){return t.deprecateSigmaRule(t.sigmaRule.rule_uuid)}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-flash-off-outline")])],1),e("v-list-item-title",[t._v("Disable from analyzer")])],1),e("v-list-item",{on:{click:function(e){return t.deleteRule(t.sigmaRule.rule_uuid)}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-delete")])],1),e("v-list-item-title",[t._v("Delete Rule")])],1)],1)],1)],1)],1)],1)],1),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],staticClass:"pa-4 pt-0"},[e("div",{staticClass:"mt-2"},[e("v-simple-table",{attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[e("tbody",t._l(t.sigmaRuleSummary,function(i,n){return e("tr",{key:n},[e("td",[e("strong",[t._v(t._s(n))])]),e("td",["references"===n?e("span",t._l(i,function(i){return e("ul",{key:i},[e("li",[e("a",{attrs:{href:i,target:"new"}},[t._v(t._s(i))])])])}),0):"falsepositives"===n?e("span",t._l(i,function(i){return e("ul",{key:i},[e("li",[t._v(t._s(i))])])}),0):"tags"===n&&i?e("span",t._l(i,function(i){return e("v-chip",{key:i,staticClass:"mr-2",attrs:{rounded:"","x-small":""},on:{click:function(e){return t.applyFilterChip(i)}}},[t._v(" "+t._s(i)+" ")])}),1):e("span",[t._v(" "+t._s(i)+" ")])])])}),0)]},proxy:!0}])})],1),e("div",{staticClass:"mt-3"},[void 0!==t.sketch.id?e("v-btn",{attrs:{small:"",depressed:"",color:"primary"},on:{click:function(e){return t.search(t.detailedSigmaRule.search_query)}}},[t._v("Search")]):t._e()],1)])]),e("v-divider")],1)},wc=[],kc=(i(53921),{components:{},props:["sigmaRule"],data:function(){return{expanded:!1,detailedSigmaRule:[]}},computed:{sketch:function(){return this.$store.state.sketch},sigmaRuleSummary:function(){var t=["author","description","references","status","date","modified","falsepositives","level","tags","rule_uuid","search_query"];return Object.fromEntries(Object.entries(this.detailedSigmaRule).filter(function(e){var i=(0,Ne.A)(e,1),n=i[0];return t.includes(n)}))}},methods:{search:function(t){var e={doSearch:!0};e.queryString=t,o.$emit("setQueryAndFilter",e)},deleteRule:function(t){var e=this;confirm("Delete Rule?")&&_.deleteSigmaRule(t).then(function(t){e.$store.dispatch("updateSigmaList"),e.$router.push({name:"Studio",params:{id:"new",type:"sigma"}})}).catch(function(t){console.error(t)})},getSigmaRuleResource:function(t){var e=this;_.getSigmaRuleResource(t).then(function(t){e.detailedSigmaRule=t.data.objects[0],e.expanded=!e.expanded}).catch(function(t){console.error(t)})},deprecateSigmaRule:function(t){var e=this;confirm("Deprecate Rule?")&&_.getSigmaRuleResource(t).then(function(i){var n=i.data.objects[0],s=/status:\s*(experimental|testing|stable)/g,a=n.rule_yaml.replace(s,"status: deprecated");_.updateSigmaRule(t,a).then(function(){e.$store.dispatch("updateSigmaList"),o.$emit("errorSnackBar","Rule deprecated: "+t)}).catch(function(t){console.error(t)})}).catch(function(t){console.error(t)})},downloadSigmaRule:function(t){_.getSigmaRuleResource(t).then(function(t){var e=t.data.objects[0],i=new Blob([e.rule_yaml],{type:"text/plain"}),n=document.createElement("a");n.href=window.URL.createObjectURL(i),n.download=e.title+".yml",n.click()}).catch(function(t){console.error(t)})},applyFilterChip:function(t){var e={doSearch:!0,queryString:"*"},i={field:"tag",value:t,type:"term",operator:"must",active:!0};e.chip=i,o.$emit("setQueryAndFilter",e)}}}),xc=kc,Tc=(0,u.A)(xc,Sc,wc,!1,null,"1c6cc184",null),Cc=Tc.exports,Ac={props:{startExpanded:Boolean,iconOnly:Boolean},components:{TsSigmaRule:Cc},data:function(){return{expanded:this.startExpanded,itemsPerPage:10,search:""}},methods:{},computed:{sigmaRules:function(){return this.$store.state.sigmaRuleList},ruleCount:function(){return this.$store.state.sigmaRuleList?this.$store.state.sigmaRuleList.length:0},sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},isLoading:function(){return!this.sigmaRules}},mounted:function(){this.$store.dispatch("updateSigmaList")}},Dc=Ac,Lc=(0,u.A)(Dc,_c,bc,!1,null,"16a86a92",null),Ic=Lc.exports,Ec=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(e){t.$emit("toggleDrawer"),t.expanded=!0}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-shield-search")]),e("div",{staticStyle:{height:"1px"}})],1):e("div",[e("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",style:t.intelligenceData&&t.intelligenceData.length?"cursor: pointer":"",on:{click:function(e){t.expanded=!t.expanded}}},[e("span",[e("v-icon",{attrs:{left:""}},[t._v("mdi-shield-search")]),t._v(" Threat Intelligence ")],1),t.intelligenceData&&!t.intelligenceData.length?e("v-btn",{staticClass:"float-right mt-n1 mr-n1",attrs:{icon:""},on:{click:function(e){return t.addIndicator()}}},[e("v-icon",{attrs:{title:"Add new indicator"}},[t._v("mdi-plus")])],1):t._e(),t.expanded&&t.intelligenceData&&t.intelligenceData.length?e("v-btn",{staticClass:"float-right mt-n1 mr-n1",attrs:{icon:""},on:{click:[function(e){return t.addIndicator()},function(t){t.stopPropagation()}]}},[e("v-icon",{attrs:{title:"Add new indicator"}},[t._v("mdi-plus")])],1):t._e(),t.expanded&&t.intelligenceData&&t.intelligenceData.length?e("v-btn",{staticClass:"float-right mt-n1",attrs:{icon:"",to:{name:"Intelligence",params:{sketchId:t.sketch.id}}},on:{click:function(t){t.stopPropagation()}}},[e("v-icon",{attrs:{small:"",title:"Manage indicators"}},[t._v("mdi-open-in-new")])],1):t._e(),t.expanded?t._e():e("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[t.intelligenceData&&t.intelligenceData.length?e("small",[e("strong",[t._v(t._s(t.intelligenceData.length))])]):t._e()])],1),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},[t.intelligenceData&&t.intelligenceData.length?e("div",[e("v-divider"),e("v-tabs",{attrs:{grow:""},model:{value:t.tabs,callback:function(e){t.tabs=e},expression:"tabs"}},[e("v-tab",[t._v(" Indicators ("),e("small",[t._v(" "+t._s(t.intelligenceData.length)+" ")]),t._v(") ")]),e("v-tab",[t._v(" Tags ("),e("small",[t._v(t._s(Object.keys(t.tagInfo).length)+" ")]),t._v(") ")])],1),e("v-tabs-items",{model:{value:t.tabs,callback:function(e){t.tabs=e},expression:"tabs"}},[e("v-tab-item",{attrs:{transition:!1}},[t.intelligenceData.length>=10?e("v-data-table",{attrs:{dense:"",headers:t.indicatorHeaders,items:t.intelligenceData,"items-per-page":10},scopedSlots:t._u([{key:"item.ioc",fn:function(i){var n=i.item;return[e("span",{attrs:{title:n.ioc}},[e("div",{staticStyle:{"max-width":"200px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[t._v(" "+t._s(n.ioc)+" ")])])]}},{key:"item.type",fn:function(i){var n=i.item;return[e("small",[t._v(t._s(n.type))])]}},{key:"item.actions",fn:function(i){var n=i.item;return[e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.generateSearchQuery(n.ioc)}}},[e("v-icon",{attrs:{small:"",title:"Search this indicator"}},[t._v("mdi-magnify")])],1)]}}],null,!1,1932107037)}):e("v-data-table",{attrs:{dense:"",headers:t.indicatorHeaders,items:t.intelligenceData,"hide-default-footer":""},scopedSlots:t._u([{key:"item.ioc",fn:function(i){var n=i.item;return[e("span",{attrs:{title:n.ioc}},[e("div",{staticStyle:{"max-width":"200px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[t._v(" "+t._s(n.ioc)+" ")])])]}},{key:"item.type",fn:function(i){var n=i.item;return[e("small",[t._v(t._s(n.type))])]}},{key:"item.actions",fn:function(i){var n=i.item;return[e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.generateSearchQuery(n.ioc)}}},[e("v-icon",{attrs:{small:"",title:"Search this indicator"}},[t._v("mdi-magnify")])],1)]}}],null,!1,1932107037)})],1),e("v-tab-item",{attrs:{transition:!1}},[e("v-data-table",{attrs:{dense:"",headers:t.tagHeaders,items:Object.values(t.tagInfo),"items-per-page":10},scopedSlots:t._u([{key:"item.tag",fn:function(i){var n=i.item;return[e("v-chip",{attrs:{"x-small":""},on:{click:function(e){return t.searchForIOC(n)}}},[t._v(t._s(n.tag.name))])]}},{key:"item.iocs",fn:function(i){var n=i.item;return[e("small",{attrs:{title:n.iocs}},[t._v(t._s(n.iocs.length))])]}},{key:"item.weight",fn:function(i){var n=i.item;return[e("small",[t._v(t._s(n.tag.weight))])]}},{key:"item.actions",fn:function(i){var n=i.item;return[e("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.searchForIOC(n)}}},[e("v-icon",{attrs:{small:"",title:"Search this indicator"}},[t._v("mdi-magnify")])],1)]}}],null,!1,1326170206)})],1)],1)],1):t._e()])]),e("v-divider")],1)},Nc=[],zc=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},$c={props:{iconOnly:Boolean},data:function(){return{expanded:!1,tagInfo:{},tagMetadata:{},tabs:null,indicatorHeaders:[{text:"Indicator",value:"ioc",align:"start"},{text:"Type",value:"type"},{value:"actions"}],tagHeaders:[{text:"Tag",value:"tag",align:"start"},{text:"Indicators",value:"iocs"},{text:"Weight",value:"weight"},{value:"actions"}]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},intelligenceAttribute:function(){return this.meta.attributes&&void 0!==this.meta.attributes.intelligence?this.meta.attributes.intelligence:{ontology:"intelligence",value:{data:[]},name:"intelligence"}},intelligenceData:function(){return this.intelligenceAttribute.value.data}},methods:{loadSketchAttributes:function(){var t=this;_.getTagMetadata().then(function(e){t.tagMetadata=e.data,t.buildTagInfo()})},buildTagInfo:function(){this.tagInfo={};var t,e=(0,Le.A)(this.intelligenceData);try{for(e.s();!(t=e.n()).done;){var i,n=t.value,s=(0,Le.A)(n.tags);try{for(s.s();!(i=s.n()).done;){var a=i.value,r=null;r="object"===(0,U.A)(a)?a.name:a,this.tagInfo[r]||(this.tagInfo[r]={count:0,iocs:[],tag:this.enrichTag(a)}),this.tagInfo[r].count++,this.tagInfo[r].iocs.push(n.ioc)}}catch(o){s.e(o)}finally{s.f()}}}catch(o){e.e(o)}finally{e.f()}},enrichTag:function(t){if("object"===(0,U.A)(t))return t;var e={name:t};if(this.tagMetadata[t])return Lt().extend(e,this.tagMetadata[t]);for(var i in this.tagMetadata["regexes"])if(t.match(i))return Lt().extend(e,this.tagMetadata["regexes"][i]);return Lt().extend(e,this.tagMetadata.default)},generateSearchQuery:function(t,e){var i='"'.concat(t,'"');i=i.replace(/[\\\s]/g,"\\$&"),void 0!==e&&(i="".concat(e,":").concat(i));var n={doSearch:!0};n.queryString=i,n.queryFilter=zc(),o.$emit("setQueryAndFilter",n)},searchForIOC:function(t){var e=t.iocs.map(function(t){return'"'.concat(t,'"')}).reduce(function(t,e){return"".concat(t," OR ").concat(e)}),i={doSearch:!0};i.queryString=e,i.queryFilter=zc(),o.$emit("setQueryAndFilter",i)},addIndicator:function(){o.$emit("addIndicator")}},mounted:function(){this.loadSketchAttributes()}},Fc=$c,Rc=(0,u.A)(Fc,Ec,Nc,!1,null,null,null),Pc=Rc.exports,Oc=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(e){t.$emit("toggleDrawer"),t.expanded=!0}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-source-branch")]),e("div",{staticStyle:{height:"1px"}})],1):e("div",[e("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer"},on:{click:function(e){t.expanded=!t.expanded}}},[e("span",[e("v-icon",{attrs:{left:""}},[t._v("mdi-source-branch")]),t._v(" Graphs ")],1),e("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[e("small",[e("strong",[t._v(t._s(t.graphs.length+t.savedGraphs.length))])])])]),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.savedGraphs.length,expression:"savedGraphs.length"}]},[e("v-subheader",[t._v("Saved Graphs")]),t._l(t.savedGraphs,function(i){return e("router-link",{key:i.id,staticStyle:{cursor:"pointer","font-size":"0.9em","text-decoration":"none"},attrs:{to:{name:"Graph",query:{graph:i.id}}}},[e("v-row",{staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""},on:{click:function(e){return t.setSavedGraph(i.id)}}},[e("span",{class:t.$vuetify.theme.dark?"dark-font":"light-font"},[t._v(t._s(i.name))])])],1)})],2),e("div",{directives:[{name:"show",rawName:"v-show",value:t.graphs.length,expression:"graphs.length"}]},[e("v-subheader",[t._v("Plugins")]),t._l(t.graphs,function(i){return e("router-link",{key:i.name,staticStyle:{cursor:"pointer","font-size":"0.9em","text-decoration":"none"},attrs:{to:{name:"Graph",query:{plugin:i.name}}}},[e("v-row",{staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""},on:{click:function(e){return t.setGraphPlugin(i.name)}}},[e("span",{class:t.$vuetify.theme.dark?"dark-font":"light-font"},[t._v(t._s(i.display_name))])])],1)})],2)])]),e("v-divider")],1)},Qc=[],Mc={props:{iconOnly:Boolean},data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},graphs:function(){return this.$store.state.graphPlugins},savedGraphs:function(){return this.$store.state.savedGraphs}},methods:{setGraphPlugin:function(t){o.$emit("setGraphPlugin",t)},setSavedGraph:function(t){o.$emit("setSavedGraph",t)}}},qc=Mc,Bc=(0,u.A)(qc,Oc,Qc,!1,null,null,null),Vc=Bc.exports,Hc=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(e){t.$emit("toggleDrawer"),t.expanded=!0}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-book-open-outline")]),e("div",{staticStyle:{height:"1px"}})],1):e("div",[e("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",style:t.filteredStories&&t.filteredStories.length?"cursor: pointer":"",attrs:{"no-gutters":"",flat:""},on:{click:function(e){t.expanded=!t.expanded}}},[e("span",[e("v-icon",{attrs:{left:""}},[t._v("mdi-book-open-outline")]),t._v(" Stories ")],1),!t.expanded&&t.filteredStories&&t.filteredStories.length?t._e():e("v-btn",{staticClass:"float-right mt-n1 mr-n1",attrs:{icon:"",text:""},on:{click:[function(e){return t.createStory()},function(t){t.stopPropagation()}]}},[e("v-icon",{attrs:{title:"Create New Story"}},[t._v("mdi-plus")])],1),!t.expanded&&t.filteredStories&&t.filteredStories.length?e("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[t.filteredStories?e("small",[e("strong",[t._v(t._s(t.filteredStories.length))])]):t._e()]):t._e()],1),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded&&t.filteredStories.length,expression:"expanded && filteredStories.length"}]},t._l(t.filteredStories,function(i){return e("router-link",{key:i.id,staticStyle:{cursor:"pointer","font-size":"0.9em","text-decoration":"none"},attrs:{to:{name:"Story",params:{storyId:i.id}}}},[e("v-row",{staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[e("span",{class:t.$vuetify.theme.dark?"dark-font":"light-font"},[t._v(t._s(i.title))])])],1)}),1)]),e("v-divider")],1)},Gc=[],Uc={props:{iconOnly:Boolean},data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},filteredStories:function(){return this.meta.stories?this.meta.stories.filter(function(t){return!t.title.startsWith("__ts_")}):[]}},methods:{createStory:function(){var t=this,e="Untitled story",i="";_.createStory(e,i,this.sketch.id).then(function(e){var i=e.data.objects[0].id;t.$router.push({name:"Story",params:{storyId:i}}),t.$store.dispatch("updateSketch",t.sketch.id)}).catch(function(t){})}}},Wc=Uc,jc=(0,u.A)(Wc,Hc,Gc,!1,null,null,null),Yc=jc.exports,Xc=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.$emit("toggleDrawer")}}},[e("router-link",{attrs:{to:{name:"Explore",params:{sketchId:t.sketch.id}}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-magnify")]),e("div",{staticStyle:{height:"1px"}})],1)],1):e("div",[e("router-link",{staticClass:"pa-4",class:t.$vuetify.theme.dark?t.isExploreRoute?"dark-highlight":"dark-hover":t.isExploreRoute?"light-highlight":"light-hover",staticStyle:{cursor:"pointer"},attrs:{to:{name:"Explore",params:{sketchId:t.sketch.id}},custom:""},scopedSlots:t._u([{key:"default",fn:function(i){var n=i.navigate;return[e("div",{attrs:{role:"link"},on:{click:n,keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:n.apply(null,arguments)}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-magnify")]),t._v("Search")],1)]}}])}),e("v-divider")],1)},Jc=[],Kc={props:{iconOnly:Boolean},computed:{sketch:function(){return this.$store.state.sketch},isExploreRoute:function(){return"Explore"===this.$route.name},sketchId:function(){return this.$store.state.sketch.id}}},Zc=Kc,tu=(0,u.A)(Zc,Xc,Jc,!1,null,null,null),eu=tu.exports,iu=function(){var t=this,e=t._self._c;return e("v-card",{attrs:{loading:t.isLoading}},[e("div",{staticClass:"pa-4"},[e("h3",[t._v('Share "'+t._s(t.sketch.name)+'"')]),e("br"),e("v-autocomplete",{attrs:{items:t.usersAndGroups,outlined:"","single-line":"",chips:"","small-chips":"","hide-details":"",multiple:"","return-object":"","deletable-chips":"",label:"Add people and groups"},scopedSlots:t._u([{key:"item",fn:function(i){var n=i.item,s=i.on,a=i.attrs;return[e("v-list-item",t._g(t._b({},"v-list-item",a,!1),s),[e("v-list-item-icon",{staticClass:"mr-3"},[e("v-icon",[t._v(t._s("user"===n.type?"mdi-account":"mdi-account-group-outline"))])],1),e("v-list-item-content",[e("v-list-item-title",{domProps:{textContent:t._s(n.text)}})],1)],1)]}}]),model:{value:t.usersAndGroupsToAdd,callback:function(e){t.usersAndGroupsToAdd=e},expression:"usersAndGroupsToAdd"}}),e("br"),t._v(" People with access "),e("v-list",[e("v-list-item",[e("v-list-item-avatar",[e("v-avatar",{attrs:{color:"grey lighten-1",size:"32"}},[e("span",{staticClass:"white--text"},[t._v(t._s(t._f("initialLetter")(t.sketch.user.username)))])])],1),e("v-list-item-content",[e("v-list-item-title",{domProps:{textContent:t._s(t.sketch.user.username)}})],1),e("v-spacer"),e("small",[t._v("Owner")])],1),t._l(t.meta.collaborators.users,function(i){return e("v-list-item",{key:i},[e("v-list-item-avatar",[e("v-avatar",{attrs:{color:"grey lighten-1",size:"32"}},[e("span",{staticClass:"white--text"},[t._v(t._s(t._f("initialLetter")(i)))])])],1),e("v-list-item-content",[e("v-list-item-title",{domProps:{textContent:t._s(i)}})],1),e("v-spacer"),e("v-icon",{on:{click:function(e){return t.revokeAccess(i,"")}}},[t._v("mdi-trash-can-outline")])],1)}),t._l(t.meta.collaborators.groups,function(i){return e("v-list-item",{key:i},[e("v-list-item-avatar",[e("v-icon",[t._v("mdi-account-group-outline")])],1),e("v-list-item-content",[e("v-list-item-title",{domProps:{textContent:t._s(i)}})],1),e("v-spacer"),e("v-icon",{on:{click:function(e){return t.revokeAccess("",i)}}},[t._v("mdi-trash-can-outline")])],1)})],2),e("br"),t._v(" General access "),e("v-select",{staticStyle:{width:"150px"},attrs:{"hide-details":"","single-line":"",items:t.items,label:t.generalAccess,"prepend-icon":t.accessIcon},on:{change:function(e){return t.setPublicAccess()}},model:{value:t.isPublic,callback:function(e){t.isPublic=e},expression:"isPublic"}}),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){return t.$emit("close-dialog")}}},[t._v("Cancel")]),e("v-btn",{attrs:{color:"primary",depressed:""},on:{click:function(e){return t.grantAccess()}}},[t._v("Done")])],1)],1)])},nu=[],su={data:function(){return{items:[{text:"Public",value:!0},{text:"Restricted",value:!1}],usersAndGroupsToAdd:[],usersToRemove:[],groupsToRemove:[],systemUsers:[],systemGroups:[],isPublic:!1,isLoading:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},generalAccess:function(){return this.isPublic?"Public":"Restricted"},accessIcon:function(){return this.isPublic?"mdi-earth":"mdi-lock-outline"},usersAndGroups:function(){return this.systemUsers.concat(this.systemGroups)}},methods:{grantAccess:function(){var t=this;if(this.usersAndGroupsToAdd.length){this.isLoading=!0;var e=this.usersAndGroupsToAdd.filter(function(t){return"user"===t.type}).map(function(t){return t.value}),i=this.usersAndGroupsToAdd.filter(function(t){return"group"===t.type}).map(function(t){return t.value});_.grantSketchAccess(this.sketch.id,e,i).then(function(e){t.$store.dispatch("updateSketch",t.sketch.id).then(function(){t.isLoading=!1,t.usersAndGroupsToAdd=[],t.$emit("close-dialog"),t.successSnackBar("Updated sharing")})}).catch(function(e){t.errorSnackBar("Failed to share sketch "+e)})}else this.$emit("close-dialog")},revokeAccess:function(t,e){var i=this;this.isLoading=!0;var n=[t],s=[e];_.revokeSketchAccess(this.sketch.id,n,s).then(function(t){i.$store.dispatch("updateSketch",i.sketch.id).then(function(){i.isLoading=!1})}).catch(function(t){i.errorSnackBar("Failed to remove access "+t)})},setPublicAccess:function(){var t=this;this.isLoading=!0,_.setSketchPublicAccess(this.sketch.id,this.isPublic).then(function(e){t.$store.dispatch("updateSketch",t.sketch.id).then(function(){t.isLoading=!1})}).catch(function(e){t.errorSnackBar("Failed to share sketch "+e)})}},mounted:function(){var t=this;this.isPublic=this.meta.permissions.public,_.getUsers().then(function(e){e.data.objects[0].forEach(function(e){var i={text:e.username,value:e.username,type:"user",disabled:!1};t.systemUsers.push(i)})}).catch(function(t){}),_.getGroups().then(function(e){e.data.objects[0].forEach(function(e){var i={text:e.name,value:e.name,type:"group",disabled:!1};t.systemGroups.push(i)})}).catch(function(t){})}},au=su,ru=(0,u.A)(au,iu,nu,!1,null,null,null),ou=ru.exports,lu=function(){var t=this,e=t._self._c;return e("div",[e("h3",[t._v("Rename sketch")]),e("br"),e("v-form",{on:{submit:function(e){return e.preventDefault(),t.renameSketch()}}},[e("v-text-field",{attrs:{outlined:"",dense:"",autofocus:"",clearable:"",rules:t.sketchNameRules},on:{focus:function(t){return t.target.select()}},model:{value:t.newSketchName,callback:function(e){t.newSketchName=e},expression:"newSketchName"}}),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{text:""},on:{click:function(e){return t.closeDialog()}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{disabled:!t.newSketchName||t.newSketchName.length>255,text:"",color:"primary"},on:{click:function(e){return t.renameSketch()}}},[t._v(" Save ")])],1)],1)],1)},cu=[],uu={data:function(){return{newSketchName:"",sketchNameRules:[function(t){return!!t||"Sketch name is required."},function(t){return t&&t.length<=255||"Sketch name is too long."}]}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{renameSketch:function(){var t=this;_.saveSketchSummary(this.sketch.id,this.newSketchName,"").then(function(e){t.$store.dispatch("updateSketch",t.sketch.id).then(function(){})}).catch(function(t){console.error(t)}),this.$emit("close")},closeDialog:function(){this.newSketchName=this.sketch.name,this.$emit("close")}},created:function(){this.newSketchName=this.sketch.name}},du=uu,hu=(0,u.A)(du,lu,cu,!1,null,"6bdfe814",null),mu=hu.exports,vu=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(e){t.$emit("toggleDrawer"),t.expanded=!0}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-auto-fix")]),e("div",{staticStyle:{height:"1px"}})],1):e("div",[e("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",style:t.sortedAnalyzerResults.length?"cursor: pointer":"",on:{click:function(e){t.expanded=!t.expanded}}},[e("span",[e("v-icon",{attrs:{left:""}},[t._v("mdi-auto-fix")]),t._v(" Analyzer Results ")],1),t.expanded||t.sortedAnalyzerResults&&!t.sortedAnalyzerResults.length&&t.analyzerResultsReady?e("v-btn",{staticClass:"float-right mt-n1 mr-n1",attrs:{icon:"",text:"",to:{name:"Analyze",params:{sketchId:t.sketch.id,analyzerTimelineId:void 0}}},on:{click:function(t){t.stopPropagation()}}},[e("v-icon",{attrs:{title:"Select analyzers for execution"}},[t._v("mdi-plus")])],1):t._e(),e("span",{staticClass:"float-right",staticStyle:{"margin-right":"3px"}},[!t.analyzerResultsReady||t.activeAnalyzerSessionIds.length>0&&!t.activeAnalyzerTimeoutTriggered?e("v-progress-circular",{attrs:{size:24,width:1,indeterminate:"",value:t.activeAnalyzerDisplayCount}},[t._v(t._s(t.activeAnalyzerDisplayCount))]):t._e(),t.activeAnalyzerTimeoutTriggered?e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on;return[e("v-btn",t._g({attrs:{small:"",icon:""},on:{click:[function(t){t.stopPropagation()},function(e){return t.startPolling()}]}},n),[e("v-icon",{attrs:{small:""}},[t._v("mdi-reload-alert")])],1)]}}],null,!1,2751229302)},[e("span",[t._v("Analyzer status check timeout, click to reload")])]):t._e()],1),e("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[!t.expanded&&t.sortedAnalyzerResults&&t.sortedAnalyzerResults.length&&t.analyzerResultsReady?e("small",{staticClass:"ml-3"},[e("strong",[t._v(t._s(t.resultCounter))])]):t._e()])],1),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},[t.sortedAnalyzerResults.length>0?e("div",[t.sortedAnalyzerResults.length<=10?e("v-data-iterator",{attrs:{items:t.sortedAnalyzerResults,"hide-default-footer":"","disable-pagination":""},scopedSlots:t._u([{key:"default",fn:function(i){return t._l(i.items,function(i){return e("ts-analyzer-result",{key:i.analyzerName,attrs:{analyzer:i,isActive:t.activeAnalyzers.has(i.analyzerName)}})})}}],null,!1,3139649614)}):e("v-data-iterator",{attrs:{items:t.sortedAnalyzerResults,"hide-default-footer":"","disable-pagination":"",search:t.search,"custom-filter":t.filterAnalyzers},scopedSlots:t._u([{key:"header",fn:function(){return[e("v-toolbar",{attrs:{flat:"",height:"45"}},[e("v-text-field",{attrs:{"prepend-inner-icon":"mdi-filter-variant",clearable:"","hide-details":"",outlined:"",dense:"",label:"Filter analyzers"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]},proxy:!0},{key:"default",fn:function(i){return t._l(i.items,function(i){return e("ts-analyzer-result",{key:i.analyzerName,attrs:{analyzer:i,isActive:t.activeAnalyzers.has(i.analyzerName)}})})}}],null,!1,3674083930)})],1):t._e()])]),e("v-divider")],1)},pu=[],fu=function(){var t=this,e=t._self._c;return e("div",[e("v-row",{staticClass:"pa-3 pl-1",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer"},attrs:{"no-gutters":""},on:{click:function(e){t.expanded=!t.expanded}}},[e("v-col",{staticClass:"pl-1",attrs:{cols:"1"}},[t.expanded?e("v-icon",{attrs:{title:"Close results"}},[t._v("mdi-chevron-down")]):e("v-icon",{attrs:{title:"Open results"}},[t._v("mdi-chevron-right")])],1),e("v-col",{attrs:{cols:"10"}},[e("span",{staticStyle:{"font-size":"0.9em"}},[t._v(" "+t._s(t.analyzer.data.analyzerInfo.display_name)+" ")])]),e("v-col",{attrs:{cols:"1"}},[t.isActive?e("div",{staticClass:"ml-1"},[e("v-progress-circular",{attrs:{size:20,width:1,indeterminate:""}},[e("small",[t._v(t._s(Object.keys(t.analyzer.data.timelines).length))])])],1):e("div",{staticClass:"ml-3"},[e("small",[t._v(t._s(Object.keys(t.analyzer.data.timelines).length))])])])],1),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},t._l(t.analyzer.data.timelines,function(i){return e("span",{key:i.id,staticStyle:{"font-size":"0.9em"}},[e("ts-analyzer-result-timeline",{attrs:{timeline:i,isMultiAnalyzer:t.analyzer.data.analyzerInfo.is_multi}})],1)}),0)]),e("v-divider")],1)},gu=[],yu=function(){var t=this,e=t._self._c;return e("div",{class:t.getHoverTheme},[e("v-divider"),"PENDING"===t.timeline.analysis_status||"STARTED"===t.timeline.analysis_status?e("div",{staticClass:"pa-2 pl-3",class:t.getHoverTheme,staticStyle:{display:"flex","align-items":"center"}},[e("v-icon",{staticClass:"mr-2",attrs:{title:"Toggle results for this timeline",color:"#"+t.timeline.color}},[t._v("mdi-circle")]),e("span",{staticClass:"mr-2 timeline-name-ellipsis",staticStyle:{color:"grey",width:"82% !important"}},[t._v(t._s(t.timeline.name))]),e("v-progress-circular",{attrs:{size:20,width:1,indeterminate:"",color:"primary"}})],1):e("div",{staticClass:"pa-2 pl-3",class:t.getHoverTheme,staticStyle:{cursor:"pointer",display:"flex","align-items":"center"},on:{click:function(e){t.expanded=!t.expanded}}},[e("v-icon",{staticClass:"mr-2",attrs:{title:"Toggle results for this timeline",color:"#"+t.timeline.color}},[t._v("mdi-circle")]),e("span",{staticClass:"timeline-name-ellipsis",staticStyle:{width:"82% !important"}},[t._v(t._s(t.timeline.name))]),"ERROR"===t.timeline.analysis_status?e("div",[e("v-btn",t._g({staticClass:"ml-1",staticStyle:{cursor:"default"},attrs:{text:"","x-small":"",icon:"",ripple:!1}},t.on),[e("v-icon",{staticClass:"ml-1",attrs:{title:"The analyzer ran into an error",small:""}},[t._v("mdi-alert")])],1)],1):t.checkAnalyzerOutput&&!t.isMultiAnalyzer?e("div",[e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on;return[e("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:!t.isMultiAnalyzer,expression:"!isMultiAnalyzer"}],staticClass:"ml-1",staticStyle:{cursor:"default"},attrs:{text:"","x-small":"",icon:"",ripple:!1}},n),[e("v-icon",{attrs:{small:"",color:t.getPriorityColor}},[t._v("mdi-information-outline")])],1)]}}])},[e("span",[t._v("Result Priority: "+t._s(t.resultPriority))])])],1):e("div",[t.isMultiAnalyzer?t._e():e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on;return[e("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:!t.isMultiAnalyzer,expression:"!isMultiAnalyzer"}],staticClass:"ml-1",staticStyle:{cursor:"default"},attrs:{text:"","x-small":"",icon:"",ripple:!1}},n),[e("v-icon",{attrs:{small:"",color:t.getPriorityColor}},[t._v("mdi-information-outline")])],1)]}}],null,!1,3109249993)},[e("span",[t._v("Result Priority: Note")])])],1)],1),e("v-expand-transition",[t.isMultiAnalyzer?e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],class:t.getHoverTheme},[e("v-simple-table",{staticClass:"ml-2 borderless",attrs:{dense:""}},[e("tbody",{class:t.getHoverTheme},[e("tr",[e("td",[e("strong",[t._v("Type:")])]),e("td",[e("span",[t._v(" Multi analyzer")])])]),e("tr",[e("td",[e("strong",[t._v("Last run:")])]),e("td",[e("span",[t._v(" "+t._s(t.timelineCreated)+" UTC ")])])]),e("tr",[e("td",{staticStyle:{border:"none"},attrs:{width:"80"}},[e("strong",[t._v("Status:")])]),e("td",[e("span",[t._v(" "+t._s(t.timeline.analysis_status)+" ")])])]),0!==t.timeline.results.length?e("tr",[e("td",{staticStyle:{border:"none"},attrs:{colspan:"2"}},[e("strong",[t._v("Results:")])])]):t._e()])]),e("v-data-iterator",{attrs:{items:t.timeline.results,"items-per-page":10,"hide-default-footer":t.timeline.results.length<10},scopedSlots:t._u([{key:"default",fn:function(i){return t._l(i.items,function(i,n){return e("div",{key:n},[e("v-divider"),e("v-row",{staticClass:"pa-1 pl-5",attrs:{"no-gutters":""}},[e("span",[t._v(t._s(i.verdict))])])],1)})}}])})],1):e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],class:t.getHoverTheme},[t.checkAnalyzerOutput?e("v-simple-table",{staticClass:"ml-2 borderless",attrs:{dense:""}},[e("tbody",{class:t.getHoverTheme},[e("tr",{staticClass:"pr-3"},[e("td",{attrs:{width:"105"}},[e("strong",[t._v("Summary:")])]),e("td",[e("span",[t._v(" "+t._s(t.resultSummary||"loading...")+" ")])])]),e("tr",[e("td",[e("strong",[t._v("Priority:")])]),e("td",[e("span",[t._v(" "+t._s(t.resultPriority||"loading...")+" ")])])]),void 0!==t.references?e("tr",[e("td",{staticStyle:{border:"none"},attrs:{colspan:"2"}},[e("strong",[t._v("References:")]),e("ul",t._l(t.references,function(i,n){return e("li",{key:n},[e("a",{on:{click:function(e){return t.contextLinkRedirect(i)}}},[t._v(t._s(i))]),e("v-dialog",{attrs:{"max-width":"515","retain-focus":!1},model:{value:t.redirectWarnDialog,callback:function(e){t.redirectWarnDialog=e},expression:"redirectWarnDialog"}},[e("ts-link-redirect-warning",{attrs:{app:"","context-url":t.contextUrl},on:{cancel:function(e){t.redirectWarnDialog=!1}}})],1)],1)}),0)])]):t._e(),e("tr",[e("td",[e("strong",[t._v("Last run:")])]),e("td",[e("span",[t._v(" "+t._s(t.timelineCreated)+" UTC ")])])]),e("tr",[e("td",{staticStyle:{border:"none"},attrs:{width:"80"}},[e("strong",[t._v("Status:")])]),e("td",[e("span",[t._v(" "+t._s(t.resultStatus||"loading...")+" ")])])]),0!==Object.keys(t.getAnalyzerOutputMetaData).length?e("tr",[e("td",{staticStyle:{border:"none"},attrs:{colspan:"2"}},[e("strong",[t._v("Result artifacts")])])]):t._e(),t._l(t.getAnalyzerOutputMetaData,function(i,n){return e("tr",{key:n},[e("td",[e("strong",[t._v(t._s(n)+":")])]),"Searches"===n?e("td",{staticStyle:{border:"none"}},t._l(i,function(i,n){return e("v-chip",{key:n,staticClass:"mr-1",attrs:{outlined:"",small:""},on:{click:function(e){return t.setView(i)}}},[t._v(" "+t._s(i.name)+" ")])}),1):t._e(),"Story"===n?e("td",{staticStyle:{border:"none"}},t._l(i,function(i){return e("router-link",{key:i.id,attrs:{to:{name:"Story",params:{storyId:i.id}}}},[e("v-chip",{staticClass:"mr-1",attrs:{outlined:"",small:"",link:""}},[t._v(t._s(i.title))])],1)}),1):t._e(),"Graphs"===n?e("td",{staticStyle:{border:"none"}},t._l(i,function(i,n){return e("router-link",{key:n,attrs:{to:{name:"Graph",params:{graph:void 0===i.id?i.name:i.id}}}},[e("v-chip",{staticClass:"mr-1",attrs:{outlined:"",small:"",link:""},on:{click:function(e){void 0===i.id?t.setGraphPlugin(i.name):t.setSavedGraph(i.id)}}},[t._v(" "+t._s(void 0===i.id?i.display_name:i.name)+" ")])],1)}),1):t._e(),"Aggregations"===n?e("td",{staticStyle:{border:"none"}},[e("span",[t._v("Linking aggregations is not supported in the new UI yet.")])]):t._e(),"Tags"===n?e("td",{staticStyle:{border:"none"}},t._l(i,function(i,n){return e("v-chip",{key:n,staticClass:"mr-1 mb-1",attrs:{color:"lightgrey",small:""},on:{click:function(e){return t.applyFilterChip(i,"tag","term",t.timeline.id)}}},[t._v(" "+t._s(i)+" ")])}),1):t._e(),"Attributes"===n?e("td",{staticStyle:{border:"none"}},t._l(i,function(i,n){return e("v-chip",{key:n,staticClass:"mr-1 mb-1",attrs:{color:"lightgrey",small:""},on:{click:function(e){return t.applySearch("_exists_:".concat(i),t.timeline.id)}}},[t._v(" "+t._s(i)+" ")])}),1):t._e()])})],2)]):e("v-simple-table",{staticClass:"ml-2 borderless",attrs:{dense:""}},[e("tbody",{class:t.getHoverTheme},[e("tr",{staticClass:"pr-3"},[e("td",{staticStyle:{border:"none"},attrs:{width:"80"}},["ERROR"===t.timeline.analysis_status?e("strong",[t._v("Error:")]):e("strong",[t._v("Summary:")])]),e("td",[e("span",[t._v(" "+t._s(t.timelineResult.verdict)+" ")])])]),e("tr",[e("td",[e("strong",[t._v("Last run:")])]),e("td",[e("span",[t._v(" "+t._s(t.timelineCreated)+" UTC ")])])]),e("tr",[e("td",{staticStyle:{border:"none"},attrs:{width:"80"}},[e("strong",[t._v("Status:")])]),e("td",[e("span",[t._v(" "+t._s(t.timeline.analysis_status)+" ")])])])])])],1)])],1)},_u=[],bu={props:["timeline","isMultiAnalyzer"],components:{TsLinkRedirectWarning:Ye},data:function(){return{expanded:!1,redirectWarnDialog:!1,contextUrl:""}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},graphs:function(){return this.$store.state.graphPlugins},savedGraphs:function(){return this.$store.state.savedGraphs},verboseAnalyzerOutput:function(){if(this.checkAnalyzerOutput){var t=JSON.parse(this.timelineResult.verdict);return null==t?void 0:t}},resultSummary:function(){return this.verboseAnalyzerOutput&&this.verboseAnalyzerOutput.result_summary},resultPriority:function(){return this.verboseAnalyzerOutput&&this.verboseAnalyzerOutput.result_priority},references:function(){return this.verboseAnalyzerOutput&&this.verboseAnalyzerOutput.references},resultStatus:function(){return this.verboseAnalyzerOutput&&this.verboseAnalyzerOutput.result_status},getAnalyzerOutputMetaData:function(){var t=this,e={};if(void 0!==this.verboseAnalyzerOutput&&void 0!==this.verboseAnalyzerOutput.platform_meta_data){if(void 0!==this.verboseAnalyzerOutput.platform_meta_data.saved_views){e["Searches"]=[];var i,n=(0,Le.A)(this.verboseAnalyzerOutput.platform_meta_data.saved_views);try{var s=function(){var n=i.value,s=t.meta.views.find(function(t){return t.id===n});void 0!==s&&e["Searches"].push(s)};for(n.s();!(i=n.n()).done;)s()}catch(d){n.e(d)}finally{n.f()}}if(void 0!==this.verboseAnalyzerOutput.platform_meta_data.saved_stories){e["Story"]=[];var a,r=(0,Le.A)(this.verboseAnalyzerOutput.platform_meta_data.saved_stories);try{var o=function(){var i=a.value,n=t.meta.stories.find(function(t){return t.id===i});void 0!==n&&e["Story"].push(n)};for(r.s();!(a=r.n()).done;)o()}catch(d){r.e(d)}finally{r.f()}}if(void 0!==this.verboseAnalyzerOutput.platform_meta_data.saved_graphs){e["Graphs"]=[];var l,c=(0,Le.A)(this.verboseAnalyzerOutput.platform_meta_data.saved_graphs);try{var u=function(){var i=l.value;if("number"===typeof i){var n=t.savedGraphs.find(function(t){return t.id===i});void 0!==n&&e["Graphs"].push(n)}else if("string"===typeof i){var s=t.graphs.find(function(t){return t.name===i});void 0!==s&&e["Graphs"].push(s)}else console.error("Saved Graph reference is neither Integer nor String.",(0,U.A)(i),i)};for(c.s();!(l=c.n()).done;)u()}catch(d){c.e(d)}finally{c.f()}}return void 0!==this.verboseAnalyzerOutput.platform_meta_data.saved_aggregations&&(e["Aggregations"]=this.verboseAnalyzerOutput.platform_meta_data.saved_aggregations),void 0!==this.verboseAnalyzerOutput.platform_meta_data.created_tags&&(e["Tags"]=this.verboseAnalyzerOutput.platform_meta_data.created_tags),void 0!==this.verboseAnalyzerOutput.platform_meta_data.created_attributes&&(e["Attributes"]=this.verboseAnalyzerOutput.platform_meta_data.created_attributes),e}return e},getPriorityColor:function(){if(void 0!==this.verboseAnalyzerOutput&&void 0!==this.verboseAnalyzerOutput.result_priority){if("HIGH"===this.verboseAnalyzerOutput.result_priority)return"#DD2003";if("MEDIUM"===this.verboseAnalyzerOutput.result_priority)return"#F89412";if("LOW"===this.verboseAnalyzerOutput.result_priority)return"#0E72ED";if("NOTE"===this.verboseAnalyzerOutput.result_priority)return"#7F7C7C"}return"#7F7C7C"},checkAnalyzerOutput:function(){try{return JSON.parse(this.timelineResult.verdict),!0}catch(gd){return!1}},timelineFirstResult:function(){return this.timeline&&this.timeline.results.length>0&&this.timeline.results[0]?this.timeline.results[0]:void 0},timelineCreated:function(){var t=this.timelineFirstResult;if(!t)return"... invalid date";var e=(t.created_at&&t.created_at.split(".").length)>0?t.created_at.split(".")[0]:"... invalid date";return e},timelineResult:function(){return this.timelineFirstResult?this.timelineFirstResult:"... no results found"},getHoverTheme:function(){return this.$vuetify.theme.dark?this.expanded?"dark-hover dark-bg":"dark-hover":this.expanded?"light-hover light-bg":"light-hover"}},methods:{setView:function(t){o.$emit("setActiveView",t)},setGraphPlugin:function(t){o.$emit("setGraphPlugin",t)},setSavedGraph:function(t){o.$emit("setSavedGraph",t)},applySearch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_all",i={doSearch:!0};i.queryString=t,i.queryFilter={from:0,terminate_after:40,size:40,indices:[e],order:"asc",chips:[]},o.$emit("setQueryAndFilter",i)},applyFilterChip:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"label",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"_all",s={doSearch:!0,queryString:"*"};s.queryFilter={from:0,terminate_after:40,size:40,indices:[n],order:"asc",chips:[]};var a={field:e,value:t,type:i,operator:"must",active:!0};s.chip=a,o.$emit("setQueryAndFilter",s)},contextLinkRedirect:function(t){this.contextUrl=t,this.redirectWarnDialog=!0}}},Su=bu,wu=(0,u.A)(Su,yu,_u,!1,null,"595e8247",null),ku=wu.exports,xu={props:["analyzer","isActive"],components:{TsAnalyzerResultTimeline:ku},data:function(){return{expanded:!1}}},Tu=xu,Cu=(0,u.A)(Tu,fu,gu,!1,null,null,null),Au=Cu.exports,Du={props:{iconOnly:Boolean},components:{TsAnalyzerResult:Au},data:function(){return{expanded:!1,search:"",analyzerResultsReady:!1,activeAnalyzerInterval:15e3,activeAnalyzerTimeout:3e5,activeAnalyzerTimeoutTriggered:!1,activeAnalyzerTimerStart:null}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},analyzerList:function(){return this.$store.state.sketchAnalyzerList},activeAnalyses:function(){return this.$store.state.activeAnalyses},analyzerResults:function(){return this.$store.state.analyzerResults},sortedAnalyzerResults:function(){var t=this.groupByAnalyzer([].concat((0,B.A)(this.analyzerResults),(0,B.A)(this.activeAnalyses))),e=(0,B.A)(Object.entries(t).map(function(t){var e=(0,Ne.A)(t,2),i=e[0],n=e[1];return{analyzerName:i,data:n}}));return e.sort(function(t,e){return t.data.analyzerInfo.display_name.localeCompare(e.data.analyzerInfo.display_name)}),e},resultCounter:function(){var t,e=0,i=(0,Le.A)(this.sortedAnalyzerResults);try{for(i.s();!(t=i.n()).done;){var n=t.value;for(var s in n.data.timelines)"DONE"!==n.data.timelines[s].analysis_status&&"ERROR"!==n.data.timelines[s].analysis_status||(e+=1)}}catch(a){i.e(a)}finally{i.f()}return e},activeAnalyzers:function(){return new Set(this.activeAnalyses.map(function(t){return t.analyzer_name}))},activeAnalyzerSessionIds:function(){return Array.from(new Set(this.activeAnalyses.map(function(t){return t.analysissession_id})))},activeAnalyzerDisplayCount:function(){return this.activeAnalyzerSessionIds.length>0?this.activeAnalyzerSessionIds.length:""}},methods:{initializeAnalyzerResults:function(){var t=this;return(0,Ja.A)((0,Xa.A)().m(function e(){var i,n,s,a,r,o,l;return(0,Xa.A)().w(function(e){while(1)switch(e.p=e.n){case 0:i=[],n=(0,Le.A)(t.sketch.timelines),e.p=1,n.s();case 2:if((s=n.n()).done){e.n=6;break}return a=s.value,e.n=3,_.getSketchTimelineAnalysis(t.sketch.id,a.id);case 3:if(r=e.v,o=r.data.objects[0],o){e.n=4;break}return e.a(3,5);case 4:i=i.concat(o);case 5:e.n=2;break;case 6:e.n=8;break;case 7:e.p=7,l=e.v,n.e(l);case 8:return e.p=8,n.f(),e.f(8);case 9:t.$store.dispatch("updateAnalyzerResults",i),t.updateActiveAnalyses(t.$store,i),t.analyzerResultsReady=!0;case 10:return e.a(2)}},e,null,[[1,7,8,9]])}))()},groupByAnalyzer:function(t){var e,i={},n={},s=(0,Le.A)(t);try{for(s.s();!(e=s.n()).done;){var a=e.value;if(i[a.analyzer_name]||(this.analyzerList[a.analyzer_name]?i[a.analyzer_name]={timelines:{},analyzerInfo:{name:a.analyzer_name,description:this.analyzerList[a.analyzer_name].description,is_multi:this.analyzerList[a.analyzer_name].is_multi,display_name:this.analyzerList[a.analyzer_name].display_name}}:i[a.analyzer_name]={timelines:{},analyzerInfo:{name:a.analyzer_name,description:"No description available.",is_multi:!1,display_name:a.analyzer_name}}),!i[a.analyzer_name].timelines[a.timeline.name]){var r={id:a.timeline.id,name:a.timeline.name,color:a.timeline.color,last_analysissession_id:a.analysissession_id};i[a.analyzer_name].analyzerInfo.is_multi?(n=this.getAnalyzerMultiResults(t,a.analyzer_name,a.analysissession_id,a.timeline.id),i[a.analyzer_name].timelines[a.timeline.name]=(0,D.A)((0,D.A)({},r),{},{analysis_status:n.analysis_status,results:n.results})):i[a.analyzer_name].timelines[a.timeline.name]=(0,D.A)((0,D.A)({},r),{},{analysis_status:a.status[0].status,results:[{verdict:a.result,created_at:a.created_at,analysis_status:a.status[0].status}]})}i[a.analyzer_name].timelines[a.timeline.name].last_analysissession_id<a.analysissession_id&&(i[a.analyzer_name].timelines[a.timeline.name].last_analysissession_id=a.analysissession_id,i[a.analyzer_name].analyzerInfo.is_multi?(n=this.getAnalyzerMultiResults(t,a.analyzer_name,a.analysissession_id,a.timeline.id),i[a.analyzer_name].timelines[a.timeline.name].results[0].analysis_status=n.analysis_status,i[a.analyzer_name].timelines[a.timeline.name].results=n.results):(i[a.analyzer_name].timelines[a.timeline.name].results[0].created_at=a.created_at,i[a.analyzer_name].timelines[a.timeline.name].results[0].verdict=a.result,i[a.analyzer_name].timelines[a.timeline.name].analysis_status=a.status[0].status,i[a.analyzer_name].timelines[a.timeline.name].results[0].analysis_status=a.status[0].status))}}catch(o){s.e(o)}finally{s.f()}return i},getAnalyzerMultiResults:function(t,e,i,n){var s,a=[],r=new Set,o=(0,Le.A)(t);try{for(o.s();!(s=o.n()).done;){var l=s.value;l.analyzer_name===e&&l.analysissession_id===i&&l.timeline.id===n&&(a.push({verdict:l.result,created_at:l.created_at,analysis_status:l.status[0].status}),r.add(l.status[0].status))}}catch(c){o.e(c)}finally{o.f()}return{results:a,analysis_status:this.getMultiStatus(r)}},getMultiStatus:function(t){return 1===t.size&&(t.has("DONE")||t.has("ERROR"))?(0,B.A)(t)[0]:2===t.size&&t.has("DONE")&&t.has("ERROR")?"ERROR":"PENDING"},filterAnalyzers:function(t,e){var i=(e||"").toLowerCase();return t&&t.filter(function(t){var e=-1!==t.data.analyzerInfo.display_name.toLowerCase().indexOf(i),n=Object.keys(t.data.timelines).find(function(t){return-1!==t.indexOf(i)});return e||n})},startPolling:function(){this.activeAnalyzerSessionIds.length>0&&!this.interval&&(this.activeAnalyzerTimerStart=Date.now(),this.interval=setInterval((0,Ja.A)((0,Xa.A)().m(function t(){var e,i;return(0,Xa.A)().w(function(t){while(1)switch(t.n){case 0:if(0!==this.activeAnalyzerSessionIds.length){t.n=1;break}return this.stopPolling(),this.initializeAnalyzerResults(),t.a(2);case 1:if(!(null!==this.activeAnalyzerTimerStart&&Date.now()-this.activeAnalyzerTimerStart>this.activeAnalyzerTimeout)){t.n=2;break}return this.stopPolling(),this.activeAnalyzerTimeoutTriggered=!0,t.a(2);case 2:return e=this.activeAnalyses.length,t.n=3,this.fetchActiveAnalyses(this.sketch.id);case 3:i=t.v,e!==i.length?this.initializeAnalyzerResults():this.updateActiveAnalyses(i);case 4:return t.a(2)}},t,this)})).bind(this),this.activeAnalyzerInterval))},stopPolling:function(){clearInterval(this.interval),this.activeAnalyzerTimerStart=null,this.interval=!1},fetchActiveAnalyses:function(t){return(0,Ja.A)((0,Xa.A)().m(function e(){var i,n,s,a,r,o,l;return(0,Xa.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,i=[],e.n=1,_.getActiveAnalyzerSessions(t);case 1:if(n=e.v,n&&n.data&&n.data.objects&&n.data.objects[0]&&(s=n.data.objects[0].detailed_sessions,s.length>0)){a=(0,Le.A)(s);try{for(a.s();!(r=a.n()).done;)o=r.value,i.push.apply(i,(0,B.A)(o.objects[0]["analyses"]))}catch(c){a.e(c)}finally{a.f()}}return e.a(2,i);case 2:e.p=2,l=e.v,console.error(l);case 3:return e.a(2)}},e,null,[[0,2]])}))()},updateActiveAnalyses:function(t,e){var i=e.filter(function(t){return"PENDING"===t.status[0].status||"STARTED"===t.status[0].status});t.dispatch("updateActiveAnalyses",i)}},mounted:function(){this.initializeAnalyzerResults(),this.activeAnalyzerTimerStart=Date.now()},beforeDestroy:function(){clearInterval(this.interval),this.interval=!1},watch:{activeAnalyzerSessionIds:function(){this.startPolling()}}},Lu=Du,Iu=(0,u.A)(Lu,vu,pu,!1,null,"69ba5af1",null),Eu=Iu.exports,Nu=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{key:"iconOnly",staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(e){t.$emit("toggleDrawer"),t.expanded=!0}}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-chart-bar ")]),e("div",{staticStyle:{height:"1px"}})],1):e("div",{key:"iconOnly"},[e("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",style:t.savedVisualizations&&t.savedVisualizations.length?"cursor: pointer":"",on:{click:function(e){t.expanded=!t.expanded}}},[e("span",[e("v-icon",{attrs:{left:""}},[t._v(" mdi-chart-bar ")]),t._v(" Visualizations ")],1),!t.expanded&&t.savedVisualizations&&t.savedVisualizations.length?t._e():e("v-btn",{staticClass:"float-right mt-n1 mr-n1",attrs:{icon:"",text:"",to:{name:"VisualizationNew"}},on:{click:function(t){t.stopPropagation()}}},[e("v-icon",{attrs:{title:"Create a new visualization"}},[t._v(" mdi-plus ")])],1),t.expanded?t._e():e("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[t.savedVisualizations&&t.savedVisualizations.length?e("small",[e("strong",[t._v(" "+t._s(t.visualizationCount)+" ")])]):t._e()])],1),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded&&t.savedVisualizations.length,expression:"expanded && savedVisualizations.length"}]},t._l(t.savedVisualizations,function(i,n){return e("div",{key:n,staticStyle:{cursor:"pointer","font-size":"0.9em","text-decoration":"none"}},[e("v-row",{staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[e("v-col",{class:t.$vuetify.theme.dark?"dark-font":"light-font",on:{click:function(e){return t.navigateToSavedVisualization(i.id)}}},[e("span",{staticClass:"d-inline-block text-truncate",staticStyle:{"max-width":"250px"}},[e("v-icon",{attrs:{left:"",small:""}},[t._v(" "+t._s(t.getIcon(i.chart_type))+" ")]),e("v-tooltip",{attrs:{bottom:"",disabled:i.name&&i.name.length<34},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on,a=n.attrs;return[e("span",t._g(t._b({},"span",a,!1),s),[t._v(t._s(i.name))])]}}],null,!0)},[e("span",[t._v(t._s(i.name))])])],1)]),e("v-col",{attrs:{cols:"auto"}},[e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,s=i.attrs;return[e("v-btn",t._g(t._b({staticClass:"mr-1",attrs:{small:"",icon:""}},"v-btn",s,!1),n),[e("v-icon",{attrs:{title:"Actions",small:""}},[t._v(" mdi-dots-vertical ")])],1)]}}],null,!0)},[e("v-list",{staticClass:"mx-auto",attrs:{dense:""}},[e("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.copyVisualizationIdToClipboard(i.id)}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-identifier")])],1),e("v-list-item-title",[t._v("Copy visualization ID")])],1),e("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.copyVisualizationUrlToClipboard(i.id)}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-link-variant")])],1),e("v-list-item-title",[t._v("Copy link to this visualization")])],1),e("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.deleteVisualization(i.id)}}},[e("v-list-item-icon",[e("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can")])],1),e("v-list-item-title",[t._v("Delete")])],1)],1)],1)],1)],1)],1)}),0)]),e("v-divider")],1)},zu=[],$u={props:{iconOnly:{type:Boolean}},data:function(){return{expanded:!1}},methods:{copyVisualizationIdToClipboard:function(t){try{navigator.clipboard.writeText(t),this.infoSnackBar("Saved Visualization ID copied to clipboard")}catch(e){this.errorSnackBar("Failed to load Saved Visualization ID into the clipboard!"),console.error(e)}},copyVisualizationUrlToClipboard:function(t){try{var e=window.location.origin+"/sketch/"+this.sketch.id+"/visualization/view/"+t;navigator.clipboard.writeText(e),this.infoSnackBar("Saved Visualization URL copied to clipboard")}catch(i){this.errorSnackBar("Failed to load Saved Visualization URL into the clipboard!"),console.error(i)}},deleteVisualization:function(t){var e=this;confirm("Delete Saved Visualization?")&&_.deleteAggregationById(this.sketch.id,t).then(function(i){e.$store.dispatch("updateSavedVisualizationList",e.sketch.id),e.infoSnackBar("Saved Visualization has been deleted");var n={name:"VisualizationView",params:{aggregationId:t}},s=e.$route.fullPath,a=e.$router.resolve(n).route.fullPath;s===a&&e.$router.push({name:"VisualizationNew"})}).catch(function(t){e.errorSnackBar("Failed to delete Saved Visualization!"),console.error(t)})},getIcon:function(t){return{bar:"mdi-poll mdi-rotate-90",column:"mdi-chart-bar",line:"mdi-chart-line",table:"mdi-table",heatmap:"mdi-blur-linear",donut:"mdi-chart-donut"}[t]},navigateToSavedVisualization:function(t){var e={name:"VisualizationView",params:{aggregationId:t}},i=this.$router.resolve(e).route.fullPath,n=this.$route.fullPath;i!==n&&this.$router.push(e)}},computed:{savedVisualizations:function(){return this.$store.state.savedVisualizations?this.$store.state.savedVisualizations.filter(function(t){return"apex"===JSON.parse(t.parameters)["aggregator_class"]}):[]},visualizationCount:function(){return this.$store.state.savedVisualizations?this.$store.state.savedVisualizations.filter(function(t){return"apex"===JSON.parse(t.parameters)["aggregator_class"]}).length:0},sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},mounted:function(){this.$store.dispatch("updateSavedVisualizationList",this.sketch.id)}},Fu=$u,Ru=(0,u.A)(Fu,Nu,zu,!1,null,null,null),Pu=Ru.exports,Ou=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(e){t.$emit("toggleDrawer"),t.expanded=!0}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-clock-outline")]),e("div",{staticStyle:{height:"1px"}})],1):e("div",[e("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer"},on:{click:function(e){t.expanded=!t.expanded}}},[e("span",[e("v-icon",{attrs:{left:""}},[t._v("mdi-clock-outline")]),t._v(" Timelines ")],1),t.expanded?e("ts-upload-timeline-form",{scopedSlots:t._u([{key:"default",fn:function(i){return[t.expanded||0===t.allTimelines.length?e("v-btn",t._g(t._b({staticClass:"float-right mt-n1 mr-n1",attrs:{icon:"",text:""},on:{click:function(t){t.stopPropagation()}}},"v-btn",i.attrs,!1),i.on),[e("v-icon",{attrs:{title:"Add timeline"}},[t._v("mdi-plus")])],1):t._e()]}}],null,!1,662016214)}):e("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[e("small",{staticClass:"ml-3"},[e("strong",[t._v(t._s(t.allTimelines.length))])])])],1),e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},[t.allTimelines.length>=t.paginationThreshold?e("v-text-field",{staticClass:"ma-3",attrs:{label:"Filter timelines","single-line":"",clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}):t._e(),e("v-data-table",{staticClass:"data-table",attrs:{"hide-default-footer":t.allTimelines.length<=t.paginationThreshold,"hide-default-header":!0,items:t.allTimelines,headers:t.headers,"item-key":"id",dense:"","disable-sort":"",search:t.search},scopedSlots:t._u([{key:"item.name",fn:function(i){var n=i.item;return[e("ts-timeline-component",{key:n.id+n.name,staticClass:"mb-1 mt-1",attrs:{"is-selected":t.isEnabled(n),timeline:n},on:{toggle:t.toggleTimeline,save:t.save,disableAllOtherTimelines:t.disableAllOtherTimelines},scopedSlots:t._u([{key:"processing",fn:function(i){return[e("div",{staticClass:"chip-content",style:t.timelineStyle(i.timelineStatus,t.isEnabled(n))},[e("span",{staticClass:"timeline-name-ellipsis"},[t._v(t._s(n.name))]),e("span",{staticClass:"right"},["processing"===i.timelineStatus?e("span",{staticClass:"ml-3 mr-3"},[e("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:17,width:2}})],1):t._e()])])]}},{key:"processed",fn:function(i){return[e("div",{staticClass:"chip-content",style:t.timelineStyle(i.timelineStatus,t.isEnabled(n))},[i.timelineFailed?e("v-icon",{staticClass:"ml-n2",attrs:{title:"Import failed; click for details",left:"",color:"red",size:"x-large"},on:{click:i.events.openDialog}},[t._v(" mdi-alert-circle-outline ")]):t._e(),i.timelineFailed?t._e():e("v-icon",{staticClass:"ml-n2",attrs:{left:"",color:i.timelineChipColor,size:"26"}},[t._v(" mdi-circle ")]),e("v-tooltip",{attrs:{bottom:"",disabled:n.name.length<40,"open-delay":"200"},scopedSlots:t._u([{key:"activator",fn:function(i){var s=i.on;return[e("span",t._g({staticClass:"timeline-name-ellipsis",staticStyle:{cursor:"default"}},s),[t._v(t._s(n.name))])]}}],null,!0)},[e("span",[t._v(t._s(n.name))])]),e("span",{staticClass:"right"},["processing"===i.timelineStatus?e("span",{staticClass:"ml-3 mr-3"},[e("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:17,width:2}})],1):t._e(),i.timelineFailed?t._e():e("span",{staticClass:"events-count mr-1",attrs:{"x-small":""}},[t._v(" "+t._s(t._f("compactNumber")(t.getCount(n)))+" ")]),i.timelineFailed?t._e():e("v-btn",{staticClass:"ma-1",attrs:{"x-small":"",icon:""},on:{click:i.events.toggleTimeline}},[t.isEnabled(n)?e("v-icon",[t._v(" mdi-eye ")]):e("v-icon",[t._v(" mdi-eye-off ")])],1),e("v-btn",t._g({staticClass:"ma-1",attrs:{"x-small":"",icon:""}},i.events.menuOn),[e("v-icon",[t._v(" mdi-dots-vertical ")])],1)],1)],1)]}}],null,!0)})]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1)]),e("v-divider")],1)},Qu=[],Mu={props:{iconOnly:Boolean},components:{TsUploadTimelineForm:ae,TsTimelineComponent:Ft},computed:{sketch:function(){return this.$store.state.sketch},allTimelines:function(){var t=(0,B.A)(this.sketch.timelines);return t.sort(function(t,e){return t.name.localeCompare(e.name)}),t},activeTimelines:function(){var t=(0,B.A)(this.sketch.active_timelines);return t.sort(function(t,e){return t.name.localeCompare(e.name)})},settings:function(){return this.$store.state.settings}},watch:{"settings.showProcessingTimelineEvents":function(t,e){this.updateEnabledTimelines(void 0===e)}},methods:{isEnabled:function(t){return this.$store.state.enabledTimelines.includes(t.id)},toggleTimeline:function(t){this.$store.dispatch("toggleEnabledTimeline",t.id)},disableAllOtherTimelines:function(t){this.$store.dispatch("updateEnabledTimelines",[t.id])},updateEnabledTimelines:function(t){var e=this,i=this.activeTimelines;t?this.settings.showProcessingTimelineEvents||(i=i.filter(function(t){return"processing"!==t.status[0].status})):(i=i.filter(function(t){return e.$store.state.enabledTimelines.includes(t.id)}),this.settings.showProcessingTimelineEvents&&(this.activeTimelines.forEach(function(t){i.includes(t)||"processing"!==t.status[0].status||i.push(t)}),i.sort(function(t,e){return t.id-e.id})));var n=i.map(function(t){return t.id});this.$store.dispatch("updateEnabledTimelines",n)},timelineStyle:function(t,e){var i=["ready"];this.settings.showProcessingTimelineEvents&&i.push("processing");var n=i.includes(t)&&!e;return{opacity:n?"50%":"100%"}},updateCountPerTimeline:function(t){this.countPerTimeline=t},getCount:function(t){var e=0;return this.countPerTimeline&&(e=this.countPerTimeline[t.id]),e},save:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];_.saveSketchTimeline(this.sketch.id,t.id,i||t.name,t.description,t.color).then(function(){return e.$store.dispatch("updateSketch",e.sketch.id)}).catch(function(t){console.error(t)})}},data:function(){return{countPerTimeline:{},expanded:!1,selected:[],search:"",headers:[{value:"name"}],paginationThreshold:10}},created:function(){this.updateEnabledTimelines(!0)},mounted:function(){o.$on("updateCountPerTimeline",this.updateCountPerTimeline)},beforeDestroy:function(){o.$off("updateCountPerTimeline")}},qu=Mu,Bu=(0,u.A)(qu,Ou,Qu,!1,null,"3fb0c4da",null),Vu=Bu.exports,Hu=function(){var t=this,e=t._self._c;return t.iconOnly?e("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"}},[e("a",{staticStyle:{color:"inherit","text-decoration":"none"},attrs:{href:t.destinationUrl}},[e("v-icon",{attrs:{left:""}},[t._v(t._s(t.menuTitle.icon))]),e("div",{staticStyle:{height:"1px"}})],1)]):e("div",[e("a",{staticStyle:{"text-decoration":"none",color:"inherit",display:"block"},attrs:{href:t.destinationUrl}},[e("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer"}},[e("v-icon",{attrs:{left:""}},[t._v(t._s(t.menuTitle.icon))]),t._v(t._s(t.menuTitle.title)+" ")],1)]),e("v-divider")],1)},Gu=[],Uu={props:{iconOnly:Boolean},computed:{sketch:function(){return this.$store.state.sketch},systemSettings:function(){return this.$store.state.systemSettings},menuTitle:function(){return this.systemSettings.LLM_FEATURES_AVAILABLE&&this.systemSettings.LLM_FEATURES_AVAILABLE.log_analyzer?{title:"AI Investigation",icon:"mdi-creation"}:!!this.systemSettings.DFIQ_ENABLED&&{title:"Investigation",icon:"mdi-text-box-search-outline"}},destinationUrl:function(){return this.sketch.id?"/v3/sketch/".concat(this.sketch.id,"/investigation"):"#"}}},Wu=Uu,ju=(0,u.A)(Wu,Hu,Gu,!1,null,null,null),Yu=ju.exports,Xu=function(){var t=this,e=t._self._c;return e("v-container",{staticStyle:{height:"70vh"},attrs:{"fill-height":"",fluid:""}},[e("v-row",{attrs:{align:"center",justify:"center"}},[e("v-sheet",{staticClass:"pa-4",attrs:{color:"transparent"}},[e("div",{staticClass:"text-center"},[e("v-icon",{staticClass:"mb-3",attrs:{size:"100",color:"grey lighten-1"}},[t._v("mdi-lock")]),e("div",{staticClass:"text-h4 mb-3 mt-3"},[t._v("Access Denied")]),e("div",{staticClass:"mb-5 text--secondary"},[t._v(" You don't have permission to access this sketch."),e("br"),t._v(" Contact the sketch owner to request access. ")]),e("v-btn",{attrs:{rounded:"",depressed:"",color:"primary",to:"/"}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-home")]),t._v(" Go to Home ")],1)],1)])],1)],1)},Ju=[],Ku={name:"TsAccessDenied"},Zu=Ku,td=(0,u.A)(Zu,Xu,Ju,!1,null,null,null),ed=td.exports,id={props:["sketchId"],components:{TsSavedSearches:jl,TsDataTypes:tc,TsTags:rc,TsSearchTemplates:yc,TsSigmaRules:Ic,TsUploadTimelineFormButton:ce,TsShareCard:ou,TsRenameSketch:mu,TsIntelligence:Pc,TsGraphs:Vc,TsStories:Yc,TsSearch:eu,TsAnalyzerResults:Eu,TsTimelinesTable:Vu,TsEventList:wn,TsVisualizations:Pu,TsQuestionCard:go,TsSettingsDialog:z,TsInvestigation:Yu,TsAccessDenied:ed},data:function(){return{showSketchMetadata:!1,navigationDrawer:{width:56},isMiniDrawer:!0,selectedScenario:null,scenarioDialog:!1,showLeftPanel:!1,leftPanelTab:0,leftPanelTabItems:["EXPLORE","INVESTIGATE"],renameSketchDialog:!1,showHidden:!1,shareDialog:!1,loadingSketch:!1,timelineViewHeight:60,showTimelineView:!1,currentContextEvent:{},minimizeTimelineView:!1,queryRequest:{},contextStartTime:null,contextEndTime:null,contextTimeWindowSeconds:300,showFacetMenu:!1,showQuestionMenu:!1,showRightSidePanel:!1,showSettingsDialog:!1,questionCardExclusionRoutes:["VisualizationNew","SigmaNewRule","Analyze","Story"]}},mounted:function(){var t=this;this.loadingSketch=!0,this.showLeftPanel=!1,this.$store.dispatch("updateUserSettings").then(function(){return t.$store.dispatch("updateSketch",t.sketchId)}).then(function(){t.$store.dispatch("updateSearchHistory",t.sketchId),t.$store.dispatch("updateScenarioTemplates",t.sketchId),t.$store.dispatch("updateSavedGraphs",t.sketchId),t.$store.dispatch("updateGraphPlugins"),t.$store.dispatch("updateContextLinks"),t.$store.dispatch("updateAnalyzerList",t.sketchId),t.$store.dispatch("updateSystemSettings").then(function(){t.userSettings.showLeftPanel&&t.toggleDrawer()}),t.hasTimelines&&!t.isArchived&&(t.showLeftPanel=!0),t.updateDocumentTitle(),t.loadingSketch=!1}),o.$on("showContextWindow",this.showContextWindow)},beforeDestroy:function(){o.$off("showContextWindow")},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},userSettings:function(){return this.$store.state.settings},isArchived:function(){return!(!this.sketch.status||!this.sketch.status.length)&&"archived"===this.sketch.status[0].status},currentUser:function(){return this.$store.state.currentUser},hasTimelines:function(){return this.sketch.timelines&&this.sketch.timelines.length},currentRouteName:function(){return this.$route.name},systemSettings:function(){return this.$store.state.systemSettings},sketchAccessDenied:function(){return this.$store.state.sketchAccessDenied}},methods:{archiveSketch:function(){var t=this;this.loadingSketch=!0,_.archiveSketch(this.sketch.id).then(function(e){t.$store.dispatch("updateSketch",t.sketch.id).then(function(){t.showLeftPanel=!1,t.loadingSketch=!1})}).catch(function(t){console.error(t)})},unArchiveSketch:function(){var t=this;this.loadingSketch=!0,_.unArchiveSketch(this.sketch.id).then(function(e){t.$store.dispatch("updateSketch",t.sketch.id).then(function(){t.loadingSketch=!1,t.showLeftPanel=!0})}).catch(function(t){console.error(t)})},deleteSketch:function(){var t=this;confirm("Are you sure you want to delete the sketch?")&&_.deleteSketch(this.sketch.id).then(function(e){t.$router.push({name:"Home"})}).catch(function(t){console.error(t)})},generateContextQuery:function(t){var e=this.$options.filters.formatTimestamp(t._source.timestamp);this.contextStartTime=It.A.utc(e).subtract(this.contextTimeWindowSeconds,"second"),this.contextEndTime=It.A.utc(e).add(this.contextTimeWindowSeconds,"second");var i={field:"",value:this.contextStartTime.toISOString()+","+this.contextEndTime.toISOString(),type:"datetime_range",operator:"must",active:!0},n={from:0,terminate_after:40,size:40,indices:["_all"],order:"asc",chips:[i]},s={queryString:"*",queryFilter:n};return s},updateContextQuery:function(t){this.contextTimeWindowSeconds=t,this.queryRequest=this.generateContextQuery(this.currentContextEvent)},contextToSearch:function(){var t=this.generateContextQuery(this.currentContextEvent);t.doSearch=!0,o.$emit("setQueryAndFilter",t),this.showTimelineView=!1},showContextWindow:function(t){this.currentContextEvent=t,this.queryRequest=this.generateContextQuery(t),this.showTimelineView=!0},increaseTimelineViewHeight:function(){this.minimizeTimelineView=!1,this.timelineViewHeight>70||(this.timelineViewHeight+=30)},decreaseTimelineViewHeight:function(){if(this.minimizeTimelineView=!1,this.timelineViewHeight<50)return this.minimizeTimelineView=!0,void(this.timelineViewHeight=0);this.timelineViewHeight-=30},closeTimelineView:function(){this.minimizeTimelineView=!0,this.timelineViewHeight=0},toggleTheme:function(){this.$vuetify.theme.dark=!this.$vuetify.theme.dark,localStorage.setItem("isDarkTheme",this.$vuetify.theme.dark.toString());var t=document.body;t.dataset.theme=this.$vuetify.theme.dark?"dark":"light"},switchUI:function(){window.location.href=window.location.href.replace("/sketch/","/legacy/sketch/")},toggleDrawer:function(){var t=this;this.navigationDrawer.width>56?(this.navigationDrawer.width=56,this.isMiniDrawer=!0):(this.navigationDrawer.width=350,setTimeout(function(){t.isMiniDrawer=!1},100))},updateDocumentTitle:function(){this.sketch&&this.sketch.name&&this.sketch.id?document.title="[".concat(this.sketch.id,"] ").concat(this.sketch.name):document.title="Timesketch"}},watch:{sketch:function(t){t&&this.updateDocumentTitle()},hasTimelines:function(t,e){0===e&&t>0&&(this.showLeftPanel=!0),e>0&&0===t&&(this.showLeftPanel=!1)}}},nd=id,sd=(0,u.A)(nd,ql,Bl,!1,null,null,null),ad=sd.exports;n["default"].use(m.Ay);var rd=[{name:"Home",path:"/",component:P},{path:"/sketch/:sketchId",component:ad,props:!0,children:[{path:"",name:"Overview",redirect:{name:"Explore"}},{path:"explore",name:"Explore",component:Ml,props:!0},{path:"intelligence",name:"Intelligence",component:Ml,props:!0},{path:"sigma",component:Ml,props:!0,children:[{path:"new",name:"SigmaNewRule",component:Ml,props:!0},{path:"edit/:ruleId",name:"SigmaEditRule",component:Ml,props:!0}]},{path:"visualization",component:Ml,props:!0,children:[{path:"new",name:"VisualizationNew",component:Ml,props:!0},{path:"view/:aggregationId",name:"VisualizationView",component:Ml,props:!0}]},{path:"graph",name:"Graph",component:Ml,props:!0},{path:"story/:storyId",name:"Story",component:Ml,props:!0},{path:"analyzers",name:"Analyze",component:Ml,props:!0}]}],od=new m.Ay({mode:"history",routes:rd}),ld=i(95353);n["default"].use(ld.Ay);var cd=function(t){return{sketch:{},meta:{},searchHistory:{},timeFilters:{},scenarios:[],hiddenScenarios:[],scenarioTemplates:[],graphPlugins:[],savedGraphs:[],tags:[],dataTypes:[],count:0,currentSearchNode:null,currentUser:t,settings:{},systemSettings:{},activeContext:{scenario:{},facet:{},question:{}},snackbar:{active:!1,color:"",message:"",timeout:-1},contextLinkConf:{},sketchAnalyzerList:{},savedVisualizations:[],activeAnalyses:[],analyzerResults:[],enabledTimelines:[],sketchAccessDenied:!1}},ud=cd(),dd=new ld.Ay.Store({state:ud,mutations:{SET_SKETCH:function(t,e){n["default"].set(t,"sketch",e.objects[0]),n["default"].set(t,"meta",e.meta)},SET_SEARCH_HISTORY:function(t,e){n["default"].set(t,"searchHistory",e.objects)},SET_SCENARIOS:function(t,e){n["default"].set(t,"scenarios",e.objects[0])},SET_SCENARIO_TEMPLATES:function(t,e){n["default"].set(t,"scenarioTemplates",e.objects)},SET_TIMELINE_TAGS:function(t,e){n["default"].set(t,"tags",e)},SET_EVENT_LABELS:function(t,e){n["default"].set(t.meta,"filter_labels",e)},SET_DATA_TYPES:function(t,e){var i=e.objects[0]["field_bucket"]["buckets"];n["default"].set(t,"dataTypes",i)},SET_COUNT:function(t,e){n["default"].set(t,"count",e)},SET_SEARCH_NODE:function(t,e){n["default"].set(t,"currentSearchNode",e)},SET_SIGMA_LIST:function(t,e){n["default"].set(t,"sigmaRuleList",e["objects"]),n["default"].set(t,"sigmaRuleList_count",e["meta"]["rules_count"])},SET_VISUALIZATION_LIST:function(t,e){n["default"].set(t,"savedVisualizations",e)},SET_ACTIVE_USER:function(t,e){_.getLoggedInUser().then(function(e){var i=e.data.objects[0].username;n["default"].set(t,"currentUser",i)})},SET_ACTIVE_CONTEXT:function(t,e){localStorage.setItem("sketchContext"+t.sketch.id.toString(),JSON.stringify({scenarioId:e.scenarioId,facetId:e.facetId,questionId:e.questionId})),n["default"].set(t,"activeContext",e)},CLEAR_ACTIVE_CONTEXT:function(t){var e={scenario:t.activeContext.scenario,facet:t.activeContext.facet,question:{}};n["default"].set(t,"activeContext",e)},SET_GRAPH_PLUGINS:function(t,e){n["default"].set(t,"graphPlugins",e)},SET_SAVED_GRAPHS:function(t,e){n["default"].set(t,"savedGraphs",e.objects[0]||[])},SET_SNACKBAR:function(t,e){n["default"].set(t,"snackbar",e)},RESET_STATE:function(t,e){_.getLoggedInUser().then(function(e){var i=e.data.objects[0].username;Object.assign(t,cd(i))})},SET_CONTEXT_LINKS:function(t,e){n["default"].set(t,"contextLinkConf",e)},SET_ANALYZER_LIST:function(t,e){n["default"].set(t,"sketchAnalyzerList",e)},SET_SAVED_VISUALIZATIONS:function(t,e){n["default"].set(t,"savedVisualizations",e)},SET_ACTIVE_ANALYSES:function(t,e){n["default"].set(t,"activeAnalyses",e)},ADD_ACTIVE_ANALYSES:function(t,e){var i=[].concat((0,B.A)(t.activeAnalyses),(0,B.A)(e));n["default"].set(t,"activeAnalyses",i)},SET_ANALYZER_RESULTS:function(t,e){n["default"].set(t,"analyzerResults",e)},SET_ENABLED_TIMELINES:function(t,e){n["default"].set(t,"enabledTimelines",e)},SET_TIME_FILTERS:function(t,e){n["default"].set(t,"timeFilters",e)},ADD_ENABLED_TIMELINES:function(t,e){var i=[].concat((0,B.A)(t.enabledTimelines),(0,B.A)(e));n["default"].set(t,"enabledTimelines",i)},REMOVE_ENABLED_TIMELINES:function(t,e){n["default"].set(t,"enabledTimelines",t.enabledTimelines.filter(function(t){return!e.includes(t)}))},TOGGLE_ENABLED_TIMELINE:function(t,e){if(t.enabledTimelines.includes(e))n["default"].set(t,"enabledTimelines",t.enabledTimelines.filter(function(t){return e!==t}));else{var i=[].concat((0,B.A)(t.enabledTimelines),[e]);n["default"].set(t,"enabledTimelines",i)}},SET_SYSTEM_SETTINGS:function(t,e){n["default"].set(t,"systemSettings",e||{})},SET_USER_SETTINGS:function(t,e){n["default"].set(t,"settings",e.objects[0]||{})},SET_SKETCH_ACCESS_DENIED:function(t,e){n["default"].set(t,"sketchAccessDenied",e)}},actions:{updateSketch:function(t,e){return t.commit("SET_SKETCH_ACCESS_DENIED",!1),_.getSketch(e).then(function(i){t.commit("SET_SKETCH",i.data),t.commit("SET_ACTIVE_USER",i.data),t.dispatch("updateTimelineTags",{sketchId:e}),t.dispatch("updateDataTypes",e)}).catch(function(e){e.response&&403===e.response.status?t.commit("SET_SKETCH_ACCESS_DENIED",!0):console.error(e)})},updateCount:function(t,e){return _.countSketchEvents(e).then(function(e){t.commit("SET_COUNT",e.data.meta.count)}).catch(function(t){console.error(t)})},resetState:function(t){t.commit("RESET_STATE")},updateSearchNode:function(t,e){t.commit("SET_SEARCH_NODE",e)},updateSearchHistory:function(t,e){return e||(e=t.state.sketch.id),_.getSearchHistory(e).then(function(e){t.commit("SET_SEARCH_HISTORY",e.data)}).catch(function(t){console.error(t)})},updateTimeFilters:function(t,e){e||(e=t.state.sketch.id),_.getSearchHistoryTree(e).then(function(e){var i=e.data.objects[0],n=[];function s(t){if(t&&t.query_filter){var e=JSON.parse(t.query_filter);e.chips.length>0&&n.push.apply(n,(0,B.A)(e.chips.filter(function(t){return"datetime_range"===t.type})));var i,a=(0,Le.A)(t.children);try{for(a.s();!(i=a.n()).done;){var r=i.value;s(r)}}catch(o){a.e(o)}finally{a.f()}}}i&&s(i);for(var a=[],r=new Set,o=0,l=n;o<l.length;o++){var c=l[o];r.has(c.value)||(r.add(c.value),a.push(c))}a.reverse(),t.commit("SET_TIME_FILTERS",a)}).catch(console.error)},updateScenarios:function(t,e){return e||(e=t.state.sketch.id),_.getSketchScenarios(e).then(function(e){t.commit("SET_SCENARIOS",e.data)}).catch(function(t){console.error(t)})},updateScenarioTemplates:function(t,e){return _.getScenarioTemplates(e).then(function(e){t.commit("SET_SCENARIO_TEMPLATES",e.data)}).catch(function(t){console.error(t)})},updateEventLabels:function(t,e){var i=e.label,n=e.num;if(i&&n){var s=t.state.meta.filter_labels,a=s.find(function(t){return t.label===i});void 0!==a?a.count+=n:s.push({label:i,count:n}),t.commit("SET_EVENT_LABELS",s)}},updateTimelineTags:function(t,e){if("archived"!==t.state.sketch.status[0].status){var i=t.state.sketch.active_timelines;if(i&&i.length){var n=i.every(function(t){return!(!t||!t.status||0===t.status.length)&&"processing"===t.status[0].status});if(!n||t.state.settings.showProcessingTimelineEvents){var s={aggregator_name:"field_bucket",aggregator_parameters:{field:"tag",limit:"1000"},include_processing_timelines:!!t.state.settings.showProcessingTimelineEvents};return _.runAggregator(e.sketchId,s).then(function(i){var n=i.data.objects[0]["field_bucket"]["buckets"];if(e.tag&&e.num){var s=void 0===n.find(function(t){return t.tag===e.tag});if(s)n.push({tag:e.tag,count:e.num});else{var a=n.findIndex(function(t){return t.tag===e.tag});n[a].count+=e.num}}t.commit("SET_TIMELINE_TAGS",n)}).catch(function(t){console.error(t)})}}}else t.commit("SET_TIMELINE_TAGS",[])},updateDataTypes:function(t,e){if("archived"!==t.state.sketch.status[0].status){var i=t.state.sketch.active_timelines;if(i&&i.length){var n=i.every(function(t){return!(!t||!t.status||0===t.status.length)&&"processing"===t.status[0].status});if(!n||t.state.settings.showProcessingTimelineEvents){var s={aggregator_name:"field_bucket",aggregator_parameters:{field:"data_type",limit:"1000"},include_processing_timelines:!!t.state.settings.showProcessingTimelineEvents};return _.runAggregator(e,s).then(function(e){t.commit("SET_DATA_TYPES",e.data)}).catch(function(t){console.error(t)})}}}else t.commit("SET_DATA_TYPES",{objects:[{field_bucket:{buckets:[]}}]})},updateSigmaList:function(t){_.getSigmaRuleList().then(function(e){t.commit("SET_SIGMA_LIST",e.data)}).catch(function(t){console.error(t)})},updateSavedVisualizationList:function(t,e){_.getAggregations(e).then(function(e){t.commit("SET_VISUALIZATION_LIST",e.data.objects[0]||[])}).catch(function(t){console.error(t)})},setActiveContext:function(t,e){t.commit("SET_ACTIVE_CONTEXT",e)},clearActiveContext:function(t){t.commit("CLEAR_ACTIVE_CONTEXT")},setSnackBar:function(t,e){t.commit("SET_SNACKBAR",{active:!0,color:e.color,message:e.message,timeout:e.timeout})},updateContextLinks:function(t){_.getContextLinkConfig().then(function(e){t.commit("SET_CONTEXT_LINKS",e.data)}).catch(function(t){console.error(t)})},updateGraphPlugins:function(t){_.getGraphPluginList().then(function(e){t.commit("SET_GRAPH_PLUGINS",e.data)}).catch(function(t){console.error(t)})},updateSavedGraphs:function(t,e){e||(e=t.state.sketch.id),_.getSavedGraphList(e).then(function(e){t.commit("SET_SAVED_GRAPHS",e.data)}).catch(function(t){console.error(t)})},updateAnalyzerList:function(t,e){e||(e=t.state.sketch.id),_.getAnalyzers(e).then(function(e){var i={};void 0!==e.data&&e.data.forEach(function(t){i[t.name]=t}),t.commit("SET_ANALYZER_LIST",i)}).catch(function(t){console.error(t)})},updateActiveAnalyses:function(t,e){t.commit("SET_ACTIVE_ANALYSES",e)},addActiveAnalyses:function(t,e){t.commit("ADD_ACTIVE_ANALYSES",e)},updateAnalyzerResults:function(t,e){t.commit("SET_ANALYZER_RESULTS",e)},enableTimeline:function(t,e){t.commit("ADD_ENABLED_TIMELINES",[e])},disableTimeline:function(t,e){t.commit("REMOVE_ENABLED_TIMELINES",[e])},updateEnabledTimelines:function(t,e){t.commit("SET_ENABLED_TIMELINES",e)},toggleEnabledTimeline:function(t,e){t.commit("TOGGLE_ENABLED_TIMELINE",e)},updateSystemSettings:function(t){return _.getSystemSettings().then(function(e){t.commit("SET_SYSTEM_SETTINGS",e.data)}).catch(function(t){console.error(t)})},updateUserSettings:function(t){return _.getUserSettings().then(function(e){t.commit("SET_USER_SETTINGS",e.data)}).catch(function(t){console.error(t)})}}}),hd=5e3;n["default"].mixin({methods:{successSnackBar:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hd,i={message:t,color:"success",timeout:e};this.$store.dispatch("setSnackBar",i)},errorSnackBar:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hd,i={message:t,color:"error",timeout:e};this.$store.dispatch("setSnackBar",i)},warningSnackBar:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hd,i={message:t,color:"warning",timeout:e};this.$store.dispatch("setSnackBar",i)},infoSnackBar:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,i={message:t,color:"info",timeout:e};this.$store.dispatch("setSnackBar",i)}}});var md=i(64600),vd=i.n(md);i(54301);n["default"].use(vd(),{options:{customProperties:!0}});var pd={theme:{dark:!1},icons:{iconfont:"mdi"}},fd=new(vd())(pd);i(48540),i(33240),i(63105),i(24590),n["default"].use(i(55624)),n["default"].config.productionTip=!1,new n["default"]({router:od,store:dd,vuetify:fd,render:function(t){return t(h)}}).$mount("#app")},91101:function(t,e,i){"use strict";var n=i(74353),s=i.n(n),a=i(83826),r=i.n(a),o=i(6279),l=i.n(o);s().extend(r()),s().extend(l()),e.A=s()},92975:function(t,e,i){"use strict";i.r(e);i(27495),i(25440);e["default"]={name:"formatLabelText",filter:function(t){return"__ts_star"===t||"label : __ts_star"===t?"All starred events":"__ts_comment"===t||"label : __ts_comment"===t?"All commented events":t.replace("__ts_","")}}},93176:function(t,e,i){"use strict";i.r(e);var n=i(91101);e["default"]={name:"shortDateTime",filter:function(t){return n.A.utc(t).format("YYYY-MM-DD HH:mm")}}}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var a=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}i.m=t,function(){var t=[];i.O=function(e,n,s,a){if(!n){var r=1/0;for(u=0;u<t.length;u++){n=t[u][0],s=t[u][1],a=t[u][2];for(var o=!0,l=0;l<n.length;l++)(!1&a||r>=a)&&Object.keys(i.O).every(function(t){return i.O[t](n[l])})?n.splice(l--,1):(o=!1,a<r&&(r=a));if(o){t.splice(u--,1);var c=s();void 0!==c&&(e=c)}}return e}a=a||0;for(var u=t.length;u>0&&t[u-1][2]>a;u--)t[u]=t[u-1];t[u]=[n,s,a]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){i.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){i.j=57}(),function(){var t={57:0};i.O.j=function(e){return 0===t[e]};var e=function(e,n){var s,a,r=n[0],o=n[1],l=n[2],c=0;if(r.some(function(e){return 0!==t[e]})){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);if(l)var u=l(i)}for(e&&e(n);c<r.length;c++)a=r[c],i.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return i.O(u)},n=self["webpackChunktimesketch"]=self["webpackChunktimesketch"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=i.O(void 0,[504],function(){return i(86545)});n=i.O(n)})();
//# sourceMappingURL=index-legacy.18e5be17.js.map