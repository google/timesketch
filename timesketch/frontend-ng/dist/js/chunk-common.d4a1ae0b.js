(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-common"],{0:function(e,t,i){e.exports=i("56d7")},"05a2":function(e,t,i){"use strict";i.r(t),t["default"]={name:"filterChip",filter:function(e){return"label"===e.type?"__ts_star"===e.value?"Starred":"__ts_comment"===e.value?"Commented":e.value:e.field+":"+e.value}}},"09ae":function(e,t,i){},"09ff":function(e,t,i){"use strict";i.r(t);i("6b54");t["default"]={name:"formatTimestamp",filter:function(e){var t=parseInt(e).toString().length;return 13===t?e:(15===t||16===t?e/=1e3:10===t&&(e*=1e6),parseInt(e))}}},"12d0":function(e,t,i){"use strict";i("69da")},"16f1":function(e,t,i){"use strict";i.r(t);i("a481");t["default"]={name:"formatLabelText",filter:function(e){return e.replace("__ts_","")}}},"2d27":function(e,t,i){"use strict";i.r(t);i("7f7f"),i("ac6a");var n=i("2b0e"),s=i("75a6");s.keys().forEach((function(e){var t=s(e),i=t.default.name;n["default"].component(i,t.default||t)}))},"2d9e":function(e,t,i){"use strict";i("71d3")},"35fd":function(e,t,i){"use strict";i("97be")},3884:function(e,t,i){"use strict";i("c7b3")},"3d1d":function(e,t,i){"use strict";i.r(t),t["default"]={name:"compactBytes",filter:function(e){e||(e=0);var t=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.min(Math.floor(Math.log(e)/Math.log(1e3)),t.length-1),n=1*(e/Math.pow(1e3,i)).toFixed(2);return n+t[i]}}},"481e":function(e,t,i){"use strict";i.r(t);var n=i("707c");t["default"]={name:"shortDateTime",filter:function(e){return n["a"].utc(e).format("YYYY-MM-DD HH:mm")}}},"524e":function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("cadf"),i("551c"),i("f751"),i("097d");var n=i("2b0e"),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",{attrs:{id:"app"}},[i("v-main",[i("v-toolbar",{attrs:{flat:"",color:"transparent"}},[e.showLeftPanel?e._e():i("v-btn",{staticClass:"ml-0",attrs:{icon:""},on:{click:function(t){e.showLeftPanel=!0}}},[i("v-icon",[e._v("mdi-menu")])],1),e.isRootPage?i("div",[i("v-avatar",{staticClass:"mt-2 ml-n4"},[i("router-link",{attrs:{to:"/"}},[i("v-img",{attrs:{src:"/dist/timesketch-color.png","max-height":"25","max-width":"25",contain:""}})],1)],1),i("span",{staticStyle:{"font-size":"1.2em"}},[e._v("timesketch")])],1):e._e(),e.activeContext.question?i("div",{staticClass:"ml-2"},[i("strong",[e._v(e._s(e.activeContext.question.display_name))])]):e._e(),i("v-spacer"),i("v-btn",{attrs:{small:"",depressed:""},on:{click:e.switchUI}},[e._v(" Use the old UI ")]),e.isRootPage?e._e():i("v-btn",{staticClass:"ml-2",attrs:{small:"",depressed:"",color:"primary"}},[i("v-icon",{attrs:{small:"",left:""}},[e._v("mdi-account-multiple-plus")]),e._v("\n        Share\n      ")],1),i("v-avatar",{staticClass:"ml-3",attrs:{color:"grey lighten-1",size:"25"}},[i("span",{staticClass:"white--text"},[e._v(e._s(e.currentUser.charAt(0).toUpperCase()))])]),e.isRootPage?e._e():i("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-avatar",[i("v-btn",e._g(e._b({attrs:{small:"",icon:""}},"v-btn",s,!1),n),[i("v-icon",[e._v("mdi-dots-vertical")])],1)],1)]}}],null,!1,1354068383)},[i("v-card",[i("v-list",[i("v-list-item-group",{attrs:{color:"primary"}},[i("v-list-item",{on:{click:e.toggleTheme}},[i("v-list-item-icon",[i("v-icon",[e._v("mdi-brightness-6")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Toggle theme")])],1)],1),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[e._v("mdi-archive")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Archive sketch")])],1)],1),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[e._v("mdi-export")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Export sketch")])],1)],1)],1)],1)],1)],1)],1),i("router-view",{attrs:{"show-left-panel":e.showLeftPanel},on:{hideLeftPanel:function(t){e.showLeftPanel=!1}}})],1)],1)},a=[],r=(i("a481"),i("6b54"),i("ac6a"),i("456d"),{name:"app",data:function(){return{showLeftPanel:!0}},computed:{sketch:function(){return this.$store.state.sketch},currentUser:function(){return this.$store.state.currentUser},isRootPage:function(){return 0===Object.keys(this.sketch).length},activeContext:function(){return this.$store.state.activeContext}},methods:{toggleTheme:function(){this.$vuetify.theme.dark=!this.$vuetify.theme.dark,localStorage.setItem("isDarkTheme",this.$vuetify.theme.dark.toString())},switchUI:function(){window.location.href=window.location.href.replace("/v2/","/")}},mounted:function(){var e=localStorage.getItem("isDarkTheme");e&&(this.$vuetify.theme.dark="true"===e),this.$store.dispatch("resetState",this.sketchId)}}),o=r,c=i("2877"),l=Object(c["a"])(o,s,a,!1,null,null,null),u=l.exports,d=i("8c4f"),h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-container",{attrs:{fluid:"","pa-0":""}},[i("v-sheet",{staticClass:"pa-5",attrs:{color:e.$vuetify.theme.dark?"grey darken-4":"grey lighten-3","min-height":"200"}},[i("h2",[e._v("Start new investigation")]),i("v-row",{staticClass:"mt-5",attrs:{"no-gutters":""}},[i("v-dialog",{attrs:{width:"500"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"mr-5",attrs:{depressed:"",small:"",color:"primary"}},"v-btn",s,!1),n),[e._v(" Blank sketch ")])]}}])},[i("v-card",{staticClass:"pa-3"},[i("h3",[e._v("New sketch")]),i("br"),i("v-text-field",{attrs:{outlined:"",dense:"",placeholder:"Name your sketch"},model:{value:e.sketchForm.name,callback:function(t){e.$set(e.sketchForm,"name",t)},expression:"sketchForm.name"}}),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{disabled:!e.sketchForm.name,color:"primary",text:""},on:{click:function(t){return e.createSketch()}}},[e._v(" Create ")])],1)],1)],1),i("v-divider",{staticClass:"mr-5",attrs:{vertical:""}}),e._l(e.scenarioTemplates,(function(t){return i("v-btn",{key:t.short_name,staticClass:"mr-5",attrs:{depressed:"",small:"",outlined:""}},[e._v("\n          "+e._s(t.display_name)+"\n        ")])}))],2)],1),i("div",{staticClass:"pa-5"},[i("h2",[e._v("Your recent work")]),i("ts-sketch-list")],1)],1)],1)},m=[],v=(i("7f7f"),i("bc3a")),f=i.n(v),p=i("2c4e"),g=f.a.create({baseURL:"/v2/api/v1",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}}),_=f.a.create({baseURL:"/v2/api/v1",responseType:"blob",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}});g.interceptors.response.use((function(e){return e}),(function(e){return"The CSRF token has expired."===e.response.data.message?p["a"].open({message:e.response.data.message,type:"is-white",position:"is-top",actionText:"Refresh",indefinite:!0,onAction:function(){location.reload()}}):(console.error(e.response.data),p["a"].open({message:e.response.data.message,type:"is-white",position:"is-top",actionText:"Close",duration:7e3})),Promise.reject(e)}));var y={getSketchList:function(e,t,i,n){var s={params:{scope:e,page:t,per_page:i,search_query:n}};return g.get("/sketches/",s)},getSketch:function(e){return g.get("/sketches/"+e+"/")},createSketch:function(e){return g.post("/sketches/",e)},deleteSketch:function(e){return g.delete("/sketches/"+e+"/")},archiveSketch:function(e){var t={action:"archive"};return g.post("/sketches/"+e+"/archive/",t)},unArchiveSketch:function(e){var t={action:"unarchive"};return g.post("/sketches/"+e+"/archive/",t)},exportSketch:function(e){var t={action:"export"};return _.post("/sketches/"+e+"/archive/",t)},getSketchAttributes:function(e){return g.get("/sketches/"+e+"/attribute/")},addSketchAttribute:function(e,t,i,n){var s={name:t,values:[i],ontology:n,action:"post"};return g.post("/sketches/"+e+"/attribute/",s)},getSketchTimeline:function(e,t){return g.get("/sketches/"+e+"/timelines/"+t+"/")},getSketchTimelineAnalysis:function(e,t){return g.get("/sketches/"+e+"/timelines/"+t+"/analysis/")},saveSketchTimeline:function(e,t,i,n,s){var a={name:i,description:n,color:s};return g.post("/sketches/"+e+/timelines/+t+"/",a)},saveSketchSummary:function(e,t,i){var n={name:t,description:i};return g.post("/sketches/"+e+"/",n)},deleteSketchTimeline:function(e,t){return g.delete("/sketches/"+e+/timelines/+t+"/")},createEvent:function(e,t,i,n,s,a){var r={date_string:t,message:i,timestamp_desc:n,attributes:s};return g.post("/sketches/"+e+"/event/create/",r,a)},getEvent:function(e,t,i){var n={params:{searchindex_id:t,event_id:i}};return g.get("/sketches/"+e+"/event/",n)},saveEventAnnotation:function(e,t,i,n,s){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r={annotation:i,annotation_type:t,events:n,current_search_node_id:s.id,remove:a};return g.post("/sketches/"+e+"/event/annotate/",r)},tagEvents:function(e,t,i){var n={tag_string:JSON.stringify(i),events:t,verbose:!1};return g.post("/sketches/"+e+"/event/tagging/",n)},updateEventAnnotation:function(e,t,i,n,s){var a={annotation:i,annotation_type:t,events:n,current_search_node_id:s.id};return g.put("/sketches/"+e+"/event/annotate/",a)},deleteEventAnnotation:function(e,t,i,n,s){var a={params:{annotation_id:i,annotation_type:t,event_id:n._id,searchindex_id:n._index,current_search_node_id:s.id}};return g.delete("/sketches/"+e+"/event/annotate/",a)},getStoryList:function(e){return g.get("sketches/"+e+"/stories/")},getStory:function(e,t){return g.get("/sketches/"+e+"/stories/"+t+"/")},createStory:function(e,t,i){var n={title:e,content:t};return g.post("/sketches/"+i+/stories/,n)},updateStory:function(e,t,i,n){var s={title:e,content:t};return g.post("/sketches/"+i+/stories/+n+"/",s)},deleteStory:function(e,t){return g.delete("/sketches/"+e+/stories/+t+"/")},getView:function(e,t){return g.get("/sketches/"+e+"/views/"+t+"/")},createView:function(e,t,i,n){var s={name:t,query:i,filter:n,dsl:""};return g.post("/sketches/"+e+/views/,s)},updateView:function(e,t,i,n){var s={query:i,filter:n};return g.post("/sketches/"+e+/views/+t+"/",s)},deleteView:function(e,t){return g.delete("/sketches/"+e+"/views/"+t+"/")},search:function(e,t){return g.post("/sketches/"+e+"/explore/",t)},exportSearchResult:function(e,t){return _.post("/sketches/"+e+"/explore/",t)},getAggregations:function(e){return g.get("/sketches/"+e+"/aggregation/")},getAggregationGroups:function(e){return g.get("/sketches/"+e+"/aggregation/group/")},runAggregator:function(e,t){return g.post("/sketches/"+e+"/aggregation/explore/",t)},runAggregatorGroup:function(e,t){return g.get("/sketches/"+e+"/aggregation/group/"+t+"/")},saveAggregation:function(e,t,i,n){var s={name:i,description:t.description,agg_type:t.name,chart_type:n["supported_charts"],parameters:n};return g.post("/sketches/"+e+"/aggregation/",s)},countSketchEvents:function(e){return g.get("/sketches/"+e+"/count/")},uploadTimeline:function(e,t){return g.post("/upload/",e,t)},getSessions:function(e,t){return g.get("/sketches/"+e+"/explore/sessions/"+t+"/")},getUsers:function(){return g.get("/users/")},getGroups:function(){return g.get("/groups/")},editCollaborators:function(e,t,i,n,s,a){var r={public:t,users:i,groups:n,remove_users:s,remove_groups:a};return g.post("/sketches/"+e+/collaborators/,r)},getAnalyzers:function(e){return g.get("/sketches/"+e+"/analyzer/")},runAnalyzers:function(e,t,i){var n={timeline_ids:t,analyzer_names:i};return g.post("/sketches/"+e+/analyzer/,n)},getAnalyzerSession:function(e,t){return g.get("/sketches/"+e+"/analyzer/sessions/"+t+"/")},getActiveAnalyzerSessions:function(e){return g.get("/sketches/"+e+"/analyzer/sessions/active/")},getLoggedInUser:function(){return g.get("/users/me/")},generateGraphFromPlugin:function(e,t,i,n,s){var a={plugin:t,config:{filter:{indices:i,timelineIds:n}},refresh:s};return n.length&&(a["timeline_ids"]=n),g.post("/sketches/"+e+/graph/,a)},getGraphPluginList:function(){return g.get("/graphs/")},saveGraph:function(e,t,i){var n={name:t,elements:i};return g.post("/sketches/"+e+/graphs/,n)},getSavedGraphList:function(e){return g.get("/sketches/"+e+/graphs/)},getSavedGraph:function(e,t){var i={params:{format:"cytoscape"}};return g.get("/sketches/"+e+/graphs/+t+"/",i)},getSearchHistory:function(e){return g.get("/sketches/"+e+/searchhistory/)},getSearchHistoryTree:function(e){return g.get("/sketches/"+e+/searchhistorytree/)},getSigmaList:function(){return g.get("/sigma/")},getSigmaResource:function(e){return g.get("/sigma/rule/"+e+"/")},getSigmaByText:function(e){var t={content:e};return g.post("/sigma/text/",t)},getSearchTemplates:function(){return g.get("/searchtemplate/")},parseSearchTemplate:function(e,t){return g.post("/searchtemplate/"+e+"/parse/",t)},getScenarios:function(){return g.get("/scenarios/")},getSketchScenarios:function(e){return g.get("/sketches/"+e+"/scenarios/")},addScenario:function(e,t){var i={scenario_name:t};return g.post("/sketches/"+e+"/scenarios/",i)}},S=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-row",{staticClass:"mt-5",attrs:{"no-gutters":""}},[i("v-text-field",{attrs:{outlined:"",flat:"",dense:"","hide-details":"","single-line":"",label:"Search","prepend-inner-icon":"mdi-magnify"},on:{change:e.search}}),i("v-spacer"),i("v-btn-toggle",{attrs:{dense:"",group:""},model:{value:e.toggleStateButton,callback:function(t){e.toggleStateButton=t},expression:"toggleStateButton"}},[i("v-btn",{on:{click:function(t){return e.switchScope("recent")}}},[e._v(" Recent ")]),i("v-btn",{on:{click:function(t){return e.switchScope("user")}}},[e._v(" My sketches ")]),i("v-btn",{on:{click:function(t){return e.switchScope("shared")}}},[e._v(" Shared with me ")])],1)],1),i("br"),i("v-data-table",{attrs:{headers:e.headers,items:e.sketches,"items-per-page":15,options:e.options,"server-items-length":e.numSketches,"footer-props":{"items-per-page-options":[15,30,40,50,100]},"disable-filtering":"","disable-sort":"",loading:e.loading},on:{"update:options":function(t){e.options=t}},scopedSlots:e._u([{key:"item.name",fn:function(t){var n=t.item;return[i("router-link",{staticStyle:{"text-decoration":"none"},attrs:{to:{name:"Overview",params:{sketchId:n.id}}}},[e._v(e._s(n.name))])]}},{key:"item.created_at",fn:function(t){var n=t.item;return[e._v("\n      "+e._s(e._f("shortDateTime")(n.created_at))+" "),i("small",[e._v("("+e._s(e._f("timeSince")(n.created_at))+")")])]}},{key:"item.last_activity",fn:function(t){var i=t.item;return[e._v("\n      "+e._s(e._f("timeSince")(i.last_activity))+"\n    ")]}}])})],1)},b=[],k={data:function(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Creator",value:"user"},{text:"Created at",value:"created_at"},{text:"Last active",value:"last_activity"}],sketches:[],numSketches:0,options:{},loading:!1,toggleStateButton:0,scope:"recent",searchQuery:null}},watch:{options:{handler:function(){this.getSketches()},deep:!0}},methods:{search:function(e){this.scope="search",this.searchQuery=e,this.getSketches()},switchScope:function(e){this.scope=e,this.getSketches()},getSketches:function(){var e=this;this.loading=!0,y.getSketchList(this.scope,this.options.page,this.options.itemsPerPage,this.searchQuery).then((function(t){e.sketches=t.data.objects,e.numSketches=t.data.meta.total_items,e.loading=!1})).catch((function(t){e.loading=!1,console.error(t)}))}}},x=k,w=Object(c["a"])(x,S,b,!1,null,"6f2c2155",null),C=w.exports,T={components:{TsSketchList:C},data:function(){return{sketchForm:{name:""},scenarioTemplates:[]}},methods:{clearFormData:function(){this.sketchForm.name=""},createSketch:function(){var e=this;y.createSketch(this.sketchForm).then((function(t){var i=t.data.objects[0].id;e.clearFormData(),e.$router.push({name:"Overview",params:{sketchId:i}})})).catch((function(e){}))}},created:function(){var e=this;this.$store.dispatch("resetState"),document.title="Timesketch",y.getScenarios().then((function(t){e.scenarioTemplates=t.data["objects"]})).catch((function(e){}))}},E=T,F=Object(c["a"])(E,h,m,!1,null,null,null),$=F.exports,D=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{attrs:{fluid:""}},[e.showRightSidePanel?i("v-navigation-drawer",{staticStyle:{"box-shadow":"0 10px 15px -3px #888"},attrs:{fixed:"",right:"",width:"600"},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("v-toolbar",{attrs:{flat:""}},[i("v-toolbar-title",[e._v("Right Side Panel")]),i("v-spacer"),i("v-btn",{attrs:{icon:""},on:{click:function(t){e.showRightSidePanel=!1}}},[i("v-icon",[e._v("mdi-close")])],1)],1)]},proxy:!0}],null,!1,1533655335)},[i("v-container",[e._v(" TODO: Add content here ")])],1):e._e(),i("v-card",{staticClass:"pa-3 pt-0 mt-n3",attrs:{flat:"",color:"transparent"}},[i("v-card",{staticClass:"d-flex align-start mb-1",attrs:{outlined:""}},[i("v-sheet",{staticClass:"mt-2"},[i("ts-search-history-buttons",{on:{toggleSearchHistory:function(t){return e.toggleSearchHistory()}}})],1),i("v-menu",{attrs:{"offset-y":"",attach:"","close-on-content-click":!1,"close-on-click":!0},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-text-field",e._g(e._b({ref:"searchInput",staticClass:"pa-1",attrs:{"hide-details":"",label:"Search",placeholder:"Search","single-line":"",dense:"",filled:"",flat:"",solo:"","append-icon":"mdi-magnify",id:"tsSearchInput"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)},click:function(t){e.showSearchDropdown=!0}},model:{value:e.currentQueryString,callback:function(t){e.currentQueryString=t},expression:"currentQueryString"}},"v-text-field",s,!1),n))]}}]),model:{value:e.showSearchDropdown,callback:function(t){e.showSearchDropdown=t},expression:"showSearchDropdown"}},[i("ts-search-dropdown",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.onClickOutside,expression:"onClickOutside"}],attrs:{"selected-labels":e.selectedLabels,"query-string":e.currentQueryString},on:{setActiveView:e.searchView,addChip:e.addChip,updateLabelChips:function(t){return e.updateLabelChips()},"close-on-click":function(t){e.showSearchDropdown=!1},"node-click":e.jumpInHistory,setQueryAndFilter:e.setQueryAndFilter}})],1)],1),i("v-sheet",{staticClass:"mb-4 mt-4",attrs:{color:"transparent"}},[i("ts-timeline-picker",{attrs:{"current-query-filter":e.currentQueryFilter,"count-per-index":e.eventList.meta.count_per_index,"count-per-timeline":e.eventList.meta.count_per_timeline},on:{updateSelectedTimelines:function(t){return e.updateSelectedTimelines(t)}}}),i("span",{staticStyle:{position:"relative",top:"-5px"}},[i("ts-upload-timeline-form")],1),i("span",{staticStyle:{position:"relative",top:"-5px"}},[i("v-dialog",{attrs:{width:"600"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({attrs:{small:"",text:"",rounded:"",color:"primary"}},"v-btn",s,!1),n),[i("v-icon",{attrs:{left:"",small:""}},[e._v(" mdi-plus ")]),e._v("\n              Add manual event\n            ")],1)]}}]),model:{value:e.addManualEvent,callback:function(t){e.addManualEvent=t},expression:"addManualEvent"}},[i("ts-add-manual-event",{attrs:{app:"",datetimeProp:e.datetimeManualEvent},on:{cancel:function(t){e.addManualEvent=!1}}})],1)],1)],1),i("div",{staticClass:"mt-n3"},[e._l(e.timeFilterChips,(function(t,n){return i("span",{key:n+t.value},[i("v-menu",{attrs:{"offset-y":"","content-class":"menu-with-gap"},scopedSlots:e._u([{key:"activator",fn:function(n){var s=n.on;return[i("v-chip",e._g({attrs:{outlined:""}},s),[i("v-icon",{attrs:{left:"",small:""}},[e._v(" mdi-clock-outline ")]),i("span",{style:[t.active?"":{"text-decoration":"line-through",opacity:"50%"}]},[i("span",[e._v(e._s(t.value.split(",")[0]))]),"datetime_range"===t.type&&t.value.split(",")[0]!==t.value.split(",")[1]?i("span",[e._v("\n                  â†’ "+e._s(t.value.split(",")[1]))]):e._e()])],1)]}}],null,!0)},[i("v-card",[i("v-list",[i("v-list-item",[i("v-list-item-action",[i("v-icon",[e._v("mdi-square-edit-outline")])],1),i("v-list-item-subtitle",[e._v("Edit filter")])],1),i("v-list-item",{on:{click:function(i){return e.toggleChip(t)}}},[i("v-list-item-action",[t.active?i("v-icon",[e._v("mdi-eye-off")]):i("v-icon",[e._v("mdi-eye")])],1),i("v-list-item-subtitle",[t.active?i("span",[e._v("Temporarily disable")]):i("span",[e._v("Re-enable")])])],1),i("v-list-item",{on:{click:function(i){return e.removeChip(t)}}},[i("v-list-item-action",[i("v-icon",[e._v("mdi-delete")])],1),i("v-list-item-subtitle",[e._v("Remove filter")])],1)],1)],1)],1),n+1<e.timeFilterChips.length?i("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"2px"},attrs:{icon:"",small:""}},[e._v("OR")]):e._e()],1)})),i("span",[i("v-menu",{staticStyle:{overflow:"visible"},attrs:{"offset-y":"","close-on-content-click":!1,"close-on-click":!0,"content-class":"menu-with-gap","allow-overflow":""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({attrs:{small:"",text:"",rounded:"",color:"primary"}},"v-btn",s,!1),n),[i("v-icon",{attrs:{left:"",small:""}},[e._v(" mdi-plus ")]),e._v("\n              Add timefilter\n            ")],1)]}}]),model:{value:e.timeFilterMenu,callback:function(t){e.timeFilterMenu=t},expression:"timeFilterMenu"}},[i("ts-filter-menu",{attrs:{app:""},on:{cancel:function(t){e.timeFilterMenu=!1},addChip:e.addChip}})],1)],1)],2),e.filterChips.length?i("div",[i("v-chip-group",e._l(e.filterChips,(function(t,n){return i("span",{key:n+t.value},[i("v-chip",[e._v("\n            "+e._s(e._f("formatLabelText")(t.value))+"\n          ")]),n+1<e.timeFilterChips.length?i("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"2px"},attrs:{icon:"",small:""}},[e._v("AND")]):e._e()],1)})),0)],1):e._e()],1),i("v-card",{directives:[{name:"show",rawName:"v-show",value:e.showSearchHistory,expression:"showSearchHistory"}],staticClass:"pa-3 mt-3",attrs:{outlined:""}},[i("v-toolbar",{attrs:{elevation:"0",dense:""}},[i("v-toolbar-title",[e._v("Search history")]),i("v-spacer"),i("v-slider",{staticClass:"mt-6",attrs:{"thumb-label":"",ticks:"","append-icon":"mdi-magnify-plus-outline","prepend-icon":"mdi-magnify-minus-outline",min:"0.1",max:"1",step:"0.1"},scopedSlots:e._u([{key:"thumb-label",fn:function(t){var i=t.value;return[e._v(" "+e._s(100*i)+"% ")]}}]),model:{value:e.zoomLevel,callback:function(t){e.zoomLevel=t},expression:"zoomLevel"}}),i("v-btn",{staticClass:"ml-4",attrs:{icon:""},on:{click:function(t){e.showSearchHistory=!1}}},[i("v-icon",[e._v("mdi-close")])],1)],1),i("div",{directives:[{name:"dragscroll",rawName:"v-dragscroll"}],staticClass:"pa-md-4 no-scrollbars",staticStyle:{overflow:"scroll","white-space":"nowrap","max-height":"500px","min-height":"500px"}},[i("ts-search-history-tree",{staticStyle:{"transform-origin":"top left"},style:{transform:"scale("+e.zoomLevel+")"},attrs:{"show-history":e.showSearchHistory},on:{"node-click":e.jumpInHistory}})],1)],1),(e.eventList.objects.length||e.searchInProgress)&&this.currentQueryFilter.indices.length?e._e():i("v-card",{staticClass:"pa-3 mt-3 mx-3",attrs:{outlined:""}},[i("p",[e._v("\n      Your search "),e.currentQueryString?i("span",[e._v('"'+e._s(e.currentQueryString)+'"')]):e._e(),e._v(" did not match any events.\n    ")]),i("p",[e._v("Suggestions:")]),i("li",[e._v("Try different keywords.")]),i("li",[e._v("Try more general keywords.")]),i("li",[e._v("Try fewer keywords.")])]),e.eventList.objects.length||e.searchInProgress&&this.currentQueryFilter.indices.length?i("v-card",{staticClass:"mt-3",attrs:{flat:""}},[i("v-data-table",{attrs:{headers:e.headers,items:e.eventList.objects,"footer-props":{"items-per-page-options":[10,40,80,100,200,500],"show-current-page":!0},loading:e.searchInProgress,options:e.tableOptions,"server-items-length":e.totalHits,"item-key":"_id","loading-text":"Searching... Please wait","show-select":"","disable-filtering":"","disable-sort":"",expanded:e.expandedRows,dense:e.displayOptions.isCompact,"fixed-header":""},on:{"update:options":function(t){e.tableOptions=t}},scopedSlots:e._u([{key:"top",fn:function(t){var n=t.pagination,s=t.options,a=t.updateOptions;return[i("v-toolbar",{attrs:{dense:"",flat:""}},[i("div",[i("span",{staticClass:"mr-2"},[i("small",[e._v(e._s(e.fromEvent)+"-"+e._s(e.toEvent)+" of "+e._s(e.totalHits)+" events ("+e._s(e.totalTime)+"s)")])]),i("v-dialog",{attrs:{width:"500"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",s,!1),n),[i("v-icon",[e._v("mdi-content-save-outline")])],1)]}}],null,!0),model:{value:e.saveSearchMenu,callback:function(t){e.saveSearchMenu=t},expression:"saveSearchMenu"}},[i("v-card",[i("v-card-title",[e._v(" Save Search ")]),i("v-card-text",[i("v-text-field",{attrs:{required:"",placeholder:"Name your saved search"},model:{value:e.saveSearchFormName,callback:function(t){e.saveSearchFormName=t},expression:"saveSearchFormName"}})],1),i("v-divider"),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.saveSearchMenu=!1}}},[e._v(" Cancel ")]),i("v-btn",{attrs:{color:"primary",text:"",disabled:!e.saveSearchFormName},on:{click:e.saveSearch}},[e._v(" Save ")])],1)],1)],1),i("v-btn",{attrs:{icon:""},on:{click:function(t){e.showHistogram=!e.showHistogram}}},[i("v-icon",[e._v("mdi-chart-bar")])],1),i("v-dialog",{attrs:{"max-width":"500px",scrollable:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",s,!1),n),[i("v-icon",[e._v("mdi-view-column-outline")])],1)]}}],null,!0),model:{value:e.columnDialog,callback:function(t){e.columnDialog=t},expression:"columnDialog"}},[i("v-card",{attrs:{height:"50vh"}},[i("v-card-title",[e._v("Select columns")]),i("v-card-text",[i("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchColumns,callback:function(t){e.searchColumns=t},expression:"searchColumns"}}),i("br"),i("v-data-table",{attrs:{headers:e.columnHeaders,items:e.meta.mappings,search:e.searchColumns,"hide-default-footer":!0,"item-key":"field","disable-pagination":"","show-select":"",dense:""},on:{input:e.updateSelectedFields},model:{value:e.selectedFields,callback:function(t){e.selectedFields=t},expression:"selectedFields"}})],1),i("v-divider"),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.selectedFields=[{field:"message",type:"text"}]}}},[e._v("\n                    Reset\n                  ")]),i("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.columnDialog=!1}}},[e._v(" Close ")])],1)],1)],1),i("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",s,!1),n),[i("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!0)},[i("v-card",{staticClass:"mx-auto",attrs:{outlined:"","max-width":"475"}},[i("v-list",{attrs:{subheader:"","two-line":"",flat:"",dense:""}},[i("v-subheader",[e._v("Density")]),i("v-list-item-group",[i("v-list-item",{attrs:{ripple:!1}},[[i("v-list-item-action",[i("v-radio-group",{model:{value:e.displayOptions.isCompact,callback:function(t){e.$set(e.displayOptions,"isCompact",t)},expression:"displayOptions.isCompact"}},[i("v-radio",{attrs:{value:!1}})],1)],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Comfortable")]),i("v-list-item-subtitle",[e._v("More space between rows")])],1)]],2),i("v-list-item",{attrs:{ripple:!1}},[[i("v-list-item-action",[i("v-radio-group",{model:{value:e.displayOptions.isCompact,callback:function(t){e.$set(e.displayOptions,"isCompact",t)},expression:"displayOptions.isCompact"}},[i("v-radio",{attrs:{value:!0}})],1)],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Compact")]),i("v-list-item-subtitle",[e._v("Less space between rows")])],1)]],2)],1),i("v-divider"),i("v-list",{attrs:{subheader:"","two-line":"",flat:""}},[i("v-subheader",[e._v("Misc")]),i("v-list-item-group",[i("v-list-item",{attrs:{ripple:!1}},[i("v-list-item-action",[i("v-switch",{attrs:{dense:"",color:""},model:{value:e.displayOptions.showTags,callback:function(t){e.$set(e.displayOptions,"showTags",t)},expression:"displayOptions.showTags"}})],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Tags")]),i("v-list-item-subtitle",[e._v("Show tags")])],1)],1)],1),i("v-list-item-group",[i("v-list-item",{attrs:{ripple:!1}},[i("v-list-item-action",[i("v-switch",{attrs:{dense:""},model:{value:e.displayOptions.showEmojis,callback:function(t){e.$set(e.displayOptions,"showEmojis",t)},expression:"displayOptions.showEmojis"}})],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Emojis")]),i("v-list-item-subtitle",[e._v("Show emojis")])],1)],1)],1),i("v-list-item-group",[i("v-list-item",{attrs:{ripple:!1}},[i("v-list-item-action",[i("v-switch",{attrs:{dense:""},model:{value:e.displayOptions.showTimelineName,callback:function(t){e.$set(e.displayOptions,"showTimelineName",t)},expression:"displayOptions.showTimelineName"}})],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Timeline name")]),i("v-list-item-subtitle",[e._v("Show timeline name")])],1)],1)],1)],1)],1)],1)],1)],1),i("v-spacer"),i("v-data-footer",{staticClass:"mr-n3",staticStyle:{border:"0"},attrs:{pagination:n,options:s,"show-current-page":!0,"items-per-page-options":[10,40,80,100,200,500],"items-per-page-text":"Rows per page:"},on:{"update:options":a}})],1),e.showHistogram?i("v-card",{staticClass:"pa-2",attrs:{outlined:""}},[i("ts-bar-chart",{attrs:{"chart-data":e.eventList.meta.count_over_time},on:{addChip:function(t){return e.addChipFromHistogram(t)}}})],1):e._e()]}},{key:"expanded-item",fn:function(t){var n=t.headers,s=t.item;return[i("td",{attrs:{colspan:n.length}},[s.showDetails?i("v-container",{staticClass:"mt-4",attrs:{fluid:""}},[i("ts-event-detail",{attrs:{event:s}})],1):e._e(),s.showDetails&&s.deltaDays?i("v-divider"):e._e(),s.deltaDays>0?i("div",{staticClass:"ml-16"},[i("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color",style:e.getTimeBubbleColor(s)}),i("div",{staticClass:"ts-time-bubble ts-time-bubble-color",style:e.getTimeBubbleColor(s)},[i("h5",[i("b",[e._v(e._s(e._f("compactNumber")(s.deltaDays)))]),e._v(" days\n              ")])]),i("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color",style:e.getTimeBubbleColor(s)})]):e._e()],1)]}},{key:"item._source.timestamp",fn:function(t){var n=t.item;return[i("div",{staticClass:"datetime-table-cell",style:e.getTimelineColor(n)},[e._v("\n          "+e._s(e._f("toISO8601")(e._f("formatTimestamp")(n._source.timestamp)))+"\n        ")])]}},{key:"item.actions",fn:function(t){var n=t.item;return[i("v-btn",{attrs:{small:"",icon:""},on:{click:function(t){return e.toggleStar(n)}}},[n._source.label.includes("__ts_star")?i("v-icon",{attrs:{color:"amber"}},[e._v("mdi-star")]):i("v-icon",[e._v("mdi-star-outline")])],1),i("ts-event-tag-menu",{attrs:{event:n}})]}},e._l(e.headers,(function(t,n){return{key:e.getFieldName(t.text),fn:function(s){var a=s.item;return[i("span",{key:t.text,staticClass:"ts-event-field-container",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.toggleDetailedEvent(a)}}},[i("span",{class:{"ts-event-field-ellipsis":"message"===t.text}},[e.displayOptions.showTags&&3===n?i("span",[e._l(a._source.tag,(function(t){return i("v-chip",{key:t,staticClass:"mr-2",attrs:{small:"",color:e.tagColor(t).color,"text-color":e.tagColor(t).textColor}},[t in e.tagConfig?i("v-icon",{attrs:{left:"",small:""}},[e._v(e._s(e.tagConfig[t].label))]):e._e(),e._v("\n                "+e._s(t))],1)})),e._l(a._source.label,(function(t){return i("span",{key:t},[t.startsWith("__ts")?e._e():i("v-chip",{staticClass:"mr-2",attrs:{small:"",outlined:""}},[e._v("\n                  "+e._s(t)+"\n                ")])],1)}))],2):e._e(),e.displayOptions.showEmojis&&0===n?i("span",e._l(a._source.__ts_emojis,(function(t){return i("span",{key:t,staticClass:"mr-2",attrs:{title:e.meta.emojis[t]},domProps:{innerHTML:e._s(t)}},[e._v(e._s(t)+"\n              ")])})),0):e._e(),i("span",[e._v(e._s(a._source[t.text]))])])])]}}})),{key:"item.timeline_name",fn:function(t){var n=t.item;return[i("v-chip",{staticStyle:{"margin-top":"1px","margin-bottom":"1px","font-size":"0.8em"},attrs:{label:""}},[i("span",{staticClass:"timeline-name-ellipsis",staticStyle:{width:"130px","text-align":"center"}},[e._v(e._s(e.getTimeline(n).name))])])]}},{key:"item._source.comment",fn:function(t){var n=t.item;return[n._source.comment.length?i("v-badge",{attrs:{"offset-y":16,bordered:"",content:n._source.comment.length}},[i("v-icon",{on:{click:function(t){return e.toggleDetailedEvent(n)}}},[e._v(" mdi-comment-text-multiple-outline ")])],1):e._e()]}}],null,!0),model:{value:e.selectedEvents,callback:function(t){e.selectedEvents=t},expression:"selectedEvents"}})],1):e._e()],1)},O=[],N=(i("6762"),i("2fdb"),i("386d"),i("7514"),i("20d6"),i("f559"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return Object.keys(e.treeData).length>0?i("ul",{staticClass:"tree"},[i("tree-node",{attrs:{node:e.treeData,"handle-click":e.handleClick,"selected-node":e.selectedNode}})],1):e._e()}),P=[],A=i("7618"),L=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",[i("span",{class:[{active:e.isSelected},{star:e.hasStar&&!e.isSelected},{dimmed:0===e.count&&!e.isSelected}],staticStyle:{"min-width":"205px"},attrs:{id:e.node.id},on:{click:function(t){return e.handleClick(e.node)}}},[e.hasStar?i("i",{staticClass:"fas fa-star",staticStyle:{float:"left",color:"#ffd700","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"#777777","margin-right":"10px","margin-top":"3px"}}):e._e(),e.hasStar?i("v-icon",{staticStyle:{float:"left",color:"#333","margin-right":"10px"}},[e._v(" mdi-star ")]):e._e(),e.hasComment?i("v-icon",{staticStyle:{float:"left","margin-right":"10px"}},[e._v("mdi-comment")]):e._e(),e.hasLabel?i("v-icon",{staticClass:"fas fa-tag",staticStyle:{float:"left","margin-right":"10px"}},[e._v("mdi-label")]):e._e(),i("div",{staticClass:"query-string",class:[{"query-string-active":e.isSelected}],staticStyle:{float:"left"}},[e._v("\n      "+e._s(e.node.query_string)+"\n    ")]),i("div",{staticClass:"tag is-light",staticStyle:{"margin-left":"10px","margin-right":"-5px",float:"right"}},[e._v("\n      "+e._s(e._f("compactNumber")(e.count))+"\n    ")])],1),e.node.children&&e.node.children.length?i("ul",e._l(e.node.children,(function(t){return i("node",{key:t.id,attrs:{node:t,"handle-click":e.handleClick,"selected-node":e.selectedNode}})})),1):e._e()])},j=[],Q={name:"node",props:{node:Object,handleClick:Function,selectedNode:Object},computed:{hasStar:function(){return this.node.labels.includes("__ts_star")},hasLabel:function(){return this.node.labels.includes("__ts_label")},hasComment:function(){return this.node.labels.includes("__ts_comment")},isSelected:function(){return this.selectedNode.id===this.node.id},count:function(){return this.node.query_result_count||0}}},I=Q,M=(i("3884"),Object(c["a"])(I,L,j,!1,null,"1623aa42",null)),R=M.exports;function H(e,t,i){if(e.hasOwnProperty(t)&&!0===i(t,e[t]))return e;for(var n=0;n<Object.keys(e).length;n++){var s=e[Object.keys(e)[n]];if("object"===Object(A["a"])(s)&&null!=s){var a=H(s,t,i);if(null!=a)return a}}return null}var q={components:{TreeNode:R},data:function(){return{treeData:{},selectedNode:null,initialNode:null}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{handleClick:function(e){this.$emit("node-click",e),this.selectedNode=e},handleClickFromDropdown:function(e){var t;t="number"===typeof e?e:e.id;var i=H(this.treeData,"id",(function(e,i){return i===t}));this.$emit("node-click",i),this.selectedNode=i},createBranch:function(e){if(this.selectedNode){if(this.selectedNode.id===e.id)return;return this.selectedNode.children.push(e),void(this.selectedNode=e)}this.fetchHistory();var t=H(this.treeData,"id",(function(t,i){return i===e.parent}));if(t){if(t.children.some((function(t){return t.id===e.id})))return;return t.children.push(e),void(this.selectedNode=e)}var i=H(this.treeData,"id",(function(t,i){return i===e.id}));i&&(this.selectedNode=i)},annotateNode:function(e){e.searchNode.labels.includes(e.type)||e.searchNode.labels.push(e.type)},scrollTo:function(){this.$nextTick((function(){document.getElementById(this.selectedNode.id.toString()).scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}))},fetchHistory:function(){var e=this;y.getSearchHistoryTree(this.sketch.id).then((function(t){if(e.treeData=t.data.objects[0],!e.selectedNode){var i=t.data.meta["last_node_id"];e.selectedNode=H(e.treeData,"id",(function(e,t){return t===i}))}})).catch((function(e){}))}},beforeDestroy:function(){_n.$off("createBranch"),_n.$off("eventAnnotated"),_n.$off("triggerScrollTo"),_n.$off("selected-node-from-dropdown")},created:function(){_n.$on("createBranch",this.createBranch),_n.$on("eventAnnotated",this.annotateNode),_n.$on("triggerScrollTo",this.scrollTo),_n.$on("selected-node-from-dropdown",this.handleClickFromDropdown),this.fetchHistory()},watch:{selectedNode:function(){this.$store.dispatch("updateSearchNode",this.selectedNode),this.scrollTo()}}},z=q,B=Object(c["a"])(z,N,P,!1,null,null,null),V=B.exports,U=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:"",disabled:!e.hasParent},on:{click:e.searchHistoryBack}},"v-btn",s,!1),n),[i("v-icon",[e._v("mdi-arrow-left")])],1)]}}])},[i("span",[e._v("Click to go back")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:"",disabled:!e.hasChild},on:{click:e.searchHistoryForward}},"v-btn",s,!1),n),[i("v-icon",[e._v("mdi-arrow-right")])],1)]}}])},[i("span",[e._v("Click to go forward")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:""},on:{click:function(t){return e.$emit("toggleSearchHistory")}}},"v-btn",s,!1),n),[i("v-icon",[e._v("mdi-history")])],1)]}}])},[i("span",[e._v("Click to see your search history")])])],1)},Y=[],J={computed:{currentSearchNode:function(){return this.$store.state.currentSearchNode},hasParent:function(){return!!this.currentSearchNode&&"number"===typeof this.currentSearchNode.parent},hasChild:function(){return!!this.currentSearchNode&&this.currentSearchNode.children.length}},methods:{searchHistoryBack:function(){_n.$emit("selected-node-from-dropdown",this.currentSearchNode.parent)},searchHistoryForward:function(){if(this.currentSearchNode.children.length){var e=this.currentSearchNode.children.slice(-1).pop();_n.$emit("selected-node-from-dropdown",e)}}}},X=J,G=(i("35fd"),Object(c["a"])(X,U,Y,!1,null,"6d090d22",null)),W=G.exports,K=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{staticStyle:{overflow:"hidden"},attrs:{outlined:"",height:"550"}},[i("v-container",{staticClass:"ma-0",attrs:{fluid:""}},[i("v-row",[i("v-col",{attrs:{cols:"4"}},[i("h5",{staticClass:"mt-3 ml-4"},[e._v("Data types")]),i("v-list",{staticClass:"overflow-y-auto",class:e.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},e._l(e.matches.dataTypes,(function(t){return i("v-list-item",{key:t.data_type,staticStyle:{"font-size":"0.9em"},on:{click:function(i){return e.searchForDataType(t.data_type)}}},[i("v-list-item-content",[i("span",[e._v(e._s(t.data_type)+"\n                "),i("span",{staticClass:"font-weight-bold",staticStyle:{"font-size":"0.8em"}},[e._v("("+e._s(e._f("compactNumber")(t.count))+")")])])])],1)})),1)],1),i("v-divider",{attrs:{vertical:""}}),i("v-col",{attrs:{cols:"4"}},[i("h5",{staticClass:"mt-3 ml-5"},[e._v("Tags")]),i("v-list",{staticClass:"overflow-y-auto",class:e.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},[e._l(e.matches.labels,(function(t){return i("v-list-item",{key:t.label,staticStyle:{"font-size":"0.9em"},on:{click:function(i){return e.searchForLabel(t.label)}}},["__ts_star"===t.label?i("v-icon",{attrs:{left:"",small:"",color:"amber"}},[e._v("mdi-star")]):e._e(),"__ts_comment"===t.label?i("v-icon",{attrs:{left:"",small:""}},[e._v("mdi-comment-multiple-outline")]):e._e(),i("v-list-item-content",[i("span",[e._v(e._s(e._f("formatLabelText")(t.label))+"\n                "),i("span",{staticClass:"font-weight-bold",staticStyle:{"font-size":"0.8em"}},[e._v("("+e._s(e._f("compactNumber")(t.count))+")")])])])],1)})),e._l(e.matches.tags,(function(t){return i("v-list-item",{key:t.tag,staticStyle:{"font-size":"0.9em"},on:{click:function(i){return e.searchForTag(t.tag)}}},[i("v-list-item-content",[i("span",[e._v(e._s(t.tag)+"\n                "),i("span",{staticClass:"font-weight-bold",staticStyle:{"font-size":"0.8em"}},[e._v("("+e._s(e._f("compactNumber")(t.count))+")")])])])],1)}))],2)],1),i("v-divider",{attrs:{vertical:""}}),e.matches.savedSearches.length?i("v-col",{attrs:{cols:"4"}},[i("h5",{staticClass:"mt-3 ml-4"},[e._v("Saved searches")]),i("v-list",{staticClass:"overflow-y-auto",class:e.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},e._l(e.matches.savedSearches,(function(t){return i("v-list-item",{key:t.id,staticStyle:{"font-size":"0.9em"},on:{click:function(i){return e.$emit("setActiveView",t)}}},[i("v-list-item-content",[e._v("\n              "+e._s(t.name)+"\n            ")])],1)})),1)],1):e._e()],1)],1)],1)},Z=[],ee=(i("8615"),function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}}),te={props:["selectedLabels","queryString"],computed:{meta:function(){return this.$store.state.meta},searchHistory:function(){return this.$store.state.searchHistory},tags:function(){return this.$store.state.tags},dataTypes:function(){return this.$store.state.dataTypes},all:function(){return{fields:this.meta.mappings,tags:this.tags,labels:this.meta.filter_labels,dataTypes:this.dataTypes,savedSearches:this.meta.views}},scrollbarTheme:function(){return this.$vuetify.theme.dark?"dark":"light"},matches:function(){var e=this,t={};return this.queryString?(t["fields"]=this.meta.mappings.filter((function(t){return t.field.toLowerCase().includes(e.queryString.toLowerCase())})),t["tags"]=this.tags.filter((function(t){return t.tag.toLowerCase().includes(e.queryString.toLowerCase())})),t["labels"]=this.meta.filter_labels.filter((function(t){return t.label.toLowerCase().includes(e.queryString.toLowerCase())})),t["dataTypes"]=this.dataTypes.filter((function(t){return t.data_type.toLowerCase().includes(e.queryString.toLowerCase())})),t["savedSearches"]=this.meta.views.filter((function(t){return t.name.toLowerCase().includes(e.queryString.toLowerCase())})),Object.values(t).filter((function(e){return e.length})).length?t:this.all):this.all}},methods:{searchForLabel:function(e){var t={doSearch:!0,queryString:"*"};t.queryFilter=ee();var i={field:"",value:e,type:"label",operator:"must",active:!0};t.queryFilter.chips.push(i),this.$emit("setQueryAndFilter",t)},searchForTag:function(e){var t={doSearch:!0};t.queryString="tag:"+e,t.queryFilter=ee(),this.$emit("setQueryAndFilter",t)},searchForDataType:function(e){var t={doSearch:!0};t.queryString='data_type:"'+e+'"',t.queryFilter=ee(),this.$emit("setQueryAndFilter",t)},searchForField:function(e){var t={},i="";""!==this.queryString&&(i=this.queryString+" "),this.queryString.includes(" ")||(i=""),t.doSearch=!1,t.queryString=i+e+":",t.queryFilter=ee(),this.$emit("setQueryAndFilter",t)}}},ie=te,ne=(i("97f2"),Object(c["a"])(ie,K,Z,!1,null,"19b74348",null)),se=ne.exports,ae=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("apexchart",{attrs:{height:"250",options:e.options,series:e.series}})],1)},re=[],oe=(i("28a5"),i("ffc1"),i("1321")),ce=i.n(oe),le={props:["chartData"],components:{Apexchart:ce.a},data:function(){var e=this;return{options:{chart:{type:"bar",zoom:{enabled:!0,type:"x",autoScaleYaxis:!0},foreColor:"#fff",animations:{enabled:!0,easing:"easeinout",speed:50,animateGradually:{enabled:!0,delay:50},dynamicAnimation:{enabled:!0,speed:50}},colors:["#4285f"],toolbar:{show:!0,tools:{download:!1,selection:!0,zoom:!0,zoomin:!0,zoomout:!0}},events:{dataPointSelection:function(t,i,n){e.emitFilterRequest(n)}}},tooltip:{enabled:!0,followCursor:!1,theme:"dark",x:{formatter:function(t){var i=e.getBucketDateTimeRange(t),n=e.$moment.duration(i.start.diff(i.end));return"".concat(i.start.format("YYYY-MM-DD HH:mm:ss")," + ").concat(n.humanize())}}},plotOptions:{bar:{columnWidth:"95%",borderRadius:4}},dataLabels:{enabled:!1},grid:{xaxis:{lines:{show:!1}},yaxis:{lines:{show:!1}}},xaxis:{type:"datetime",tickPlacement:"on"}}}},computed:{series:function(){var e={name:"Events",data:[]};return this.chartData?(e.data=Object.entries(this.chartData.data).map((function(e){return[parseInt(e[0]),e[1]]})),[e]):[e]}},methods:{getBucketDateTimeRange:function(e){var t=this.$moment.utc(e),i=this.chartData.interval.split(/(\d+)/),n=i[1],s=i[2],a=this.$moment.utc(e).add(parseInt(n),s);return{start:t,end:a}},emitFilterRequest:function(e){var t=e.selectedDataPoints[0][0],i=e.w.config.series[0]["data"];if(1!==i.length){var n=i[t][0],s=this.getBucketDateTimeRange(n),a={field:"",type:"datetime_range",value:s.start.toISOString()+","+s.end.toISOString(),operator:"must",active:!0};this.$emit("addChip",a)}},setTheme:function(){"dark"===localStorage.theme?this.options={chart:{foreColor:"#fff"},tooltip:{theme:"dark"}}:this.options={chart:{foreColor:"#333"},tooltip:{theme:"light"}}}},created:function(){_n.$on("isDarkTheme",this.setTheme)},mounted:function(){this.setTheme()}},ue=le,de=Object(c["a"])(ue,ae,re,!1,null,null,null),he=de.exports,me=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[e._l(e.allTimelines,(function(t){return i("ts-timeline-chip",{key:t.id+t.name,attrs:{timeline:t,"is-selected":e.isSelected(t),"is-empty-state":e.isEmptyState,"events-count":e.getCount(t)},on:{remove:e.remove,save:e.save,toggle:e.toggleTimeline}})})),e.sketch.timelines.length>20?i("v-btn",{staticClass:"mt-n3 mr-5",attrs:{small:"",outlined:"",rounded:"",color:"primary"},on:{click:function(t){e.showAll=!e.showAll}}},[e.showAll?i("span",[e._v(" show less ")]):i("span",[e._v(" "+e._s(e.sketch.timelines.length-20)+" more.. ")])]):e._e(),e.sketch.timelines.length>5?i("span",{staticStyle:{position:"relative",top:"-5px"}},[i("v-btn-toggle",{attrs:{dense:"",rounded:""}},[e.sketch.timelines.length>5?i("v-btn",{attrs:{small:"",outlined:"",rounded:"",color:"primary"},on:{click:function(t){return e.enableAllTimelines()}}},[e._v("\n        Select all\n      ")]):e._e(),e.sketch.timelines.length>5?i("v-btn",{attrs:{small:"",outlined:"",rounded:"",color:"primary"},on:{click:function(t){return e.disableAllTimelines()}}},[e._v("\n        Unselect all\n      ")]):e._e()],1)],1):e._e()],2)},ve=[],fe=(i("55dd"),i("75fc")),pe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",["processing"===e.timelineStatus?i("v-dialog",{attrs:{width:"600"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;t.attrs;return[i("v-chip",e._g({staticClass:"mr-2 mb-3",style:e.getTimelineStyle(e.timeline)},n),[i("span",{staticClass:"timeline-name-ellipsis"},[e._v(e._s(e.timeline.name))]),i("span",{staticClass:"ml-1"},[i("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:20,width:1}})],1)])]}}],null,!1,1840978003),model:{value:e.dialogStatus,callback:function(t){e.dialogStatus=t},expression:"dialogStatus"}},[i("v-card",[i("v-app-bar",{attrs:{flat:"",dense:""}},[e._v('Importing events to timeline "'+e._s(e.timeline.name)+'"')]),i("div",{staticClass:"pa-5"},[i("ul",[i("li",[i("strong",[e._v("Opensearch index: ")]),e._v(e._s(e.timeline.searchindex.index_name))]),"processing"===e.timelineStatus||"ready"===e.timelineStatus?i("li",[i("strong",[e._v("Number of events: ")]),e._v("\n            "+e._s(e._f("compactNumber")(e.allIndexedEvents))+"\n          ")]):e._e(),i("li",[i("strong",[e._v("Created by: ")]),e._v(e._s(e.timeline.user.username))]),i("li",[i("strong",[e._v("Created at: ")]),e._v(e._s(e._f("shortDateTime")(e.timeline.created_at))+"\n            "),i("small",[e._v("("+e._s(e._f("timeSince")(e.timeline.created_at))+")")])])]),i("br"),i("div",{staticClass:"mb-3"},[e._v(e._s(e.datasourcesProcessing.length)+" datasource(s) in progress..")]),e._l(e.datasourcesProcessing,(function(t){return i("v-alert",{key:t.id,attrs:{"colored-border":"",border:"left",elevation:"1",color:e.datasourceStatusColors(t)}},[i("ul",[i("li",[i("strong",[e._v("Original filename:")]),e._v(" "+e._s(t.original_filename))]),i("li",[i("strong",[e._v("File on disk:")]),e._v(" "+e._s(t.file_on_disk))]),i("li",[i("strong",[e._v("File size:")]),e._v(" "+e._s(e._f("compactBytes")(t.file_size)))]),i("li",[i("strong",[e._v("Provider:")]),e._v(" "+e._s(t.provider))]),t.data_label?i("li",[i("strong",[e._v("Data label:")]),e._v(" "+e._s(t.data_label))]):e._e(),i("li",[i("strong",[e._v("Status:")]),e._v(" "+e._s(e.dataSourceStatus(t)))]),i("li",[i("strong",[e._v("Total File Events:")]),e._v(e._s(e._f("compactNumber")(e.totalEventsDatasource(t.file_on_disk)))+"\n            ")]),"fail"===e.dataSourceStatus(t)?i("li",[i("strong",[e._v("Error message:")]),t.error_message?i("code",[e._v(" "+e._s(t.error_message))]):e._e()]):e._e()]),i("br")])})),e.percentComplete>.1?i("v-card",{attrs:{outlined:""}},[i("v-card-title",[e._v(e._s(e.eventsPerSecond.slice(-1)[0])+" events/s")]),i("v-sparkline",{attrs:{value:e.eventsPerSecond,gradient:e.sparkline.gradient,smooth:e.sparkline.radius||!1,padding:e.sparkline.padding,"line-width":e.sparkline.width,"stroke-linecap":e.sparkline.lineCap,"gradient-direction":e.sparkline.gradientDirection,fill:e.sparkline.fill,type:e.sparkline.type,"auto-line-width":e.sparkline.autoLineWidth,"auto-draw":""}}),i("v-sheet",{staticClass:"py-4 px-3"},[i("v-progress-linear",{attrs:{color:"light-blue",height:"25",value:e.percentComplete,rounded:""}},[e._v("\n              "+e._s(e.percentComplete)+"% (complete "+e._s(e.processingETA())+")\n            ")])],1)],1):i("v-card",{staticClass:"pa-3",attrs:{outlined:""}},[e._v(" Waiting for processing to begin.. ")])],2),i("v-divider"),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.dialogStatus=!1}}},[e._v(" Close ")])],1)],1)],1):i("v-menu",{attrs:{"offset-y":"","content-class":"menu-with-gap"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[i("v-chip",e._g({staticClass:"mr-2 mb-3",style:e.getTimelineStyle(e.timeline)},n),["fail"===e.timelineStatus?i("v-icon",{attrs:{left:"",color:"red"}},[e._v(" mdi-alert-circle-outline ")]):e._e(),i("span",{staticClass:"timeline-name-ellipsis"},[e._v(e._s(e.timeline.name))]),"processing"===e.timelineStatus?i("span",{staticClass:"ml-3"},[i("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:20,width:2}})],1):e._e(),"ready"===e.timelineStatus?i("v-avatar",{staticStyle:{"background-color":"rgba(0, 0, 0, 0.1)","font-size":"0.55em"},attrs:{right:""}},[e._v("\n          "+e._s(e._f("compactNumber")(e.eventsCount))+"\n        ")]):e._e()],1)]}}])},[i("v-card",{attrs:{flat:"",width:"300"}},[i("v-list",["ready"===e.timelineStatus?i("v-list-item",[i("v-list-item-action",[i("v-icon",[e._v("mdi-square-edit-outline")])],1),i("v-list-item-subtitle",[e._v("Rename timeline")])],1):e._e(),"ready"===e.timelineStatus?i("v-list-item",{on:{click:function(t){return e.$emit("toggle",e.timeline)}}},[i("v-list-item-action",[e.isSelected?i("v-icon",[e._v("mdi-eye-off")]):i("v-icon",[e._v("mdi-eye")])],1),e.isSelected?i("v-list-item-subtitle",[e._v("Temporarily disabled")]):i("v-list-item-subtitle",[e._v("Re-enable")])],1):e._e(),i("v-dialog",{attrs:{width:"600"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-list-item",e._g(e._b({},"v-list-item",s,!1),n),[i("v-list-item-action",[i("v-icon",[e._v(e._s(e.iconStatus))])],1),i("v-list-item-subtitle",[e._v("Data sources ("+e._s(e.datasources.length)+")")])],1)]}}]),model:{value:e.dialogStatus,callback:function(t){e.dialogStatus=t},expression:"dialogStatus"}},[i("v-card",[i("v-app-bar",{attrs:{flat:"",dense:""}},[e._v(e._s(e.timeline.name))]),i("div",{staticClass:"pa-3"},[i("ul",{staticStyle:{"list-style-type":"none"}},[i("li",[i("strong",[e._v("Opensearch index: ")]),e._v(e._s(e.timeline.searchindex.index_name))]),"processing"===e.timelineStatus||"ready"===e.timelineStatus?i("li",[i("strong",[e._v("Number of events: ")]),e._v("\n                  "+e._s(e._f("compactNumber")(e.allIndexedEvents))+"\n                ")]):e._e(),i("li",[i("strong",[e._v("Created by: ")]),e._v(e._s(e.timeline.user.username))]),i("li",[i("strong",[e._v("Created at: ")]),e._v(e._s(e._f("shortDateTime")(e.timeline.created_at))+"\n                  "),i("small",[e._v("("+e._s(e._f("timeSince")(e.timeline.created_at))+")")])])]),i("br"),e._v("\n              "+e._s(e.datasources.length)+" data source(s) in this timeline "),i("br"),i("br"),e._l(e.datasources,(function(t){return i("v-alert",{key:t.id,attrs:{"colored-border":"",border:"left",elevation:"1",color:e.datasourceStatusColors(t)}},[i("ul",{staticStyle:{"list-style-type":"none"}},[i("li",[i("strong",[e._v("Original filename:")]),e._v(" "+e._s(t.original_filename))]),i("li",[i("strong",[e._v("File on disk:")]),e._v(" "+e._s(t.file_on_disk))]),i("li",[i("strong",[e._v("File size:")]),e._v(" "+e._s(e._f("compactBytes")(t.file_size)))]),i("li",[i("strong",[e._v("Provider:")]),e._v(" "+e._s(t.provider))]),t.data_label?i("li",[i("strong",[e._v("Data label:")]),e._v(" "+e._s(t.data_label))]):e._e(),i("li",[i("strong",[e._v("Status:")]),e._v(" "+e._s(e.dataSourceStatus(t)))]),i("li",[i("strong",[e._v("Total File Events:")]),e._v(e._s(e._f("compactNumber")(e.totalEventsDatasource(t.file_on_disk)))+"\n                  ")]),"fail"===e.dataSourceStatus(t)?i("li",[i("strong",[e._v("Error message:")]),t.error_message?i("code",[e._v(" "+e._s(t.error_message))]):e._e()]):e._e()]),i("br")])}))],2),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.dialogStatus=!1}}},[e._v(" Close ")])],1)],1)],1)],1)],1)],1)],1)},ge=[],_e=i("2ef0"),ye=i.n(_e),Se=i("707c"),be=[["#222"],["#42b3f4"],["red","orange","yellow"],["purple","violet"],["#00c6ff","#F0F","#FF0"],["#f72047","#ffd200","#1feaea"]],ke={props:["timeline","eventsCount","isSelected","isEmptyState"],data:function(){return{initialColor:{},newColor:"",newTimelineName:"",colorPickerActive:!1,showInfoModal:!1,showEditModal:!1,showAnalyzerModal:!1,autoRefresh:!1,allIndexedEvents:0,totalEvents:null,dialogStatus:!1,datasources:[],timelineStatus:null,eventsPerSecond:[],sparkline:{width:2,radius:10,padding:8,lineCap:"round",gradient:be[5],gradientDirection:"bottom",gradients:be,fill:!1,type:"trend",autoDrawDuration:4e3,autoLineWidth:!1}}},computed:{meta:function(){return this.$store.state.meta},datasourceErrors:function(){return this.timeline.datasources.filter((function(e){return e.error_message}))},datasourcesProcessing:function(){var e=this;return this.datasources.filter((function(t){return"processing"===e.dataSourceStatus(t)||"queueing"===e.dataSourceStatus(t)}))},sketch:function(){return this.$store.state.sketch},totalEventsToIndex:function(){var e=this;return this.datasources.filter((function(t){return"processing"===e.dataSourceStatus(t)})).map((function(e){return e.total_file_events})).reduce((function(e,t){return e+t}),0)},secondsToComplete:function(){return this.totalEventsToIndex/this.avarageEventsPerSecond()},percentComplete:function(){return Math.floor(this.secondsSinceStart()/this.secondsToComplete*100)||0},iconStatus:function(){return"ready"===this.timelineStatus?"mdi-information-outline":"processing"===this.timelineStatus?"mdi-circle-slice-7":"mdi-alert-circle-outline"}},methods:{showColorPicker:function(){this.$refs.colorPicker.click()},rename:function(){this.showEditModal=!1,this.$emit("save",this.timeline,this.newTimelineName)},remove:function(){confirm("Delete the timeline?")&&this.$emit("remove",this.timeline)},secondsSinceStart:function(){if(!this.datasourcesProcessing.length)return 0;var e=Se["a"].utc(this.datasourcesProcessing[0].updated_at),t=Se["a"].utc(),i=t.diff(e,"second");return i},avarageEventsPerSecond:function(){var e=this.eventsPerSecond.reduce((function(e,t){return e+t}),0),t=e/this.eventsPerSecond.length||0;return Math.floor(t)},processingETA:function(){var e=this.secondsToComplete-this.secondsSinceStart(),t=Object(Se["a"])().add(e,"second").fromNow();return t},updateColor:ye.a.debounce((function(e){this.newColor=e.hex,this.newColor.startsWith("#")&&(this.newColor=this.newColor.substring(1)),n["default"].set(this.timeline,"color",this.newColor),this.$emit("save",this.timeline)}),0),getTimelineStyle:function(e){var t=e.color,i="none",n="50%",s=100;t.startsWith("#")||(t="#"+t),"ready"===this.timelineStatus?this.isSelected?n="100%":(t="#d2d2d2",i="line-through"):(t="#f5f5f5",n="100%");var a="linear-gradient(90deg, "+t+" "+s+"%, #d2d2d2  0%) ";return this.$vuetify.theme.dark?{background:a,filter:"grayscale(25%)",color:"#333"}:{background:a,"text-decoration":i,opacity:n}},fetchData:function(){var e=this;y.getSketchTimeline(this.sketch.id,this.timeline.id).then((function(t){e.timelineStatus=t.data.objects[0].status[0].status,e.datasources=t.data.objects[0].datasources;var i=e.allIndexedEvents;e.allIndexedEvents=t.data.meta.lines_indexed;var n=e.allIndexedEvents-i;n<1e4&&n>0&&e.eventsPerSecond.push(Math.floor(n/5)),"ready"!==e.timelineStatus&&"fail"!==e.timelineStatus?e.autoRefresh=!0:(e.autoRefresh=!1,e.$store.dispatch("updateSketch",e.sketch.id).then((function(){"ready"===e.timelineStatus&&e.$emit("toggle",t.data.objects[0])})))})).catch((function(e){console.log(e)}))},dataSourceStatus:function(e){return e.status[0]?e.status[0].status:"ready"},datasourceStatusColors:function(e){return e.status[0]?"ready"===e.status[0].status||e.status===[]?"success":"processing"===e.status[0].status?"info":"queueing"===e.status[0].status?"warning":"error":"ready"},totalEventsDatasource:function(e){return this.datasources.find((function(t){return t.file_on_disk===e})).total_file_events}},mounted:function(){var e=this;window.addEventListener("click",(function(t){e.$el.contains(t.target)||(e.colorPickerActive=!1)}))},created:function(){this.initialColor={hex:this.timeline.color},this.timelineStatus=this.timeline.status[0].status,this.datasources=this.timeline.datasources,"processing"===this.timelineStatus?this.autoRefresh=!0:(this.autoRefresh=!1,this.allIndexedEvents=this.meta.stats_per_timeline[this.timeline.id]["count"]),this.newTimelineName=this.timeline.name},beforeDestroy:function(){clearInterval(this.t),this.t=!1},watch:{autoRefresh:function(e){e&&!this.t?this.t=setInterval(function(){this.fetchData()}.bind(this),5e3):(clearInterval(this.t),this.t=!1)},timeline:function(){this.timeline.datasources.length>this.datasources.length&&this.fetchData()}}},xe=ke,we=Object(c["a"])(xe,pe,ge,!1,null,"5ffc82c9",null),Ce=we.exports,Te={components:{TsTimelineChip:Ce},props:["currentQueryFilter","countPerIndex","countPerTimeline"],computed:{sketch:function(){return this.$store.state.sketch},allTimelines:function(){var e=Object(fe["a"])(this.sketch.timelines);return e=e.sort((function(e,t){return e.name.localeCompare(t.name)})),this.showAll||(e=e.slice(0,20)),e},activeTimelines:function(){var e=Object(fe["a"])(this.sketch.active_timelines);return e.sort((function(e,t){return e.name.localeCompare(t.name)}))},isEmptyState:function(){return void 0===this.countPerTimeline}},data:function(){return{isDarkTheme:!1,isLoading:!1,selectedTimelines:[],showAll:!1}},methods:{isSelected:function(e){return this.selectedTimelines.map((function(e){return e.id})).includes(e.id)},getCount:function(e){var t=0;return this.countPerTimeline&&(t=this.countPerTimeline[e.id],"number"===typeof t)||!t&&this.countPerIndex&&(t=this.countPerIndex[e.searchindex.index_name]),t},remove:function(e){var t=this;this.isLoading=!0,y.deleteSketchTimeline(this.sketch.id,e.id).then((function(){t.$store.dispatch("updateSketch",t.sketch.id).then((function(){t.syncSelectedTimelines(),t.isLoading=!1}))})).catch((function(e){console.error(e),t.isLoading=!1}))},save:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i&&(this.isLoading=!0),y.saveSketchTimeline(this.sketch.id,e.id,i||e.name,e.description,e.color).then((function(){t.$store.dispatch("updateSketch",t.sketch.id).then((function(){t.syncSelectedTimelines(),t.isLoading=!1}))})).catch((function(e){console.error(e),t.isLoading=!1}))},enableAllTimelines:function(){this.selectedTimelines=this.activeTimelines,this.$emit("updateSelectedTimelines",this.selectedTimelines)},disableAllTimelines:function(){this.selectedTimelines=[],this.$emit("updateSelectedTimelines",this.selectedTimelines)},toggleTimeline:function(e){var t=this.selectedTimelines.slice(),i=t.map((function(e){return e.id})).indexOf(e.id);-1===i?t.push(e):t.splice(i,1),this.selectedTimelines=t,this.$emit("updateSelectedTimelines",this.selectedTimelines)},toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme},syncSelectedTimelines:function(){var e=this;if(this.currentQueryFilter.indices.includes("_all"))this.selectedTimelines=this.activeTimelines;else{var t=[];this.currentQueryFilter.indices.forEach((function(i){if("string"===typeof i){var n=e.activeTimelines.find((function(e){return e.searchindex.index_name===i}));t.push(n)}else if("number"===typeof i){var s=e.activeTimelines.find((function(e){return e.id===i}));t.push(s)}})),this.selectedTimelines=t}}},created:function(){_n.$on("isDarkTheme",this.toggleTheme),this.enableAllTimelines(),this.currentQueryFilter.indices.includes("_all")?this.selectedTimelines=this.activeTimelines:this.syncSelectedTimelines()},watch:{"currentQueryFilter.indices":function(e){this.syncSelectedTimelines()},deep:!0}},Ee=Te,Fe=Object(c["a"])(Ee,me,ve,!1,null,null,null),$e=Fe.exports,De=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{staticStyle:{overflow:"visible"},attrs:{width:"700"}},[i("v-container",{staticClass:"px-8"},[i("br"),i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(t){return e.getDateRange(0,"days")}}},[e._v("Today")]),i("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(t){return e.getDateRange(7,"days")}}},[e._v("Last 7 days")]),i("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(t){return e.getDateRange(30,"days")}}},[e._v("Last 30 days")]),i("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(t){return e.getDateRange(90,"days")}}},[e._v("Last 90 days")]),i("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(t){return e.getDateRange(1,"year")}}},[e._v("Last 1 year")])],1)],1),i("v-row",[i("v-col",{attrs:{cols:"6"}},[i("v-text-field",{attrs:{value:e.formatStartTime,label:"From",outlined:"","hide-details":""},on:{click:function(t){e.showPicker=!0},change:e.setStartTime}})],1),i("v-col",{attrs:{cols:"6"}},[i("v-text-field",{attrs:{value:e.formatEndTime,label:"To (optional)",outlined:"","hide-details":"","append-outer-icon":e.showPicker?"mdi-calendar-remove":"mdi-calendar"},on:{click:function(t){e.showPicker=!0},change:e.setEndTime,"click:append-outer":function(t){e.showPicker=!e.showPicker}}})],1)],1),e.showPicker?i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("date-picker",{ref:"picker",attrs:{mode:"dateTime",timezone:"UTC","is-dark":e.$vuetify.theme.dark,is24hr:"","is-range":"","is-expanded":""},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1)],1):e._e(),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{text:"",color:"primary"},on:{click:e.clearAndCancel}},[e._v(" Cancel ")]),i("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.submit()}}},[e._v(" Add filter ")])],1)],1)],1)},Oe=[],Ne=i("404b"),Pe=i.n(Ne),Ae={components:{DatePicker:Pe.a},data:function(){return{range:{start:"",end:""},filterTab:null,showPicker:!1}},computed:{dateRange:{set:function(e){this.range.start=Se["a"].utc(e.start).millisecond(0).toISOString(),this.range.end=Se["a"].utc(e.end).millisecond(0).toISOString()},get:function(){var e={start:this.range.start,end:this.range.end};return e}},formatStartTime:function(){return this.range.start},formatEndTime:function(){return this.range.start!==this.range.end&&this.range.start?this.range.end:""}},methods:{getDateRange:function(e,t){var i=Se["a"].utc(),n=i.subtract(e,t),s="datetime_range",a=n.format("YYYY-MM-DD")+","+i.format("YYYY-MM-DD");return this.chip={field:"",type:s,value:a,operator:"must",active:!0},this.$emit("addChip",this.chip),this.$emit("cancel"),{start:i,end:n}},setStartTime:function(e){e?(this.range.start=Se["a"].utc(e).toISOString(),this.range.end||this.range.start&&(this.range.end=this.range.start||""),this.$refs.picker.focusDate(this.range.start)):this.range.start=""},setEndTime:function(e){e?(this.range.end=Se["a"].utc(e).toISOString(),this.$refs.picker.focusDate(this.range.start)):this.range.end=""},addDateTimeChip:function(e){var t="datetime_range",i={field:"",type:t,value:e,operator:"must",active:!0};this.$emit("addChip",i),this.range={start:null,end:null}},clearAndCancel:function(){this.range={start:"",end:""},this.$emit("cancel")},submit:function(){if(this.range.start){if(this.range.start===this.range.end){var e=this.range.start.split("T"),t=e[0],i=t+","+t;this.addDateTimeChip(i)}if(this.range.start,this.range.end,this.range.start!==this.range.end){var n="datetime_range",s=this.range.start+","+this.range.end;this.chip={field:"",type:n,value:s,operator:"must",active:!0},this.$emit("addChip",this.chip),this.range={start:"",end:""}}this.$emit("cancel")}}}},Le=Ae,je=Object(c["a"])(Le,De,Oe,!1,null,"6a06fd4e",null),Qe=je.exports,Ie=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-row",[i("v-col",{attrs:{cols:"8"}},[i("v-card",{attrs:{outlined:"",height:"100%"}},[i("v-simple-table",{attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[i("tbody",e._l(e.fullEventFiltered,(function(t,n){return i("tr",{key:n},[i("td",[e._v("\n                  "+e._s(n)+"\n                  "),n.includes("xml")?i("v-dialog",{attrs:{width:"1000"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({staticStyle:{cursor:"pointer"},attrs:{icon:"","x-small":""},on:{click:function(t){e.formatXMLString=!0}}},"v-btn",s,!1),n),[i("v-icon",[e._v("mdi-xml")])],1)]}}],null,!0),model:{value:e.formatXMLString,callback:function(t){e.formatXMLString=t},expression:"formatXMLString"}},[i("ts-format-xml-string",{attrs:{app:"",xmlString:t},on:{cancel:function(t){e.formatXMLString=!1}}})],1):e._e()],1),i("td",[e._v(e._s(t))])])})),0)]},proxy:!0}])})],1)],1),i("v-col",{attrs:{cols:"4"}},[i("v-card",{attrs:{outlined:""}},[i("v-toolbar",{attrs:{dense:"",flat:""}},[i("v-toolbar-title",{staticStyle:{"font-size":"1.2em"}},[e._v("Comments")])],1),i("v-list",{attrs:{"three-line":""}},e._l(e.comments,(function(t,n){return i("v-list-item",{key:t.id,on:{mouseover:function(i){return e.selectComment(t)},mouseleave:function(t){return e.unSelectComment()}}},[i("v-list-item-avatar",[i("v-avatar",{attrs:{color:"grey lighten-1"}},[i("span",{staticClass:"white--text"},[e._v(e._s(t.user.username.charAt(0).toUpperCase()))])])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("\n                "+e._s(t.user.username)+"\n              ")]),i("v-list-item-subtitle",[e._v("\n                "+e._s(e._f("shortDateTime")(t.created_at))+" ("+e._s(e._f("timeSince")(t.created_at))+")\n              ")]),t.editable?i("v-card",{staticClass:"mt-5",attrs:{flat:""}},[i("v-textarea",{attrs:{"hide-details":"","auto-grow":"",filled:""},model:{value:e.comments[n].comment,callback:function(t){e.$set(e.comments[n],"comment",t)},expression:"comments[index].comment"}}),t.editable?i("v-card-actions",[i("v-spacer"),t.editable?i("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.editComment(n,!1)}}},[e._v("\n                    Cancel\n                  ")]):e._e(),i("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(i){return e.updateComment(t,n)}}},[e._v(" Save ")])],1):e._e()],1):i("p",{staticClass:"body-2",staticStyle:{"max-width":"90%"}},[e._v(e._s(t.comment))])],1),t===e.selectedComment&&e.meta.permissions.write&&e.currentUser==t.user.username?i("v-list-item-action",{staticStyle:{position:"absolute",right:"0"}},[i("v-chip",{staticStyle:{"margin-right":"10px"},attrs:{outlined:""}},[i("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.editComment(n)}}},[i("v-icon",{attrs:{small:""}},[e._v("mdi-square-edit-outline")])],1),i("v-btn",{attrs:{icon:"",small:""},on:{click:function(i){return e.deleteComment(t.id,n)}}},[i("v-icon",{attrs:{small:""}},[e._v("mdi-trash-can-outline")])],1)],1)],1):e._e()],1)})),1),e.meta.permissions.write?i("v-card-actions",[i("v-textarea",{staticClass:"mx-2 mb-2",attrs:{"hide-details":"","auto-grow":"",filled:"",label:"Add comment",rows:"1"},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}}),i("v-btn",{attrs:{icon:""},on:{click:e.postComment}},[i("v-icon",[e._v("mdi-send")])],1)],1):e._e()],1)],1)],1),i("br")],1)},Me=[],Re=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{staticStyle:{overflow:"initial"},attrs:{width:"1000"}},[i("v-container",{staticClass:"px-8"},[i("v-alert",{attrs:{border:"top","colored-border":"",type:"info",elevation:"2"}},[e._v(" XML viewer ")]),i("v-alert",{attrs:{"colored-border":"",color:"success",border:"left",elevation:"1"}},[i("pre",{attrs:{lang:"xml"}},[e._v(e._s(e.xmlString))])]),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{text:"",color:"primary"},on:{click:e.clearAndCancel}},[e._v(" Close ")])],1)],1)],1)},He=[],qe={props:["xmlString"],methods:{clearAndCancel:function(){this.$emit("cancel")}}},ze=qe,Be=Object(c["a"])(ze,Re,He,!1,null,"5bf1c96e",null),Ve=Be.exports,Ue={components:{TsFormatXmlString:Ve},props:["event"],data:function(){return{fullEvent:{},comment:"",comments:[],selectedComment:null,formatXMLString:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},currentUser:function(){return this.$store.state.currentUser},currentSearchNode:function(){return this.$store.state.currentSearchNode},fullEventFiltered:function(){var e=this;return Object.getOwnPropertyNames(this.fullEvent).forEach((function(t){t.startsWith("__ts")&&delete e.fullEvent[t]})),this.fullEvent}},methods:{getEvent:function(){var e=this,t=this.event._index,i=this.event._id;y.getEvent(this.sketch.id,t,i).then((function(t){e.fullEvent=t.data.objects,e.comments=t.data.meta.comments})).catch((function(e){}))},postComment:function(){var e=this;_n.$emit("eventAnnotated",{type:"__ts_comment",event:this.event,searchNode:this.currentSearchNode}),y.saveEventAnnotation(this.sketch.id,"comment",this.comment,[this.event],this.currentSearchNode).then((function(t){e.comments.push(t.data.objects[0][0]),e.comment=""})).catch((function(e){}))},updateComment:function(e,t){var i=this;y.updateEventAnnotation(this.sketch.id,"comment",e,[this.event],this.currentSearchNode).then((function(n){i.comments.splice(t,1,e),e.editable=!1})).catch((function(e){console.error(e)}))},deleteComment:function(e,t){var i=this;confirm("Are you sure?")&&y.deleteEventAnnotation(this.sketch.id,"comment",e,this.event,this.currentSearchNode).then((function(e){i.comments.splice(t,1)})).catch((function(e){console.error(e)}))},editComment:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.comments[e];i.editable=t,this.comments.splice(e,1,i)},selectComment:function(e){this.selectedComment=e},unSelectComment:function(){this.selectedComment=!1}},created:function(){this.getEvent()}},Ye=Ue,Je=(i("c3ca"),Object(c["a"])(Ye,Ie,Me,!1,null,null,null)),Xe=Je.exports,Ge=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("v-dialog",{attrs:{persistent:"",width:"700"},model:{value:e.percentageFlag,callback:function(t){e.percentageFlag=t},expression:"percentageFlag"}},[i("v-card",{staticClass:"pa-5",attrs:{flat:""}},[e._v("\n      Uploading..\n      "),i("br"),i("br"),i("v-progress-linear",{attrs:{color:"light-blue",height:"25",value:e.percentCompleted}},[e._v(e._s(e.percentCompleted)+"%")]),i("v-divider")],1)],1),i("v-dialog",{attrs:{"max-width":"1000"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({attrs:{small:"",text:"",rounded:"",color:"primary"}},"v-btn",s,!1),n),[i("v-icon",{attrs:{left:"",small:""}},[e._v(" mdi-plus ")]),e._v("\n        Add Timeline\n      ")],1)]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[i("v-card",[i("v-container",{staticClass:"px-8"},[i("v-card-title",{staticClass:"text-h5"},[e._v(" "+e._s(e.title)+" ")]),e.error.length>0?i("div",e._l(e.error,(function(t,n){return i("v-alert",{key:n,attrs:{outlined:"",type:"error"}},[e._v("\n            "+e._s(t)+"\n            "),i("br"),i("br"),["csv","jsonl","json"].includes(e.extension)?i("div",[e.headers.length>0?i("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[i("thead",[i("tr",e._l(e.headersTable,(function(t){return i("th",{key:t.name,staticClass:"text-left",style:t.color},[e.missingHeaders.includes(t.name)?i("div",[i("v-select",{attrs:{items:e.listHeadersSelectMenu,label:t.name,multiple:"",chips:"",hint:"Mapped to","persistent-hint":""},on:{change:function(i){return e.changeHeaderMapping(i,t.name)}},model:{value:e.mandatoryHeaders.find((function(e){return e.name===t.name})).columnsSelected,callback:function(i){e.$set(e.mandatoryHeaders.find((function(e){return e.name===t.name})),"columnsSelected",i)},expression:"mandatoryHeaders.find((h) => h.name === mandatoryHeader.name).columnsSelected"}})],1):i("div",[i("span",{staticClass:"tag is-large",style:t.color},[i("label",[e._v(e._s(t.name))])])])])})),0)]),i("br"),i("strong",[e._v("Preview")]),i("tbody",e._l(e.numberRows,(function(t){return i("tr",{key:t},e._l(e.headersTable,(function(n){return i("td",{key:n.name},[e._v("\n                        "+e._s(n.values[t-1])+"\n                      ")])})),0)})),0)]},proxy:!0}],null,!0)}):e._e()],1):e._e()])})),1):e._e(),e.fileName?i("div",[i("v-text-field",{attrs:{label:"Timeline Name",outlined:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),"csv"===e.extension?i("v-radio-group",{scopedSlots:e._u([{key:"label",fn:function(){return[i("div",[e._v("Choose "),i("strong",[e._v("CSV delimiter")])])]},proxy:!0}],null,!1,3646347247),model:{value:e.CSVDelimiter,callback:function(t){e.CSVDelimiter=t},expression:"CSVDelimiter"}},e._l(e.delimitersList,(function(t,n){return i("v-radio",{key:n,attrs:{value:t},on:{change:function(i){return e.changeCSVDelimiter(t)}},scopedSlots:e._u([{key:"label",fn:function(){return[i("div",[e._v(e._s(n)+" ("+e._s(t)+")")])]},proxy:!0}],null,!0)})})),1):e._e(),e.percentageFlag?e._e():i("v-list",[e._v("\n            File info\n            "),i("v-simple-table",{attrs:{height:"100px"},scopedSlots:e._u([{key:"default",fn:function(){return[i("thead",[i("tr",e._l(e.fileMetaData,(function(t,n){return i("th",{key:n,staticClass:"text-left"},[e._v("\n                      "+e._s(n)+"\n                    ")])})),0)]),i("tbody",[i("tr",e._l(e.fileMetaData,(function(t,n){return i("td",{key:n,staticClass:"text-left"},[e._v("\n                      "+e._s(t)+"\n                    ")])})),0)])]},proxy:!0}],null,!1,362866586)})],1)],1):i("div",[i("v-file-input",{attrs:{label:"Plaso/CSV/JSONL file",outlined:"",dense:"",clearable:"",multiple:"","show-size":"","truncate-length":"15",id:"datafile"},on:{change:function(t){return e.setFile(t)},"click:clear":e.clearFormData},model:{value:e.uploadedFiles,callback:function(t){e.uploadedFiles=t},expression:"uploadedFiles"}})],1)],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.clearFormData(),e.dialog=!1}}},[e._v("\n          Cancel\n        ")]),e.fileName?i("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){return e.clearFormData()}}},[e._v(" Select another file ")]):e._e(),e.error.length>0||!e.fileName?e._e():i("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){return e.submitForm()}}},[e._v(" Submit ")])],1)],1)],1)],1)},We=[],Ke=(i("6c7b"),i("5df3"),i("4f7f"),{data:function(){return{headersString:"",valuesString:[],title:"Upload your Plaso/CSV/JSONL file",headersMapping:[],mandatoryHeaders:[{name:"datetime",columnsSelected:[]},{name:"message",columnsSelected:[]}],form:{name:"",file:""},fileName:"",fileMetaData:{},error:[],percentCompleted:0,uploadedFiles:[],CSVDelimiter:",",infoMessage:"",delimitersList:{Comma:",",Semicolon:";",Pipe:"|"},showHelperFlag:!1,showPreviewFlag:!1,showAddColumnFlag:!1,checkedHeaders:[],staticNumberRows:3,dialog:!1,colors:[{name:"red",value:"background-color: #FEECF0; color:#CC0F35"},{name:"blue",value:"background-color: #EEF6FC; color:#1D72AA"},{name:"green",value:"background-color: #EFFAF3; color:#257942"}]}},computed:{headers:function(){var e=[];return"csv"===this.extension?e=this.headersString.split(this.CSVDelimiter):["json","jsonl"].includes(this.extension)&&(e=Object.keys(this.headersString)),e},missingHeaders:function(){var e=this;return this.mandatoryHeaders.filter((function(t){return e.headers.indexOf(t.name)<0})).map((function(e){return e.name}))},listHeadersSelectMenu:function(){var e=new Set(this.mandatoryHeaders.map((function(e){return e.name}))),t=this.headers.filter((function(t){return!e.has(t)}));return t.unshift("Create New Header"),t},extension:function(){var e=this.fileName.split(".");return e.length>1?e[e.length-1].toLowerCase():null},numberRows:function(){if("csv"===this.extension){var e=this.valuesString.indexOf("");return e<0?this.staticNumberRows:e}return["json","jsonl"].includes(this.extension)?this.valuesString.length:0},percentageFlag:function(){return this.percentCompleted>0},sketch:function(){return this.$store.state.sketch},headersTable:function(){var e=this,t={};if("csv"===this.extension)for(var i=this.valuesString.map((function(t){return t.split(e.CSVDelimiter)})),n=0;n<this.headers.length;n++){for(var s=[],a=0;a<i.length;a++)s.push(i[a][n]);t[this.headers[n]]=s}else if(["json","jsonl"].includes(this.extension))for(var r=0;r<this.valuesString.length;r++)for(var o in this.valuesString[r])o in t?t[o].push(this.valuesString[r][o]):t[o]=[this.valuesString[r][o]];else console.error(this.extension+" file extension not supported for this feature");var c=this.checkedHeaders;return c.sort().map((function(i){var n="",s=[];if(e.headers.includes(i))s=t[i],n=e.colors.find((function(e){return"blue"===e.name})).value;else{var a=e.headersMapping.find((function(e){return e.target===i}));if(a){if(a.source)if(1===a.source.length)s=t[a.source[0]];else for(var r=a.source,o=function(e){var i="";r.forEach((function(n){i+=n+": ",i+=JSON.stringify(t[n][e])+" | "})),s.push(i)},c=0;c<e.numberRows;c++)o(c);else s=Array(e.numberRows).fill(a.default_value);n=e.colors.find((function(e){return"green"===e.name})).value}else s=Array(e.numberRows).fill("Header not mapped"),n=e.colors.find((function(e){return"red"===e.name})).value}return{name:i,values:s,color:n}}))}},methods:{showHelper:function(){this.showPreviewFlag=!1,this.showAddColumnFlag=!1,this.showHelperFlag=!this.showHelperFlag},showPreview:function(){this.showHelperFlag=!1,this.showPreviewFlag=!this.showPreviewFlag,this.showPreviewFlag||(this.showAddColumnFlag=!1)},showAddColumn:function(){this.showAddColumnFlag=!this.showAddColumnFlag},getDefaultValue:function(e){var t=this.headersMapping.find((function(t){return t["target"]===e}));return t?t["default_value"]:null},changeCSVDelimiter:function(e){this.CSVDelimiter=e;for(var t=0;t<this.mandatoryHeaders.length;t++)this.mandatoryHeaders[t]["columnsSelected"]=[];this.headersMapping=[],this.validateFile()},changeHeaderMapping:function(e,t){var i=e[e.length-1],n=this.mandatoryHeaders.findIndex((function(e){return e.name===t}));this.mandatoryHeaders[n].columnsSelected="Create New Header"===i?["Create New Header"]:this.mandatoryHeaders[n].columnsSelected.filter((function(e){return"Create New Header"!==e}));var s=[],a=null;if("Create New Header"===i){s=null;do{a=prompt("Insert the default value for this header"),a.includes(this.CSVDelimiter)&&(alert("New header value cannot contain CSV separator (found ".concat(this.CSVDelimiter,")")),a=null)}while(!a)}else s=this.mandatoryHeaders[n].columnsSelected;this.headersMapping=this.headersMapping.filter((function(e){return e["target"]!==t})),(null===s||s.length>0)&&this.headersMapping.push({target:t,source:s,default_value:a}),this.validateFile()},clearFormData:function(){this.fileMetaData={},this.form.name="",this.form.file="",this.fileName="",this.headersMapping=[],this.infoMessage="",this.headersString="",this.valuesString=[],this.uploadedFiles=[],this.title="Upload your Plaso/JSONL/CSV file",this.error=[],this.percentCompleted=0;for(var e=0;e<this.mandatoryHeaders.length;e++)this.mandatoryHeaders[e]["columnsSelected"]=[]},submitForm:function(){var e=this;if(this.validateFile()){var t=new FormData;if(t.append("file",this.form.file),t.append("name",this.form.name),t.append("provider","WebUpload"),t.append("context",this.fileName),t.append("total_file_size",this.form.file.size),t.append("sketch_id",this.sketch.id),["csv","jsonl","json"].includes(this.extension)){var i=JSON.stringify(this.headersMapping);t.append("headersMapping",i),t.append("delimiter",this.CSVDelimiter)}var n={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){this.percentCompleted=Math.round(100*e.loaded/e.total)}.bind(this)};this.dialog=!1,y.uploadTimeline(t,n).then((function(){e.clearFormData(),e.percentCompleted=0,e.$store.dispatch("updateSketch",e.sketch.id)})).catch((function(e){}))}},validateFile:function(){this.error=[],this.form.file.size<=0&&this.error.push("Please select a non empty file");var e=["csv","json","jsonl","plaso"];if(e.includes(this.extension)||this.error.push("Please select a file with a valid extension: "+e.toString()),["csv","jsonl","json"].includes(this.extension)){this.headersMapping.length!==this.missingHeaders.length&&this.error.push("Missing headers: "+this.missingHeaders.toString());var t=this.headersMapping.filter((function(e){return e["source"]})).map((function(e){return e.source}));t=t.filter((function(e){return 1===e.length})).map((function(e){return e[0]})),t.length>new Set(t).size&&this.error.push("New headers mapping contains duplicates (".concat(t,")"))}return 0===this.error.length?this.title="Submit your file to Timesketch":this.title="Almost there... Map the "+this.missingHeaders.length+" missing headers.",0===this.error.length},setFile:function(e){if(e[0]){var t=function(e){return e/Math.pow(1024,2)};this.fileMetaData={Name:e[0].name,Size:t(e[0].size)+" MB"};var i=e[0].name;this.headersMapping=[],this.headersString="",this.valuesString=[],this.form.file=e[0],this.form.name=i.split(".").slice(0,-1).join("."),this.fileName=i,"csv"===this.extension?this.extractCSVHeader():["json","jsonl"].includes(this.extension)?this.extractJSONLHeader():this.validateFile(),this.checkedHeaders=this.mandatoryHeaders.map((function(e){return e.name}))}},extractCSVHeader:function(){var e=new FileReader,t=document.getElementById("datafile").files[0],i=this;e.readAsText(t.slice(0,1e4)),e.onloadend=function(e){if(e.target.readyState===FileReader.DONE){var t=e.target.result;i.headersString=t.split("\n")[0].replaceAll('"',""),i.valuesString=t.split("\n").slice(1,i.staticNumberRows+1),i.validateFile()}}},extractJSONLHeader:function(){var e=new FileReader,t=document.getElementById("datafile").files[0],i=this;e.readAsText(t.slice(0,1e4)),e.onloadend=function(e){if(e.target.readyState===FileReader.DONE){var t=e.target.result,n=t.split("\n"),s=Math.min(i.staticNumberRows,n.length);try{i.headersString=JSON.parse(n[0]),i.valuesString=n.slice(0,s).map((function(e){return JSON.parse(e)})),i.validateFile()}catch(r){var a=r.message;a+=". Your first lines of JSON: ",a+=n[0],a+=". Be sure to upload a JSON file in a JSONL format.",i.title="Cannot parse the JSON file",i.error.push(a)}}}}}}),Ze=Ke,et=Object(c["a"])(Ze,Ge,We,!1,null,null,null),tt=et.exports,it=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-menu",{attrs:{"offset-x":"","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-icon",e._g(e._b({},"v-icon",s,!1),n),[e._v("mdi-tag-plus-outline")])]}}]),model:{value:e.showMenu,callback:function(t){e.showMenu=t},expression:"showMenu"}},[i("v-card",{staticClass:"mx-auto",attrs:{"min-width":"500px"}},[i("v-card-text",[i("strong",[e._v("Quick tags")]),i("v-chip-group",e._l(e.quickTags,(function(t){return i("v-chip",{key:t.tag,staticClass:"text-center",attrs:{color:t.color,"text-color":t.textColor,small:""},on:{click:function(i){return e.addTags(t.tag)}}},[i("v-icon",{attrs:{small:"",left:""}},[e._v(" "+e._s(t.label)+" ")]),e._v("\n          "+e._s(t.tag))],1)})),1),i("br"),i("v-combobox",{attrs:{items:e.tags,label:"Add tags..",outlined:"",chips:"","small-chips":"",multiple:""},model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}})],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{text:""},on:{click:function(t){return e.addTags(e.selectedTags)}}},[e._v("Save")])],1)],1)],1)},nt=[],st={props:["event"],data:function(){return{showMenu:!1,listItems:[],selectedTags:[],quickTags:[{tag:"bad",color:"red",textColor:"white",label:"mdi-alert-circle-outline"},{tag:"suspicious",color:"orange",textColor:"white",label:"mdi-help-circle-outline"},{tag:"good",color:"green",textColor:"white",label:"mdi-check-circle-outline"}]}},computed:{sketch:function(){return this.$store.state.sketch},tags:function(){return this.$store.state.tags.map((function(e){return e.tag}))}},methods:{addTags:function(e){var t=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){-1===t.event._source.tag.indexOf(e)&&(t.event._source.tag.push(e),y.tagEvents(t.sketch.id,[t.event],[e]).then((function(e){})).catch((function(e){console.error("Cannot tag event")}))),t.selectedTags=[],t.showMenu=!1}))}}},at=st,rt=Object(c["a"])(at,it,nt,!1,null,"15c357d2",null),ot=rt.exports,ct=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{staticStyle:{overflow:"visible"},attrs:{width:"700"}},[i("v-container",{staticClass:"px-8"},[i("br"),i("v-row",[i("v-col",{attrs:{cols:"6"}},[i("v-text-field",{attrs:{value:e.datetime,label:"Datetime",outlined:"","hide-details":""},on:{click:function(t){e.showPicker=!0}},model:{value:e.datetime,callback:function(t){e.datetime=t},expression:"datetime"}})],1)],1),e.showPicker?i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("date-picker",{ref:"picker",attrs:{mode:"dateTime",timezone:"UTC","is-dark":e.$vuetify.theme.dark,is24hr:"","is-date":"","is-expanded":""},model:{value:e.dateFromPicker,callback:function(t){e.dateFromPicker=t},expression:"dateFromPicker"}})],1)],1):e._e(),i("v-row",[i("v-col",{attrs:{cols:"6"}},[i("v-text-field",{attrs:{value:e.message,label:"Message",outlined:"","hide-details":""},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1)],1),i("v-row",[i("v-col",{attrs:{cols:"6"}},[i("v-text-field",{attrs:{value:e.timestampDesc,label:"Timestamp Description",outlined:"","hide-details":""},model:{value:e.timestampDesc,callback:function(t){e.timestampDesc=t},expression:"timestampDesc"}})],1)],1),e._l(e.attributes,(function(t,n){return i("v-row",{key:n},[i("v-col",{attrs:{cols:"6"}},[i("v-text-field",{attrs:{label:"Attribute Name",outlined:"","hide-details":""},model:{value:e.attributes[n].name,callback:function(t){e.$set(e.attributes[n],"name",t)},expression:"attributes[index].name"}})],1),i("v-col",{attrs:{cols:"6"}},[i("v-text-field",{attrs:{label:"Attribute Value",outlined:"","hide-details":""},model:{value:e.attributes[n].value,callback:function(t){e.$set(e.attributes[n],"value",t)},expression:"attributes[index].value"}})],1)],1)})),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{text:"",color:"primary",disabled:e.isDisabled},on:{click:function(t){return e.attributes.push({name:"",value:""})}}},[e._v("\n        Add Attribute\n      ")]),i("v-btn",{attrs:{text:"",color:"primary"},on:{click:e.clearAndCancel}},[e._v(" Cancel ")]),i("v-btn",{attrs:{text:"",color:"primary"},on:{click:e.submit}},[e._v(" Add Event ")])],1)],2)],1)},lt=[],ut={props:["datetimeProp"],components:{DatePicker:Pe.a},data:function(){return{message:null,timestampDesc:null,filterTab:null,showPicker:!1,attributes:[],datetime:this.datetimeProp}},watch:{datetimeProp:function(e){this.datetime=e}},computed:{dateFromPicker:{set:function(e){null!==e&&(this.datetime=Se["a"].utc(e).millisecond(0).toISOString())},get:function(){return this.datetime}},isDisabled:function(){return this.attributes.some((function(e){return""===e.name||""===e.value}))}},methods:{clearAndCancel:function(){this.datetime=null,this.message=null,this.timestampDesc=null,this.attributes=[],this.$emit("cancel")},submit:function(){var e=this;if(null!==this.datetime&&null!==this.message&&null!==this.timestampDesc){var t=this.$store.state.sketch.id,i={headers:{"Content-Type":"application/json"}},n={};this.attributes.filter((function(e){return!(""===e.name||""===e.value)})).reduce((function(e,t){n[t.name]=t.value}),n),y.createEvent(t,this.datetime,this.message,this.timestampDesc,n,i).then((function(t){e.clearAndCancel()})).catch((function(e){}))}}}},dt=ut,ht=Object(c["a"])(dt,ct,lt,!1,null,"035f3f29",null),mt=ht.exports,vt=i("e1a1"),ft=i("34f3"),pt=function(){return{from:0,terminate_after:40,size:40,indices:[],order:"asc",chips:[]}},gt=function(){return{meta:{count_per_index:{}},objects:[]}},_t={directives:{dragscroll:ft["a"]},components:{TsSearchHistoryTree:V,TsSearchHistoryButtons:W,TsSearchDropdown:se,TsBarChart:he,TsTimelinePicker:$e,TsFilterMenu:Qe,TsEventDetail:Xe,TsUploadTimelineForm:tt,TsEventTagMenu:ot,TsAddManualEvent:mt},props:["sketchId"],data:function(){return{columnHeaders:[{text:"",value:"field"}],tableOptions:{itemsPerPage:40},currentItemsPerPage:40,drawer:!1,leftDrawer:!0,expandedRows:[],timeFilterMenu:!1,selectedFields:[{field:"message",type:"text"}],searchColumns:"",columnDialog:!1,saveSearchMenu:!1,saveSearchFormName:"",selectedEventTags:[],showRightSidePanel:!1,addManualEvent:!1,datetimeManualEvent:"",tagConfig:{good:{color:"green",textColor:"white",label:"mdi-check-circle-outline"},bad:{color:"red",textColor:"white",label:"mdi-alert-circle-outline"},suspicious:{color:"orange",textColor:"white",label:"mdi-help-circle-outline"}},params:{},searchInProgress:!1,currentPage:1,contextEvent:!1,originalContext:!1,showSearchDropdown:!1,eventList:{meta:{},objects:[]},currentQueryString:"",currentQueryFilter:pt(),selectedEvents:[],displayOptions:{isCompact:!1,showTags:!0,showEmojis:!0,showMillis:!1,showTimelineName:!0},selectedLabels:[],showSearchHistory:!1,showHistogram:!1,branchParent:vt["a"],zoomLevel:.7,zoomOrigin:{x:0,y:0},minimizeRightSidePanel:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},totalHits:function(){return this.eventList.meta.es_total_count_complete||0},totalTime:function(){return this.eventList.meta.es_time/1e3||0},fromEvent:function(){return this.currentQueryFilter.from||1},toEvent:function(){if(!(this.totalHits<this.currentQueryFilter.size))return parseInt(this.currentQueryFilter.from)+parseInt(this.currentQueryFilter.size)},numSelectedEvents:function(){return this.selectedEvents.length},filterChips:function(){return this.currentQueryFilter.chips.filter((function(e){return"label"===e.type||"term"===e.type}))},timeFilterChips:function(){return this.currentQueryFilter.chips.filter((function(e){return e.type.startsWith("datetime")}))},filteredLabels:function(){return this.$store.state.meta.filter_labels.filter((function(e){return!e.label.startsWith("__")}))},currentSearchNode:function(){return this.$store.state.currentSearchNode},headers:function(){var e=[{text:"",value:"data-table-select"},{text:"Datetime (UTC)",align:"start",value:"_source.timestamp",width:"230"},{value:"actions",width:"90"},{value:"_source.comment",align:"end"}],t=[];return this.selectedFields.forEach((function(e){var i={text:e.field,align:"start",value:"_source."+e.field};"message"===e.field?(i.width="100%",t.unshift(i)):t.push(i)})),e.splice.apply(e,[3,0].concat(t)),this.displayOptions.showTimelineName&&e.push({value:"timeline_name",align:"end"}),e},rightSidePanelWidth:function(){var e="400";return this.minimizeRightSidePanel&&(e="50"),e}},methods:{tagColor:function(e){return this.tagConfig[e]?this.tagConfig[e]:"lightgrey"},getFieldName:function(e){return"item._source."+e},addEventBtn:function(e){this.datetimeManualEvent=e,this.addManualEvent=!0},toggleSearchHistory:function(){this.showSearchHistory=!this.showSearchHistory,this.showSearchHistory&&this.triggerScrollTo()},toggleDetailedEvent:function(e){var t=this.expandedRows.findIndex((function(t){return t._id===e._id}));if(this.expandedRows.some((function(t){return t._id===e._id}))){if(!e.showDetails)return e["showDetails"]=!0,this.expandedRows.splice(t,1),void this.expandedRows.push(e);e["showDetails"]=!1,this.expandedRows.splice(t,1),e.deltaDays&&(this.expandedRows.splice(t,1),this.expandedRows.push(e))}else e["showDetails"]=!0,this.expandedRows.push(e)},addTimeBubbles:function(){var e=this;this.expandedRows=[],this.eventList.objects.forEach((function(t,i){if(!(i<1)){var n=e.eventList.objects[i-1],s=e.$options.filters.formatTimestamp(t._source.timestamp),a=e.$options.filters.formatTimestamp(n._source.timestamp),r=Math.floor(s/1e3),o=Math.floor(a/1e3),c=Math.floor(r-o);"desc"===e.order&&(c=Math.floor(o-r));var l=Math.floor(c/60/60/24);l>0&&(n["deltaDays"]=l,e.expandedRows.push(n))}}))},getTimeline:function(e){var t,i=this.meta.indices_metadata[e._index].is_legacy;return t=i?this.sketch.active_timelines.find((function(t){return t.searchindex.index_name===e._index})):this.sketch.active_timelines.find((function(t){return t.id===e._source.__ts_timeline_id})),t},getTimelineColor:function(e){var t=this.getTimeline(e),i=t.color;return i.startsWith("#")||(i="#"+i),this.$vuetify.theme.dark?{"background-color":i,filter:"grayscale(25%)",color:"#333"}:{"background-color":i}},getTimeBubbleColor:function(){var e="#f5f5f5";return this.$vuetify.theme.dark&&(e="#333"),{"background-color":e}},search:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.currentQueryString){this.searchInProgress=!0,this.contextEvent&&this.$scrollTo("#context",200,{offset:-300}),this.selectedEvents=[],this.eventList=gt(),i&&(this.currentQueryFilter.from=0),this.currentQueryFilter.fields=this.selectedFields;var a={query:this.currentQueryString,filter:this.currentQueryFilter};n&&(a["incognito"]=!0),s&&(a["parent"]=s),s&&n&&(this.branchParent=s),this.branchParent&&(a["parent"]=this.branchParent),t&&(_n.$emit("newSearch"),this.showSearchDropdown=!1),y.search(this.sketchId,a).then((function(t){e.eventList.objects=t.data.objects,e.eventList.meta=t.data.meta,e.searchInProgress=!1,e.addTimeBubbles(),n||(_n.$emit("createBranch",e.eventList.meta.search_node),e.$store.dispatch("updateSearchHistory"),e.branchParent=e.eventList.meta.search_node.id)})).catch((function(e){}))}},setQueryAndFilter:function(e){this.currentQueryString=e.queryString,this.currentQueryFilter=e.queryFilter,this.currentQueryFilter.size=this.currentItemsPerPage,this.currentQueryFilter.terminate_after=this.currentItemsPerPage,e.doSearch&&this.search()},exportSearchResult:function(){var e={query:this.currentQueryString,filter:this.currentQueryFilter,file_name:"export.zip"};y.exportSearchResult(this.sketchId,e).then((function(e){var t=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a"),n="export.zip";i.href=t,i.setAttribute("download",n),document.body.appendChild(i),i.click()})).catch((function(e){console.error(e)}))},searchView:function(e){var t=this;this.selectedEvents=[],this.showSearchDropdown=!1,e!==parseInt(e,10)&&"string"!==typeof e&&(e=e.id,this.$router.push({name:"Explore",query:{view:e}})),y.getView(this.sketchId,e).then((function(e){var i=e.data.objects[0];if(t.currentQueryString=i.query_string,t.currentQueryFilter=JSON.parse(i.query_filter),t.currentQueryFilter.fields&&t.currentQueryFilter.fields.length||(t.currentQueryFilter.fields=[{field:"message",type:"text"}]),t.selectedFields=t.currentQueryFilter.fields,"_all"===t.currentQueryFilter.indices[0]||"_all"===t.currentQueryFilter.indices){var n=[];t.sketch.active_timelines.forEach((function(e){var i=t.meta.indices_metadata[e.searchindex.index_name].is_legacy;i?n.push(e.searchindex.index_name):n.push(e.id)})),t.currentQueryFilter.indices=n}var s=t.currentQueryFilter.chips;if(s)for(var a=0;a<s.length;a++)"label"===s[a].type&&t.selectedLabels.push(s[a].value);t.contextEvent=!1,t.search(!1)})).catch((function(e){}))},searchContext:function(e){var t=300,i=500;if(this.contextEvent=e,!this.originalContext){var n=JSON.parse(JSON.stringify(this.currentQueryString)),s=JSON.parse(JSON.stringify(this.currentQueryFilter));this.originalContext={queryString:n,queryFilter:s}}var a="YYYY-MM-DDTHH:mm:ss",r=this.$moment.utc(this.contextEvent._source.datetime),o=r.clone().subtract(t,"s").format(a),c=r.clone().add(t,"s").format(a),l={field:"",value:o+","+r.format(a),type:"datetime_range",operator:"must",active:!0},u={field:"",value:r.format(a)+","+c,type:"datetime_range",operator:"must",active:!0};this.currentQueryString="* OR _id:"+this.contextEvent._id,this.currentQueryFilter.chips=[l,u];var d=this.meta.indices_metadata[this.contextEvent._index].is_legacy;this.currentQueryFilter.indices=d?[this.contextEvent._index]:[this.contextEvent._source.__ts_timeline_id],this.currentQueryFilter.size=i,this.search()},removeContext:function(){this.contextEvent=!1,this.currentQueryString=JSON.parse(JSON.stringify(this.originalContext.queryString)),this.currentQueryFilter=JSON.parse(JSON.stringify(this.originalContext.queryFilter)),this.search()},updateSelectedTimelines:function(e){var t=this,i=[];e.forEach((function(e){var n=t.meta.indices_metadata[e.searchindex.index_name].is_legacy;n?i.push(e.searchindex.index_name):i.push(e.id)})),this.currentQueryFilter.indices=i,this.search()},clearSearch:function(){this.currentQueryString="",this.currentQueryFilter=pt(),this.currentQueryFilter.indices="_all",this.eventList=gt(),this.$router.replace({query:null})},toggleChip:function(e){void 0===e.active&&(e.active=!0),e.active=!e.active,this.search()},removeChip:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.currentQueryFilter.chips.findIndex((function(t){return t.value===e.value}));this.currentQueryFilter.chips.splice(i,1),"label"===e.type&&(this.selectedLabels=this.selectedLabels.filter((function(t){return t!==e.value}))),t&&this.search()},updateChip:function(e,t){var i=this.currentQueryFilter.chips.findIndex((function(e){return e.value===t.value&&e.type===t.type}));this.currentQueryFilter.chips.splice(i,1,e),this.search()},addChip:function(e){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.push(e),this.search()},addChipFromHistogram:function(e){var t=this;this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.forEach((function(e){"datetime_range"===e.type&&t.removeChip(e,!1)})),this.addChip(e)},toggleLabelChip:function(e){var t={field:"",value:e,type:"label",operator:"must",active:!0},i=this.currentQueryFilter.chips;if(i)for(var n=0;n<i.length;n++)if(i[n].value===e)return void this.removeChip(n);this.addChip(t)},updateLabelChips:function(){var e=this;this.currentQueryFilter.chips=this.currentQueryFilter.chips.filter((function(e){return"label"!==e.type})),this.selectedLabels.forEach((function(t){var i={field:"",value:t,type:"label",operator:"must",active:!0};e.addChip(i),e.showSearchDropdown=!1}))},updateLabelList:function(e){-1===this.meta.filter_labels.indexOf(e)&&this.meta.filter_labels.push(e)},paginate:function(){if(this.tableOptions.itemsPerPage!==this.currentItemsPerPage)return this.tableOptions.page=1,this.currentPage=1,this.currentItemsPerPage=this.tableOptions.itemsPerPage,this.currentQueryFilter.size=this.tableOptions.itemsPerPage,void this.search(!0,!0,!0);this.currentPage!==this.tableOptions.page&&(this.currentQueryFilter.from=this.tableOptions.page*this.currentQueryFilter.size-this.currentQueryFilter.size,this.currentPage=this.tableOptions.page,this.search(!0,!1,!0))},updateSelectedFields:function(e){var t=this;e.forEach((function(e){!t.headers.filter((function(t){return t.field===e.field})).length>0&&t.search(!0,!0,!0)}))},removeField:function(e){this.selectedFields.splice(e,1)},toggleStar:function(e){e._source.label.includes("__ts_star")?e._source.label.splice(e._source.label.indexOf("__ts_star"),1):e._source.label.push("__ts_star"),y.saveEventAnnotation(this.sketch.id,"label","__ts_star",e,this.currentSearchNode).then((function(e){})).catch((function(e){console.error(e)}))},toggleMultipleStars:function(){var e=this,t=[];Object.keys(this.selectedEvents).forEach((function(i,n){t.push(e.selectedEvents[i])})),y.saveEventAnnotation(this.sketch.id,"label","__ts_star",t,this.currentSearchNode).then((function(e){})).catch((function(e){})),_n.$emit("toggleStar",this.selectedEvents)},jumpInHistory:function(e){var t=this;if(this.currentQueryString=e.query_string,this.currentQueryFilter=JSON.parse(e.query_filter),this.currentQueryFilter.fields&&this.currentQueryFilter.fields.length||(this.currentQueryFilter.fields=[{field:"message",type:"text"}]),this.selectedFields=this.currentQueryFilter.fields,"_all"===this.currentQueryFilter.indices[0]||"_all"===this.currentQueryFilter.indices){var i=[];this.sketch.active_timelines.forEach((function(e){var n=t.meta.indices_metadata[e.searchindex.index_name].is_legacy;n?i.push(e.searchindex.index_name):i.push(e.id)})),this.currentQueryFilter.indices=i}var n=this.currentQueryFilter.chips;if(n)for(var s=0;s<n.length;s++)"label"===n[s].type&&this.selectedLabels.push(n[s].value);this.contextEvent=!1,this.search(!1,!0,!0,e.id)},triggerScrollTo:function(){_n.$emit("triggerScrollTo")},zoomWithMouse:function(e){this.zoomOrigin.x=e.pageX,this.zoomOrigin.y=e.pageY,e.deltaY<0?this.zoomLevel+=.07:e.deltaY>0&&(this.zoomLevel-=.07)},closeSearchDropdown:function(e){e!==this.$refs.searchInput&&null===e.getAttribute("data-explore-element")&&(this.showSearchDropdown=!1)},onClickOutside:function(e){"tsSearchInput"!==e.target.id&&(this.showSearchDropdown=!1)},saveSearch:function(){var e=this;y.createView(this.sketchId,this.saveSearchFormName,this.currentQueryString,this.currentQueryFilter).then((function(t){e.saveSearchFormName="",e.saveSearchMenu=!1;var i=t.data.objects[0];e.$store.state.meta.views.push(i),e.$router.push({name:"Explore",query:{view:i.id}})})).catch((function(e){}))}},watch:{tableOptions:{handler:function(){this.paginate()},deep:!0}},mounted:function(){this.$refs.searchInput.focus(),_n.$on("setQueryAndFilter",this.setQueryAndFilter),_n.$on("setActiveView",this.searchView)},beforeDestroy:function(){_n.$off("setQueryAndFilter"),_n.$off("setActiveView")},created:function(){var e=this,t=!1;if(this.params={viewId:this.$route.query.view,indexName:this.$route.query.timeline,resultLimit:this.$route.query.limit,queryString:this.$route.query.q},this.params.viewId)this.searchView(this.params.viewId);else{if(this.params.queryString&&(this.currentQueryString=this.params.queryString,t=!0),this.params.indexName){this.params.queryString||(this.currentQueryString="*");var i=this.sketch.active_timelines.find((function(t){return t.id===parseInt(e.params.indexName,10)})),n=this.meta.indices_metadata[i.searchindex.index_name].is_legacy;this.currentQueryFilter.indices=n?[i.searchindex.index_name]:[i.id],t=!0}this.currentQueryString||(this.currentQueryFilter.indices=["_all"]),t&&(this.currentQueryFilter.indices.length||(this.currentQueryFilter.indices=["_all"]),this.search())}}},yt=_t,St=(i("2d9e"),Object(c["a"])(yt,D,O,!1,null,null,null)),bt=St.exports,kt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.sketch?i("div",[i("v-navigation-drawer",{ref:"drawer",attrs:{app:"",permanent:"",width:e.navigationDrawer.width,"hide-overlay":""}},[i("v-toolbar",{attrs:{flat:""}},[i("v-avatar",{staticClass:"mt-2 ml-n4"},[i("router-link",{attrs:{to:"/"}},[i("v-img",{attrs:{src:"/dist/timesketch-color.png","max-height":"25","max-width":"25",contain:""}})],1)],1),i("span",{staticStyle:{"font-size":"1.1em",cursor:"pointer"},on:{click:function(t){e.showSketchMetadata=!e.showSketchMetadata}}},[e._v(e._s(e.sketch.name)+"\n      ")]),i("v-spacer"),i("v-icon",{on:{click:function(t){return e.hideDrawer()}}},[e._v("mdi-chevron-left")])],1),i("v-expand-transition",[i("v-list",{directives:[{name:"show",rawName:"v-show",value:e.showSketchMetadata,expression:"showSketchMetadata"}],attrs:{"two-line":""}},[e.sketch.user?i("v-list-item",[i("v-list-item-content",[i("v-list-item-title",[i("strong",[e._v("Created:")]),e._v(" "+e._s(e._f("shortDateTime")(e.sketch.created_at))+" ")]),i("v-list-item-subtitle",[i("small",[e._v(e._s(e._f("timeSince")(e.sketch.created_at))+" by "+e._s(e.sketch.user.username))])])],1)],1):e._e(),i("v-list-item",[i("v-list-item-content",[i("v-list-item-title",[i("strong",[e._v("Access: ")]),e.meta.permissions.public?i("span",[e._v("Public")]):i("span",[e._v("Restricted")])]),i("v-list-item-subtitle",[e.meta.permissions.public?i("small",[e._v("Visibly to all users on this server")]):i("small",[e._v("Only people with access can open")])])],1)],1),i("v-list-item",[i("v-list-item-content",[i("v-list-item-title",[i("strong",[e._v("Shared with")])]),i("v-list-item-subtitle",[i("small",[e._v("People and groups with access")])])],1)],1)],1)],1),i("v-divider"),i("ts-add-scenario-dialog",{attrs:{dialog:e.dialog},on:{"update:dialog":function(t){e.dialog=t},"close-dialog":function(t){e.dialog=!1}}}),!e.scenarios&&e.scenarioTemplates.length?i("div",[i("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{flat:""}},[i("span",{staticStyle:{cursor:"pointer"},on:{click:e.addScenarioDialog}},[i("v-icon",{attrs:{left:""}},[e._v("mdi-plus")]),e._v(" Add Investigation Scenario")],1)]),i("v-divider")],1):e._e(),e._l(e.scenarios,(function(t){return i("ts-scenario",{key:t.id,attrs:{scenario:t}},[i("v-menu",{attrs:{"offset-y":"","close-on-content-click":!0},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({attrs:{small:"",icon:""}},"v-btn",s,!1),n),[i("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!0)},[i("v-card",[i("v-list",[i("v-list-item-group",{attrs:{color:"primary"}},[i("v-list-item",{on:{click:e.addScenarioDialog}},[i("v-list-item-icon",[i("v-icon",[e._v("mdi-plus")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Add another scenario")])],1)],1),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[e._v("mdi-pencil")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Rename")])],1)],1)],1)],1)],1)],1)],1)})),i("ts-saved-searches"),i("ts-data-types"),i("ts-tags"),i("ts-search-templates"),i("ts-sigma-rules")],2),e.sketch.status?i("router-view"):e._e()],1):e._e()},xt=[],wt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-row",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":"",flat:""}},[i("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.expanded=!e.expanded}}},[i("v-icon",{attrs:{left:""}},[e._v("mdi-clipboard-check-outline")]),e._v(" "+e._s(e.scenario.display_name))],1),i("v-spacer"),e._t("default")],2),e.scenario.facets.length?i("v-expand-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}]},e._l(e.scenario.facets,(function(t){return i("div",{key:t.id},[i("ts-facet",{staticClass:"mt-3",attrs:{scenario:e.scenario,facet:t}})],1)})),0)]):e._e(),i("v-divider")],1)},Ct=[],Tt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-row",{class:e.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.toggleFacet()}}},[i("v-col",{attrs:{cols:"1"}},[e.expanded?i("v-icon",{staticClass:"ml-2"},[e._v("mdi-chevron-down")]):i("v-icon",{staticClass:"ml-2"},[e._v("mdi-chevron-right")])],1),i("v-col",{attrs:{cols:"10"}},[i("span",{staticStyle:{"font-size":"0.9em"}},[e._v(e._s(e.facet.display_name))])])],1),i("v-expand-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}]},[i("v-divider",{staticClass:"mt-3"}),e._l(e.facet.questions,(function(t){return i("span",{key:t.id,staticStyle:{"font-size":"0.9em"},on:{click:function(i){return e.setActiveContext(t)}}},[i("ts-question",{attrs:{question:t}})],1)}))],2)]),i("v-divider",{staticClass:"mt-3"})],1)},Et=[],Ft=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"pa-2 pl-4",staticStyle:{cursor:"pointer"},on:{click:function(t){e.expanded=!e.expanded}}},[i("a",{staticStyle:{"font-size":"1em"}},[e._v(e._s(e.question.display_name))])]),i("v-expand-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}]},[i("div",{staticClass:"ma-2 mx-4 mb-4 mt-n1"},[i("v-expand-transition",[e.fullDescription?i("div",[i("small",[e._v(e._s(e.question.description)+" "),i("a",{on:{click:function(t){e.fullDescription=!e.fullDescription}}},[e._v("show less")])])]):e._e()]),e.fullDescription?e._e():i("div",[i("span",[i("small",[e._v("\n              "+e._s(e.question.description.slice(0,100))+"...\n              "),i("a",{on:{click:function(t){e.fullDescription=!e.fullDescription}}},[e._v("show more")])])])])],1),e.question.search_templates.length?i("v-card",{staticClass:"ma-2 mx-4 mb-6",attrs:{flat:"",outlined:""}},[i("v-system-bar",{attrs:{dense:"",flat:""}},[e._v(" Get started ")]),i("div",{staticClass:"pa-3"},e._l(e.question.search_templates,(function(e){return i("ts-search-template",{key:e.id,attrs:{searchtemplate:e}})})),1)],1):e._e()],1)])],1)},$t=[],Dt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-row",{attrs:{"no-gutters":""}},[i("div",{staticStyle:{"font-size":"0.9em"}},[i("v-icon",{staticClass:"mr-3",attrs:{"x-small":""}},[e._v("mdi-magnify")]),i("a",{on:{click:function(t){return e.search(e.searchtemplate.query_string)}}},[e._v(e._s(e.searchtemplate.name))])],1)]),i("v-expand-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}],staticClass:"pa-4 pt-0"},[i("div",{staticStyle:{"font-size":"0.9em"}},[i("v-simple-table",{attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[i("tbody",[i("tr",[i("td",[i("strong",[e._v("Author")])]),i("td",[e._v(e._s(e.searchTemplateSpec.author))])]),i("tr",[i("td",[i("strong",[e._v("Description")])]),i("td",[e._v(e._s(e.searchTemplateSpec.description))])]),i("tr",[i("td",[i("strong",[e._v("Date")])]),i("td",[e._v(e._s(e.searchTemplateSpec.date))])]),i("tr",[i("td",[i("strong",[e._v("ID")])]),i("td",[e._v(e._s(e.searchTemplateSpec.id))])]),e.searchTemplateSpec.references.length?i("tr",[i("td",[i("strong",[e._v("References")])]),i("td",e._l(e.searchTemplateSpec.references,(function(t){return i("div",{key:t},[i("a",{attrs:{href:t,target:"new"}},[e._v(e._s(t))])])})),0)]):e._e()])]},proxy:!0}])})],1),e.parameters.length?i("div",{staticClass:"pt-3"},[i("div",{staticClass:"mb-3"},[i("strong",{staticClass:"mb-3"},[e._v("Required input parameters")])]),e._l(e.parameters,(function(t){return i("div",{key:t.name,staticClass:"mb-4"},[i("v-text-field",{attrs:{hint:t.description,label:t.description,outlined:"",dense:"","hide-details":""},model:{value:e.params[t.name],callback:function(i){e.$set(e.params,t.name,i)},expression:"params[parameter.name]"}})],1)})),i("v-card-actions",{staticClass:"pl-0 mt-n3"},[i("v-btn",{attrs:{small:"",depressed:"",color:"primary",disabled:!e.filledOut},on:{click:function(t){return e.parseQueryAndSearch()}}},[e._v("\n            Search\n          ")])],1)],2):i("div",{staticClass:"mt-3"},[i("v-btn",{attrs:{small:"",depressed:"",color:"primary",disabled:!e.filledOut},on:{click:function(t){return e.search(e.searchtemplate.query_string)}}},[e._v("Search")])],1)])])],1)},Ot=[],Nt=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},Pt={props:["searchtemplate"],data:function(){return{expanded:!1,params:{}}},computed:{sketch:function(){return this.$store.state.sketch},parameters:function(){return JSON.parse(this.searchtemplate.template_json).parameters},filledOut:function(){return Object.keys(this.params).length===this.parameters.length},searchTemplateSpec:function(){return JSON.parse(this.searchtemplate.template_json)}},methods:{search:function(e){var t={doSearch:!0};t.queryString=e,t.queryFilter=Nt(),_n.$emit("setQueryAndFilter",t)},parseQueryAndSearch:function(){var e,t=this;y.parseSearchTemplate(this.searchtemplate.id,this.params).then((function(i){e=i.data.objects[0].query_string,t.search(e)})).catch((function(e){}))}}},At=Pt,Lt=Object(c["a"])(At,Dt,Ot,!1,null,"ab9c29dc",null),jt=Lt.exports,Qt={props:["question"],components:{TsSearchTemplate:jt},data:function(){return{expanded:!1,fullDescription:!1}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{},created:function(){}},It=Qt,Mt=(i("12d0"),Object(c["a"])(It,Ft,$t,!1,null,"7ed16858",null)),Rt=Mt.exports,Ht={props:["scenario","facet"],components:{TsQuestion:Rt},data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{toggleFacet:function(){this.expanded?null!=this.$store.state.activeContext.facet&&this.facet.id===this.$store.state.activeContext.facet.id&&this.$store.dispatch("clearActiveContext"):this.setActiveContext(),this.expanded=!this.expanded},setActiveContext:function(e){var t={scenario:this.scenario,facet:this.facet,question:e};this.$store.dispatch("setActiveContext",t)}},created:function(){}},qt=Ht,zt=Object(c["a"])(qt,Tt,Et,!1,null,null,null),Bt=zt.exports,Vt={props:["scenario","minimizePanel"],components:{TsFacet:Bt},data:function(){return{activeQuestion:{},selectedItem:null,expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},activeQuestionSpec:function(){return JSON.parse(this.activeQuestion.spec_json)}},methods:{addScenario:function(){y.addScenario(this.sketch.id,"compromise_assessment").then((function(e){})).catch((function(e){}))},setActiveQuestion:function(e){this.activeQuestion=e},resetActiveQuestion:function(){this.selectedItem=null,this.activeQuestion={}}}},Ut=Vt,Yt=Object(c["a"])(Ut,wt,Ct,!1,null,"405c94ed",null),Jt=Yt.exports,Xt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.meta.views.length?i("div",[i("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{flat:""}},[i("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.expanded=!e.expanded}}},[i("v-icon",{attrs:{left:""}},[e._v("mdi-content-save-outline")]),e._v("Saved Searches ("+e._s(e.meta.views.length)+")")],1)]),i("v-expand-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}]},[i("v-divider"),e._l(e.meta.views,(function(t){return i("v-row",{key:t.name,staticClass:"pa-3 pl-5",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[i("div",{staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(i){return e.setView(t)}}},[e._v(e._s(t.name))])])}))],2)]),i("v-divider")],1):e._e()},Gt=[],Wt={props:[],data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{setView:function(e){_n.$emit("setActiveView",e)}},created:function(){}},Kt=Wt,Zt=Object(c["a"])(Kt,Xt,Gt,!1,null,null,null),ei=Zt.exports,ti=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.dataTypes.length?i("div",[i("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{flat:""}},[i("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.expanded=!e.expanded}}},[i("v-icon",{attrs:{left:""}},[e._v("mdi-database-outline")]),e._v(" Data Types ("+e._s(e.dataTypes.length)+")")],1)]),i("v-expand-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}]},[i("v-data-iterator",{attrs:{items:e.dataTypes,"items-per-page":e.itemsPerPage,search:e.search},on:{"update:itemsPerPage":function(t){e.itemsPerPage=t},"update:items-per-page":function(t){e.itemsPerPage=t}},scopedSlots:e._u([{key:"header",fn:function(){return[i("v-toolbar",{attrs:{flat:""}},[i("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for a data type.."},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)]},proxy:!0},{key:"default",fn:function(t){return e._l(t.items,(function(t){return i("v-row",{key:t.data_type,staticClass:"pa-3 pl-5",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[i("div",{staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(i){return e.setQueryAndFilter(t.data_type)}}},[i("span",[e._v(e._s(t.data_type)+" ("+e._s(e._f("compactNumber")(t.count))+")")])])])}))}}],null,!1,3490573420)})],1)]),i("v-divider")],1):e._e()},ii=[],ni=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},si={props:[],data:function(){return{expanded:!1,itemsPerPage:10,search:""}},computed:{sketch:function(){return this.$store.state.sketch},dataTypes:function(){return this.$store.state.dataTypes}},methods:{setQueryAndFilter:function(e){var t={doSearch:!0};t.queryString='data_type:"'+e+'"',t.queryFilter=ni(),_n.$emit("setQueryAndFilter",t)}},created:function(){}},ai=si,ri=Object(c["a"])(ai,ti,ii,!1,null,null,null),oi=ri.exports,ci=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.tags.length?i("div",[i("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{flat:""}},[i("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.expanded=!e.expanded}}},[i("v-icon",{attrs:{left:""}},[e._v("mdi-tag-multiple-outline")]),e._v(" Tags ("+e._s(e.tags.length)+")")],1)]),i("v-expand-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}]},[i("v-divider"),e._l(e.tags,(function(t){return i("v-row",{key:t.tag,staticClass:"pa-3 pl-5",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[i("div",{staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(i){return e.search(t.tag)}}},[i("span",[e._v(e._s(t.tag)+" ("+e._s(e._f("compactNumber")(t.count))+")")])])])}))],2)]),i("v-divider")],1):e._e()},li=[],ui=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},di={props:[],data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},tags:function(){return this.$store.state.tags}},methods:{search:function(e){var t={doSearch:!0};t.queryString='tag:"'+e+'"',t.queryFilter=ui(),_n.$emit("setQueryAndFilter",t)}}},hi=di,mi=Object(c["a"])(hi,ci,li,!1,null,null,null),vi=mi.exports,fi=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{flat:""}},[i("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.expanded=!e.expanded}}},[i("v-icon",{attrs:{left:""}},[e._v("mdi-text-box-search-outline")]),e._v(" Search Templates ("+e._s(e.searchtemplates.length)+")")],1)]),i("v-expand-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}]},[i("v-data-iterator",{attrs:{items:e.searchtemplates,"items-per-page":e.itemsPerPage,search:e.search},on:{"update:itemsPerPage":function(t){e.itemsPerPage=t},"update:items-per-page":function(t){e.itemsPerPage=t}},scopedSlots:e._u([{key:"header",fn:function(){return[i("v-toolbar",{attrs:{flat:""}},[i("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for a template.."},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)]},proxy:!0},{key:"default",fn:function(t){return e._l(t.items,(function(e){return i("ts-search-template",{key:e.id,attrs:{searchtemplate:e}})}))}}])})],1)]),i("v-divider")],1)},pi=[],gi=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-row",{staticClass:"pa-3",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[i("div",{staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(t){e.expanded=!e.expanded}}},[e.expanded?i("v-icon",[e._v("mdi-chevron-down")]):i("v-icon",[e._v("mdi-chevron-right")]),e._v("\n      "+e._s(e.searchtemplate.name)+"\n    ")],1),i("v-spacer"),i("div",[i("v-icon",[e._v("mdi-dots-vertical")])],1)],1),i("v-expand-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}],staticClass:"pa-4 pt-0"},[i("div",{staticStyle:{"font-size":"0.9em"}},[i("v-simple-table",{attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[i("tbody",[i("tr",[i("td",[i("strong",[e._v("Author")])]),i("td",[e._v(e._s(e.searchTemplateSpec.author))])]),i("tr",[i("td",[i("strong",[e._v("Description")])]),i("td",[e._v(e._s(e.searchTemplateSpec.description))])]),i("tr",[i("td",[i("strong",[e._v("Date")])]),i("td",[e._v(e._s(e.searchTemplateSpec.date))])]),i("tr",[i("td",[i("strong",[e._v("ID")])]),i("td",[e._v(e._s(e.searchTemplateSpec.id))])]),e.searchTemplateSpec.references.length?i("tr",[i("td",[i("strong",[e._v("References")])]),i("td",e._l(e.searchTemplateSpec.references,(function(t){return i("div",{key:t},[i("a",{attrs:{href:t,target:"new"}},[e._v(e._s(t))])])})),0)]):e._e()])]},proxy:!0}])})],1),e.parameters.length?i("div",{staticClass:"pt-3"},[i("div",{staticClass:"mb-3"},[i("strong",{staticClass:"mb-3"},[e._v("Required input parameters")])]),e._l(e.parameters,(function(t){return i("div",{key:t.name,staticClass:"mb-4"},[i("v-text-field",{attrs:{hint:t.description,label:t.description,outlined:"",dense:"","hide-details":""},model:{value:e.params[t.name],callback:function(i){e.$set(e.params,t.name,i)},expression:"params[parameter.name]"}})],1)})),i("v-card-actions",{staticClass:"pl-0 mt-n3"},[i("v-btn",{attrs:{small:"",depressed:"",color:"primary",disabled:!e.filledOut},on:{click:function(t){return e.parseQueryAndSearch()}}},[e._v("\n            Search\n          ")])],1)],2):i("div",{staticClass:"mt-3"},[i("v-btn",{attrs:{small:"",depressed:"",color:"primary",disabled:!e.filledOut},on:{click:function(t){return e.search(e.searchtemplate.query_string)}}},[e._v("Search")])],1)])]),i("v-divider")],1)},_i=[],yi=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},Si={props:["searchtemplate"],data:function(){return{expanded:!1,params:{}}},computed:{sketch:function(){return this.$store.state.sketch},parameters:function(){return JSON.parse(this.searchtemplate.template_json).parameters},filledOut:function(){return Object.keys(this.params).length===this.parameters.length},searchTemplateSpec:function(){return JSON.parse(this.searchtemplate.template_json)}},methods:{search:function(e){var t={doSearch:!0};t.queryString=e,t.queryFilter=yi(),_n.$emit("setQueryAndFilter",t)},parseQueryAndSearch:function(){var e,t=this;y.parseSearchTemplate(this.searchtemplate.id,this.params).then((function(i){e=i.data.objects[0].query_string,t.search(e)})).catch((function(e){}))}}},bi=Si,ki=Object(c["a"])(bi,gi,_i,!1,null,"913b8168",null),xi=ki.exports,wi={props:[],components:{TsSearchTemplate:xi},data:function(){return{searchtemplates:[],expanded:!1,itemsPerPage:10,search:""}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},created:function(){var e=this;y.getSearchTemplates().then((function(t){e.searchtemplates=t.data.objects[0]})).catch((function(e){}))}},Ci=wi,Ti=Object(c["a"])(Ci,fi,pi,!1,null,null,null),Ei=Ti.exports,Fi=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{flat:""}},[i("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.expanded=!e.expanded}}},[i("v-icon",{attrs:{left:""}},[e._v("mdi-sigma-lower")]),e._v(" Sigma Rules ("+e._s(e.sigmaRules.length)+")")],1)]),i("v-expand-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded&&e.sigmaRules.length,expression:"expanded && sigmaRules.length"}]},[i("v-data-iterator",{attrs:{items:e.sigmaRules,"items-per-page":e.itemsPerPage,search:e.search},on:{"update:itemsPerPage":function(t){e.itemsPerPage=t},"update:items-per-page":function(t){e.itemsPerPage=t}},scopedSlots:e._u([{key:"header",fn:function(){return[i("v-toolbar",{attrs:{flat:""}},[i("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for a rule.."},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)]},proxy:!0},{key:"default",fn:function(t){return e._l(t.items,(function(e){return i("ts-sigma-rule",{key:e.id,attrs:{"sigma-rule":e}})}))}}])})],1)]),i("v-divider")],1)},$i=[],Di=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-row",{staticClass:"pa-3",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[i("div",{staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(t){e.expanded=!e.expanded}}},[e.expanded?i("v-icon",[e._v("mdi-chevron-down")]):i("v-icon",[e._v("mdi-chevron-right")]),e._v("\n      "+e._s(e.sigmaRule.title)+"\n    ")],1),i("v-spacer"),i("div",[i("v-icon",[e._v("mdi-dots-vertical")])],1)],1),i("v-expand-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}],staticClass:"pa-4 pt-0"},[i("div",{staticClass:"mt-2",staticStyle:{"font-size":"0.9em"}},[i("v-simple-table",{attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[i("tbody",e._l(e.sigmaRuleSummary,(function(t,n){return i("tr",{key:t.id},[i("td",[i("strong",[e._v(e._s(e._f("capitalize")(n)))])]),i("td",["references"===n?i("span",e._l(t,(function(t){return i("div",{key:t},[i("a",{attrs:{href:t,target:"new"}},[e._v(e._s(t))])])})),0):"falsepositives"===n||"tags"===n?i("span",e._l(t,(function(t){return i("v-chip",{key:t,staticClass:"mr-2",attrs:{rounded:"","x-small":""}},[e._v(e._s(t))])})),1):i("span",[e._v("\n                    "+e._s(t)+"\n                  ")])])])})),0)]},proxy:!0}])})],1),i("div",{staticClass:"mt-3"},[i("v-btn",{attrs:{small:"",depressed:"",color:"primary"},on:{click:function(t){return e.search(e.sigmaRule.search_query)}}},[e._v("Search")])],1)])]),i("v-divider")],1)},Oi=[],Ni=i("768b"),Pi=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},Ai={props:["sigmaRule"],data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},sigmaRuleSummary:function(){var e=["author","description","references","date","modified","falsepositives","level","tags"];return Object.fromEntries(Object.entries(this.sigmaRule).filter((function(t){var i=Object(Ni["a"])(t,1),n=i[0];return e.includes(n)})))}},methods:{search:function(e){var t={doSearch:!0};t.queryString=e,t.queryFilter=Pi(),console.log(t),_n.$emit("setQueryAndFilter",t)}}},Li=Ai,ji=Object(c["a"])(Li,Di,Oi,!1,null,"3fe73c67",null),Qi=ji.exports,Ii={props:[],components:{TsSigmaRule:Qi},data:function(){return{sigmaRules:[],expanded:!1,itemsPerPage:10,search:""}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},created:function(){var e=this;y.getSigmaList().then((function(t){e.sigmaRules=t.data.objects})).catch((function(e){}))}},Mi=Ii,Ri=Object(c["a"])(Mi,Fi,$i,!1,null,null,null),Hi=Ri.exports,qi=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-dialog",{attrs:{value:e.dialog,"max-width":"500px",persistent:""},on:{input:function(t){return e.$emit("input",t)}}},[i("v-card",[i("div",{staticClass:"pa-3"},[i("h3",[e._v("Investigative Scenarios")]),i("v-select",{staticClass:"mt-3",attrs:{items:e.scenarioTemplates,"item-text":"display_name","return-object":"",label:"Select a scenario",outlined:""},model:{value:e.selectedScenario,callback:function(t){e.selectedScenario=t},expression:"selectedScenario"}}),e.selectedScenario?i("div",[e._v("\n        "+e._s(e.selectedScenario.description)+"\n      ")]):e._e()],1),i("v-divider"),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",text:""},on:{click:e.closeDialog}},[e._v(" Close ")]),i("v-btn",{attrs:{disabled:!e.selectedScenario,color:"primary",text:""},on:{click:function(t){return e.addScenario(e.selectedScenario.short_name)}}},[e._v("\n        Add\n      ")])],1)],1)],1)},zi=[],Bi={props:{dialog:Boolean},data:function(){return{selectedScenario:null}},computed:{sketch:function(){return this.$store.state.sketch},scenarioTemplates:function(){return this.$store.state.scenarioTemplates}},methods:{closeDialog:function(){this.selectedScenario=null,this.$emit("close-dialog")},addScenario:function(e){var t=this;this.closeDialog(),y.addScenario(this.sketch.id,e).then((function(e){t.$store.dispatch("updateScenarios",t.sketch.id)})).catch((function(e){}))}}},Vi=Bi,Ui=Object(c["a"])(Vi,qi,zi,!1,null,"cc9f1812",null),Yi=Ui.exports,Ji={props:["sketchId","showLeftPanel"],components:{TsScenario:Jt,TsSavedSearches:ei,TsDataTypes:oi,TsTags:vi,TsSearchTemplates:Ei,TsSigmaRules:Hi,TsAddScenarioDialog:Yi},data:function(){return{showSketchMetadata:!1,navigationDrawer:{width:400},selectedScenario:null,dialog:!1}},created:function(){this.$store.dispatch("updateSketch",this.sketchId),this.$store.dispatch("updateSearchHistory",this.sketchId),this.$store.dispatch("updateScenarios",this.sketchId),this.$store.dispatch("updateScenarioTemplates",this.sketchId),this.$store.dispatch("updateSigmaList",this.sketchId)},updated:function(){this.$nextTick((function(){this.setDrawerBorderStyle(),this.setDrawerResizeEvents()}))},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},scenarios:function(){return this.$store.state.scenarios},scenarioTemplates:function(){return this.$store.state.scenarioTemplates}},methods:{addScenarioDialog:function(){this.dialog=!0},hideDrawer:function(){this.navigationDrawer.width=0,this.$emit("hideLeftPanel")},setDrawerBorderStyle:function(){var e=this.$refs.drawer.$el.querySelector(".v-navigation-drawer__border");e.style.cursor="ew-resize"},setDrawerResizeEvents:function(){var e=this,t=1,i=this.$refs.drawer.$el,n=i.querySelector(".v-navigation-drawer__border"),s=i.classList.contains("v-navigation-drawer--right")?"right":"left";function a(e){document.body.style.cursor="ew-resize";var t="right"===s?document.body.scrollWidth-e.clientX:e.clientX;i.style.width=t+"px"}n.addEventListener("mousedown",(function(e){e.offsetX<t&&(i.style.transition="initial",document.addEventListener("mousemove",a,!1))}),!1),document.addEventListener("mouseup",(function(){i.style.transition="",e.navigationDrawer.width=i.style.width,document.body.style.cursor="",document.removeEventListener("mousemove",a,!1)}),!1)}},watch:{sketch:function(e){"archived"===e.status[0].status&&this.$router.push({name:"Overview",params:{sketchId:this.sketch.id}}),document.title=this.sketch.name},showLeftPanel:function(e){!0===e&&(this.navigationDrawer.width=400)}}},Xi=Ji,Gi=Object(c["a"])(Xi,kt,xt,!1,null,null,null),Wi=Gi.exports;n["default"].use(d["a"]);var Ki=[{name:"Home",path:"/",component:$},{path:"/sketch/:sketchId",component:Wi,props:!0,children:[{path:"",name:"Overview",redirect:{name:"Explore"}},{path:"explore",name:"Explore",component:bt,props:!0}]}],Zi=new d["a"]({mode:"history",base:"/v2/",routes:Ki}),en=i("2f62");n["default"].use(en["a"]);var tn=function(e){return{sketch:{},meta:{},searchHistory:{},scenarios:[],scenarioTemplates:[],tags:[],dataTypes:[],count:0,currentSearchNode:null,currentUser:e,activeContext:{scenario:null,facet:null,question:null}}},nn=tn(),sn=new en["a"].Store({state:nn,mutations:{SET_SKETCH:function(e,t){n["default"].set(e,"sketch",t.objects[0]),n["default"].set(e,"meta",t.meta)},SET_SEARCH_HISTORY:function(e,t){n["default"].set(e,"searchHistory",t.objects)},SET_SCENARIOS:function(e,t){n["default"].set(e,"scenarios",t.objects[0])},SET_SCENARIO_TEMPLATES:function(e,t){n["default"].set(e,"scenarioTemplates",t.objects)},SET_TIMELINE_TAGS:function(e,t){var i=t.objects[0]["field_bucket"]["buckets"];n["default"].set(e,"tags",i)},SET_DATA_TYPES:function(e,t){var i=t.objects[0]["field_bucket"]["buckets"];n["default"].set(e,"dataTypes",i)},SET_COUNT:function(e,t){n["default"].set(e,"count",t)},SET_SEARCH_NODE:function(e,t){n["default"].set(e,"currentSearchNode",t)},SET_SIGMA_LIST:function(e,t){n["default"].set(e,"sigmaRuleList",t["objects"]),n["default"].set(e,"sigmaRuleList_count",t["meta"]["rules_count"])},SET_ACTIVE_USER:function(e,t){y.getLoggedInUser().then((function(t){var i=t.data.objects[0].username;n["default"].set(e,"currentUser",i)}))},SET_ACTIVE_CONTEXT:function(e,t){n["default"].set(e,"activeContext",t)},CLEAR_ACTIVE_CONTEXT:function(e){var t={scenario:null,facet:null,question:null};n["default"].set(e,"activeContext",t)},RESET_STATE:function(e,t){y.getLoggedInUser().then((function(t){var i=t.data.objects[0].username;Object.assign(e,tn(i))}))}},actions:{updateSketch:function(e,t){return y.getSketch(t).then((function(i){e.commit("SET_SKETCH",i.data),e.commit("SET_ACTIVE_USER",i.data),e.dispatch("updateTimelineTags",t),e.dispatch("updateDataTypes",t)})).catch((function(e){}))},updateCount:function(e,t){return y.countSketchEvents(t).then((function(t){e.commit("SET_COUNT",t.data.meta.count)})).catch((function(e){}))},resetState:function(e){e.commit("RESET_STATE")},updateSearchNode:function(e,t){e.commit("SET_SEARCH_NODE",t)},updateSearchHistory:function(e,t){return t||(t=e.state.sketch.id),y.getSearchHistory(t).then((function(t){e.commit("SET_SEARCH_HISTORY",t.data)})).catch((function(e){}))},updateScenarios:function(e,t){return t||(t=e.state.sketch.id),y.getSketchScenarios(t).then((function(t){e.commit("SET_SCENARIOS",t.data)})).catch((function(e){}))},updateScenarioTemplates:function(e,t){return y.getScenarios(t).then((function(t){e.commit("SET_SCENARIO_TEMPLATES",t.data)})).catch((function(e){}))},updateTimelineTags:function(e,t){if(e.state.sketch.active_timelines.length){var i={aggregator_name:"field_bucket",aggregator_parameters:{field:"tag",limit:"1000"}};return y.runAggregator(t,i).then((function(t){e.commit("SET_TIMELINE_TAGS",t.data)})).catch((function(e){}))}},updateDataTypes:function(e,t){if(e.state.sketch.active_timelines.length){var i={aggregator_name:"field_bucket",aggregator_parameters:{field:"data_type",limit:"1000"}};return y.runAggregator(t,i).then((function(t){e.commit("SET_DATA_TYPES",t.data)})).catch((function(e){}))}},updateSigmaList:function(e){y.getSigmaList().then((function(t){e.commit("SET_SIGMA_LIST",t.data)})).catch((function(e){}))},setActiveContext:function(e,t){e.commit("SET_ACTIVE_CONTEXT",t)},clearActiveContext:function(e){e.commit("CLEAR_ACTIVE_CONTEXT")}}}),an=i("f13c"),rn=i.n(an),on=i("8e5f"),cn=i.n(on),ln=i("3a6f"),un=i.n(ln),dn=i("4eb5"),hn=i.n(dn),mn=i("ce5b"),vn=i.n(mn);i("bf40");n["default"].use(vn.a,{options:{customProperties:!0}});var fn={theme:{dark:!1}},pn=new vn.a(fn);i("b383"),i("2d27"),i("56eb");var gn=new n["default"],_n=t["default"]=gn;n["default"].use(i("2ead")),n["default"].use(un.a),n["default"].use(hn.a),n["default"].use(rn.a),n["default"].component("multiselect",cn.a),n["default"].config.productionTip=!1,new n["default"]({router:Zi,store:sn,vuetify:pn,render:function(e){return e(u)}}).$mount("#app")},"56eb":function(e,t,i){"use strict";i.r(t);i("7f7f"),i("ac6a");var n=i("2b0e"),s=i("6dde");s.keys().forEach((function(e){var t=s(e);n["default"].filter(t.default.name,t.default.filter)}))},6107:function(e,t,i){"use strict";i.r(t);var n=i("707c");t["default"]={name:"timeSince",filter:function(e){return e?n["a"].utc(e).fromNow():""}}},"69da":function(e,t,i){},"6dde":function(e,t,i){var n={"./Capitalize.js":"76f9","./CompactBytes.js":"3d1d","./CompactNumber.js":"d3b7","./FilterChip.js":"05a2","./FormatLabelText.js":"16f1","./FormatTimestamp.js":"09ff","./ToISO8601.js":"84cc","./shortDateTime.js":"481e","./timeSince.js":"6107"};function s(e){var t=a(e);return i(t)}function a(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=a,e.exports=s,s.id="6dde"},"707c":function(e,t,i){"use strict";var n=i("5a0c"),s=i.n(n),a=i("0ecf"),r=i.n(a),o=i("4208"),c=i.n(o);s.a.extend(r.a),s.a.extend(c.a),t["a"]=s.a},"71d3":function(e,t,i){},"75a6":function(e,t){function i(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id="75a6"},"76f9":function(e,t,i){"use strict";i.r(t);i("6b54");t["default"]={name:"capitalize",filter:function(e){return e?(e=e.toString(),e.charAt(0).toUpperCase()+e.slice(1)):""}}},"84cc":function(e,t,i){"use strict";i.r(t);var n=i("707c");t["default"]={name:"toISO8601",filter:function(e){return e<0?"No timestamp":Object(n["a"])(e).toISOString()}}},"97be":function(e,t,i){},"97f2":function(e,t,i){"use strict";i("524e")},b383:function(e,t,i){},c3ca:function(e,t,i){"use strict";i("09ae")},c7b3:function(e,t,i){},d3b7:function(e,t,i){"use strict";i.r(t),t["default"]={name:"compactNumber",filter:function(e){e||(e=0);var t="";if(e>999999999)e=Math.round(e/1e9*10)/10,t="B";else if(e>999999)e=Math.round(e/1e6*10)/10,t="M";else{if(!(e>999))return e;e=Math.round(e/1e3*10)/10,t="K"}return e+t}}}}]);
//# sourceMappingURL=chunk-common.d4a1ae0b.js.map