(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-common"],{0:function(t,e,n){t.exports=n("56d7")},"0062":function(t,e,n){},"05a2":function(t,e,n){"use strict";n.r(e),e["default"]={name:"filterChip",filter:function(t){return"label"===t.type?"__ts_star"===t.value?"Starred":"__ts_comment"===t.value?"Commented":t.value:t.field+":"+t.value}}},"09ae":function(t,e,n){},"09ff":function(t,e,n){"use strict";n.r(e);n("6b54");e["default"]={name:"formatTimestamp",filter:function(t){var e=parseInt(t).toString().length;return 13===e?t:(15===e||16===e?t/=1e3:10===e&&(t*=1e6),parseInt(t))}}},"165b":function(t,e,n){},"16f1":function(t,e,n){"use strict";n.r(e);n("a481");e["default"]={name:"formatLabelText",filter:function(t){return t.replace("__ts_","")}}},"17b7":function(t,e,n){},1890:function(t,e,n){"use strict";n("4ea4")},2736:function(t,e,n){"use strict";n("17b7")},"2a67":function(t,e,n){},"2b31":function(t,e,n){"use strict";n("f921")},"2d27":function(t,e,n){"use strict";n.r(e);n("7f7f"),n("ac6a");var i=n("2b0e"),s=n("75a6");s.keys().forEach((function(t){var e=s(t),n=e.default.name;i["default"].component(n,e.default||e)}))},"2d9e":function(t,e,n){"use strict";n("71d3")},"35fd":function(t,e,n){"use strict";n("97be")},3788:function(t,e,n){},3884:function(t,e,n){"use strict";n("c7b3")},"3d1d":function(t,e,n){"use strict";n.r(e),e["default"]={name:"compactBytes",filter:function(t){t||(t=0);var e=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.min(Math.floor(Math.log(t)/Math.log(1e3)),e.length-1),i=1*(t/Math.pow(1e3,n)).toFixed(2);return i+e[n]}}},"43f8":function(t,e,n){"use strict";n.r(e);n("6b54");e["default"]={name:"initialLetter",filter:function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()):""}}},"444e":function(t,e,n){"use strict";n("2a67")},"481e":function(t,e,n){"use strict";n.r(e);var i=n("707c");e["default"]={name:"shortDateTime",filter:function(t){return i["a"].utc(t).format("YYYY-MM-DD HH:mm")}}},"4ea4":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var i=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{id:"app"}},[n("v-snackbar",{attrs:{timeout:t.snackbar.timeout,color:t.snackbar.color,top:""},scopedSlots:t._u([{key:"action",fn:function(e){var i=e.attrs;return[n("v-btn",t._b({attrs:{text:""},on:{click:function(e){t.snackbar.active=!1}}},"v-btn",i,!1),[t._v(" Close ")])]}}]),model:{value:t.snackbar.active,callback:function(e){t.$set(t.snackbar,"active",e)},expression:"snackbar.active"}},[t._v("\n    "+t._s(t.snackbar.message)+"\n    ")]),n("v-main",[n("router-view")],1)],1)},r=[],a={name:"app",data:function(){return{}},computed:{snackbar:function(){return this.$store.state.snackbar}},methods:{setErrorSnackBar:function(t){var e={message:t,color:"error",timeout:7e3};this.$store.dispatch("setSnackBar",e)}},mounted:function(){ro.$on("errorSnackBar",this.setErrorSnackBar);var t=localStorage.getItem("isDarkTheme");t&&(this.$vuetify.theme.dark="true"===t);var e=document.body;e.dataset.theme=this.$vuetify.theme.dark?"dark":"light"},beforeDestroy:function(){ro.$off("errorSnackBar")}},o=a,c=n("2877"),l=Object(c["a"])(o,s,r,!1,null,null,null),u=l.exports,d=n("8c4f"),h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-toolbar",{attrs:{flat:"",color:"transparent"}},[n("v-avatar",{staticClass:"mt-2 ml-n3"},[n("router-link",{attrs:{to:"/"}},[n("v-img",{attrs:{src:"/dist/timesketch-color.png","max-height":"25","max-width":"25",contain:""}})],1)],1),n("span",{staticStyle:{"font-size":"1.2em"}},[t._v("timesketch")]),n("v-spacer"),n("v-btn",{attrs:{small:"",depressed:""},on:{click:t.switchUI}},[t._v(" Use the old UI ")]),n("v-avatar",{staticClass:"ml-3",attrs:{color:"grey lighten-1",size:"25"}},[n("span",{staticClass:"white--text"},[t._v(t._s(t._f("initialLetter")(t.currentUser)))])]),n("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-avatar",[n("v-btn",t._g(t._b({attrs:{small:"",icon:""}},"v-btn",s,!1),i),[n("v-icon",[t._v("mdi-dots-vertical")])],1)],1)]}}])},[n("v-card",[n("v-list",[n("v-list-item-group",{attrs:{color:"primary"}},[n("v-list-item",{on:{click:t.toggleTheme}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-brightness-6")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Toggle theme")])],1)],1),n("a",{staticStyle:{"text-decoration":"none",color:"inherit"},attrs:{href:"/logout/"}},[n("v-list-item",[n("v-list-item-icon",[n("v-icon",[t._v("mdi-logout")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Logout")])],1)],1)],1)],1)],1)],1)],1)],1),n("v-container",{attrs:{fluid:"","pa-0":""}},[n("v-sheet",{staticClass:"pa-5",attrs:{color:t.$vuetify.theme.dark?"grey darken-4":"grey lighten-3","min-height":"200"}},[n("h2",[t._v("Start new investigation")]),n("v-row",{staticClass:"mt-5",attrs:{"no-gutters":""}},[n("v-dialog",{attrs:{width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({staticClass:"mr-5",attrs:{depressed:"",small:"",color:"primary"}},"v-btn",s,!1),i),[t._v(" Blank sketch ")])]}}])},[n("v-card",{staticClass:"pa-4"},[n("h3",[t._v("New sketch")]),n("br"),n("v-text-field",{attrs:{outlined:"",dense:"",placeholder:"Name your sketch",autofocus:""},model:{value:t.sketchForm.name,callback:function(e){t.$set(t.sketchForm,"name",e)},expression:"sketchForm.name"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{disabled:!t.sketchForm.name,color:"primary",text:""},on:{click:function(e){return t.createSketch()}}},[t._v(" Create ")])],1)],1)],1)],1)],1),n("div",{staticClass:"pa-5"},[n("h2",[t._v("Your recent work")]),n("ts-sketch-list")],1)],1)],1)},m=[],v=(n("a481"),n("6b54"),n("7f7f"),n("bc3a")),p=n.n(v),f=p.a.create({baseURL:"/v2/api/v1",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}}),g=p.a.create({baseURL:"/v2/api/v1",responseType:"blob",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}});f.interceptors.response.use((function(t){return t}),(function(t){return 500===t.response.status?ro.$emit("errorSnackBar","Server side error. Please contact your server administrator for troubleshooting."):ro.$emit("errorSnackBar",t.response.data.message),Promise.reject(t)}));var _={getSketchList:function(t,e,n,i){var s={params:{scope:t,page:e,per_page:n,search_query:i}};return f.get("/sketches/",s)},getSketch:function(t){return f.get("/sketches/"+t+"/")},createSketch:function(t){return f.post("/sketches/",t)},deleteSketch:function(t){return f.delete("/sketches/"+t+"/")},archiveSketch:function(t){var e={action:"archive"};return f.post("/sketches/"+t+"/archive/",e)},unArchiveSketch:function(t){var e={action:"unarchive"};return f.post("/sketches/"+t+"/archive/",e)},exportSketch:function(t){var e={action:"export"};return g.post("/sketches/"+t+"/archive/",e)},getSketchAttributes:function(t){return f.get("/sketches/"+t+"/attribute/")},addSketchAttribute:function(t,e,n,i){var s={name:e,values:[n],ontology:i,action:"post"};return f.post("/sketches/"+t+"/attribute/",s)},getSketchTimeline:function(t,e){return f.get("/sketches/"+t+"/timelines/"+e+"/")},getSketchTimelineAnalysis:function(t,e){return f.get("/sketches/"+t+"/timelines/"+e+"/analysis/")},saveSketchTimeline:function(t,e,n,i,s){var r={name:n,description:i,color:s};return f.post("/sketches/"+t+/timelines/+e+"/",r)},saveSketchSummary:function(t,e,n){var i={name:e,description:n};return f.post("/sketches/"+t+"/",i)},deleteSketchTimeline:function(t,e){return f.delete("/sketches/"+t+/timelines/+e+"/")},createEvent:function(t,e,n,i,s,r){var a={date_string:e,message:n,timestamp_desc:i,attributes:s};return f.post("/sketches/"+t+"/event/create/",a,r)},getEvent:function(t,e,n){var i={params:{searchindex_id:e,event_id:n}};return f.get("/sketches/"+t+"/event/",i)},saveEventAnnotation:function(t,e,n,i,s){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a={annotation:n,annotation_type:e,events:i,current_search_node_id:s.id,remove:r};return f.post("/sketches/"+t+"/event/annotate/",a)},tagEvents:function(t,e,n){var i={tag_string:JSON.stringify(n),events:e,verbose:!1};return f.post("/sketches/"+t+"/event/tagging/",i)},updateEventAnnotation:function(t,e,n,i,s){var r={annotation:n,annotation_type:e,events:i,current_search_node_id:s.id};return f.put("/sketches/"+t+"/event/annotate/",r)},deleteEventAnnotation:function(t,e,n,i,s){var r={params:{annotation_id:n,annotation_type:e,event_id:i._id,searchindex_id:i._index,current_search_node_id:s.id}};return f.delete("/sketches/"+t+"/event/annotate/",r)},getStoryList:function(t){return f.get("sketches/"+t+"/stories/")},getStory:function(t,e){return f.get("/sketches/"+t+"/stories/"+e+"/")},createStory:function(t,e,n){var i={title:t,content:e};return f.post("/sketches/"+n+/stories/,i)},updateStory:function(t,e,n,i){var s={title:t,content:e};return f.post("/sketches/"+n+/stories/+i+"/",s)},deleteStory:function(t,e){return f.delete("/sketches/"+t+/stories/+e+"/")},getView:function(t,e){return f.get("/sketches/"+t+"/views/"+e+"/")},createView:function(t,e,n,i){var s={name:e,query:n,filter:i,dsl:""};return f.post("/sketches/"+t+/views/,s)},updateView:function(t,e,n,i){var s={query:n,filter:i};return f.post("/sketches/"+t+/views/+e+"/",s)},deleteView:function(t,e){return f.delete("/sketches/"+t+"/views/"+e+"/")},search:function(t,e){return f.post("/sketches/"+t+"/explore/",e)},exportSearchResult:function(t,e){return g.post("/sketches/"+t+"/explore/",e)},getAggregations:function(t){return f.get("/sketches/"+t+"/aggregation/")},getAggregationGroups:function(t){return f.get("/sketches/"+t+"/aggregation/group/")},runAggregator:function(t,e){return f.post("/sketches/"+t+"/aggregation/explore/",e)},runAggregatorGroup:function(t,e){return f.get("/sketches/"+t+"/aggregation/group/"+e+"/")},saveAggregation:function(t,e,n,i){var s={name:n,description:e.description,agg_type:e.name,chart_type:i["supported_charts"],parameters:i};return f.post("/sketches/"+t+"/aggregation/",s)},countSketchEvents:function(t){return f.get("/sketches/"+t+"/count/")},uploadTimeline:function(t,e){return f.post("/upload/",t,e)},getSessions:function(t,e){return f.get("/sketches/"+t+"/explore/sessions/"+e+"/")},getUsers:function(){return f.get("/users/")},getGroups:function(){return f.get("/groups/")},grantSketchAccess:function(t,e,n){var i={users:e,groups:n};return f.post("/sketches/"+t+/collaborators/,i)},revokeSketchAccess:function(t,e,n){var i={remove_users:e,remove_groups:n};return f.post("/sketches/"+t+/collaborators/,i)},setSketchPublicAccess:function(t,e){var n={public:e};return f.post("/sketches/"+t+/collaborators/,n)},getAnalyzers:function(t){return f.get("/sketches/"+t+"/analyzer/")},runAnalyzers:function(t,e,n){var i={timeline_ids:e,analyzer_names:n};return f.post("/sketches/"+t+/analyzer/,i)},getAnalyzerSession:function(t,e){return f.get("/sketches/"+t+"/analyzer/sessions/"+e+"/")},getActiveAnalyzerSessions:function(t){return f.get("/sketches/"+t+"/analyzer/sessions/active/")},getLoggedInUser:function(){return f.get("/users/me/")},generateGraphFromPlugin:function(t,e,n,i,s){var r={plugin:e,config:{filter:{indices:n,timelineIds:i}},refresh:s};return i.length&&(r["timeline_ids"]=i),f.post("/sketches/"+t+/graph/,r)},getGraphPluginList:function(){return f.get("/graphs/")},saveGraph:function(t,e,n){var i={name:e,elements:n};return f.post("/sketches/"+t+/graphs/,i)},getSavedGraphList:function(t){return f.get("/sketches/"+t+/graphs/)},getSavedGraph:function(t,e){var n={params:{format:"cytoscape"}};return f.get("/sketches/"+t+/graphs/+e+"/",n)},getSearchHistory:function(t){return f.get("/sketches/"+t+/searchhistory/)},getSearchHistoryTree:function(t){return f.get("/sketches/"+t+/searchhistorytree/)},getSigmaRuleList:function(){return f.get("/sigmarules/")},getSigmaRuleResource:function(t){return f.get("/sigmarules/"+t+"/")},getSigmaRuleByText:function(t){var e={content:t};return f.post("/sigmarules/text/",e)},deleteSigmaRule:function(t){return f.delete("/sigmarules/"+t+"/")},createSigmaRule:function(t){var e={rule_yaml:t};return f.post("/sigmarules/",e)},updateSigmaRule:function(t,e){var n={id:t,rule_yaml:e};return f.put("/sigmarules/"+t+"/",n)},getSearchTemplates:function(){return f.get("/searchtemplates/")},parseSearchTemplate:function(t,e){return f.post("/searchtemplates/"+t+"/parse/",e)},getContextLinkConfig:function(){return f.get("/contextlinks/")},getScenarioTemplates:function(){return f.get("/scenarios/")},getSketchScenarios:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={};return e&&(n.params={status:e}),f.get("/sketches/"+t+"/scenarios/",n)},addScenario:function(t,e,n){var i={scenario_name:e,display_name:n};return f.post("/sketches/"+t+"/scenarios/",i)},renameScenario:function(t,e,n){var i={scenario_name:n};return f.post("/sketches/"+t+"/scenarios/"+e+"/",i)},setScenarioStatus:function(t,e,n){var i={status:n};return f.post("/sketches/"+t+"/scenarios/"+e+"/status/",i)},createQuestionConclusion:function(t,e,n){var i={conclusionText:n};return f.post("/sketches/"+t+"/questions/"+e+"/",i)},editQuestionConclusion:function(t,e,n,i){var s={conclusionText:i};return f.put("/sketches/"+t+"/questions/"+e+"/conclusions/"+n+"/",s)},deleteQuestionConclusion:function(t,e,n){return f.delete("/sketches/"+t+"/questions/"+e+"/conclusions/"+n+"/")},getTagMetadata:function(){return f.get("/intelligence/tagmetadata/")}},y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-row",{staticClass:"mt-5",attrs:{"no-gutters":""}},[n("v-text-field",{attrs:{outlined:"",flat:"",dense:"","hide-details":"","single-line":"",label:"Search","prepend-inner-icon":"mdi-magnify"},on:{change:t.search}}),n("v-spacer"),n("v-btn-toggle",{attrs:{dense:"",group:""},model:{value:t.toggleStateButton,callback:function(e){t.toggleStateButton=e},expression:"toggleStateButton"}},[n("v-btn",{on:{click:function(e){return t.switchScope("recent")}}},[t._v(" Recent ")]),n("v-btn",{on:{click:function(e){return t.switchScope("user")}}},[t._v(" My sketches ")]),n("v-btn",{on:{click:function(e){return t.switchScope("shared")}}},[t._v(" Shared with me ")])],1)],1),n("br"),n("v-data-table",{attrs:{headers:t.headers,items:t.sketches,"items-per-page":15,options:t.options,"server-items-length":t.numSketches,"footer-props":{"items-per-page-options":[15,30,40,50,100]},"disable-filtering":"","disable-sort":"",loading:t.loading},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.name",fn:function(e){var i=e.item;return[n("router-link",{staticStyle:{"text-decoration":"none"},attrs:{to:{name:"Overview",params:{sketchId:i.id}}}},[t._v(t._s(i.name))])]}},{key:"item.created_at",fn:function(e){var i=e.item;return[t._v("\n      "+t._s(t._f("shortDateTime")(i.created_at))+" "),n("small",[t._v("("+t._s(t._f("timeSince")(i.created_at))+")")])]}},{key:"item.last_activity",fn:function(e){var n=e.item;return[t._v("\n      "+t._s(t._f("timeSince")(n.last_activity))+"\n    ")]}}])})],1)},b=[],k={data:function(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Creator",value:"user"},{text:"Created at",value:"created_at"},{text:"Last active",value:"last_activity"}],sketches:[],numSketches:0,options:{},loading:!1,toggleStateButton:0,scope:"recent",searchQuery:null}},watch:{options:{handler:function(){this.getSketches()},deep:!0}},methods:{search:function(t){this.scope="search",this.searchQuery=t,this.getSketches()},switchScope:function(t){this.scope=t,this.getSketches()},getSketches:function(){var t=this;this.loading=!0,_.getSketchList(this.scope,this.options.page,this.options.itemsPerPage,this.searchQuery).then((function(e){t.sketches=e.data.objects,t.numSketches=e.data.meta.total_items,t.loading=!1})).catch((function(e){t.loading=!1,console.error(e)}))}}},S=k,w=Object(c["a"])(S,y,b,!1,null,"6f2c2155",null),x=w.exports,C={components:{TsSketchList:x},data:function(){return{sketchForm:{name:""},scenarioTemplates:[]}},computed:{currentUser:function(){return this.$store.state.currentUser}},methods:{toggleTheme:function(){this.$vuetify.theme.dark=!this.$vuetify.theme.dark,localStorage.setItem("isDarkTheme",this.$vuetify.theme.dark.toString())},switchUI:function(){window.location.href=window.location.href.replace("/v2/","/")},clearFormData:function(){this.sketchForm.name=""},createSketch:function(){var t=this;_.createSketch(this.sketchForm).then((function(e){var n=e.data.objects[0].id;t.clearFormData(),t.$router.push({name:"Overview",params:{sketchId:n}})})).catch((function(t){}))}},created:function(){var t=this;this.$store.dispatch("resetState"),document.title="Timesketch",_.getScenarioTemplates().then((function(e){t.scenarioTemplates=e.data["objects"]})).catch((function(t){}))}},T=C,$=Object(c["a"])(T,h,m,!1,null,null,null),E=$.exports,F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{directives:[{name:"show",rawName:"v-show",value:"Explore"===t.currentRouteName,expression:"currentRouteName === 'Explore'"}]},[n("explore",{attrs:{"sketch-id":t.sketchId}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"Intelligence"===t.currentRouteName,expression:"currentRouteName === 'Intelligence'"}]},[n("threat-intel",{attrs:{"sketch-id":t.sketchId}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"Graph"===t.currentRouteName,expression:"currentRouteName === 'Graph'"}]},[n("graph")],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"Story"===t.currentRouteName,expression:"currentRouteName === 'Story'"}]},[n("story",{attrs:{"sketch-id":t.sketchId,"story-id":t.storyId}})],1)])},P=[],A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[t.showRightSidePanel?n("v-navigation-drawer",{staticStyle:{"box-shadow":"0 10px 15px -3px #888"},attrs:{fixed:"",right:"",width:"600"},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("v-toolbar",{attrs:{flat:""}},[n("v-toolbar-title",[t._v("Right Side Panel")]),n("v-spacer"),n("v-btn",{attrs:{icon:""},on:{click:function(e){t.showRightSidePanel=!1}}},[n("v-icon",[t._v("mdi-close")])],1)],1)]},proxy:!0}],null,!1,1533655335)},[n("v-container",[t._v(" TODO: Add content here ")])],1):t._e(),n("v-card",{staticClass:"pa-3 pt-0 mt-n3",attrs:{flat:"",color:"transparent"}},[n("v-card",{staticClass:"d-flex align-start mb-1",attrs:{outlined:""}},[n("v-sheet",{staticClass:"mt-2"},[n("ts-search-history-buttons",{on:{toggleSearchHistory:function(e){return t.toggleSearchHistory()}}})],1),n("v-menu",{attrs:{"offset-y":"",attach:"","close-on-content-click":!1,"close-on-click":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-text-field",t._g(t._b({ref:"searchInput",staticClass:"pa-1",attrs:{"hide-details":"",label:"Search",placeholder:"Search","single-line":"",dense:"",filled:"",flat:"",solo:"","append-icon":"mdi-magnify",id:"tsSearchInput"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},click:function(e){t.showSearchDropdown=!0}},model:{value:t.currentQueryString,callback:function(e){t.currentQueryString=e},expression:"currentQueryString"}},"v-text-field",s,!1),i))]}}]),model:{value:t.showSearchDropdown,callback:function(e){t.showSearchDropdown=e},expression:"showSearchDropdown"}},[n("ts-search-dropdown",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onClickOutside,expression:"onClickOutside"}],attrs:{"selected-labels":t.selectedLabels,"query-string":t.currentQueryString},on:{setActiveView:t.searchView,addChip:t.addChip,updateLabelChips:function(e){return t.updateLabelChips()},"close-on-click":function(e){t.showSearchDropdown=!1},"node-click":t.jumpInHistory,setQueryAndFilter:t.setQueryAndFilter}})],1)],1),n("div",{staticClass:"mt-4"},[n("v-card",{directives:[{name:"show",rawName:"v-show",value:t.showSearchHistory,expression:"showSearchHistory"}],attrs:{outlined:""}},[n("v-toolbar",{attrs:{dense:"",flat:""}},[n("v-toolbar-title",[t._v("Search history")]),n("v-spacer"),n("v-slider",{staticClass:"mt-6",attrs:{"thumb-label":"",ticks:"","append-icon":"mdi-magnify-plus-outline","prepend-icon":"mdi-magnify-minus-outline",min:"0.1",max:"1",step:"0.1"},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var n=e.value;return[t._v(" "+t._s(100*n)+"% ")]}}]),model:{value:t.zoomLevel,callback:function(e){t.zoomLevel=e},expression:"zoomLevel"}}),n("v-btn",{staticClass:"ml-4",attrs:{icon:""},on:{click:function(e){t.showSearchHistory=!1}}},[n("v-icon",[t._v("mdi-close")])],1)],1),n("v-divider"),n("div",{directives:[{name:"dragscroll",rawName:"v-dragscroll"}],staticClass:"pa-md-4 no-scrollbars",staticStyle:{overflow:"scroll","white-space":"nowrap","max-height":"500px","min-height":"100px"}},[n("ts-search-history-tree",{staticStyle:{"transform-origin":"top left"},style:{transform:"scale("+t.zoomLevel+")"},attrs:{"show-history":t.showSearchHistory},on:{"node-click":t.jumpInHistory}})],1)],1)],1),n("v-sheet",{staticClass:"mb-4 mt-4",attrs:{color:"transparent"}},[n("ts-timeline-picker",{attrs:{"current-query-filter":t.currentQueryFilter,"count-per-index":t.countPerIndex,"count-per-timeline":t.countPerTimeline},on:{updateSelectedTimelines:function(e){return t.updateSelectedTimelines(e)}}}),n("span",{staticStyle:{position:"relative",top:"-5px"}},[n("ts-upload-timeline-form",{attrs:{"btn-type":"small"}})],1),n("span",{staticStyle:{position:"relative",top:"-5px"}},[n("v-dialog",{attrs:{width:"600"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{small:"",text:"",rounded:"",color:"primary"}},"v-btn",s,!1),i),[n("v-icon",{attrs:{left:"",small:""}},[t._v(" mdi-plus ")]),t._v("\n              Add manual event\n            ")],1)]}}]),model:{value:t.addManualEvent,callback:function(e){t.addManualEvent=e},expression:"addManualEvent"}},[n("ts-add-manual-event",{attrs:{app:"",datetimeProp:t.datetimeManualEvent},on:{cancel:function(e){t.addManualEvent=!1}}})],1)],1)],1),n("div",{staticClass:"mt-n3"},[t._l(t.timeFilterChips,(function(e,i){return n("span",{key:i+e.value},[n("v-menu",{attrs:{"offset-y":"","content-class":"menu-with-gap"},scopedSlots:t._u([{key:"activator",fn:function(i){var s=i.on;return[n("v-chip",t._g({attrs:{outlined:""}},s),[n("v-icon",{attrs:{left:"",small:""}},[t._v(" mdi-clock-outline ")]),n("span",{style:[e.active?"":{"text-decoration":"line-through",opacity:"50%"}]},[n("span",[t._v(t._s(e.value.split(",")[0]))]),"datetime_range"===e.type&&e.value.split(",")[0]!==e.value.split(",")[1]?n("span",[t._v("\n                  → "+t._s(e.value.split(",")[1]))]):t._e()])],1)]}}],null,!0)},[n("v-card",[n("v-list",[n("v-menu",{staticStyle:{overflow:"visible"},attrs:{"offset-y":"","close-on-content-click":!1,"close-on-click":!0,"nudge-top":"70","content-class":"menu-with-gap","allow-overflow":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-list-item",t._g(t._b({},"v-list-item",s,!1),i),[n("v-list-item-action",[n("v-icon",[t._v("mdi-square-edit-outline")])],1),n("v-list-item-subtitle",[t._v("Edit filter")])],1)]}}],null,!0)},[n("ts-filter-menu",{attrs:{app:"","selected-chip":e},on:{updateChip:function(n){return t.updateChip(n,e)}}})],1),n("v-list-item",{on:{click:function(n){return t.toggleChip(e)}}},[n("v-list-item-action",[e.active?n("v-icon",[t._v("mdi-eye-off")]):n("v-icon",[t._v("mdi-eye")])],1),n("v-list-item-subtitle",[e.active?n("span",[t._v("Temporarily disable")]):n("span",[t._v("Re-enable")])])],1),n("v-list-item",{on:{click:function(n){return t.removeChip(e)}}},[n("v-list-item-action",[n("v-icon",[t._v("mdi-delete")])],1),n("v-list-item-subtitle",[t._v("Remove filter")])],1)],1)],1)],1),i+1<t.timeFilterChips.length?n("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"2px"},attrs:{icon:"",small:""}},[t._v("OR")]):t._e()],1)})),n("span",[n("v-menu",{staticStyle:{overflow:"visible"},attrs:{"offset-y":"","close-on-content-click":!1,"close-on-click":!0,"content-class":"menu-with-gap","allow-overflow":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{small:"",text:"",rounded:"",color:"primary"}},"v-btn",s,!1),i),[n("v-icon",{attrs:{left:"",small:""}},[t._v(" mdi-plus ")]),t._v("\n              Add timefilter\n            ")],1)]}}]),model:{value:t.timeFilterMenu,callback:function(e){t.timeFilterMenu=e},expression:"timeFilterMenu"}},[n("ts-filter-menu",{attrs:{app:""},on:{cancel:function(e){t.timeFilterMenu=!1},addChip:t.addChip}})],1)],1)],2),t.filterChips.length?n("div",[n("v-chip-group",t._l(t.filterChips,(function(e,i){return n("span",{key:i+e.value},[n("v-chip",{attrs:{small:"",outlined:"",close:""},on:{"click:close":function(n){return t.removeChip(e)}}},["__ts_star"===e.value?n("v-icon",{attrs:{left:"",small:"",color:"amber"}},[t._v("mdi-star")]):t._e(),"__ts_comment"===e.value?n("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-comment-multiple-outline")]):t._e(),t._v("\n            "+t._s(t._f("formatLabelText")(e.value))+"\n          ")],1),i+1<t.timeFilterChips.length?n("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"2px"},attrs:{icon:"",small:""}},[t._v("AND")]):t._e()],1)})),0)],1):t._e()],1),n("div",{staticClass:"mt-3 mx-3"},[t.activeContext.question?n("div",{class:[t.$vuetify.theme.dark?"dark-info-card":"light-info-card"]},[n("v-toolbar",{attrs:{dense:"",flat:"",color:"transparent"}},[n("h4",[t._v(t._s(t.activeContext.question.display_name))]),n("v-spacer"),n("v-btn",{staticClass:"mr-1",attrs:{small:"",icon:""},on:{click:function(e){return t.$store.dispatch("clearActiveContext")}}},[n("v-icon",[t._v("mdi-close")])],1)],1),n("p",{staticClass:"mt-1 pb-4 px-4",staticStyle:{"font-size":"0.9em"}},[t._v("\n        "+t._s(t.activeContext.question.description)+"\n      ")])],1):t._e()]),n("v-card",{staticClass:"mt-5 mx-3",attrs:{flat:""}},[n("ts-event-list",{attrs:{"query-request":t.activeQueryRequest},on:{countPerIndex:function(e){return t.updateCountPerIndex(e)},countPerTimeline:function(e){return t.updateCountPerTimeline(e)}}})],1)],1)},O=[],D=(n("7514"),n("20d6"),n("ac6a"),n("386d"),n("f559"),n("34f3")),N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return Object.keys(t.treeData).length>0?n("ul",{staticClass:"tree"},[n("tree-node",{attrs:{node:t.treeData,"handle-click":t.handleClick,"selected-node":t.selectedNode}})],1):t._e()},I=[],R=(n("6762"),n("2fdb"),n("7618")),L=(n("456d"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",[n("span",{class:[{active:t.isSelected},{star:t.hasStar&&!t.isSelected},{dimmed:0===t.count&&!t.isSelected}],staticStyle:{"min-width":"205px"},attrs:{id:t.node.id},on:{click:function(e){return t.handleClick(t.node)}}},[t.hasStar?n("i",{staticClass:"fas fa-star",staticStyle:{float:"left",color:"#ffd700","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"#777777","margin-right":"10px","margin-top":"3px"}}):t._e(),t.hasStar?n("v-icon",{staticStyle:{float:"left",color:"#333","margin-right":"10px"}},[t._v(" mdi-star ")]):t._e(),t.hasComment?n("v-icon",{staticStyle:{float:"left","margin-right":"10px"}},[t._v("mdi-comment")]):t._e(),t.hasLabel?n("v-icon",{staticClass:"fas fa-tag",staticStyle:{float:"left","margin-right":"10px"}},[t._v("mdi-label")]):t._e(),n("div",{staticClass:"query-string",class:[{"query-string-active":t.isSelected}],staticStyle:{float:"left"}},[t._v("\n      "+t._s(t.node.query_string)+"\n    ")]),n("div",{staticClass:"tag is-light",staticStyle:{"margin-left":"10px","margin-right":"-5px",float:"right"}},[t._v("\n      "+t._s(t._f("compactNumber")(t.count))+"\n    ")])],1),t.node.children&&t.node.children.length?n("ul",t._l(t.node.children,(function(e){return n("node",{key:e.id,attrs:{node:e,"handle-click":t.handleClick,"selected-node":t.selectedNode}})})),1):t._e()])}),j=[],q={name:"node",props:{node:Object,handleClick:Function,selectedNode:Object},computed:{hasStar:function(){return this.node.labels.includes("__ts_star")},hasLabel:function(){return this.node.labels.includes("__ts_label")},hasComment:function(){return this.node.labels.includes("__ts_comment")},isSelected:function(){return this.selectedNode.id===this.node.id},count:function(){return this.node.query_result_count||0}}},Q=q,H=(n("3884"),Object(c["a"])(Q,L,j,!1,null,"1623aa42",null)),M=H.exports;function W(t,e,n){if(t.hasOwnProperty(e)&&!0===n(e,t[e]))return t;for(var i=0;i<Object.keys(t).length;i++){var s=t[Object.keys(t)[i]];if("object"===Object(R["a"])(s)&&null!=s){var r=W(s,e,n);if(null!=r)return r}}return null}var z={components:{TreeNode:M},data:function(){return{treeData:{},selectedNode:null,initialNode:null}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{handleClick:function(t){this.$emit("node-click",t),this.selectedNode=t},handleClickFromDropdown:function(t){var e;e="number"===typeof t?t:t.id;var n=W(this.treeData,"id",(function(t,n){return n===e}));this.$emit("node-click",n),this.selectedNode=n},createBranch:function(t){if(this.selectedNode){if(this.selectedNode.id===t.id)return;return this.selectedNode.children.push(t),void(this.selectedNode=t)}this.fetchHistory();var e=W(this.treeData,"id",(function(e,n){return n===t.parent}));if(e){if(e.children.some((function(e){return e.id===t.id})))return;return e.children.push(t),void(this.selectedNode=t)}var n=W(this.treeData,"id",(function(e,n){return n===t.id}));n&&(this.selectedNode=n)},annotateNode:function(t){t.searchNode.labels.includes(t.type)||t.searchNode.labels.push(t.type)},scrollTo:function(){this.$nextTick((function(){document.getElementById(this.selectedNode.id.toString()).scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}))},fetchHistory:function(){var t=this;_.getSearchHistoryTree(this.sketch.id).then((function(e){if(t.treeData=e.data.objects[0],!t.selectedNode){var n=e.data.meta["last_node_id"];t.selectedNode=W(t.treeData,"id",(function(t,e){return e===n}))}})).catch((function(t){}))}},beforeDestroy:function(){ro.$off("createBranch"),ro.$off("eventAnnotated"),ro.$off("triggerScrollTo"),ro.$off("selected-node-from-dropdown")},created:function(){ro.$on("createBranch",this.createBranch),ro.$on("eventAnnotated",this.annotateNode),ro.$on("triggerScrollTo",this.scrollTo),ro.$on("selected-node-from-dropdown",this.handleClickFromDropdown),this.fetchHistory()},watch:{selectedNode:function(){this.$store.dispatch("updateSearchNode",this.selectedNode),this.scrollTo()}}},G=z,B=Object(c["a"])(G,N,I,!1,null,null,null),U=B.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:"",disabled:!t.hasParent},on:{click:t.searchHistoryBack}},"v-btn",s,!1),i),[n("v-icon",[t._v("mdi-arrow-left")])],1)]}}])},[n("span",[t._v("Click to go back")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:"",disabled:!t.hasChild},on:{click:t.searchHistoryForward}},"v-btn",s,!1),i),[n("v-icon",[t._v("mdi-arrow-right")])],1)]}}])},[n("span",[t._v("Click to go forward")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:""},on:{click:function(e){return t.$emit("toggleSearchHistory")}}},"v-btn",s,!1),i),[n("v-icon",[t._v("mdi-history")])],1)]}}])},[n("span",[t._v("Click to see your search history")])])],1)},Y=[],J={computed:{currentSearchNode:function(){return this.$store.state.currentSearchNode},hasParent:function(){return!!this.currentSearchNode&&"number"===typeof this.currentSearchNode.parent},hasChild:function(){return!!this.currentSearchNode&&this.currentSearchNode.children.length}},methods:{searchHistoryBack:function(){ro.$emit("selected-node-from-dropdown",this.currentSearchNode.parent)},searchHistoryForward:function(){if(this.currentSearchNode.children.length){var t=this.currentSearchNode.children.slice(-1).pop();ro.$emit("selected-node-from-dropdown",t)}}}},X=J,K=(n("35fd"),Object(c["a"])(X,V,Y,!1,null,"6d090d22",null)),Z=K.exports,tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{staticStyle:{overflow:"hidden"},attrs:{outlined:"","min-height":"550"}},[n("v-row",[t.matches.savedSearches.length?n("v-col",{attrs:{cols:"4"}},[n("h5",{staticClass:"mt-3 ml-4"},[t._v("Saved searches")]),n("v-list",{staticClass:"overflow-y-auto",class:t.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},t._l(t.matches.savedSearches,(function(e){return n("v-list-item",{key:e.id,staticStyle:{"font-size":"0.9em"},on:{click:function(n){return t.$emit("setActiveView",e)}}},[n("v-list-item-content",[t._v("\n            "+t._s(e.name)+"\n          ")])],1)})),1)],1):t._e(),n("v-divider",{attrs:{vertical:""}}),n("v-col",{attrs:{cols:"4"}},[n("h5",{staticClass:"mt-3 ml-4"},[t._v("Data types")]),n("v-list",{staticClass:"overflow-y-auto",class:t.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},t._l(t.matches.dataTypes,(function(e){return n("v-list-item",{key:e.data_type,staticStyle:{"font-size":"0.9em"},on:{click:function(n){return t.searchForDataType(e.data_type)}}},[n("v-list-item-content",[n("span",[t._v(t._s(e.data_type)+"\n              "),n("span",{staticClass:"font-weight-bold",staticStyle:{"font-size":"0.8em"}},[t._v("("+t._s(t._f("compactNumber")(e.count))+")")])])])],1)})),1)],1),n("v-divider",{attrs:{vertical:""}}),t.matches.labels.length||t.matches.tags.length?n("v-col",{attrs:{cols:"4"}},[n("h5",{staticClass:"mt-3 ml-5"},[t._v("Tags")]),n("v-list",{staticClass:"overflow-y-auto",class:t.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},[t._l(t.matches.labels,(function(e){return n("v-list-item",{key:e.label,staticStyle:{"font-size":"0.9em"},on:{click:function(n){return t.searchForLabel(e.label)}}},["__ts_star"===e.label?n("v-icon",{attrs:{left:"",small:"",color:"amber"}},[t._v("mdi-star")]):t._e(),"__ts_comment"===e.label?n("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-comment-multiple-outline")]):t._e(),n("v-list-item-content",[n("span",[t._v(t._s(t._f("formatLabelText")(e.label))+"\n              "),n("span",{staticClass:"font-weight-bold",staticStyle:{"font-size":"0.8em"}},[t._v("("+t._s(t._f("compactNumber")(e.count))+")")])])])],1)})),t._l(t.matches.tags,(function(e){return n("v-list-item",{key:e.tag,staticStyle:{"font-size":"0.9em"},on:{click:function(n){return t.searchForTag(e.tag)}}},[n("v-list-item-content",[n("span",[t._v(t._s(e.tag)+"\n              "),n("span",{staticClass:"font-weight-bold",staticStyle:{"font-size":"0.8em"}},[t._v("("+t._s(t._f("compactNumber")(e.count))+")")])])])],1)}))],2)],1):t._e()],1)],1)},et=[],nt=(n("8615"),function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}}),it={props:["selectedLabels","queryString"],computed:{meta:function(){return this.$store.state.meta},searchHistory:function(){return this.$store.state.searchHistory},tags:function(){return this.$store.state.tags},dataTypes:function(){return this.$store.state.dataTypes},all:function(){return{fields:this.meta.mappings,tags:this.tags,labels:this.meta.filter_labels,dataTypes:this.dataTypes,savedSearches:this.meta.views}},scrollbarTheme:function(){return this.$vuetify.theme.dark?"dark":"light"},matches:function(){var t=this,e={};return this.queryString?(e["fields"]=this.meta.mappings.filter((function(e){return e.field.toLowerCase().includes(t.queryString.toLowerCase())})),e["tags"]=this.tags.filter((function(e){return e.tag.toLowerCase().includes(t.queryString.toLowerCase())})),e["labels"]=this.meta.filter_labels.filter((function(e){return e.label.toLowerCase().includes(t.queryString.toLowerCase())})),e["dataTypes"]=this.dataTypes.filter((function(e){return e.data_type.toLowerCase().includes(t.queryString.toLowerCase())})),e["savedSearches"]=this.meta.views.filter((function(e){return e.name.toLowerCase().includes(t.queryString.toLowerCase())})),Object.values(e).filter((function(t){return t.length})).length?e:this.all):this.all}},methods:{searchForLabel:function(t){var e={doSearch:!0,queryString:"*"};e.queryFilter=nt();var n={field:"",value:t,type:"label",operator:"must",active:!0};e.queryFilter.chips.push(n),this.$emit("setQueryAndFilter",e)},searchForTag:function(t){var e={doSearch:!0};e.queryString="tag:"+t,e.queryFilter=nt(),this.$emit("setQueryAndFilter",e)},searchForDataType:function(t){var e={doSearch:!0};e.queryString='data_type:"'+t+'"',e.queryFilter=nt(),this.$emit("setQueryAndFilter",e)},searchForField:function(t){var e={},n="";""!==this.queryString&&(n=this.queryString+" "),this.queryString.includes(" ")||(n=""),e.doSearch=!1,e.queryString=n+t+":",e.queryFilter=nt(),this.$emit("setQueryAndFilter",e)}}},st=it,rt=(n("444e"),Object(c["a"])(st,tt,et,!1,null,"92ef386a",null)),at=rt.exports,ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[t._l(t.allTimelines,(function(e){return n("ts-timeline-chip",{key:e.id+e.name,attrs:{timeline:e,"is-selected":t.isSelected(e),"is-empty-state":t.isEmptyState,"events-count":t.getCount(e)},on:{remove:t.remove,save:t.save,toggle:t.toggleTimeline}})})),t.sketch.timelines.length>20?n("v-btn",{staticClass:"mt-n3 mr-5",attrs:{small:"",outlined:"",rounded:"",color:"primary"},on:{click:function(e){t.showAll=!t.showAll}}},[t.showAll?n("span",[t._v(" show less ")]):n("span",[t._v(" "+t._s(t.sketch.timelines.length-20)+" more.. ")])]):t._e(),t.sketch.timelines.length>5?n("span",{staticStyle:{position:"relative",top:"-5px"}},[n("v-btn-toggle",{attrs:{dense:"",rounded:""}},[t.sketch.timelines.length>5?n("v-btn",{attrs:{small:"",outlined:"",rounded:"",color:"primary"},on:{click:function(e){return t.enableAllTimelines()}}},[t._v("\n        Select all\n      ")]):t._e(),t.sketch.timelines.length>5?n("v-btn",{attrs:{small:"",outlined:"",rounded:"",color:"primary"},on:{click:function(e){return t.disableAllTimelines()}}},[t._v("\n        Unselect all\n      ")]):t._e()],1)],1):t._e()],2)},ct=[],lt=(n("55dd"),n("75fc")),ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",["processing"===t.timelineStatus?n("v-dialog",{attrs:{width:"600"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;e.attrs;return[n("v-chip",t._g({staticClass:"mr-2 mb-3",style:t.getTimelineStyle(t.timeline)},i),[n("span",{staticClass:"timeline-name-ellipsis"},[t._v(t._s(t.timeline.name))]),n("span",{staticClass:"ml-1"},[n("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:20,width:1}})],1)])]}}],null,!1,1840978003),model:{value:t.dialogStatus,callback:function(e){t.dialogStatus=e},expression:"dialogStatus"}},[n("v-card",[n("v-app-bar",{attrs:{flat:"",dense:""}},[t._v('Importing events to timeline "'+t._s(t.timeline.name)+'"')]),n("div",{staticClass:"pa-5"},[n("ul",[n("li",[n("strong",[t._v("Opensearch index: ")]),t._v(t._s(t.timeline.searchindex.index_name))]),"processing"===t.timelineStatus||"ready"===t.timelineStatus?n("li",[n("strong",[t._v("Number of events: ")]),t._v("\n            "+t._s(t._f("compactNumber")(t.allIndexedEvents))+"\n          ")]):t._e(),n("li",[n("strong",[t._v("Created by: ")]),t._v(t._s(t.timeline.user.username))]),n("li",[n("strong",[t._v("Created at: ")]),t._v(t._s(t._f("shortDateTime")(t.timeline.created_at))+"\n            "),n("small",[t._v("("+t._s(t._f("timeSince")(t.timeline.created_at))+")")])])]),n("br"),n("div",{staticClass:"mb-3"},[t._v(t._s(t.datasourcesProcessing.length)+" datasource(s) in progress..")]),t._l(t.datasourcesProcessing,(function(e){return n("v-alert",{key:e.id,attrs:{"colored-border":"",border:"left",elevation:"1",color:t.datasourceStatusColors(e)}},[n("ul",[n("li",[n("strong",[t._v("Original filename:")]),t._v(" "+t._s(e.original_filename))]),n("li",[n("strong",[t._v("File on disk:")]),t._v(" "+t._s(e.file_on_disk))]),n("li",[n("strong",[t._v("File size:")]),t._v(" "+t._s(t._f("compactBytes")(e.file_size)))]),n("li",[n("strong",[t._v("Provider:")]),t._v(" "+t._s(e.provider))]),e.data_label?n("li",[n("strong",[t._v("Data label:")]),t._v(" "+t._s(e.data_label))]):t._e(),n("li",[n("strong",[t._v("Status:")]),t._v(" "+t._s(t.dataSourceStatus(e)))]),n("li",[n("strong",[t._v("Total File Events:")]),t._v(t._s(t._f("compactNumber")(t.totalEventsDatasource(e.file_on_disk)))+"\n            ")]),"fail"===t.dataSourceStatus(e)?n("li",[n("strong",[t._v("Error message:")]),e.error_message?n("code",[t._v(" "+t._s(e.error_message))]):t._e()]):t._e()]),n("br")])})),t.percentComplete>.1?n("v-card",{attrs:{outlined:""}},[n("v-card-title",[t._v(t._s(t.eventsPerSecond.slice(-1)[0])+" events/s")]),n("v-sparkline",{attrs:{value:t.eventsPerSecond,gradient:t.sparkline.gradient,smooth:t.sparkline.radius||!1,padding:t.sparkline.padding,"line-width":t.sparkline.width,"stroke-linecap":t.sparkline.lineCap,"gradient-direction":t.sparkline.gradientDirection,fill:t.sparkline.fill,type:t.sparkline.type,"auto-line-width":t.sparkline.autoLineWidth,"auto-draw":""}}),n("v-sheet",{staticClass:"py-4 px-3"},[n("v-progress-linear",{attrs:{color:"light-blue",height:"25",value:t.percentComplete,rounded:""}},[t._v("\n              "+t._s(t.percentComplete)+"% (complete "+t._s(t.processingETA())+")\n            ")])],1)],1):n("v-card",{staticClass:"pa-3",attrs:{outlined:""}},[t._v(" Waiting for processing to begin.. ")])],2),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialogStatus=!1}}},[t._v(" Close ")])],1)],1)],1):n("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1,"content-class":"menu-with-gap"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[n("v-chip",t._g({staticClass:"mr-2 mb-3",style:t.getTimelineStyle(t.timeline)},i),["fail"===t.timelineStatus?n("v-icon",{attrs:{left:"",color:"red"}},[t._v(" mdi-alert-circle-outline ")]):t._e(),n("span",{staticClass:"timeline-name-ellipsis"},[t._v(t._s(t.timeline.name))]),"processing"===t.timelineStatus?n("span",{staticClass:"ml-3"},[n("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:20,width:2}})],1):t._e(),"ready"===t.timelineStatus?n("v-avatar",{staticStyle:{"background-color":"rgba(0, 0, 0, 0.1)","font-size":"0.55em"},attrs:{right:""}},[t._v("\n          "+t._s(t._f("compactNumber")(t.eventsCount))+"\n        ")]):t._e()],1)]}}])},[n("v-sheet",{attrs:{flat:"",width:"320"}},[n("v-list",[n("v-dialog",{attrs:{width:"600"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-list-item",t._g(t._b({},"v-list-item",s,!1),i),[n("v-list-item-action",[n("v-icon",[t._v("mdi-square-edit-outline")])],1),n("v-list-item-subtitle",[t._v("Rename timeline")])],1)]}}]),model:{value:t.dialogRename,callback:function(e){t.dialogRename=e},expression:"dialogRename"}},[n("v-card",{staticClass:"pa-4"},[n("h3",[t._v("Rename timeline")]),n("br"),n("v-text-field",{attrs:{outlined:"",dense:"",autofocus:""},on:{focus:function(t){return t.target.select()}},model:{value:t.newTimelineName,callback:function(e){t.newTimelineName=e},expression:"newTimelineName"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialogRename=!1}}},[t._v(" Close ")]),n("v-btn",{attrs:{color:"primary",depressed:""},on:{click:t.rename}},[t._v(" Save ")])],1)],1)],1),"ready"===t.timelineStatus?n("v-list-item",{on:{click:function(e){return t.$emit("toggle",t.timeline)}}},[n("v-list-item-action",[t.isSelected?n("v-icon",[t._v("mdi-eye-off")]):n("v-icon",[t._v("mdi-eye")])],1),t.isSelected?n("v-list-item-subtitle",[t._v("Temporarily disabled")]):n("v-list-item-subtitle",[t._v("Re-enable")])],1):t._e(),n("v-dialog",{attrs:{width:"600"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-list-item",t._g(t._b({},"v-list-item",s,!1),i),[n("v-list-item-action",[n("v-icon",[t._v(t._s(t.iconStatus))])],1),n("v-list-item-subtitle",[t._v("Data sources ("+t._s(t.datasources.length)+")")])],1)]}}]),model:{value:t.dialogStatus,callback:function(e){t.dialogStatus=e},expression:"dialogStatus"}},[n("v-card",[n("v-app-bar",{attrs:{flat:"",dense:""}},[t._v(t._s(t.timeline.name))]),n("div",{staticClass:"pa-3"},[n("ul",{staticStyle:{"list-style-type":"none"}},[n("li",[n("strong",[t._v("Opensearch index: ")]),t._v(t._s(t.timeline.searchindex.index_name))]),"processing"===t.timelineStatus||"ready"===t.timelineStatus?n("li",[n("strong",[t._v("Number of events: ")]),t._v("\n                  "+t._s(t._f("compactNumber")(t.allIndexedEvents))+"\n                ")]):t._e(),n("li",[n("strong",[t._v("Created by: ")]),t._v(t._s(t.timeline.user.username))]),n("li",[n("strong",[t._v("Created at: ")]),t._v(t._s(t._f("shortDateTime")(t.timeline.created_at))+"\n                  "),n("small",[t._v("("+t._s(t._f("timeSince")(t.timeline.created_at))+")")])])]),n("br"),t._v("\n              "+t._s(t.datasources.length)+" data source(s) in this timeline "),n("br"),n("br"),t._l(t.datasources,(function(e){return n("v-alert",{key:e.id,attrs:{"colored-border":"",border:"left",elevation:"1",color:t.datasourceStatusColors(e)}},[n("ul",{staticStyle:{"list-style-type":"none"}},[n("li",[n("strong",[t._v("Original filename:")]),t._v(" "+t._s(e.original_filename))]),n("li",[n("strong",[t._v("File on disk:")]),t._v(" "+t._s(e.file_on_disk))]),n("li",[n("strong",[t._v("File size:")]),t._v(" "+t._s(t._f("compactBytes")(e.file_size)))]),n("li",[n("strong",[t._v("Provider:")]),t._v(" "+t._s(e.provider))]),e.data_label?n("li",[n("strong",[t._v("Data label:")]),t._v(" "+t._s(e.data_label))]):t._e(),n("li",[n("strong",[t._v("Status:")]),t._v(" "+t._s(t.dataSourceStatus(e)))]),n("li",[n("strong",[t._v("Total File Events:")]),t._v(t._s(t._f("compactNumber")(t.totalEventsDatasource(e.file_on_disk)))+"\n                  ")]),"fail"===t.dataSourceStatus(e)?n("li",[n("strong",[t._v("Error message:")]),e.error_message?n("code",[t._v(" "+t._s(e.error_message))]):t._e()]):t._e()]),n("br")])}))],2),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialogStatus=!1}}},[t._v(" Close ")])],1)],1)],1)],1),n("div",{staticClass:"px-4"},[n("v-color-picker",{attrs:{value:t.timeline.color,"show-swatches":!t.showCustomColorPicker,swatches:t.colorPickerSwatches,"hide-canvas":!t.showCustomColorPicker,"hide-sliders":!t.showCustomColorPicker,"hide-inputs":"",mode:"hexa","dot-size":"15"},on:{"update:color":t.updateColor}}),n("v-btn",{staticClass:"mt-2",attrs:{text:"","x-small":""},on:{click:function(e){t.showCustomColorPicker=!t.showCustomColorPicker}}},[t.showCustomColorPicker?n("span",[t._v("Palette")]):n("span",[t._v("Custom color")])])],1),n("br")],1)],1)],1)},dt=[],ht=n("2ef0"),mt=n.n(ht),vt=n("707c"),pt=[["#222"],["#42b3f4"],["red","orange","yellow"],["purple","violet"],["#00c6ff","#F0F","#FF0"],["#f72047","#ffd200","#1feaea"]],ft={props:["timeline","eventsCount","isSelected","isEmptyState"],data:function(){return{autoRefresh:!1,allIndexedEvents:0,totalEvents:null,dialogStatus:!1,dialogRename:!1,datasources:[],timelineStatus:null,eventsPerSecond:[],newTimelineName:Object(lt["a"])(this.timeline.name),sparkline:{width:2,radius:10,padding:8,lineCap:"round",gradient:pt[5],gradientDirection:"bottom",gradients:pt,fill:!1,type:"trend",autoDrawDuration:4e3,autoLineWidth:!1},showCustomColorPicker:!1,colorPickerSwatches:[["#5E75C2","#BB77C4","#FD7EAC"],["#FF9987","#FFC66A","#F9F871"],["#FFB5BC","#97D788","#9BC1AF"],["#FFC7A0","#FFDF79","#FFEAEF"],["#DEBBFF","#9AB0FB","#CFFBE2"]]}},computed:{meta:function(){return this.$store.state.meta},datasourceErrors:function(){return this.timeline.datasources.filter((function(t){return t.error_message}))},datasourcesProcessing:function(){var t=this;return this.datasources.filter((function(e){return"processing"===t.dataSourceStatus(e)||"queueing"===t.dataSourceStatus(e)}))},sketch:function(){return this.$store.state.sketch},totalEventsToIndex:function(){var t=this;return this.datasources.filter((function(e){return"processing"===t.dataSourceStatus(e)})).map((function(t){return t.total_file_events})).reduce((function(t,e){return t+e}),0)},secondsToComplete:function(){return this.totalEventsToIndex/this.avarageEventsPerSecond()},percentComplete:function(){return Math.floor(this.secondsSinceStart()/this.secondsToComplete*100)||0},iconStatus:function(){return"ready"===this.timelineStatus?"mdi-information-outline":"processing"===this.timelineStatus?"mdi-circle-slice-7":"mdi-alert-circle-outline"}},methods:{rename:function(){this.dialogRename=!1,this.$emit("save",this.timeline,this.newTimelineName)},remove:function(){confirm("Delete the timeline?")&&this.$emit("remove",this.timeline)},secondsSinceStart:function(){if(!this.datasourcesProcessing.length)return 0;var t=vt["a"].utc(this.datasourcesProcessing[0].updated_at),e=vt["a"].utc(),n=e.diff(t,"second");return n},avarageEventsPerSecond:function(){var t=this.eventsPerSecond.reduce((function(t,e){return t+e}),0),e=t/this.eventsPerSecond.length||0;return Math.floor(e)},processingETA:function(){var t=this.secondsToComplete-this.secondsSinceStart(),e=Object(vt["a"])().add(t,"second").fromNow();return e},updateColor:mt.a.debounce((function(t){i["default"].set(this.timeline,"color",t.hex.substring(1)),this.$emit("save",this.timeline)}),300),getTimelineStyle:function(t){var e=t.color,n="none",i="50%",s=100;e.startsWith("#")||(e="#"+e),"ready"===this.timelineStatus?this.isSelected?i="100%":(e="#d2d2d2",n="line-through"):(e="#f5f5f5",i="100%");var r="linear-gradient(90deg, "+e+" "+s+"%, #d2d2d2  0%) ";return this.$vuetify.theme.dark?{background:r,filter:"grayscale(25%)",color:"#333"}:{background:r,"text-decoration":n,opacity:i}},fetchData:function(){var t=this;_.getSketchTimeline(this.sketch.id,this.timeline.id).then((function(e){t.timelineStatus=e.data.objects[0].status[0].status,t.datasources=e.data.objects[0].datasources;var n=t.allIndexedEvents;t.allIndexedEvents=e.data.meta.lines_indexed;var i=t.allIndexedEvents-n;i<1e4&&i>0&&t.eventsPerSecond.push(Math.floor(i/5)),"ready"!==t.timelineStatus&&"fail"!==t.timelineStatus?t.autoRefresh=!0:(t.autoRefresh=!1,t.$store.dispatch("updateSketch",t.sketch.id).then((function(){"ready"===t.timelineStatus&&t.$emit("toggle",e.data.objects[0])})))})).catch((function(t){console.log(t)}))},dataSourceStatus:function(t){return t.status[0]?t.status[0].status:"ready"},datasourceStatusColors:function(t){return t.status[0]?"ready"===t.status[0].status||t.status===[]?"success":"processing"===t.status[0].status?"info":"queueing"===t.status[0].status?"warning":"error":"ready"},totalEventsDatasource:function(t){return this.datasources.find((function(e){return e.file_on_disk===t})).total_file_events}},created:function(){this.timelineStatus=this.timeline.status[0].status,this.datasources=this.timeline.datasources,"processing"===this.timelineStatus?this.autoRefresh=!0:(this.autoRefresh=!1,this.allIndexedEvents=this.meta.stats_per_timeline[this.timeline.id]["count"]),this.newTimelineName=this.timeline.name},beforeDestroy:function(){clearInterval(this.t),this.t=!1},watch:{autoRefresh:function(t){t&&!this.t?this.t=setInterval(function(){this.fetchData()}.bind(this),5e3):(clearInterval(this.t),this.t=!1)},timeline:function(){this.timeline.datasources.length>this.datasources.length&&this.fetchData()}}},gt=ft,_t=Object(c["a"])(gt,ut,dt,!1,null,"a6275152",null),yt=_t.exports,bt={components:{TsTimelineChip:yt},props:["currentQueryFilter","countPerIndex","countPerTimeline"],computed:{sketch:function(){return this.$store.state.sketch},allTimelines:function(){var t=Object(lt["a"])(this.sketch.timelines);return t=t.sort((function(t,e){return t.name.localeCompare(e.name)})),this.showAll||(t=t.slice(0,20)),t},activeTimelines:function(){var t=Object(lt["a"])(this.sketch.active_timelines);return t.sort((function(t,e){return t.name.localeCompare(e.name)}))},isEmptyState:function(){return void 0===this.countPerTimeline}},data:function(){return{isDarkTheme:!1,isLoading:!1,selectedTimelines:[],showAll:!1}},methods:{isSelected:function(t){return this.selectedTimelines.map((function(t){return t.id})).includes(t.id)},getCount:function(t){var e=0;return this.countPerTimeline&&(e=this.countPerTimeline[t.id],"number"===typeof e)||!e&&this.countPerIndex&&(e=this.countPerIndex[t.searchindex.index_name]),e},remove:function(t){var e=this;this.isLoading=!0,_.deleteSketchTimeline(this.sketch.id,t.id).then((function(){e.$store.dispatch("updateSketch",e.sketch.id).then((function(){e.syncSelectedTimelines(),e.isLoading=!1}))})).catch((function(t){console.error(t),e.isLoading=!1}))},save:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n&&(this.isLoading=!0),_.saveSketchTimeline(this.sketch.id,t.id,n||t.name,t.description,t.color).then((function(){e.$store.dispatch("updateSketch",e.sketch.id).then((function(){e.syncSelectedTimelines(),e.isLoading=!1}))})).catch((function(t){console.error(t),e.isLoading=!1}))},enableAllTimelines:function(){this.selectedTimelines=this.activeTimelines,this.$emit("updateSelectedTimelines",this.selectedTimelines)},disableAllTimelines:function(){this.selectedTimelines=[],this.$emit("updateSelectedTimelines",this.selectedTimelines)},toggleTimeline:function(t){var e=this.selectedTimelines.slice(),n=e.map((function(t){return t.id})).indexOf(t.id);-1===n?e.push(t):e.splice(n,1),this.selectedTimelines=e,this.$emit("updateSelectedTimelines",this.selectedTimelines)},toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme},syncSelectedTimelines:function(){var t=this;if(this.currentQueryFilter.indices.includes("_all"))this.selectedTimelines=this.activeTimelines;else{var e=[];this.currentQueryFilter.indices.forEach((function(n){if("string"===typeof n){var i=t.activeTimelines.find((function(t){return t.searchindex.index_name===n}));e.push(i)}else if("number"===typeof n){var s=t.activeTimelines.find((function(t){return t.id===n}));e.push(s)}})),this.selectedTimelines=e}}},created:function(){ro.$on("isDarkTheme",this.toggleTheme),this.enableAllTimelines(),this.currentQueryFilter.indices.includes("_all")?this.selectedTimelines=this.activeTimelines:this.syncSelectedTimelines()},watch:{"currentQueryFilter.indices":function(t){this.syncSelectedTimelines()},deep:!0}},kt=bt,St=Object(c["a"])(kt,ot,ct,!1,null,null,null),wt=St.exports,xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{staticStyle:{overflow:"visible"},attrs:{width:"700"}},[n("v-container",{staticClass:"px-8"},[n("br"),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(0,"days")}}},[t._v("Today")]),n("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(7,"days")}}},[t._v("Last 7 days")]),n("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(30,"days")}}},[t._v("Last 30 days")]),n("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(90,"days")}}},[t._v("Last 90 days")]),n("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(1,"year")}}},[t._v("Last 1 year")])],1)],1),n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{value:t.formatStartTime,label:"From",outlined:"","hide-details":""},on:{click:function(e){t.showPicker=!0},change:t.setStartTime}})],1),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{value:t.formatEndTime,label:"To (optional)",outlined:"","hide-details":"","append-outer-icon":t.showPicker?"mdi-calendar-remove":"mdi-calendar"},on:{click:function(e){t.showPicker=!0},change:t.setEndTime,"click:append-outer":function(e){t.showPicker=!t.showPicker}}})],1)],1),t.showPicker?n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("date-picker",{ref:"picker",attrs:{mode:"dateTime",timezone:"UTC","is-dark":t.$vuetify.theme.dark,is24hr:"","is-range":"","is-expanded":""},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)],1):t._e(),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:t.clearAndCancel}},[t._v(" Cancel ")]),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.submit()}}},[t._v(" Add filter ")])],1)],1)],1)},Ct=[],Tt=(n("28a5"),n("404b")),$t=n.n(Tt),Et={props:["selectedChip"],components:{DatePicker:$t.a},data:function(){return{range:{start:"",end:""},filterTab:null,showPicker:!1}},computed:{dateRange:{set:function(t){this.range.start=vt["a"].utc(t.start).millisecond(0).toISOString(),this.range.end=vt["a"].utc(t.end).millisecond(0).toISOString()},get:function(){var t={start:this.range.start,end:this.range.end};return t}},formatStartTime:function(){return this.range.start},formatEndTime:function(){return this.range.start!==this.range.end&&this.range.start?this.range.end:""}},created:function(){this.selectedChip&&(this.range.start=this.selectedChip.value.split(",")[0],this.range.end=this.selectedChip.value.split(",")[1])},methods:{getDateRange:function(t,e){var n=vt["a"].utc(),i=n.subtract(t,e),s="datetime_range",r=i.format("YYYY-MM-DD")+","+n.format("YYYY-MM-DD"),a={field:"",type:s,value:r,operator:"must",active:!0};return this.addChip(a),this.$emit("cancel"),{start:n,end:i}},setStartTime:function(t){t?(this.range.start=vt["a"].utc(t).toISOString(),this.range.end||this.range.start&&(this.range.end=this.range.start||""),this.$refs.picker.focusDate(this.range.start)):this.range.start=""},setEndTime:function(t){t?(this.range.end=vt["a"].utc(t).toISOString(),this.$refs.picker.focusDate(this.range.start)):this.range.end=""},addDateTimeChip:function(t){var e="datetime_range",n={field:"",type:e,value:t,operator:"must",active:!0};this.addChip(n),this.range={start:null,end:null}},clearAndCancel:function(){this.range={start:"",end:""},this.$emit("cancel")},addChip:function(t){this.selectedChip?this.$emit("updateChip",t):this.$emit("addChip",t)},submit:function(){if(this.range.start){if(this.range.start===this.range.end){var t=this.range.start.split("T"),e=t[0],n=e+","+e;this.addDateTimeChip(n)}if(this.range.start,this.range.end,this.range.start!==this.range.end){var i="datetime_range",s=this.range.start+","+this.range.end,r={field:"",type:i,value:s,operator:"must",active:!0};this.addChip(r),this.range={start:"",end:""}}this.$emit("cancel")}}}},Ft=Et,Pt=Object(c["a"])(Ft,xt,Ct,!1,null,"5015cf2a",null),At=Pt.exports,Ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("v-dialog",{attrs:{persistent:"",width:"700"},model:{value:t.percentageFlag,callback:function(e){t.percentageFlag=e},expression:"percentageFlag"}},[n("v-card",{staticClass:"pa-5",attrs:{flat:""}},[t._v("\n      Uploading..\n      "),n("br"),n("br"),n("v-progress-linear",{attrs:{color:"light-blue",height:"25",value:t.percentCompleted}},[t._v(t._s(t.percentCompleted)+"%")]),n("v-divider")],1)],1),n("v-dialog",{attrs:{"max-width":"1000"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return["small"===t.btnType?n("v-btn",t._g(t._b({attrs:{small:"",text:"",rounded:"",color:"primary"}},"v-btn",s,!1),i),[n("v-icon",{attrs:{left:"",small:""}},[t._v(" mdi-plus ")]),t._v("\n        Add Timeline\n      ")],1):n("v-btn",t._g(t._b({attrs:{outlined:"",color:"primary"}},"v-btn",s,!1),i),[n("v-icon",{attrs:{left:""}},[t._v(" mdi-plus ")]),t._v("\n        Add Timeline\n      ")],1)]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-container",{staticClass:"px-8"},[n("v-card-title",{staticClass:"text-h5"},[t._v(" "+t._s(t.title)+" ")]),t.error.length>0?n("div",t._l(t.error,(function(e,i){return n("v-alert",{key:i,attrs:{outlined:"",type:"error"}},[t._v("\n            "+t._s(e)+"\n            "),n("br"),n("br"),["csv","jsonl","json"].includes(t.extension)?n("div",[t.headers.length>0?n("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[n("thead",[n("tr",t._l(t.headersTable,(function(e){return n("th",{key:e.name,staticClass:"text-left",style:e.color},[t.missingHeaders.includes(e.name)?n("div",[n("v-select",{attrs:{items:t.listHeadersSelectMenu,label:e.name,multiple:"",chips:"",hint:"Mapped to","persistent-hint":""},on:{change:function(n){return t.changeHeaderMapping(n,e.name)}},model:{value:t.mandatoryHeaders.find((function(t){return t.name===e.name})).columnsSelected,callback:function(n){t.$set(t.mandatoryHeaders.find((function(t){return t.name===e.name})),"columnsSelected",n)},expression:"mandatoryHeaders.find((h) => h.name === mandatoryHeader.name).columnsSelected"}})],1):n("div",[n("span",{staticClass:"tag is-large",style:e.color},[n("label",[t._v(t._s(e.name))])])])])})),0)]),n("br"),n("strong",[t._v("Preview")]),n("tbody",t._l(t.numberRows,(function(e){return n("tr",{key:e},t._l(t.headersTable,(function(i){return n("td",{key:i.name},[t._v("\n                        "+t._s(i.values[e-1])+"\n                      ")])})),0)})),0)]},proxy:!0}],null,!0)}):t._e()],1):t._e()])})),1):t._e(),t.fileName?n("div",[n("v-text-field",{attrs:{label:"Timeline Name",outlined:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),"csv"===t.extension?n("v-radio-group",{scopedSlots:t._u([{key:"label",fn:function(){return[n("div",[t._v("Choose "),n("strong",[t._v("CSV delimiter")])])]},proxy:!0}],null,!1,3646347247),model:{value:t.CSVDelimiter,callback:function(e){t.CSVDelimiter=e},expression:"CSVDelimiter"}},t._l(t.delimitersList,(function(e,i){return n("v-radio",{key:i,attrs:{value:e},on:{change:function(n){return t.changeCSVDelimiter(e)}},scopedSlots:t._u([{key:"label",fn:function(){return[n("div",[t._v(t._s(i)+" ("+t._s(e)+")")])]},proxy:!0}],null,!0)})})),1):t._e(),t.percentageFlag?t._e():n("v-list",[t._v("\n            File info\n            "),n("v-simple-table",{attrs:{height:"100px"},scopedSlots:t._u([{key:"default",fn:function(){return[n("thead",[n("tr",t._l(t.fileMetaData,(function(e,i){return n("th",{key:i,staticClass:"text-left"},[t._v("\n                      "+t._s(i)+"\n                    ")])})),0)]),n("tbody",[n("tr",t._l(t.fileMetaData,(function(e,i){return n("td",{key:i,staticClass:"text-left"},[t._v("\n                      "+t._s(e)+"\n                    ")])})),0)])]},proxy:!0}],null,!1,362866586)})],1)],1):n("div",[n("v-file-input",{attrs:{label:"Plaso/CSV/JSONL file",outlined:"",dense:"",clearable:"",multiple:"","show-size":"","truncate-length":"15",id:"datafile"},on:{change:function(e){return t.setFile(e)},"click:clear":t.clearFormData},model:{value:t.uploadedFiles,callback:function(e){t.uploadedFiles=e},expression:"uploadedFiles"}})],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.clearFormData(),t.dialog=!1}}},[t._v("\n          Cancel\n        ")]),t.fileName?n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){return t.clearFormData()}}},[t._v(" Select another file ")]):t._e(),t.error.length>0||!t.fileName?t._e():n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){return t.submitForm()}}},[t._v(" Submit ")])],1)],1)],1)],1)},Dt=[],Nt=(n("6c7b"),n("5df3"),n("4f7f"),{props:["btnType"],data:function(){return{headersString:"",valuesString:[],title:"Upload your Plaso/CSV/JSONL file",headersMapping:[],mandatoryHeaders:[{name:"datetime",columnsSelected:[]},{name:"message",columnsSelected:[]}],form:{name:"",file:""},fileName:"",fileMetaData:{},error:[],percentCompleted:0,uploadedFiles:[],CSVDelimiter:",",infoMessage:"",delimitersList:{Comma:",",Semicolon:";",Pipe:"|"},showHelperFlag:!1,showPreviewFlag:!1,showAddColumnFlag:!1,checkedHeaders:[],staticNumberRows:3,dialog:!1,colors:[{name:"red",value:"background-color: #FEECF0; color:#CC0F35"},{name:"blue",value:"background-color: #EEF6FC; color:#1D72AA"},{name:"green",value:"background-color: #EFFAF3; color:#257942"}]}},computed:{headers:function(){var t=[];return"csv"===this.extension?t=this.headersString.split(this.CSVDelimiter):["json","jsonl"].includes(this.extension)&&(t=Object.keys(this.headersString)),t},missingHeaders:function(){var t=this;return this.mandatoryHeaders.filter((function(e){return t.headers.indexOf(e.name)<0})).map((function(t){return t.name}))},listHeadersSelectMenu:function(){var t=new Set(this.mandatoryHeaders.map((function(t){return t.name}))),e=this.headers.filter((function(e){return!t.has(e)}));return e.unshift("Create New Header"),e},extension:function(){var t=this.fileName.split(".");return t.length>1?t[t.length-1].toLowerCase():null},numberRows:function(){if("csv"===this.extension){var t=this.valuesString.indexOf("");return t<0?this.staticNumberRows:t}return["json","jsonl"].includes(this.extension)?this.valuesString.length:0},percentageFlag:function(){return this.percentCompleted>0},sketch:function(){return this.$store.state.sketch},headersTable:function(){var t=this,e={};if("csv"===this.extension)for(var n=this.valuesString.map((function(e){return e.split(t.CSVDelimiter)})),i=0;i<this.headers.length;i++){for(var s=[],r=0;r<n.length;r++)s.push(n[r][i]);e[this.headers[i]]=s}else if(["json","jsonl"].includes(this.extension))for(var a=0;a<this.valuesString.length;a++)for(var o in this.valuesString[a])o in e?e[o].push(this.valuesString[a][o]):e[o]=[this.valuesString[a][o]];else console.error(this.extension+" file extension not supported for this feature");var c=this.checkedHeaders;return c.sort().map((function(n){var i="",s=[];if(t.headers.includes(n))s=e[n],i=t.colors.find((function(t){return"blue"===t.name})).value;else{var r=t.headersMapping.find((function(t){return t.target===n}));if(r){if(r.source)if(1===r.source.length)s=e[r.source[0]];else for(var a=r.source,o=function(t){var n="";a.forEach((function(i){n+=i+": ",n+=JSON.stringify(e[i][t])+" | "})),s.push(n)},c=0;c<t.numberRows;c++)o(c);else s=Array(t.numberRows).fill(r.default_value);i=t.colors.find((function(t){return"green"===t.name})).value}else s=Array(t.numberRows).fill("Header not mapped"),i=t.colors.find((function(t){return"red"===t.name})).value}return{name:n,values:s,color:i}}))}},methods:{showHelper:function(){this.showPreviewFlag=!1,this.showAddColumnFlag=!1,this.showHelperFlag=!this.showHelperFlag},showPreview:function(){this.showHelperFlag=!1,this.showPreviewFlag=!this.showPreviewFlag,this.showPreviewFlag||(this.showAddColumnFlag=!1)},showAddColumn:function(){this.showAddColumnFlag=!this.showAddColumnFlag},getDefaultValue:function(t){var e=this.headersMapping.find((function(e){return e["target"]===t}));return e?e["default_value"]:null},changeCSVDelimiter:function(t){this.CSVDelimiter=t;for(var e=0;e<this.mandatoryHeaders.length;e++)this.mandatoryHeaders[e]["columnsSelected"]=[];this.headersMapping=[],this.validateFile()},changeHeaderMapping:function(t,e){var n=t[t.length-1],i=this.mandatoryHeaders.findIndex((function(t){return t.name===e}));this.mandatoryHeaders[i].columnsSelected="Create New Header"===n?["Create New Header"]:this.mandatoryHeaders[i].columnsSelected.filter((function(t){return"Create New Header"!==t}));var s=[],r=null;if("Create New Header"===n){s=null;do{r=prompt("Insert the default value for this header"),r.includes(this.CSVDelimiter)&&(alert("New header value cannot contain CSV separator (found ".concat(this.CSVDelimiter,")")),r=null)}while(!r)}else s=this.mandatoryHeaders[i].columnsSelected;this.headersMapping=this.headersMapping.filter((function(t){return t["target"]!==e})),(null===s||s.length>0)&&this.headersMapping.push({target:e,source:s,default_value:r}),this.validateFile()},clearFormData:function(){this.fileMetaData={},this.form.name="",this.form.file="",this.fileName="",this.headersMapping=[],this.infoMessage="",this.headersString="",this.valuesString=[],this.uploadedFiles=[],this.title="Upload your Plaso/JSONL/CSV file",this.error=[],this.percentCompleted=0;for(var t=0;t<this.mandatoryHeaders.length;t++)this.mandatoryHeaders[t]["columnsSelected"]=[]},submitForm:function(){var t=this;if(this.validateFile()){var e=new FormData;if(e.append("file",this.form.file),e.append("name",this.form.name),e.append("provider","WebUpload"),e.append("context",this.fileName),e.append("total_file_size",this.form.file.size),e.append("sketch_id",this.sketch.id),["csv","jsonl","json"].includes(this.extension)){var n=JSON.stringify(this.headersMapping);e.append("headersMapping",n),e.append("delimiter",this.CSVDelimiter)}var i={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){this.percentCompleted=Math.round(100*t.loaded/t.total)}.bind(this)};this.dialog=!1,_.uploadTimeline(e,i).then((function(){t.clearFormData(),t.percentCompleted=0,t.$store.dispatch("updateSketch",t.sketch.id)})).catch((function(t){}))}},validateFile:function(){this.error=[],this.form.file.size<=0&&this.error.push("Please select a non empty file");var t=["csv","json","jsonl","plaso"];if(t.includes(this.extension)||this.error.push("Please select a file with a valid extension: "+t.toString()),["csv","jsonl","json"].includes(this.extension)){this.headersMapping.length!==this.missingHeaders.length&&this.error.push("Missing headers: "+this.missingHeaders.toString());var e=this.headersMapping.filter((function(t){return t["source"]})).map((function(t){return t.source}));e=e.filter((function(t){return 1===t.length})).map((function(t){return t[0]})),e.length>new Set(e).size&&this.error.push("New headers mapping contains duplicates (".concat(e,")"))}return 0===this.error.length?this.title="Submit your file to Timesketch":this.title="Almost there... Map the "+this.missingHeaders.length+" missing headers.",0===this.error.length},setFile:function(t){if(t[0]){var e=function(t){return t/Math.pow(1024,2)};this.fileMetaData={Name:t[0].name,Size:e(t[0].size)+" MB"};var n=t[0].name;this.headersMapping=[],this.headersString="",this.valuesString=[],this.form.file=t[0],this.form.name=n.split(".").slice(0,-1).join("."),this.fileName=n,"csv"===this.extension?this.extractCSVHeader():["json","jsonl"].includes(this.extension)?this.extractJSONLHeader():this.validateFile(),this.checkedHeaders=this.mandatoryHeaders.map((function(t){return t.name}))}},extractCSVHeader:function(){var t=new FileReader,e=document.getElementById("datafile").files[0],n=this;t.readAsText(e.slice(0,1e4)),t.onloadend=function(t){if(t.target.readyState===FileReader.DONE){var e=t.target.result;n.headersString=e.split("\n")[0].replaceAll('"',""),n.valuesString=e.split("\n").slice(1,n.staticNumberRows+1),n.validateFile()}}},extractJSONLHeader:function(){var t=new FileReader,e=document.getElementById("datafile").files[0],n=this;t.readAsText(e.slice(0,1e4)),t.onloadend=function(t){if(t.target.readyState===FileReader.DONE){var e=t.target.result,i=e.split("\n"),s=Math.min(n.staticNumberRows,i.length);try{n.headersString=JSON.parse(i[0]),n.valuesString=i.slice(0,s).map((function(t){return JSON.parse(t)})),n.validateFile()}catch(a){var r=a.message;r+=". Your first lines of JSON: ",r+=i[0],r+=". Be sure to upload a JSON file in a JSONL format.",n.title="Cannot parse the JSON file",n.error.push(r)}}}}}}),It=Nt,Rt=Object(c["a"])(It,Ot,Dt,!1,null,null,null),Lt=Rt.exports,jt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{staticStyle:{overflow:"visible"},attrs:{width:"700"}},[n("v-container",{staticClass:"px-8"},[n("br"),n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{value:t.datetime,label:"Datetime",outlined:"","hide-details":""},on:{click:function(e){t.showPicker=!0}},model:{value:t.datetime,callback:function(e){t.datetime=e},expression:"datetime"}})],1)],1),t.showPicker?n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("date-picker",{ref:"picker",attrs:{mode:"dateTime",timezone:"UTC","is-dark":t.$vuetify.theme.dark,is24hr:"","is-date":"","is-expanded":""},model:{value:t.dateFromPicker,callback:function(e){t.dateFromPicker=e},expression:"dateFromPicker"}})],1)],1):t._e(),n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{value:t.message,label:"Message",outlined:"","hide-details":""},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{value:t.timestampDesc,label:"Timestamp Description",outlined:"","hide-details":""},model:{value:t.timestampDesc,callback:function(e){t.timestampDesc=e},expression:"timestampDesc"}})],1)],1),t._l(t.attributes,(function(e,i){return n("v-row",{key:i},[n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Attribute Name",outlined:"","hide-details":""},model:{value:t.attributes[i].name,callback:function(e){t.$set(t.attributes[i],"name",e)},expression:"attributes[index].name"}})],1),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Attribute Value",outlined:"","hide-details":""},model:{value:t.attributes[i].value,callback:function(e){t.$set(t.attributes[i],"value",e)},expression:"attributes[index].value"}})],1)],1)})),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:"",color:"primary",disabled:t.isDisabled},on:{click:function(e){return t.attributes.push({name:"",value:""})}}},[t._v("\n        Add Attribute\n      ")]),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:t.clearAndCancel}},[t._v(" Cancel ")]),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:t.submit}},[t._v(" Add Event ")])],1)],2)],1)},qt=[],Qt={props:["datetimeProp"],components:{DatePicker:$t.a},data:function(){return{message:null,timestampDesc:null,filterTab:null,showPicker:!1,attributes:[],datetime:this.datetimeProp}},watch:{datetimeProp:function(t){this.datetime=t}},computed:{dateFromPicker:{set:function(t){null!==t&&(this.datetime=vt["a"].utc(t).millisecond(0).toISOString())},get:function(){return this.datetime}},isDisabled:function(){return this.attributes.some((function(t){return""===t.name||""===t.value}))}},methods:{clearAndCancel:function(){this.datetime=null,this.message=null,this.timestampDesc=null,this.attributes=[],this.$emit("cancel")},submit:function(){var t=this;if(null!==this.datetime&&null!==this.message&&null!==this.timestampDesc){var e=this.$store.state.sketch.id,n={headers:{"Content-Type":"application/json"}},i={};this.attributes.filter((function(t){return!(""===t.name||""===t.value)})).reduce((function(t,e){i[e.name]=e.value}),i),_.createEvent(e,this.datetime,this.message,this.timestampDesc,i,n).then((function(e){t.clearAndCancel()})).catch((function(t){}))}}}},Ht=Qt,Mt=Object(c["a"])(Ht,jt,qt,!1,null,"035f3f29",null),Wt=Mt.exports,zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.eventList.objects.length||t.searchInProgress?t._e():n("div",{staticClass:"ml-3"},[n("p",[t._v("\n      Your search "),t.currentQueryString?n("span",[t._v('"'+t._s(t.currentQueryString)+'"')]):t._e(),t._v(" did not match any events.\n    ")]),n("p",[t._v("Suggestions:")]),n("li",[t._v("Try different keywords.")]),n("li",[t._v("Try more general keywords.")]),n("li",[t._v("Try fewer keywords.")])]),t.eventList.objects.length||t.searchInProgress?n("div",[n("v-data-table",{attrs:{headers:t.headers,items:t.eventList.objects,"footer-props":{"items-per-page-options":[10,40,80,100,200,500],"show-current-page":!0},loading:t.searchInProgress,options:t.tableOptions,"server-items-length":t.totalHitsForPagination,"item-key":"_id","loading-text":"Searching... Please wait","show-select":"","disable-filtering":"","disable-sort":"","hide-default-footer":t.totalHits<11||t.disablePagination,expanded:t.expandedRows,dense:t.displayOptions.isCompact,"fixed-header":""},on:{"update:options":function(e){t.tableOptions=e}},scopedSlots:t._u([{key:"top",fn:function(e){var i=e.pagination,s=e.options,r=e.updateOptions;return[n("v-toolbar",{attrs:{dense:"",flat:"",color:"transparent"}},[t.selectedEvents.length?n("div",[n("small",{staticClass:"mr-2"},[t._v("Actions:")]),n("v-btn",{attrs:{"x-small":"",outlined:""},on:{click:function(e){return t.toggleMultipleStars()}}},[n("v-icon",{attrs:{left:"",color:"amber"}},[t._v("mdi-star")]),t._v("\n              Toggle star\n            ")],1)],1):n("div",[n("span",{staticStyle:{display:"inline-block","min-width":"200px"}},[n("small",[t._v(t._s(t.fromEvent)+"-"+t._s(t.toEvent)+" of "+t._s(t.totalHits)+" events ("+t._s(t.totalTime)+"s)")])]),t.disableSaveSearch?t._e():n("v-dialog",{attrs:{width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",s,!1),i),[n("v-icon",[t._v("mdi-content-save-outline")])],1)]}}],null,!0),model:{value:t.saveSearchMenu,callback:function(e){t.saveSearchMenu=e},expression:"saveSearchMenu"}},[n("v-card",{staticClass:"pa-4"},[n("h3",[t._v("Save Search")]),n("br"),n("v-text-field",{attrs:{required:"",placeholder:"Name your saved search",outlined:"",dense:"",autofocus:""},on:{focus:function(t){return t.target.select()}},model:{value:t.saveSearchFormName,callback:function(e){t.saveSearchFormName=e},expression:"saveSearchFormName"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(e){t.saveSearchMenu=!1}}},[t._v(" Cancel ")]),n("v-btn",{attrs:{color:"primary",depressed:"",disabled:!t.saveSearchFormName},on:{click:t.saveSearch}},[t._v(" Save ")])],1)],1)],1),t.disableHistogram?t._e():n("v-btn",{attrs:{icon:""},on:{click:function(e){t.showHistogram=!t.showHistogram}}},[n("v-icon",[t._v("mdi-chart-bar")])],1),t.disableColumns?t._e():n("v-dialog",{attrs:{"max-width":"500px",scrollable:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",s,!1),i),[n("v-icon",[t._v("mdi-view-column-outline")])],1)]}}],null,!0),model:{value:t.columnDialog,callback:function(e){t.columnDialog=e},expression:"columnDialog"}},[n("v-card",{attrs:{height:"50vh"}},[n("v-card-title",[t._v("Select columns")]),n("v-card-text",[n("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.searchColumns,callback:function(e){t.searchColumns=e},expression:"searchColumns"}}),n("br"),n("v-data-table",{attrs:{headers:t.columnHeaders,items:t.meta.mappings,search:t.searchColumns,"hide-default-footer":!0,"item-key":"field","disable-pagination":"","show-select":"",dense:""},on:{input:t.updateSelectedFields},model:{value:t.selectedFields,callback:function(e){t.selectedFields=e},expression:"selectedFields"}})],1),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.selectedFields=[{field:"message",type:"text"}]}}},[t._v("\n                    Reset\n                  ")]),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.columnDialog=!1}}},[t._v(" Close ")])],1)],1)],1),t.disableSettings?t._e():n("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",s,!1),i),[n("v-icon",[t._v("mdi-dots-horizontal")])],1)]}}],null,!0)},[n("v-card",{staticClass:"mx-auto",attrs:{outlined:"","max-width":"475"}},[n("v-list",{attrs:{subheader:"","two-line":"",flat:"",dense:""}},[n("v-subheader",[t._v("Density")]),n("v-list-item-group",[n("v-list-item",{attrs:{ripple:!1}},[[n("v-list-item-action",[n("v-radio-group",{model:{value:t.displayOptions.isCompact,callback:function(e){t.$set(t.displayOptions,"isCompact",e)},expression:"displayOptions.isCompact"}},[n("v-radio",{attrs:{value:!1}})],1)],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Comfortable")]),n("v-list-item-subtitle",[t._v("More space between rows")])],1)]],2),n("v-list-item",{attrs:{ripple:!1}},[[n("v-list-item-action",[n("v-radio-group",{model:{value:t.displayOptions.isCompact,callback:function(e){t.$set(t.displayOptions,"isCompact",e)},expression:"displayOptions.isCompact"}},[n("v-radio",{attrs:{value:!0}})],1)],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Compact")]),n("v-list-item-subtitle",[t._v("Less space between rows")])],1)]],2)],1),n("v-divider"),n("v-list",{attrs:{subheader:"","two-line":"",flat:""}},[n("v-subheader",[t._v("Misc")]),n("v-list-item-group",[n("v-list-item",{attrs:{ripple:!1}},[n("v-list-item-action",[n("v-switch",{attrs:{dense:"",color:""},model:{value:t.displayOptions.showTags,callback:function(e){t.$set(t.displayOptions,"showTags",e)},expression:"displayOptions.showTags"}})],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Tags")]),n("v-list-item-subtitle",[t._v("Show tags")])],1)],1)],1),n("v-list-item-group",[n("v-list-item",{attrs:{ripple:!1}},[n("v-list-item-action",[n("v-switch",{attrs:{dense:""},model:{value:t.displayOptions.showEmojis,callback:function(e){t.$set(t.displayOptions,"showEmojis",e)},expression:"displayOptions.showEmojis"}})],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Emojis")]),n("v-list-item-subtitle",[t._v("Show emojis")])],1)],1)],1),n("v-list-item-group",[n("v-list-item",{attrs:{ripple:!1}},[n("v-list-item-action",[n("v-switch",{attrs:{dense:""},model:{value:t.displayOptions.showTimelineName,callback:function(e){t.$set(t.displayOptions,"showTimelineName",e)},expression:"displayOptions.showTimelineName"}})],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Timeline name")]),n("v-list-item-subtitle",[t._v("Show timeline name")])],1)],1)],1)],1)],1)],1)],1)],1),n("v-spacer"),t.totalHits>11&&!t.disablePagination?n("v-data-footer",{staticClass:"mr-n3",staticStyle:{border:"0"},attrs:{pagination:i,options:s,"show-current-page":!0,"items-per-page-options":[10,40,80,100,200,500],"items-per-page-text":"Rows per page:"},on:{"update:options":r}}):t._e()],1),t.showHistogram?n("v-card",{staticClass:"my-3",attrs:{outlined:""}},[n("v-toolbar",{attrs:{dense:"",flat:"",color:"transparent"}},[n("v-spacer"),t.timeFilterChips.length?n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.removeChips(t.timeFilterChips)}}},[t._v("\n              reset\n            ")]):t._e(),n("v-btn",{attrs:{icon:""},on:{click:function(e){t.showHistogram=!1}}},[n("v-icon",[t._v("mdi-close")])],1)],1),n("ts-bar-chart",{attrs:{"chart-data":t.eventList.meta.count_over_time},on:{addChip:function(e){return t.addChipFromHistogram(e)}}})],1):t._e()]}},{key:"expanded-item",fn:function(e){var i=e.headers,s=e.item;return[n("td",{attrs:{colspan:i.length}},[s.showDetails?n("v-container",{staticClass:"mt-4",attrs:{fluid:""}},[n("ts-event-detail",{attrs:{event:s}})],1):t._e(),s.showDetails&&s.deltaDays?n("v-divider"):t._e(),s.deltaDays>0?n("div",{staticClass:"ml-7"},[n("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color",style:t.getTimeBubbleColor(s)}),n("div",{staticClass:"ts-time-bubble ts-time-bubble-color",style:t.getTimeBubbleColor(s)},[n("h5",[n("b",[t._v(t._s(t._f("compactNumber")(s.deltaDays)))]),t._v(" days\n              ")])]),n("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color",style:t.getTimeBubbleColor(s)})]):t._e()],1)]}},{key:"item.actions",fn:function(e){var i=e.item;return[n("v-btn",{attrs:{small:"",icon:""},on:{click:function(e){return t.toggleStar(i)}}},[i._source.label.includes("__ts_star")?n("v-icon",{attrs:{color:"amber"}},[t._v("mdi-star")]):n("v-icon",[t._v("mdi-star-outline")])],1),n("ts-event-tag-menu",{attrs:{event:i}}),n("ts-event-action-menu",{attrs:{event:i}})]}},{key:"item._source.timestamp",fn:function(e){var i=e.item;return[n("div",{staticClass:"datetime-table-cell",style:t.getTimelineColor(i)},[t._v("\n          "+t._s(t._f("toISO8601")(t._f("formatTimestamp")(i._source.timestamp)))+"\n        ")])]}},t._l(t.headers,(function(e,i){return{key:t.getFieldName(e.text),fn:function(s){var r=s.item;return[n("span",{key:e.text,staticClass:"ts-event-field-container",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.toggleDetailedEvent(r)}}},[n("span",{class:{"ts-event-field-ellipsis":"message"===e.text}},[t.displayOptions.showTags&&3===i?n("span",[t._l(r._source.tag,(function(e){return n("v-chip",{key:e,staticClass:"mr-2",attrs:{small:"",color:t.tagColor(e).color,"text-color":t.tagColor(e).textColor}},[e in t.tagConfig?n("v-icon",{attrs:{left:"",small:""}},[t._v(t._s(t.tagConfig[e].label))]):t._e(),t._v("\n                "+t._s(e))],1)})),t._l(r._source.label,(function(e){return n("span",{key:e},[e.startsWith("__ts")?t._e():n("v-chip",{staticClass:"mr-2",attrs:{small:"",outlined:""}},[t._v("\n                  "+t._s(e)+"\n                ")])],1)}))],2):t._e(),t.displayOptions.showEmojis&&0===i?n("span",t._l(r._source.__ts_emojis,(function(e){return n("span",{key:e,staticClass:"mr-2",attrs:{title:t.meta.emojis[e]},domProps:{innerHTML:t._s(e)}},[t._v(t._s(e)+"\n              ")])})),0):t._e(),n("span",[t._v(t._s(r._source[e.text]))])])])]}}})),{key:"item.timeline_name",fn:function(e){var i=e.item;return[n("v-chip",{staticStyle:{"margin-top":"1px","margin-bottom":"1px","font-size":"0.8em"},attrs:{label:""}},[n("span",{staticClass:"timeline-name-ellipsis",staticStyle:{width:"130px","text-align":"center"}},[t._v(t._s(t.getTimeline(i).name))])])]}},{key:"item._source.comment",fn:function(e){var i=e.item;return[i._source.comment.length?n("v-badge",{attrs:{"offset-y":10,bordered:"",content:i._source.comment.length}},[n("v-icon",{attrs:{small:""},on:{click:function(e){return t.toggleDetailedEvent(i)}}},[t._v(" mdi-comment-text-multiple-outline ")])],1):t._e()]}}],null,!0),model:{value:t.selectedEvents,callback:function(e){t.selectedEvents=e},expression:"selectedEvents"}})],1):t._e()])},Gt=[],Bt=(n("8e6e"),n("bd86")),Ut=(n("c5f6"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("apexchart",{attrs:{height:"250",options:t.options,series:t.series}})],1)}),Vt=[],Yt=(n("ffc1"),n("1321")),Jt=n.n(Yt),Xt={props:["chartData"],components:{Apexchart:Jt.a},data:function(){var t=this;return{options:{chart:{type:"bar",zoom:{enabled:!1,type:"x",autoScaleYaxis:!0},foreColor:"#fff",animations:{enabled:!0,easing:"easeinout",speed:50,animateGradually:{enabled:!0,delay:50},dynamicAnimation:{enabled:!0,speed:50}},colors:["#4285f"],toolbar:{show:!0,tools:{download:!1,selection:!0,zoom:!0,zoomin:!0,zoomout:!0}},events:{dataPointSelection:function(e,n,i){t.emitFilterRequest(i)}}},tooltip:{enabled:!0,followCursor:!1,theme:"dark",x:{formatter:function(e){var n=t.getBucketDateTimeRange(e),i=t.$moment.duration(n.start.diff(n.end));return"".concat(n.start.format("YYYY-MM-DD HH:mm:ss")," + ").concat(i.humanize())}}},plotOptions:{bar:{columnWidth:"95%",borderRadius:4}},dataLabels:{enabled:!1},grid:{xaxis:{lines:{show:!1}},yaxis:{lines:{show:!1}}},xaxis:{type:"datetime",tickPlacement:"on"}}}},computed:{series:function(){var t={name:"Events",data:[]};return this.chartData?(t.data=Object.entries(this.chartData.data).map((function(t){return[parseInt(t[0]),t[1]]})),[t]):[t]}},methods:{getBucketDateTimeRange:function(t){var e=this.$moment.utc(t),n=this.chartData.interval.split(/(\d+)/),i=n[1],s=n[2],r=this.$moment.utc(t).add(parseInt(i),s);return{start:e,end:r}},emitFilterRequest:function(t){var e=t.selectedDataPoints[0][0],n=t.w.config.series[0]["data"];if(1!==n.length){var i=n[e][0],s=this.getBucketDateTimeRange(i),r={field:"",type:"datetime_range",value:s.start.toISOString()+","+s.end.toISOString(),operator:"must",active:!0};this.$emit("addChip",r)}},setTheme:function(){"dark"===localStorage.theme?this.options={chart:{foreColor:"#fff"},tooltip:{theme:"dark"}}:this.options={chart:{foreColor:"#333"},tooltip:{theme:"light"}}}},created:function(){ro.$on("isDarkTheme",this.setTheme)},mounted:function(){this.setTheme()}},Kt=Xt,Zt=Object(c["a"])(Kt,Ut,Vt,!1,null,null,null),te=Zt.exports,ee=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-row",[n("v-col",{attrs:{cols:"8"}},[n("v-card",{attrs:{outlined:"",height:"100%"}},[n("v-simple-table",{attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[n("tbody",t._l(t.fullEventFiltered,(function(e,i){return n("tr",{key:i,on:{mouseover:function(e){t.c_key=i},mouseleave:function(e){t.c_key=-1}}},[i==t.c_key?n("td",{staticClass:"text-right"},[n("v-btn",{staticClass:"pr-1",staticStyle:{cursor:"pointer"},attrs:{icon:"","x-small":""},on:{click:function(e){return t.copyToClipboard(i)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-content-copy")])],1)],1):n("td",[n("div",{staticClass:"px-3"})]),n("td",[t._v("\n                  "+t._s(i)+"\n                ")]),i.includes("xml")||t.checkContextLinkDisplay(i,e)||i==t.c_key?n("td",{staticClass:"text-right pr-1"},[n("v-btn",{directives:[{name:"show",rawName:"v-show",value:i==t.c_key,expression:"key == c_key"}],staticStyle:{cursor:"pointer"},attrs:{icon:"","x-small":""},on:{click:function(n){return t.copyToClipboard(e)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-content-copy")])],1),i.includes("xml")?n("v-dialog",{attrs:{width:"1000"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({staticStyle:{cursor:"pointer"},attrs:{icon:"",color:"primary","x-small":""},on:{click:function(e){t.formatXMLString=!0}}},"v-btn",s,!1),i),[n("v-tooltip",{attrs:{top:"","close-delay":"300","open-on-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[n("v-icon",t._g({attrs:{small:""}},i),[t._v("\n                              mdi-xml\n                            ")])]}}],null,!0)},[n("span",[t._v("Prettify XML")])])],1)]}}],null,!0),model:{value:t.formatXMLString,callback:function(e){t.formatXMLString=e},expression:"formatXMLString"}},[n("ts-format-xml-string",{attrs:{app:"",xmlString:e},on:{cancel:function(e){t.formatXMLString=!1}}})],1):t._e(),t.checkContextLinkDisplay(i,e)?n("v-menu",{attrs:{"offset-y":"",transition:"slide-y-transition"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({staticStyle:{cursor:"pointer"},attrs:{icon:"",color:"primary","x-small":""}},"v-btn",s,!1),i),[n("v-tooltip",{attrs:{top:"","close-delay":"300","open-on-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[n("v-icon",t._g({attrs:{small:""}},i),[t._v("\n                              mdi-open-in-new\n                            ")])]}}],null,!0)},[n("span",[t._v("Context Lookup")])])],1)]}}],null,!0)},[n("v-list",{attrs:{dense:""}},t._l(t.getContextLinkItems(i),(function(s,r){return n("v-list-item",{key:r,staticStyle:{cursor:"pointer"},on:{click:function(n){return n.stopPropagation(),t.contextLinkRedirect(i,s,e)}}},[t.getContextLinkRedirectState(i,s)?n("v-list-item-title",[t._v(t._s(s))]):n("v-list-item-title",[t._v(t._s(s)+"*")]),n("v-dialog",{attrs:{"max-width":"515","retain-focus":!1},model:{value:t.redirectWarnDialog,callback:function(e){t.redirectWarnDialog=e},expression:"redirectWarnDialog"}},[n("ts-link-redirect-warning",{attrs:{app:"","context-value":t.contextValue,"context-url":t.contextUrl},on:{cancel:function(e){t.redirectWarnDialog=!1}}})],1)],1)})),1)],1):t._e()],1):n("td",[n("div",{staticClass:"px-5"})]),n("td",{staticClass:"pl-0",attrs:{width:"100%"}},[t._v("\n                  "+t._s(e)+"\n                ")])])})),0)]},proxy:!0}])})],1)],1),n("v-col",{attrs:{cols:"4"}},[n("v-card",{attrs:{outlined:""}},[n("v-toolbar",{attrs:{dense:"",flat:""}},[n("v-toolbar-title",{staticStyle:{"font-size":"1.2em"}},[t._v("Comments")])],1),n("v-list",{attrs:{"three-line":""}},t._l(t.comments,(function(e,i){return n("v-list-item",{key:e.id,on:{mouseover:function(n){return t.selectComment(e)},mouseleave:function(e){return t.unSelectComment()}}},[n("v-list-item-avatar",[n("v-avatar",{attrs:{color:"grey lighten-1"}},[n("span",{staticClass:"white--text"},[t._v(t._s(t._f("initialLetter")(e.user.username)))])])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("\n                "+t._s(e.user.username)+"\n              ")]),n("v-list-item-subtitle",[t._v("\n                "+t._s(t._f("shortDateTime")(e.created_at))+" ("+t._s(t._f("timeSince")(e.created_at))+")\n              ")]),e.editable?n("v-card",{staticClass:"mt-5",attrs:{flat:""}},[n("v-textarea",{attrs:{"hide-details":"","auto-grow":"",filled:""},model:{value:t.comments[i].comment,callback:function(e){t.$set(t.comments[i],"comment",e)},expression:"comments[index].comment"}}),e.editable?n("v-card-actions",[n("v-spacer"),e.editable?n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.editComment(i,!1)}}},[t._v("\n                    Cancel\n                  ")]):t._e(),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(n){return t.updateComment(e,i)}}},[t._v(" Save ")])],1):t._e()],1):n("p",{staticClass:"body-2",staticStyle:{"max-width":"90%"}},[t._v(t._s(e.comment))])],1),e===t.selectedComment&&t.meta.permissions.write&&t.currentUser==e.user.username?n("v-list-item-action",{staticStyle:{position:"absolute",right:"0"}},[n("v-chip",{staticStyle:{"margin-right":"10px"},attrs:{outlined:""}},[n("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.editComment(i)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-square-edit-outline")])],1),n("v-btn",{attrs:{icon:"",small:""},on:{click:function(n){return t.deleteComment(e.id,i)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1)],1)],1):t._e()],1)})),1),t.meta.permissions.write?n("v-card-actions",[n("v-textarea",{staticClass:"mx-2 mb-2",attrs:{"hide-details":"","auto-grow":"",filled:"",label:"Add comment",rows:"1"},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),n("v-btn",{attrs:{icon:""},on:{click:t.postComment}},[n("v-icon",[t._v("mdi-send")])],1)],1):t._e()],1)],1)],1),n("br")],1)},ne=[],ie=(n("ac4d"),n("8a81"),n("1c4c"),n("3b2b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{staticStyle:{overflow:"initial"},attrs:{width:"1000"}},[n("v-container",{staticClass:"px-8"},[n("v-alert",{attrs:{border:"top","colored-border":"",type:"info",elevation:"2"}},[t._v(" XML viewer ")]),n("v-alert",{attrs:{"colored-border":"",color:"success",border:"left",elevation:"1"}},[n("pre",{attrs:{lang:"xml"}},[t._v(t._s(t.xmlString))])]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:t.clearAndCancel}},[t._v(" Close ")])],1)],1)],1)}),se=[],re={props:["xmlString"],methods:{clearAndCancel:function(){this.$emit("cancel")}}},ae=re,oe=Object(c["a"])(ae,ie,se,!1,null,"5bf1c96e",null),ce=oe.exports,le=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-card-title",[n("v-icon",{attrs:{large:"",color:"red"}},[t._v("mdi-shield-alert-outline")]),n("span",{staticClass:"text-h6 ml-2"},[t._v("External redirect warning!")])],1),n("v-card-text",[n("div",[t._v("\n      This action will open the link below in a new tab! Do you really \n      want to send the following value to this external service?\n    ")]),n("div",[n("b",[t._v("Value:")]),n("br"),n("code",{staticClass:"code"},[t._v("\n        "+t._s(t.contextValue)+"\n      ")])]),n("div",[n("b",[t._v("External website:")]),n("br"),n("code",{staticClass:"code"},[t._v("\n        "+t._s(t.contextUrl)+"\n      ")])])]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:t.clearAndCancel}},[t._v("\n      cancel\n    ")]),n("v-btn",{attrs:{color:"primary",text:"",href:t.contextUrl,target:"_blank"},on:{click:t.clearAndCancel}},[t._v("\n      continue\n    ")])],1)],1)},ue=[],de={props:["contextValue","contextUrl"],methods:{clearAndCancel:function(){this.$emit("cancel")}}},he=de,me=Object(c["a"])(he,le,ue,!1,null,"3e620fbd",null),ve=me.exports;function pe(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=fe(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw r}}}}function fe(t,e){if(t){if("string"===typeof t)return ge(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ge(t,e):void 0}}function ge(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var _e={components:{TsFormatXmlString:ce,TsLinkRedirectWarning:ve},props:["event"],data:function(){return{fullEvent:{},comment:"",comments:[],selectedComment:null,formatXMLString:!1,redirectWarnDialog:!1,contextUrl:"",contextValue:"",c_key:-1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},currentUser:function(){return this.$store.state.currentUser},currentSearchNode:function(){return this.$store.state.currentSearchNode},fullEventFiltered:function(){var t=this;return Object.getOwnPropertyNames(this.fullEvent).forEach((function(e){e.startsWith("__ts")&&delete t.fullEvent[e]})),this.fullEvent},contextLinkConf:function(){return this.$store.state.contextLinkConf}},methods:{getEvent:function(){var t=this,e=this.event._index,n=this.event._id;_.getEvent(this.sketch.id,e,n).then((function(e){t.fullEvent=e.data.objects,t.comments=e.data.meta.comments})).catch((function(t){}))},postComment:function(){var t=this;ro.$emit("eventAnnotated",{type:"__ts_comment",event:this.event,searchNode:this.currentSearchNode}),_.saveEventAnnotation(this.sketch.id,"comment",this.comment,[this.event],this.currentSearchNode).then((function(e){t.comments.push(e.data.objects[0][0]),t.comment=""})).catch((function(t){}))},updateComment:function(t,e){var n=this;_.updateEventAnnotation(this.sketch.id,"comment",t,[this.event],this.currentSearchNode).then((function(i){n.comments.splice(e,1,t),t.editable=!1})).catch((function(t){console.error(t)}))},deleteComment:function(t,e){var n=this;confirm("Are you sure?")&&_.deleteEventAnnotation(this.sketch.id,"comment",t,this.event,this.currentSearchNode).then((function(t){n.comments.splice(e,1)})).catch((function(t){console.error(t)}))},editComment:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.comments[t];n.editable=e,this.comments.splice(t,1,n)},selectComment:function(t){this.selectedComment=t},unSelectComment:function(){this.selectedComment=!1},getContextLinkItems:function(t){var e=this.contextLinkConf[t.toLowerCase()]?this.contextLinkConf[t.toLowerCase()]:[],n=e.map((function(t){return t.short_name}));return n},checkContextLinkDisplay:function(t,e){var n,i=this.contextLinkConf[t.toLowerCase()]?this.contextLinkConf[t.toLowerCase()]:[],s=pe(i);try{for(s.s();!(n=s.n()).done;){var r=n.value;if(""!==r["validation_regex"]&&void 0!==r["validation_regex"]){var a=r["validation_regex"],o=a.slice(a.lastIndexOf("/")+1),c=a.slice(a.indexOf("/")+1,a.lastIndexOf("/")),l=new RegExp(c,o);return!!l.test(e)}return!0}}catch(u){s.e(u)}finally{s.f()}return!1},contextLinkRedirect:function(t,e,n){var i,s=this.contextLinkConf[t.toLowerCase()]?this.contextLinkConf[t.toLowerCase()]:[],r=pe(s);try{for(r.s();!(i=r.n()).done;){var a=i.value;a["short_name"]===e&&(a["redirect_warning"]?(this.redirectWarnDialog=!0,this.contextValue=n,this.contextUrl=a["context_link"].replace("<ATTR_VALUE>",encodeURIComponent(n))):(window.open(a["context_link"].replace("<ATTR_VALUE>",encodeURIComponent(n)),"_blank"),this.redirectWarnDialog=!1))}}catch(o){r.e(o)}finally{r.f()}},getContextLinkRedirectState:function(t,e){var n,i=this.contextLinkConf[t.toLowerCase()]?this.contextLinkConf[t.toLowerCase()]:[],s=pe(i);try{for(s.s();!(n=s.n()).done;){var r=n.value;if(r["short_name"]===e)return r["redirect_warning"]}}catch(a){s.e(a)}finally{s.f()}},copyToClipboard:function(t){try{navigator.clipboard.writeText(t),this.infoSnackBar("copied")}catch(e){this.errorSnackBar("Failed copying to the clipboard!"),console.error(e)}}},created:function(){this.getEvent()}},ye=_e,be=(n("c3ca"),Object(c["a"])(ye,ee,ne,!1,null,null,null)),ke=be.exports,Se=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-menu",{attrs:{"offset-x":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"ml-1"},"v-icon",s,!1),i),[t._v("mdi-tag-plus-outline")])]}}]),model:{value:t.showMenu,callback:function(e){t.showMenu=e},expression:"showMenu"}},[n("v-card",{staticClass:"mx-auto",attrs:{"min-width":"500px"}},[n("v-card-text",[n("strong",[t._v("Quick tags")]),n("v-chip-group",t._l(t.quickTags,(function(e){return n("v-chip",{key:e.tag,staticClass:"text-center",attrs:{color:e.color,"text-color":e.textColor,small:""},on:{click:function(n){return t.addTags(e.tag)}}},[n("v-icon",{attrs:{small:"",left:""}},[t._v(" "+t._s(e.label)+" ")]),t._v("\n          "+t._s(e.tag))],1)})),1),n("br"),n("v-combobox",{attrs:{items:t.tags,label:"Add tags..",outlined:"",chips:"","small-chips":"",multiple:""},model:{value:t.selectedTags,callback:function(e){t.selectedTags=e},expression:"selectedTags"}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(e){return t.addTags(t.selectedTags)}}},[t._v("Save")])],1)],1)],1)},we=[],xe={props:["event"],data:function(){return{showMenu:!1,listItems:[],selectedTags:[],quickTags:[{tag:"bad",color:"red",textColor:"white",label:"mdi-alert-circle-outline"},{tag:"suspicious",color:"orange",textColor:"white",label:"mdi-help-circle-outline"},{tag:"good",color:"green",textColor:"white",label:"mdi-check-circle-outline"}]}},computed:{sketch:function(){return this.$store.state.sketch},tags:function(){return this.$store.state.tags.map((function(t){return t.tag}))}},methods:{addTags:function(t){var e=this;Array.isArray(t)||(t=[t]),t.forEach((function(t){-1===e.event._source.tag.indexOf(t)&&(e.event._source.tag.push(t),_.tagEvents(e.sketch.id,[e.event],[t]).then((function(n){e.$store.dispatch("updateTimelineTags",{sketchId:e.sketch.id,tag:t,num:1})})).catch((function(t){console.error("Cannot tag event")}))),e.selectedTags=[],e.showMenu=!1}))}}},Ce=xe,Te=Object(c["a"])(Ce,Se,we,!1,null,"8f863e78",null),$e=Te.exports,Ee=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-menu",{attrs:{"offset-y":"",transition:"slide-y-transition"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-icon",t._g(t._b({staticClass:"ml-1"},"v-icon",s,!1),i),[t._v("mdi-dots-vertical")])]}}]),model:{value:t.showMenu,callback:function(e){t.showMenu=e},expression:"showMenu"}},[n("v-list",{staticClass:"mx-auto",attrs:{dense:""}},[n("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.copyEventUrlToClipboard()}}},[n("v-list-item-title",[n("v-icon",[t._v("mdi-link-variant")]),t._v(" Copy link to event ")],1)],1),n("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.copyEventAsJSON()}}},[n("v-list-item-title",[n("v-icon",[t._v("mdi-code-json")]),t._v(" Copy event data as JSON ")],1)],1)],1)],1)},Fe=[],Pe={props:["event"],data:function(){return{showMenu:!1,originalContext:!1}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{copyEventAsJSON:function(){var t=this;_.getEvent(this.sketch.id,this.event._index,this.event._id).then((function(e){var n=e.data.objects,i=JSON.stringify(n,null,3);navigator.clipboard.writeText(i),t.infoSnackBar("Event JSON copied to clipboard")})).catch((function(e){t.errorSnackBar("Failed to load JSON into the clipboard"),console.error(e)}))},copyEventUrlToClipboard:function(){try{var t=window.location.origin+this.$route.path+"?q=_id:"+this.event._id;navigator.clipboard.writeText(t),this.infoSnackBar("Event URL copied to clipboard")}catch(e){this.errorSnackBar("Failed to load Event URL into the clipboard"),console.error(e)}}}},Ae=Pe,Oe=Object(c["a"])(Ae,Ee,Fe,!1,null,"259a8939",null),De=Oe.exports;function Ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Ie(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(n),!0).forEach((function(e){Object(Bt["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Re=function(){return{from:0,terminate_after:40,size:40,indices:["_all"],order:"asc",chips:[]}},Le=function(){return{meta:{count_per_index:{},count_per_timeline:{}},objects:[]}},je={components:{TsBarChart:te,TsEventDetail:ke,TsEventTagMenu:$e,TsEventActionMenu:De},props:{queryRequest:{type:Object,default:function(){}},itemsPerPage:{type:Number,default:40},disableSaveSearch:{type:Boolean,default:!1},disableHistogram:{type:Boolean,default:!1},disableColumns:{type:Boolean,default:!1},disableSettings:{type:Boolean,default:!1},disablePagination:{type:Boolean,default:!1}},data:function(){return{columnHeaders:[{text:"",value:"field"}],tableOptions:{itemsPerPage:this.itemsPerPage},currentItemsPerPage:this.itemsPerPage,expandedRows:[],selectedFields:[{field:"message",type:"text"}],searchColumns:"",columnDialog:!1,saveSearchMenu:!1,saveSearchFormName:"",selectedEventTags:[],tagConfig:{good:{color:"green",textColor:"white",label:"mdi-check-circle-outline"},bad:{color:"red",textColor:"white",label:"mdi-alert-circle-outline"},suspicious:{color:"orange",textColor:"white",label:"mdi-help-circle-outline"}},searchInProgress:!1,currentPage:1,eventList:{meta:{},objects:[]},currentQueryString:"",currentQueryFilter:Re(),selectedEvents:[],displayOptions:{isCompact:!1,showTags:!0,showEmojis:!0,showMillis:!1,showTimelineName:!0},showHistogram:!1,branchParent:null}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},totalHits:function(){return this.eventList.meta.es_total_count>0&&0===this.eventList.meta.es_total_count_complete?this.eventList.meta.es_total_count:this.eventList.meta.es_total_count_complete||0},totalHitsForPagination:function(){return this.eventList.meta.es_total_count||0},totalTime:function(){return this.eventList.meta.es_time/1e3||0},fromEvent:function(){return this.currentQueryFilter.from||1},toEvent:function(){if(!(this.totalHits<this.currentQueryFilter.size))return parseInt(this.currentQueryFilter.from)+parseInt(this.currentQueryFilter.size)},timeFilterChips:function(){return this.currentQueryFilter.chips.filter((function(t){return t.type.startsWith("datetime")}))},currentSearchNode:function(){return this.$store.state.currentSearchNode},headers:function(){var t=[{text:"",value:"data-table-select"},{value:"actions",width:"105"},{text:"Datetime (UTC)",align:"start",value:"_source.timestamp",width:"200"},{value:"_source.comment",width:"40"}],e=[];return this.selectedFields.forEach((function(t){var n={text:t.field,align:"start",value:"_source."+t.field};"message"===t.field?(n.width="100%",e.unshift(n)):e.push(n)})),t.splice.apply(t,[3,0].concat(e)),this.displayOptions.showTimelineName&&t.push({value:"timeline_name",align:"end"}),t}},methods:{tagColor:function(t){return this.tagConfig[t]?this.tagConfig[t]:"lightgrey"},getFieldName:function(t){return"item._source."+t},toggleDetailedEvent:function(t){var e=this.expandedRows.findIndex((function(e){return e._id===t._id}));if(this.expandedRows.some((function(e){return e._id===t._id}))){if(!t.showDetails)return t["showDetails"]=!0,this.expandedRows.splice(e,1),void this.expandedRows.push(t);t["showDetails"]=!1,this.expandedRows.splice(e,1),t.deltaDays&&(this.expandedRows.splice(e,1),this.expandedRows.push(t))}else t["showDetails"]=!0,this.expandedRows.push(t)},addTimeBubbles:function(){var t=this;this.expandedRows=[],this.eventList.objects.forEach((function(e,n){if(!(n<1)){var i=t.eventList.objects[n-1],s=t.$options.filters.formatTimestamp(e._source.timestamp),r=t.$options.filters.formatTimestamp(i._source.timestamp),a=Math.floor(s/1e3),o=Math.floor(r/1e3),c=Math.floor(a-o);"desc"===t.order&&(c=Math.floor(o-a));var l=Math.floor(c/60/60/24);l>0&&(i["deltaDays"]=l,t.expandedRows.push(i))}}))},getTimeline:function(t){var e,n=this.meta.indices_metadata[t._index].is_legacy;return e=n?this.sketch.active_timelines.find((function(e){return e.searchindex.index_name===t._index})):this.sketch.active_timelines.find((function(e){return e.id===t._source.__ts_timeline_id})),e},getTimelineColor:function(t){var e=this.getTimeline(t),n=e.color;return n.startsWith("#")||(n="#"+n),this.$vuetify.theme.dark?{"background-color":n,filter:"grayscale(25%)",color:"#333"}:{"background-color":n}},getTimeBubbleColor:function(){var t="#f5f5f5";return this.$vuetify.theme.dark&&(t="#333"),{"background-color":t}},search:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.currentQueryString||this.currentQueryDsl){this.searchInProgress=!0,this.selectedEvents=[],this.eventList=Le(),e&&(this.tableOptions.page=1,this.currentPage=1,this.currentItemsPerPage=this.tableOptions.itemsPerPage,this.currentQueryFilter.size=this.tableOptions.itemsPerPage,this.currentQueryFilter.from=0),this.currentQueryFilter.fields=this.selectedFields;var s={};this.currentQueryDsl&&(s.dsl=this.currentQueryDsl,s.filter=this.currentQueryFilter),this.currentQueryString&&(s.query=this.currentQueryString,s.filter=this.currentQueryFilter),n&&(s["incognito"]=!0),i&&(s["parent"]=i),i&&n&&(this.branchParent=i),this.branchParent&&(s["parent"]=this.branchParent),_.search(this.sketch.id,s).then((function(e){t.eventList.objects=e.data.objects,t.eventList.meta=e.data.meta,t.searchInProgress=!1,t.$emit("countPerTimeline",e.data.meta.count_per_timeline),t.$emit("countPerIndex",e.data.meta.count_per_index),t.addTimeBubbles(),n||(ro.$emit("createBranch",t.eventList.meta.search_node),t.$store.dispatch("updateSearchHistory"),t.branchParent=t.eventList.meta.search_node.id)})).catch((function(e){t.errorSnackBar("Sorry, there was a problem fetching your search results. Please try again."),console.error(e)}))}},exportSearchResult:function(){var t={query:this.currentQueryString,filter:this.currentQueryFilter,file_name:"export.zip"};_.exportSearchResult(this.sketch.id,t).then((function(t){var e=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a"),i="export.zip";n.href=e,n.setAttribute("download",i),document.body.appendChild(n),n.click()})).catch((function(t){console.error(t)}))},addChip:function(t){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.push(t),this.search()},removeChip:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.currentQueryFilter.chips.findIndex((function(e){return e.value===t.value}));this.currentQueryFilter.chips.splice(n,1),e&&this.search()},removeChips:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Array.isArray(t)?(t.forEach((function(t){e.removeChip(t,!1)})),n&&this.search()):this.errorSnackBar("Not an array of chips")},addChipFromHistogram:function(t){var e=this;this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.forEach((function(t){"datetime_range"===t.type&&e.removeChip(t,!1)})),this.addChip(t)},paginate:function(){if(this.tableOptions.itemsPerPage!==this.currentItemsPerPage)return this.tableOptions.page=1,this.currentPage=1,this.currentItemsPerPage=this.tableOptions.itemsPerPage,this.currentQueryFilter.size=this.tableOptions.itemsPerPage,void this.search(!0,!0);this.currentPage!==this.tableOptions.page&&(this.currentQueryFilter.from=this.tableOptions.page*this.currentQueryFilter.size-this.currentQueryFilter.size,this.currentPage=this.tableOptions.page,this.search(!1,!0))},updateSelectedFields:function(t){var e=this;t.forEach((function(t){!e.headers.filter((function(e){return e.field===t.field})).length>0&&e.search(!0,!0)}))},removeField:function(t){this.selectedFields.splice(t,1)},toggleStar:function(t){t._source.label.includes("__ts_star")?t._source.label.splice(t._source.label.indexOf("__ts_star"),1):t._source.label.push("__ts_star"),_.saveEventAnnotation(this.sketch.id,"label","__ts_star",t,this.currentSearchNode).then((function(t){})).catch((function(t){console.error(t)}))},toggleMultipleStars:function(){var t=this;this.selectedEvents.forEach((function(t){t._source.label.includes("__ts_star")?t._source.label.splice(t._source.label.indexOf("__ts_star"),1):t._source.label.push("__ts_star")})),_.saveEventAnnotation(this.sketch.id,"label","__ts_star",this.selectedEvents,this.currentSearchNode).then((function(e){t.selectedEvents=[]})).catch((function(t){}))},saveSearch:function(){var t=this;_.createView(this.sketch.id,this.saveSearchFormName,this.currentQueryString,this.currentQueryFilter).then((function(e){t.saveSearchFormName="",t.saveSearchMenu=!1;var n=e.data.objects[0];t.$store.state.meta.views.push(n),t.$router.push({name:"Explore",query:{view:n.id}})})).catch((function(t){}))}},watch:{tableOptions:{handler:function(){this.paginate()},deep:!0},queryRequest:{handler:function(t,e){if(JSON.stringify(t)!==JSON.stringify(e)&&t){this.currentQueryString=t.queryString||"",this.currentQueryFilter=t.queryFilter||Re(),this.currentQueryDsl=t.queryDsl||null;var n=t["resetPagination"]||!0,i=t["incognito"]||!1,s=t["parent"]||!1;this.currentQueryFilter.fields&&(this.selectedFields=this.currentQueryFilter.fields),this.search(n,i,s)}},deep:!0}},created:function(){Object.keys(this.queryRequest).length&&(this.currentQueryString=this.queryRequest.queryString,this.currentQueryFilter=Ie({},this.queryRequest.queryFilter)||Re(),this.currentQueryDsl=Ie({},this.queryRequest.queryDsl),this.currentQueryFilter.fields&&(this.selectedFields=this.currentQueryFilter.fields),this.search())}},qe=je,Qe=(n("8089"),Object(c["a"])(qe,zt,Gt,!1,null,null,null)),He=Qe.exports,Me=function(){return{from:0,terminate_after:40,size:40,indices:[],order:"asc",chips:[]}},We={directives:{dragscroll:D["a"]},components:{TsSearchHistoryTree:U,TsSearchHistoryButtons:Z,TsSearchDropdown:at,TsTimelinePicker:wt,TsFilterMenu:At,TsUploadTimelineForm:Lt,TsAddManualEvent:Wt,TsEventList:He},props:["sketchId"],data:function(){return{countPerIndex:{},countPerTimeline:{},currentItemsPerPage:40,timeFilterMenu:!1,selectedFields:[{field:"message",type:"text"}],showRightSidePanel:!1,addManualEvent:!1,datetimeManualEvent:"",params:{},contextEvent:!1,originalContext:!1,showSearchDropdown:!1,activeQueryRequest:{},currentQueryString:"",currentQueryFilter:Me(),selectedLabels:[],showSearchHistory:!1,zoomLevel:.7,zoomOrigin:{x:0,y:0}}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},filterChips:function(){return this.currentQueryFilter.chips.filter((function(t){return"label"===t.type||"term"===t.type}))},timeFilterChips:function(){return this.currentQueryFilter.chips.filter((function(t){return t.type.startsWith("datetime")}))},filteredLabels:function(){return this.$store.state.meta.filter_labels.filter((function(t){return!t.label.startsWith("__")}))},currentSearchNode:function(){return this.$store.state.currentSearchNode},activeContext:function(){return this.$store.state.activeContext}},methods:{updateCountPerIndex:function(t){this.countPerIndex=t},updateCountPerTimeline:function(t){this.countPerTimeline=t},toggleSearchHistory:function(){this.showSearchHistory=!this.showSearchHistory,this.showSearchHistory&&this.triggerScrollTo()},setQueryAndFilter:function(t){"Explore"!==this.$route.name&&this.$router.push({name:"Explore",params:{sketchId:this.sketch.id}}),this.currentQueryString=t.queryString,this.currentQueryFilter=t.queryFilter,this.currentQueryFilter.size=this.currentItemsPerPage,this.currentQueryFilter.terminate_after=this.currentItemsPerPage,t.doSearch&&this.search()},search:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i={};i["queryString"]=this.currentQueryString,i["queryFilter"]=this.currentQueryFilter,i["resetPagination"]=t,i["incognito"]=e,i["parent"]=n,this.activeQueryRequest=i,this.showSearchDropdown=!1},searchView:function(t){var e=this;this.showSearchDropdown=!1,t!==parseInt(t,10)&&"string"!==typeof t&&(t=t.id,this.$router.push({name:"Explore",query:{view:t}})),_.getView(this.sketchId,t).then((function(t){var n=t.data.objects[0];if(e.currentQueryString=n.query_string,e.currentQueryFilter=JSON.parse(n.query_filter),e.currentQueryFilter.fields&&e.currentQueryFilter.fields.length||(e.currentQueryFilter.fields=[{field:"message",type:"text"}]),e.selectedFields=e.currentQueryFilter.fields,"_all"===e.currentQueryFilter.indices[0]||"_all"===e.currentQueryFilter.indices){var i=[];e.sketch.active_timelines.forEach((function(t){var n=e.meta.indices_metadata[t.searchindex.index_name].is_legacy;n?i.push(t.searchindex.index_name):i.push(t.id)})),e.currentQueryFilter.indices=i}var s=e.currentQueryFilter.chips;if(s)for(var r=0;r<s.length;r++)"label"===s[r].type&&e.selectedLabels.push(s[r].value);e.contextEvent=!1,e.search()})).catch((function(t){}))},searchContext:function(t){var e=300,n=500;if(this.contextEvent=t,!this.originalContext){var i=JSON.parse(JSON.stringify(this.currentQueryString)),s=JSON.parse(JSON.stringify(this.currentQueryFilter));this.originalContext={queryString:i,queryFilter:s}}var r="YYYY-MM-DDTHH:mm:ss",a=this.$moment.utc(this.contextEvent._source.datetime),o=a.clone().subtract(e,"s").format(r),c=a.clone().add(e,"s").format(r),l={field:"",value:o+","+a.format(r),type:"datetime_range",operator:"must",active:!0},u={field:"",value:a.format(r)+","+c,type:"datetime_range",operator:"must",active:!0};this.currentQueryString="* OR _id:"+this.contextEvent._id,this.currentQueryFilter.chips=[l,u];var d=this.meta.indices_metadata[this.contextEvent._index].is_legacy;this.currentQueryFilter.indices=d?[this.contextEvent._index]:[this.contextEvent._source.__ts_timeline_id],this.currentQueryFilter.size=n,this.search()},removeContext:function(){this.contextEvent=!1,this.currentQueryString=JSON.parse(JSON.stringify(this.originalContext.queryString)),this.currentQueryFilter=JSON.parse(JSON.stringify(this.originalContext.queryFilter)),this.search()},updateSelectedTimelines:function(t){var e=this,n=[];t.forEach((function(t){var i=e.meta.indices_metadata[t.searchindex.index_name].is_legacy;i?n.push(t.searchindex.index_name):n.push(t.id)})),this.currentQueryFilter.indices=n,this.search()},toggleChip:function(t){void 0===t.active&&(t.active=!0),t.active=!t.active,this.search()},removeChip:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.currentQueryFilter.chips.findIndex((function(e){return e.value===t.value}));this.currentQueryFilter.chips.splice(n,1),"label"===t.type&&(this.selectedLabels=this.selectedLabels.filter((function(e){return e!==t.value}))),e&&this.search()},updateChip:function(t,e){var n=this.currentQueryFilter.chips.findIndex((function(t){return t.value===e.value&&t.type===e.type}));this.currentQueryFilter.chips.splice(n,1,t),this.search()},addChip:function(t){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.push(t),this.search()},addChipFromHistogram:function(t){var e=this;this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.forEach((function(t){"datetime_range"===t.type&&e.removeChip(t,!1)})),this.addChip(t)},toggleLabelChip:function(t){var e={field:"",value:t,type:"label",operator:"must",active:!0},n=this.currentQueryFilter.chips;if(n)for(var i=0;i<n.length;i++)if(n[i].value===t)return void this.removeChip(i);this.addChip(e)},updateLabelChips:function(){var t=this;this.currentQueryFilter.chips=this.currentQueryFilter.chips.filter((function(t){return"label"!==t.type})),this.selectedLabels.forEach((function(e){var n={field:"",value:e,type:"label",operator:"must",active:!0};t.addChip(n),t.showSearchDropdown=!1}))},updateLabelList:function(t){-1===this.meta.filter_labels.indexOf(t)&&this.meta.filter_labels.push(t)},jumpInHistory:function(t){var e=this;if(this.currentQueryString=t.query_string,this.currentQueryFilter=JSON.parse(t.query_filter),this.currentQueryFilter.fields&&this.currentQueryFilter.fields.length||(this.currentQueryFilter.fields=[{field:"message",type:"text"}]),this.selectedFields=this.currentQueryFilter.fields,"_all"===this.currentQueryFilter.indices[0]||"_all"===this.currentQueryFilter.indices){var n=[];this.sketch.active_timelines.forEach((function(t){var i=e.meta.indices_metadata[t.searchindex.index_name].is_legacy;i?n.push(t.searchindex.index_name):n.push(t.id)})),this.currentQueryFilter.indices=n}var i=this.currentQueryFilter.chips;if(i)for(var s=0;s<i.length;s++)"label"===i[s].type&&this.selectedLabels.push(i[s].value);this.contextEvent=!1,this.search(!0,!0,t.id)},triggerScrollTo:function(){ro.$emit("triggerScrollTo")},zoomWithMouse:function(t){this.zoomOrigin.x=t.pageX,this.zoomOrigin.y=t.pageY,t.deltaY<0?this.zoomLevel+=.07:t.deltaY>0&&(this.zoomLevel-=.07)},closeSearchDropdown:function(t){t!==this.$refs.searchInput&&null===t.getAttribute("data-explore-element")&&(this.showSearchDropdown=!1)},onClickOutside:function(t){"tsSearchInput"!==t.target.id&&(this.showSearchDropdown=!1)}},mounted:function(){this.$refs.searchInput.focus(),ro.$on("setQueryAndFilter",this.setQueryAndFilter),ro.$on("setActiveView",this.searchView)},beforeDestroy:function(){ro.$off("setQueryAndFilter"),ro.$off("setActiveView")},created:function(){var t=this,e=!1;if(this.params={viewId:this.$route.query.view,indexName:this.$route.query.timeline,resultLimit:this.$route.query.limit,queryString:this.$route.query.q},this.params.viewId)this.searchView(this.params.viewId);else{if(this.params.queryString&&(this.currentQueryString=this.params.queryString,e=!0),this.params.indexName){this.params.queryString||(this.currentQueryString="*");var n=this.sketch.active_timelines.find((function(e){return e.id===parseInt(t.params.indexName,10)})),i=this.meta.indices_metadata[n.searchindex.index_name].is_legacy;this.currentQueryFilter.indices=i?[n.searchindex.index_name]:[n.id],e=!0}this.currentQueryString||(this.currentQueryFilter.indices=["_all"]),e&&(this.currentQueryFilter.indices.length||(this.currentQueryFilter.indices=["_all"]),this.search())}}},ze=We,Ge=(n("2d9e"),Object(c["a"])(ze,A,O,!1,null,null,null)),Be=Ge.exports,Ue=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("ts-indicator-dialog",{attrs:{dialog:t.indicatorDialog,index:t.currentIndex,"tag-info":t.tagInfo},on:{"update:dialog":function(e){t.indicatorDialog=e},"open-dialog":function(e){t.indicatorDialog=!0},"close-dialog":function(e){t.indicatorDialog=!1,t.currentIndex=-1},save:function(e){t.saveIntelligence(e),t.indicatorDialog=!1}}}),n("v-container",{attrs:{fluid:""}},[n("v-btn",{staticClass:"mt-n1 ml-3",attrs:{text:"",color:"primary"},on:{click:t.addIndicator}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-plus")]),t._v("\n      Add Indicator\n    ")],1),n("v-card",{staticClass:"mt-3 mx-3",attrs:{outlined:""}},[n("v-data-table",{attrs:{headers:t.headers,items:t.intelligenceData,"footer-props":{"items-per-page-options":[10,40,80,100,200,500],"show-current-page":!0},"items-per-page":40},scopedSlots:t._u([{key:"item.search",fn:function(e){var i=e.item;return[n("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.generateSearchQuery(i.ioc)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-magnify")])],1)]}},{key:"item.externalURI",fn:function(e){var i=e.item;return[i.externalURI?n("v-icon",{attrs:{"x-small":""}},[t._v("mdi-open-in-new")]):t._e(),t.getValidUrl(i.externalURI)?n("a",{staticStyle:{"text-decoration":"none"},attrs:{href:t.getValidUrl(i.externalURI),target:"_blank"}},[t._v("\n            "+t._s(t.getValidUrl(i.externalURI).host))]):t._e()]}},{key:"item.tags",fn:function(e){var i=e.item;return[n("v-chip-group",t._l(i.tags,(function(e){return n("v-chip",{key:e,attrs:{small:""},on:{click:function(n){return t.searchForIOC(e)}}},[t._v("\n              "+t._s(e)+"\n            ")])})),1)]}},{key:"item.actions",fn:function(e){var i=e.item;return[n("v-btn",{attrs:{small:"",icon:""},on:{click:function(e){return t.editIndicator(i.index)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-pencil")])],1),n("v-btn",{attrs:{small:"",icon:""},on:{click:function(e){return t.deleteIndicator(i.index)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1)]}}])})],1)],1)],1)},Ve=[],Ye=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{value:t.dialog,"max-width":"600px"},on:{input:function(e){return t.$emit("input",e)},"click:outside":function(e){return t.closeDialog()}}},[n("v-card",{staticClass:"pa-4"},[n("h3",[t._v(t._s(t.title))]),n("br"),n("v-text-field",{attrs:{outlined:"",label:"Indicator data"},on:{input:function(e){return t.autoSelectIndicatorType(e)}},model:{value:t.newIndicator.ioc,callback:function(e){t.$set(t.newIndicator,"ioc",e)},expression:"newIndicator.ioc"}}),n("v-select",{attrs:{outlined:"",label:"Indicator type",items:t.indicatorTypes},model:{value:t.newIndicator.type,callback:function(e){t.$set(t.newIndicator,"type",e)},expression:"newIndicator.type"}}),n("v-combobox",{attrs:{items:Object.keys(this.tagInfo),label:"Add tags.. (optional)",outlined:"",chips:"","small-chips":"",multiple:""},model:{value:t.newIndicator.tags,callback:function(e){t.$set(t.newIndicator,"tags",e)},expression:"newIndicator.tags"}}),n("v-text-field",{attrs:{outlined:"",label:"External reference (optional)"},model:{value:t.newIndicator.externalURI,callback:function(e){t.$set(t.newIndicator,"externalURI",e)},expression:"newIndicator.externalURI"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(e){return t.closeDialog()}}},[t._v(" Cancel ")]),n("v-btn",{attrs:{color:"primary",depressed:"",disabled:!t.newIndicator.ioc},on:{click:t.saveIndicator}},[t._v(" Save ")])],1)],1)],1)},Je=[],Xe=[{regex:/^(\/[\S]+)+$/i,type:"fs_path"},{regex:/^([-\w]+\.)+[a-z]{2,}$/i,type:"hostname"},{regex:/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g,type:"ipv4"},{regex:/^[0-9a-f]{64}$/i,type:"hash_sha256"},{regex:/^[0-9a-f]{40}$/i,type:"hash_sha1"},{regex:/^[0-9a-f]{32}$/i,type:"hash_md5"},{regex:/./g,type:"other"}];function Ke(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Ze(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw r}}}}function Ze(t,e){if(t){if("string"===typeof t)return tn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tn(t,e):void 0}}function tn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var en=function(){return{ioc:"",type:"other",externalURI:"",tags:[]}},nn={props:["dialog","tagInfo","index"],data:function(){return{IOCTypes:Xe,newIndicator:en()}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},intelligenceAttribute:function(){return void 0===this.meta.attributes.intelligence?{ontology:"intelligence",value:{data:[]},name:"intelligence"}:this.meta.attributes.intelligence},indicatorTypes:function(){return this.IOCTypes.map((function(t){return t.type}))},title:function(){return this.index<0?"Create new indicator":"Edit indicator"}},methods:{closeDialog:function(){this.$emit("close-dialog")},autoSelectIndicatorType:function(t){var e,n=Ke(this.IOCTypes);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.regex.test(t))return void(this.newIndicator.type=i.type)}}catch(s){n.e(s)}finally{n.f()}},saveIndicator:function(){this.$emit("save",this.newIndicator),this.newIndicator=en()}},watch:{index:function(){this.index<0?this.newIndicator=en():this.newIndicator=this.intelligenceAttribute.value.data[this.index]}}},sn=nn,rn=Object(c["a"])(sn,Ye,Je,!1,null,"5504ac72",null),an=rn.exports;function on(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=cn(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw r}}}}function cn(t,e){if(t){if("string"===typeof t)return ln(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ln(t,e):void 0}}function ln(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function un(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function dn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?un(Object(n),!0).forEach((function(e){Object(Bt["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):un(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var hn=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},mn={props:[],components:{TsIndicatorDialog:an},data:function(){return{headers:[{text:"",value:"search",align:"start"},{text:"Indicator data",value:"ioc"},{text:"Indicator type",value:"type"},{text:"Tags",value:"tags"},{text:"External reference",value:"externalURI"},{text:"",value:"actions"}],tagInfo:{},indicatorDialog:!1,currentIndex:-1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},intelligenceAttribute:function(){return void 0===this.meta.attributes.intelligence?{ontology:"intelligence",value:{data:[]},name:"intelligence"}:this.meta.attributes.intelligence},intelligenceData:function(){return this.intelligenceAttribute.value.data.map((function(t,e){return dn(dn({},t),{},{index:e})}))}},methods:{addIndicator:function(){this.indicatorDialog=!0},deleteIndicator:function(t){var e=this;confirm("Delete indicator?")&&(this.intelligenceAttribute.value.data.splice(t,1),_.addSketchAttribute(this.sketch.id,"intelligence",this.intelligenceAttribute.value,"intelligence").then((function(){e.successSnackBar("Indicator deleted"),e.buildTagInfo()})).catch((function(t){e.errorSnackBar("Failed to save indicator"),console.error(t)})))},editIndicator:function(t){this.currentIndex=t,this.indicatorDialog=!0},getValidUrl:function(t){return void 0!==t&&null!==t&&""!==t&&(t.startsWith("http")?new URL(t):!!t.includes("/")&&new URL("http://"+t))},buildTagInfo:function(){this.tagInfo={};var t,e=on(this.intelligenceData);try{for(e.s();!(t=e.n()).done;){var n,i=t.value,s=on(i.tags);try{for(s.s();!(n=s.n()).done;){var r=n.value,a=null;a="object"===Object(R["a"])(r)?r.name:r,this.tagInfo[a]||(this.tagInfo[a]={iocs:[]}),this.tagInfo[a].iocs.push(i.ioc)}}catch(o){s.e(o)}finally{s.f()}}}catch(o){e.e(o)}finally{e.f()}},generateSearchQuery:function(t,e){var n='"'.concat(t,'"');n=n.replace(/[\\\s]/g,"\\$&"),void 0!==e&&(n="".concat(e,":").concat(n));var i={doSearch:!0};i.queryString=n,i.queryFilter=hn(),ro.$emit("setQueryAndFilter",i)},searchForIOC:function(t){var e=this.tagInfo[t]||{},n=e.iocs.map((function(t){return'"'.concat(t,'"')})).reduce((function(t,e){return"".concat(t," OR ").concat(e)})),i={doSearch:!0};i.queryString=n,i.queryFilter=hn(),ro.$emit("setQueryAndFilter",i)},saveIntelligence:function(t){var e=this;this.currentIndex<0&&this.intelligenceAttribute.value.data.push(t),_.addSketchAttribute(this.sketch.id,"intelligence",this.intelligenceAttribute.value,"intelligence").then((function(){e.successSnackBar("Indicator saved"),e.buildTagInfo()})).catch((function(t){e.errorSnackBar("Failed to save indicator"),console.error(t)}))}},mounted:function(){this.buildTagInfo()}},vn=mn,pn=Object(c["a"])(vn,Ue,Ve,!1,null,null,null),fn=pn.exports,gn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-card",{staticClass:"pa-3 pt-0 mt-n3",attrs:{flat:"",color:"transparent"}},[n("v-card",{staticClass:"d-flex align-start mb-1",attrs:{outlined:""}},[n("v-text-field",{staticClass:"pa-1",attrs:{placeholder:"Filter nodes and edges",label:"Filter nodes and edges","append-icon":"mdi-magnify","hide-details":"","single-line":"",dense:"",filled:"",flat:"",solo:""},on:{input:t.filterGraphByInput},model:{value:t.filterString,callback:function(e){t.filterString=e},expression:"filterString"}})],1),n("v-toolbar",{attrs:{dense:"",flat:"",color:"transparent"}},[n("div",[n("span",{staticClass:"mr-2"},[n("small",[t._v(t._s(t.nodes.length)+" nodes and "+t._s(t.edges.length)+" edges")])]),n("v-dialog",{attrs:{width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:"",disabled:!t.edgeQuery,title:"Save selected graph"}},"v-btn",s,!1),i),[n("v-icon",[t._v("mdi-content-save-outline")])],1)]}}]),model:{value:t.saveGraphDialog,callback:function(e){t.saveGraphDialog=e},expression:"saveGraphDialog"}},[n("v-card",{staticClass:"pa-4"},[n("h3",[t._v("Save selected elements")]),n("br"),n("v-text-field",{attrs:{required:"",placeholder:"Name your graph",outlined:"",dense:"",autofocus:""},on:{focus:function(t){return t.target.select()}},model:{value:t.saveAsName,callback:function(e){t.saveAsName=e},expression:"saveAsName"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(e){t.saveGraphDialog=!1}}},[t._v(" Cancel ")]),n("v-btn",{attrs:{color:"primary",depressed:"",disabled:!t.saveAsName},on:{click:t.saveGraph}},[t._v(" Save ")])],1)],1)],1),n("v-btn",{attrs:{icon:"",disabled:!t.currentGraph,title:"Fit to canvas"},on:{click:function(e){return t.cy.fit()}}},[n("v-icon",[t._v("mdi-fit-to-page-outline")])],1),n("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1,"close-on-click":!0,"content-class":"menu-with-gap"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:"",disabled:!t.currentGraph,title:"Graph settings"}},"v-btn",s,!1),i),[n("v-icon",[t._v(" mdi-cog-outline ")])],1)]}}]),model:{value:t.graphSettingsMenu,callback:function(e){t.graphSettingsMenu=e},expression:"graphSettingsMenu"}},[n("v-card",{staticClass:"pa-4 pt-5",attrs:{width:"600"}},[n("h5",[t._v("Layout type")]),n("v-radio-group",{attrs:{row:""},model:{value:t.layoutName,callback:function(e){t.layoutName=e},expression:"layoutName"}},t._l(t.layouts,(function(e){return n("v-radio",{key:e,attrs:{label:e,value:e},on:{click:function(e){return t.buildGraph(t.currentGraph)}}})})),1),n("h5",[t._v("Edge style")]),n("v-radio-group",{attrs:{row:""},model:{value:t.edgeStyle,callback:function(e){t.edgeStyle=e},expression:"edgeStyle"}},t._l(t.edgeStyles,(function(e){return n("v-radio",{key:e,attrs:{label:e,value:e},on:{click:function(e){return t.buildGraph(t.currentGraph)}}})})),1),n("h5",[t._v("Transparency for unselected elements")]),n("v-slider",{attrs:{max:100,min:0,"thumb-label":""},on:{change:t.changeOpacity},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var n=e.value;return[t._v(" "+t._s(n)+"% ")]}}]),model:{value:t.fadeOpacity,callback:function(e){t.fadeOpacity=e},expression:"fadeOpacity"}})],1)],1)],1),n("v-spacer"),Object.keys(t.currentGraphCache).length?n("div",[n("i",[t._v("Generated "+t._s(t._f("timeSince")(t.currentGraphCache.updated_at)))]),n("v-btn",{staticClass:"ml-1",attrs:{icon:"",title:"Refresh graph",disabled:!t.currentGraph},on:{click:function(e){return t.buildGraph({name:t.currentGraph},!0)}}},[n("v-icon",[t._v("mdi-refresh")])],1)],1):t._e()],1)],1),t.isLoading?n("div",{staticClass:"pa-4"},[n("v-progress-linear",{attrs:{indeterminate:"",color:"primary"}})],1):t._e(),t.elements.length||t.isLoading?t._e():n("v-card",{staticClass:"pa-4",attrs:{flat:""}},[t._v(" No data to generate graph ")]),n("div",{ref:"graphContainer",staticStyle:{height:"85vh"}},[t.elements.length&&t.showGraph?n("cytoscape",{attrs:{config:t.config,preConfig:t.preConfig,afterCreated:t.afterCreated},on:{select:function(e){return t.filterGraphBySelection(e)},unselect:function(e){return t.unSelectAllElements(e)}}},t._l(t.elements,(function(t){return n("cy-element",{key:t.data.id,attrs:{definition:t}})})),1):t._e()],1),n("v-bottom-sheet",{attrs:{"hide-overlay":"",persistent:"","no-click-animation":"",scrollable:""},on:{"click:outside":t.closeTimelineView},model:{value:t.showTimelineView,callback:function(e){t.showTimelineView=e},expression:"showTimelineView"}},[n("v-card",[n("v-toolbar",{attrs:{dense:"",flat:""}},[n("strong",[t._v("Timeline for "+t._s(t.selectedEdgesCount)+" selected edge(s)")]),n("v-spacer"),n("v-btn",{attrs:{icon:"",disabled:t.timelineViewHeight>40},on:{click:function(e){return t.increaseTimelineViewHeight()}}},[n("v-icon",[t._v("mdi-chevron-up")])],1),n("v-btn",{attrs:{icon:"",disabled:0===t.timelineViewHeight},on:{click:function(e){return t.decreaseTimelineViewHeight()}}},[n("v-icon",[t._v("mdi-chevron-down")])],1),n("v-btn",{attrs:{icon:""},on:{click:function(e){t.showTimelineView=!1}}},[n("v-icon",[t._v("mdi-close")])],1)],1),n("v-divider"),n("v-expand-transition",[n("v-card-text",{directives:[{name:"show",rawName:"v-show",value:!t.minimizeTimelineView,expression:"!minimizeTimelineView"}],style:{height:t.timelineViewHeight+"vh"}},[n("ts-event-list",{attrs:{"query-request":t.queryRequest,"items-per-page":t.maxEvents,"disable-save-search":""}})],1)],1)],1)],1)],1)},_n=[],yn=(n("96cf"),n("3b8d")),bn=n("6882"),kn=n.n(bn),Sn=n("b17d"),wn=n.n(Sn),xn={props:["graphId"],components:{TsEventList:He},data:function(){return{saveGraphDialog:!1,graphSettingsMenu:!1,showTimelineView:!1,timelineViewHeight:40,minimizeTimelineView:!1,showGraph:!0,isLoading:!1,filterString:"",graphs:{},currentGraph:"",currentGraphCache:{},currentGraphCacheConfig:{},fadeOpacity:7,elements:[],selectedEdgesCount:0,edgeQuery:"",maxEvents:40,queryFilter:{from:0,terminate_after:40,size:this.maxEvents,indices:["_all"],order:"asc",chips:[]},saveAsName:"",layouts:["spread","dagre","circle","concentric","breadthfirst"],layoutName:"spread",edgeStyles:["bezier","taxi"],edgeStyle:"bezier",config:{style:[{selector:"node",style:{shape:"roundrectangle",width:"label",height:"label","compound-sizing-wrt-labels":"include","text-halign":"center","text-valign":"center",color:"#FFFFFF","font-size":"10","font-weight":"bold","text-outline-width":"0px",padding:"7px","background-color":"gray","text-outline-color":"gray","text-wrap":"wrap","text-max-width":"12em",label:"data(label)"}},{selector:"node:selected",style:{"overlay-color":"black","overlay-opacity":"0.3","overlay-padding":"7px"}},{selector:"node[type = 'user']",style:{"background-color":"#FF756E","text-outline-color":"#FF756E"}},{selector:"node[type = 'computer']",style:{"background-color":"#6992f3","text-outline-color":"#ffffff"}},{selector:"node[type = 'file']",style:{"background-color":"#82b578","text-outline-color":"#2b2b2b"}},{selector:"node[type = 'winservice']",style:{"background-color":"#9d8f35","text-outline-color":"#2b2b2b"}},{selector:"edge",style:{width:1,"curve-style":"bezier","control-point-step-size":70,"target-arrow-shape":"triangle","font-size":11,"text-rotation":"autorotate","text-outline-width":3,"text-outline-color":"#FFFFFF",label:"data(label)"}},{selector:"edge:selected",style:{width:2,"line-color":"#333333","source-arrow-color":"#333333","target-arrow-color":"#333333"}},{selector:".faded",style:{opacity:.07,color:"#333333"}}],layout:{name:"",animate:!1,prelayout:!1,spacingFactor:2},minZoom:.1,maxZoom:1.5,zoomingEnabled:!0,userZoomingEnabled:!0,panningEnabled:!0,userPanningEnabled:!0,boxSelectionEnabled:!0,selectionType:"single",touchTapThreshold:8,desktopTapThreshold:4,autolock:!1,autoungrabify:!1,autounselectify:!1,headless:!1,styleEnabled:!0,hideEdgesOnViewport:!1,hideLabelsOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.2,pixelRatio:"auto"}}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},nodes:function(){return this.elements.filter((function(t){return"nodes"===t.group}))},edges:function(){return this.elements.filter((function(t){return"edges"===t.group}))},queryRequest:function(){if(this.edgeQuery)return{queryDsl:this.edgeQuery,queryFilter:this.queryFilter}}},methods:{increaseTimelineViewHeight:function(){this.minimizeTimelineView=!1,this.timelineViewHeight>70||(this.timelineViewHeight+=30)},decreaseTimelineViewHeight:function(){if(this.minimizeTimelineView=!1,this.timelineViewHeight<50)return this.minimizeTimelineView=!0,void(this.timelineViewHeight=0);this.timelineViewHeight-=30},closeTimelineView:function(){"Graph"!==this.$route.name&&(this.showTimelineView=!1)},setSavedGraph:function(t){this.showTimelineView=!1,"Graph"!==this.$route.name&&this.$router.push({name:"Graph",params:{graph:t}}),this.buildSavedGraph(t)},setGraphPlugin:function(t){this.showTimelineView=!1,"Graph"!==this.$route.name&&this.$router.push({name:"Graph",params:{graphPlugin:t}}),this.buildGraph(t)},buildSavedGraph:function(t){var e=this;this.config.layout.name="preset",this.currentGraph=t.name,this.currentGraphCache={},this.showGraph=!1,this.elements=[],this.loadingTimeout=setTimeout((function(){e.elements.length||(e.isLoading=!0)}),600),this.edgeQuery="";var n="";n="object"===Object(R["a"])(t)?t.id:t,_.getSavedGraph(this.sketch.id,n).then((function(t){e.currentGraph=t.data["objects"][0].name;var n=JSON.parse(t.data["objects"][0].graph_elements),i=n.filter((function(t){return"nodes"===t.group})),s=n.filter((function(t){return"edges"===t.group})),r=[];i.forEach((function(t){t.selected=!1,r.push(t)})),s.forEach((function(t){t.selected=!1,r.push(t)})),clearTimeout(e.loadingTimeout),e.elements=r,e.showGraph=!0,e.isLoading=!1})).catch((function(t){console.error(t)}))},buildGraph:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.config.layout.name=this.layoutName;var i=this.config.style.filter((function(t){return"edge"===t.selector}));i[0].style["curve-style"]=this.edgeStyle,"object"===Object(R["a"])(t)?this.currentGraph=t.name:this.currentGraph=t,this.showGraph=!1,this.elements=[],this.isLoading=!0,this.edgeQuery="";var s=[],r=[];this.$route.query.timeline?(r.push(parseInt(this.$route.query.timeline)),n=!0):this.sketch.timelines.forEach((function(t){s.push(t.searchindex.index_name)})),_.generateGraphFromPlugin(this.sketch.id,this.currentGraph,s,r,n).then((function(t){var n,i,s=t.data["objects"][0],r=JSON.parse(s.graph_elements),a=JSON.parse(s.graph_config),o=[];"elements"in r?(n=r["elements"]["nodes"],i=r["elements"]["edges"]):(n=r["nodes"],i=r["edges"]),n.forEach((function(t){o.push({data:t.data,group:"nodes"})})),i.forEach((function(t){o.push({data:t.data,group:"edges"})})),delete s.graph_elements,e.currentGraphCache=s,e.currentGraphCacheConfig=a,e.elements=o,clearTimeout(e.loadingTimeout),e.showGraph=!0,e.isLoading=!1})).catch((function(t){console.error(t)}))},saveGraph:function(){var t=this,e=this.cy.filter(":selected"),n=this.buildNeighborhood(e),i=n.jsons();this.showGraph=!1,this.elements=i,this.currentGraph=this.saveAsName,this.showGraph=!0,_.saveGraph(this.sketch.id,this.saveAsName,i).then((function(e){t.$store.dispatch("updateSavedGraphs",t.sketch.id),t.$router.push({name:"Graph",query:{graph:e.data.objects[0].id}})})).catch((function(e){t.errorSnackBar("Unable to save graph"),console.error(e)})),this.saveAsName="",this.saveGraphDialog=!1},filterGraphByInput:function(){var t=this;this.cy.elements().unselect();var e=this.cy.elements().filter((function(e){return e.data("label").toLowerCase().includes(t.filterString.toLowerCase())}));this.showNeighborhood(e)},filterGraphBySelection:function(t){var e=this.cy.filter(":selected");this.showNeighborhood(e),this.showTimelineView=!0},unSelectAllElements:function(t){this.cy.elements().removeClass("faded"),this.edgeQuery=null,this.showTimelineView=!1,this.selectedEdgesCount=0},buildNeighborhood:function(t){var e=this.cy.collection();return e=e.add(t.filter("node").neighborhood()),e=e.add(t.filter("edge").connectedNodes()),e=e.add(t),e},showNeighborhood:function(t){var e=this,n=this.buildNeighborhood(t);if(0!==t.length){this.cy.elements().addClass("faded"),n.removeClass("faded");var i={query:{bool:{should:[]}}};n.forEach((function(t){"edges"===t.group()&&Object.keys(t.data().events).forEach((function(n){e.selectedEdgesCount++;var s={bool:{must:[{ids:{values:t.data().events[n]}},{term:{_index:{value:n}}}]}};i.query.bool.should.push(s)}))})),this.edgeQuery=i}else this.cy.elements().removeClass("faded")},resizeCanvas:function(){if("Graph"===this.$route.name){var t=this.$refs.graphContainer.clientHeight,e=this.$refs.graphContainer.clientWidth,n=document.getElementById("cytoscape-div");n.style.minHeight=t+"px",n.style.height=t+"px",n.style.minWidth=e+"px",n.style.width=e+"px"}},preConfig:function(t){t.use(kn.a),t.use(wn.a),this.resizeCanvas()},afterCreated:function(){var t=Object(yn["a"])(regeneratorRuntime.mark((function t(){var e,n=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:null,null!==e?this.cy=e:e=this.cy,t.next=4,e;case 4:this.setTheme(),e.layout(this.config.layout).run();case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changeOpacity:function(){this.cy&&this.cy.style().selector(".faded").style({opacity:this.fadeOpacity/100}).update()},setTheme:function(){this.$vuetify.theme.dark?this.cy.style().selector("edge").style({color:"#f5f5f5","text-outline-color":"#25272c"}).update():this.cy.style().selector("edge").style({color:"#333333","text-outline-color":"#FFFFFF"}).update()}},mounted:function(){var t=this;window.addEventListener("resize",mt.a.debounce((function(){t.resizeCanvas()}),250)),ro.$on("setGraphPlugin",this.setGraphPlugin),ro.$on("setSavedGraph",this.setSavedGraph),this.params={graphId:this.$route.query.graph,pluginName:this.$route.query.plugin,timelineId:this.$route.query.timeline},this.params.graphId&&this.buildSavedGraph(this.params.graphId),this.params.pluginName&&this.buildGraph(this.params.pluginName)},beforeDestroy:function(){ro.$off("setGraphPlugin"),ro.$off("setSavedGraph")},watch:{"$vuetify.theme.dark":function(){this.setTheme()}}},Cn=xn,Tn=Object(c["a"])(Cn,gn,_n,!1,null,"9db14154",null),$n=Tn.exports,En=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-dialog",{attrs:{width:"600"},model:{value:t.renameStoryDialog,callback:function(e){t.renameStoryDialog=e},expression:"renameStoryDialog"}},[n("v-card",{staticClass:"pa-4"},[n("h3",[t._v("Rename story")]),n("br"),n("v-text-field",{attrs:{outlined:"",dense:"",autofocus:""},on:{focus:function(t){return t.target.select()}},model:{value:t.titleDraft,callback:function(e){t.titleDraft=e},expression:"titleDraft"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(e){t.renameStoryDialog=!1}}},[t._v(" Cancel ")]),n("v-btn",{attrs:{color:"primary",depressed:""},on:{click:function(e){return t.rename()}}},[t._v(" Save ")])],1)],1)],1),n("v-hover",{scopedSlots:t._u([{key:"default",fn:function(e){var i=e.hover;return[n("v-toolbar",{staticClass:"mt-n3",attrs:{dense:"",flat:"",color:"transparent"}},[n("v-toolbar-title",{staticClass:"mx-3",on:{dblclick:function(e){t.renameStoryDialog=!0}}},[t._v(" "+t._s(t.title))]),i?n("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){t.renameStoryDialog=!0}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-pencil")])],1):t._e()],1)]}}])}),n("div",{staticClass:"mx-3 pa-4"},t._l(t.blocks,(function(e,i){return n("div",{key:i},[e.componentName?t._e():n("div",[n("v-hover",{scopedSlots:t._u([{key:"default",fn:function(s){var r=s.hover;return[n("div",{staticStyle:{"min-height":"30px"},on:{dblclick:function(n){return t.editTextBlock(e)},keydown:function(n){if(!n.type.indexOf("key")&&t._k(n.keyCode,"esc",27,n.key,["Esc","Escape"]))return null;e.edit=!1}}},[r&&!e.edit?n("v-card",{staticClass:"float-right px-2",attrs:{outlined:""}},[n("v-btn",{attrs:{icon:"",small:""},on:{click:function(n){return t.editTextBlock(e)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-pencil")])],1),n("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.deleteBlock(i)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1)],1):t._e(),e.edit?t._e():n("div",{staticClass:"markdown-body",domProps:{innerHTML:t._s(t.toHtml(e.content))}}),e.edit?n("v-card",{staticClass:"mb-2",attrs:{flat:"",outlined:""}},[n("v-toolbar",{attrs:{flat:"",dense:""}},[n("v-tabs",{model:{value:e.currentTab,callback:function(n){t.$set(e,"currentTab",n)},expression:"block.currentTab"}},[n("v-tab",[t._v("Edit")]),n("v-tab",[t._v("Preview")])],1),n("v-spacer"),t.hasContent?n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.deleteBlock(i)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1):t._e()],1),n("v-divider"),n("v-tabs-items",{model:{value:e.currentTab,callback:function(n){t.$set(e,"currentTab",n)},expression:"block.currentTab"}},[n("v-tab-item",{attrs:{transition:!1}},[n("v-textarea",{attrs:{solo:"",flat:"",value:e.draft,placeholder:"Your story starts here..",rows:"5","auto-grow":"",autofocus:""},on:{input:function(n){return t.updateDraft(n,e)}}})],1),n("v-tab-item",{attrs:{transition:!1}},[n("div",{staticClass:"markdown-body pa-4",domProps:{innerHTML:t._s(t.toHtml(e.draft))}})])],1),e.edit?n("v-divider"):t._e(),e.edit?n("v-card-actions",[n("v-btn",{attrs:{text:"",color:"primary",disabled:!e.draft},on:{click:function(e){return t.save()}}},[t._v("Save")]),n("v-btn",{attrs:{text:"",disabled:!t.hasContent},on:{click:function(t){e.edit=!1}}},[t._v("Cancel")])],1):t._e()],1):t._e()],1)]}}],null,!0)})],1),e.componentName?n("div",[n("v-hover",{scopedSlots:t._u([{key:"default",fn:function(s){var r=s.hover;return[n("div",["TsEventList"===e.componentName?n("v-card",{staticClass:"mb-2",attrs:{outlined:""}},[n("v-toolbar",{attrs:{dense:"",flat:""}},[n("router-link",{staticStyle:{cursor:"pointer","text-decoration":"none"},attrs:{to:{name:"Explore",query:{view:e.componentProps.view.id}}}},[n("span",{on:{click:function(n){return t.setActiveView(e.componentProps.view)}}},[t._v(t._s(e.componentProps.view.name))])]),n("v-spacer"),r?n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.deleteBlock(i)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1):t._e()],1),n("v-divider"),n("v-card-text",[n(e.componentName,t._b({tag:"component"},"component",t.formatComponentProps(e),!1))],1)],1):t._e(),"TsAggregationGroupCompact"===e.componentName?n("v-card",{staticClass:"mb-2",attrs:{outlined:""}},[n("v-toolbar",{attrs:{dense:"",flat:""}},[t._v(t._s(e.componentProps.aggregation_group.name))]),n("v-divider"),n("v-card-text",[t._v("Aggregations are not yet supported")])],1):t._e(),"TsAggregationCompact"===e.componentName?n("v-card",{staticClass:"mb-2",attrs:{outlined:""}},[n("v-toolbar",{attrs:{dense:"",flat:""}},[t._v(t._s(e.componentProps.aggregation.name))]),n("v-divider"),n("v-card-text",[t._v("Aggregations are not yet supported")])],1):t._e()],1)]}}],null,!0)})],1):t._e(),n("v-hover",{scopedSlots:t._u([{key:"default",fn:function(s){var r=s.hover;return[n("div",{staticClass:"mb-2"},[n("div",{class:{hidden:!r&&!e.isActive&&t.hasContent}},[t.hasContent?n("v-btn",{staticClass:"mr-2",attrs:{rounded:"",outlined:"",small:""},on:{click:function(e){return t.addTextBlock(i)}}},[n("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-plus")]),t._v("\n              Text\n            ")],1):t._e(),n("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{rounded:"",outlined:"",small:"",disabled:!t.meta.views.length}},"v-btn",s,!1),i),[n("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-plus")]),t._v("\n                  Saved Search\n                ")],1)]}}],null,!0),model:{value:e.isActive,callback:function(n){t.$set(e,"isActive",n)},expression:"block.isActive"}},[n("v-card",{attrs:{width:"475"}},[n("v-list",[n("v-list-item-group",{attrs:{color:"primary"}},t._l(t.meta.views,(function(e){return n("v-list-item",{key:e.id},[n("v-list-item-content",{on:{click:function(n){return t.addEventListBlock(e,i)}}},[t._v("\n                        "+t._s(e.name)+"\n                      ")])],1)})),1)],1)],1)],1)],1)])]}}],null,!0)})],1)})),0)],1)},Fn=[],Pn=n("c0c4"),An=n.n(Pn),On=n("7c5c"),Dn=function(){return{componentName:"",componentProps:{},content:"",draft:"",edit:!0,isActive:!1}},Nn=function(){return{TsViewEventList:"TsEventList"}},In={props:["sketchId","storyId"],components:{TsEventList:He},data:function(){return{title:"",titleDraft:"",blocks:[],renameStoryDialog:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},hasContent:function(){return!!this.blocks.length&&!(this.blocks.length<2&&!this.blocks[0].componentName&&!this.blocks[0].content)}},methods:{updateDraft:mt.a.debounce((function(t,e){e.draft=t}),300),fetchStory:function(){var t=this;_.getStory(this.sketchId,this.storyId).then((function(e){t.title=e.data.objects[0].title,t.titleDraft=t.title;var n=e.data.objects[0].content;t.blocks="[]"===n?[Dn()]:JSON.parse(n),t.formatBlocks(t.blocks),t.blocks.length<2&&!t.blocks[0].componentName&&!t.blocks[0].content&&(t.blocks[0].edit=!0)})).catch((function(t){console.error(t)}))},formatBlocks:function(t){var e=Nn();return t.forEach((function(t){t.componentName in e&&(t.componentName=e[t.componentName])})),t},formatComponentProps:function(t){if("TsEventList"===t.componentName||"TsViewEventList"===t.componentName){var e=10,n=t.componentProps.view.query_string,i=t.componentProps.view.query_filter,s={};return i=i&&void 0!==i?JSON.parse(i):{},i.size=e,i.terminate_after=e,s["queryString"]=n,s["queryFilter"]=i,s["incognito"]=!0,{queryRequest:s,disableSaveSearch:!0,itemsPerPage:e}}return t.componentProps},toHtml:function(t){return An.a.sanitize(Object(On["marked"])(t))},addTextBlock:function(t){var e=t+1,n=Dn();this.blocks.splice(e,0,n)},addEventListBlock:function(t,e){var n=e+1,i=Dn();i.componentName="TsEventList",i.componentProps={view:t},this.blocks.splice(n,0,i),this.save()},editTextBlock:function(t){t.draft=t.content,t.edit||(t.edit=!t.edit)},deleteBlock:function(t){confirm("Delete block?")&&(this.blocks.splice(t,1),this.blocks.length||(this.blocks=[Dn()]),this.save())},setActiveView:function(t){ro.$emit("setActiveView",t)},save:function(){var t,e=this;this.blocks.forEach((function(t){t.isActive=!1,t.edit=!1,t.draft&&(t.content=t.draft,t.draft="")})),this.hasContent?t=JSON.stringify(this.blocks):(t=JSON.stringify([]),this.blocks=[Dn()]),_.updateStory(this.title,t,this.sketchId,this.storyId).then((function(t){e.$store.dispatch("updateSketch",e.sketchId)})).catch((function(t){}))},rename:function(){this.renameStoryDialog=!1,this.title=this.titleDraft,this.save()}},mounted:function(){this.storyId&&this.fetchStory()},watch:{storyId:function(t){this.storyId&&this.fetchStory()}}},Rn=In,Ln=(n("dc60"),Object(c["a"])(Rn,En,Fn,!1,null,null,null)),jn=Ln.exports,qn={props:["sketchId","storyId"],components:{Explore:Be,ThreatIntel:fn,Graph:$n,Story:jn},computed:{currentRouteName:function(){return this.$route.name}}},Qn=qn,Hn=Object(c["a"])(Qn,F,P,!1,null,null,null),Mn=Hn.exports,Wn=function(){var t=this,e=this,n=e.$createElement,i=e._self._c||n;return e.sketch?i("div",{staticStyle:{height:"30%"}},[e.loadingSketch?i("v-progress-linear",{attrs:{indeterminate:"",color:"primary"}}):e._e(),i("v-toolbar",{attrs:{flat:"",color:"transparent"}},[i("v-avatar",{directives:[{name:"show",rawName:"v-show",value:!e.showLeftPanel||!e.hasTimelines,expression:"!showLeftPanel || !hasTimelines"}],staticClass:"ml-n3 mt-1"},[i("router-link",{attrs:{to:"/"}},[i("v-img",{attrs:{src:"/dist/timesketch-color.png","max-height":"25","max-width":"25",contain:""}})],1)],1),i("span",{directives:[{name:"show",rawName:"v-show",value:!e.showLeftPanel&&!e.loadingSketch,expression:"!showLeftPanel && !loadingSketch"}],staticClass:"mr-1",staticStyle:{"font-size":"1.1em"}},[e._v(e._s(e.sketch.name)+" ")]),i("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.showLeftPanel&&!e.loadingSketch,expression:"!showLeftPanel && !loadingSketch"}],staticClass:"ml-n1",attrs:{icon:""},on:{click:e.toggleLeftPanel}},[i("v-icon",[e._v("mdi-menu")])],1),i("v-btn",{directives:[{name:"show",rawName:"v-show",value:"Explore"!==e.currentRouteName,expression:"currentRouteName !== 'Explore'"}],staticClass:"ml-3",attrs:{to:{name:"Explore",params:{sketchId:e.sketchId}},color:"primary",small:"",text:""}},[i("v-icon",{attrs:{small:"",left:""}},[e._v("mdi-arrow-left")]),e._v("\n      back to explore\n    ")],1),i("v-spacer"),i("v-btn",{attrs:{small:"",depressed:""},on:{click:e.switchUI}},[e._v(" Use the old UI ")]),i("v-dialog",{attrs:{width:"500"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"ml-2",attrs:{small:"",depressed:"",color:"primary"}},"v-btn",s,!1),n),[i("v-icon",{attrs:{small:"",left:""}},[e._v("mdi-account-multiple-plus")]),e._v("\n          Share\n        ")],1)]}}],null,!1,2726467621),model:{value:e.shareDialog,callback:function(t){e.shareDialog=t},expression:"shareDialog"}},[i("ts-share-card",{on:{"close-dialog":function(t){e.shareDialog=!1}}})],1),i("v-avatar",{staticClass:"ml-3",attrs:{color:"grey lighten-1",size:"25"}},[i("span",{staticClass:"white--text"},[e._v(e._s(e._f("initialLetter")(e.currentUser)))])]),i("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-avatar",[i("v-btn",e._g(e._b({attrs:{small:"",icon:""}},"v-btn",s,!1),n),[i("v-icon",[e._v("mdi-dots-vertical")])],1)],1)]}}],null,!1,1354068383)},[i("v-card",[i("v-list",[i("v-list-item-group",{attrs:{color:"primary"}},[i("v-list-item",{on:{click:e.toggleTheme}},[i("v-list-item-icon",[i("v-icon",[e._v("mdi-brightness-6")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Toggle theme")])],1)],1),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[e._v("mdi-archive")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Archive sketch")])],1)],1),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[e._v("mdi-export")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Export sketch")])],1)],1),i("a",{staticStyle:{"text-decoration":"none",color:"inherit"},attrs:{href:"/logout/"}},[i("v-list-item",[i("v-list-item-icon",[i("v-icon",[e._v("mdi-logout")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v("Logout")])],1)],1)],1)],1)],1)],1)],1)],1),e.hasTimelines||e.loadingSketch?e._e():i("v-container",{attrs:{"fill-height":"",fluid:""}},[i("v-row",{attrs:{align:"center",justify:"center"}},[i("v-sheet",{staticClass:"pa-4"},[i("center",[i("div",{staticClass:"mb-3",staticStyle:{"font-size":"2em"}},[e._v("It's empty around here")]),i("ts-upload-timeline-form",{attrs:{"btn-size":"normal","btn-type":"outlined"}})],1)],1)],1)],1),e.showLeftPanel&&e.hasTimelines?i("v-navigation-drawer",{ref:"drawer",attrs:{app:"",permanent:"",width:e.navigationDrawer.width,"hide-overlay":""}},[i("v-toolbar",{attrs:{flat:""}},[i("v-avatar",{staticClass:"ml-n3 mt-1"},[i("router-link",{attrs:{to:"/"}},[i("v-img",{attrs:{src:"/dist/timesketch-color.png","max-height":"25","max-width":"25",contain:""}})],1)],1),i("div",{staticStyle:{"font-size":"1.1em",cursor:"pointer","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},attrs:{title:e.sketch.name},on:{click:function(t){e.showSketchMetadata=!e.showSketchMetadata}}},[e._v("\n        "+e._s(e.sketch.name)+"\n      ")]),i("v-spacer"),i("v-icon",{on:{click:e.toggleLeftPanel}},[e._v("mdi-chevron-left")])],1),i("v-expand-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.showSketchMetadata,expression:"showSketchMetadata"}],staticClass:"px-4"},[i("v-dialog",{attrs:{width:"600"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({attrs:{small:"",outlined:"",depressed:"",color:"primary"}},"v-btn",s,!1),n),[i("v-icon",{attrs:{left:""}},[e._v(" mdi-pencil ")]),e._v("\n              Rename")],1)]}}],null,!1,888508409),model:{value:e.renameSketchDialog,callback:function(t){e.renameSketchDialog=t},expression:"renameSketchDialog"}},[i("v-card",{staticClass:"pa-4"},[i("ts-rename-sketch",{on:{close:function(t){e.renameSketchDialog=!1}}})],1)],1),i("v-list",{staticClass:"mx-n4",attrs:{"two-line":""}},[e.sketch.user?i("v-list-item",[i("v-list-item-content",[i("v-list-item-title",[i("strong",[e._v("Created:")]),e._v(" "+e._s(e._f("shortDateTime")(e.sketch.created_at))+"\n              ")]),i("v-list-item-subtitle",[i("small",[e._v(e._s(e._f("timeSince")(e.sketch.created_at))+" by "+e._s(e.sketch.user.username))])])],1)],1):e._e(),i("v-list-item",[i("v-list-item-content",[i("v-list-item-title",[i("strong",[e._v("Access: ")]),e.meta.permissions&&e.meta.permissions.public?i("span",[e._v("Public")]):i("span",[e._v("Restricted")])]),i("v-list-item-subtitle",[e.meta.permissions&&e.meta.permissions.public?i("small",[e._v("Visible to all users on this server")]):i("small",[e._v("Only people with access can open")])])],1)],1)],1)],1)]),i("v-divider"),i("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.scenarioDialog,callback:function(t){e.scenarioDialog=t},expression:"scenarioDialog"}},[i("v-card",[i("div",{staticClass:"pa-3"},[i("h3",[e._v("Investigative Scenarios")]),i("v-select",{staticClass:"mt-3",attrs:{items:e.scenarioTemplates,"item-text":"display_name","return-object":"",label:"Select a scenario",outlined:""},model:{value:e.selectedScenario,callback:function(t){e.selectedScenario=t},expression:"selectedScenario"}}),e.selectedScenario?i("div",[e._v("\n            "+e._s(e.selectedScenario.description)+"\n          ")]):e._e()],1),i("v-divider"),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.scenarioDialog=!1}}},[e._v(" Close ")]),i("v-btn",{attrs:{disabled:!e.selectedScenario,color:"primary",text:""},on:{click:function(t){return e.addScenario(e.selectedScenario.short_name)}}},[e._v("\n            Add\n          ")])],1)],1)],1),i("v-tabs",{attrs:{grow:""},model:{value:e.leftPanelTab,callback:function(t){e.leftPanelTab=t},expression:"leftPanelTab"}},e._l(e.leftPanelTabItems,(function(t){return i("v-tab",{key:t},[e._v(" "+e._s(t)+" ")])})),1),i("v-divider"),i("v-tabs-items",{model:{value:e.leftPanelTab,callback:function(t){e.leftPanelTab=t},expression:"leftPanelTab"}},[i("v-tab-item",{attrs:{transition:!1}},[e.meta.views?i("ts-saved-searches"):e._e(),i("ts-data-types"),i("ts-tags"),i("ts-search-templates"),i("ts-graphs"),i("ts-stories"),i("ts-sigma-rules"),i("ts-intelligence")],1),i("v-tab-item",{attrs:{transition:!1}},[e._l(e.activeScenarios,(function(t){return i("ts-scenario",{key:t.id,attrs:{scenario:t}})})),i("v-row",{staticClass:"mt-0 px-2",attrs:{flat:""}},[i("v-col",{attrs:{cols:"6"}},[i("v-btn",{staticStyle:{cursor:"pointer"},attrs:{text:"",color:"primary"},on:{click:function(t){e.scenarioDialog=!0}}},[i("v-icon",{attrs:{left:""}},[e._v("mdi-plus")]),e._v(" Add Scenario")],1)],1),i("v-col",{attrs:{cols:"6",align:"right"}},[e.hiddenScenarios.length?i("div",{staticClass:"mt-1",staticStyle:{cursor:"pointer"},on:{click:function(t){e.showHidden=!e.showHidden}}},[i("small",[e.showHidden?i("span",[e._v("Hide")]):i("span",[e._v("Show")]),e._v(" hidden scenarios ("+e._s(e.hiddenScenarios.length)+")")])]):e._e()])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showHidden,expression:"showHidden"}]},e._l(e.hiddenScenarios,(function(t){return i("ts-scenario",{key:t.id,attrs:{scenario:t}})})),1)],2)],1)],1):e._e(),e.sketch.status&&e.hasTimelines?i("router-view",{on:{setTitle:function(e){return t.title=e}}}):e._e()],1):e._e()},zn=[],Gn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-row",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer"},attrs:{"no-gutters":"",flat:""},on:{click:function(e){t.expanded=!t.expanded}}},[n("v-col",{attrs:{cols:"11"}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-clipboard-check-outline")]),n("span",[t._v(t._s(t.scenario.display_name))])],1),n("v-col",{attrs:{cols:"1"}},[n("v-dialog",{attrs:{"max-width":"500"},model:{value:t.renameDialog,callback:function(e){t.renameDialog=e},expression:"renameDialog"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5"},[t._v(" Rename scenario ")]),n("v-card-text",[t._v("\n            Use a custom name for the scenario.\n            "),n("v-text-field",{model:{value:t.newName,callback:function(e){t.newName=e},expression:"newName"}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.renameDialog=!1}}},[t._v(" Cancel ")]),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){return t.renameScenario()}}},[t._v(" Save ")])],1)],1)],1),n("v-menu",{attrs:{"offset-y":"","close-on-content-click":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{small:"",icon:""}},"v-btn",s,!1),i),[n("v-icon",[t._v("mdi-dots-vertical")])],1)]}}])},[n("v-card",[n("v-list",{attrs:{dense:""}},[n("v-list-item-group",{attrs:{color:"primary"}},[n("v-list-item",{on:{click:t.copyScenario}},[n("v-list-item-icon",[n("v-icon",{attrs:{small:""}},[t._v("mdi-content-copy")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Make a copy")])],1)],1),n("v-list-item",{on:{click:function(e){e.stopPropagation(),t.renameDialog=!0}}},[n("v-list-item-icon",[n("v-icon",{attrs:{small:""}},[t._v("mdi-pencil")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Rename")])],1)],1),t.is_hidden?n("v-list-item",{on:{click:function(e){return t.setStatus("active")}}},[n("v-list-item-icon",[n("v-icon",{attrs:{small:""}},[t._v("mdi-eye")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Reactivate")])],1)],1):n("v-list-item",{on:{click:function(e){return t.setStatus("hidden")}}},[n("v-list-item-icon",[n("v-icon",{attrs:{small:""}},[t._v("mdi-eye-off")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Hide from list")])],1)],1)],1)],1)],1)],1)],1)],1),t.scenario.facets.length?n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},t._l(t.scenario.facets,(function(e){return n("div",{key:e.id},[n("ts-facet",{attrs:{scenario:t.scenario,facet:e}})],1)})),0)]):t._e(),t.expanded?t._e():n("v-divider"),t.expanded?n("br"):t._e()],1)},Bn=[],Un=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-row",{staticClass:"pa-3 pl-1",class:[t.$vuetify.theme.dark?"dark-hover":"light-hover"],staticStyle:{cursor:"pointer"},attrs:{"no-gutters":""},on:{click:function(e){return t.toggleFacet()}}},[n("v-col",{staticClass:"pl-1",attrs:{cols:"1"}},[t.expanded?n("v-icon",[t._v("mdi-chevron-down")]):n("v-icon",[t._v("mdi-chevron-right")])],1),n("v-col",{attrs:{cols:"10"}},[n("span",{staticStyle:{"font-size":"0.9em"}},[t.notStarted||t.isActive?n("span",[n("strong",[t._v(t._s(t.facet.display_name))])]):n("span",[t._v(t._s(t.facet.display_name))])])]),n("v-col",{attrs:{cols:"1"}},[n("div",{staticClass:"ml-1"},[n("small",[t._v(t._s(t.questionsWithConclusion.length)+"/"+t._s(t.facet.questions.length)+" ")])])])],1),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},t._l(t.facet.questions,(function(e){return n("span",{key:e.id,staticStyle:{"font-size":"0.9em"},on:{click:function(n){return t.setActiveContext(e)}}},[n("ts-question",{attrs:{question:e}})],1)})),0)]),n("v-divider")],1)},Vn=[],Yn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-divider"),n("div",{staticClass:"pa-2 pl-3",class:[t.$vuetify.theme.dark?"dark-hover":"light-hover"],staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(e){t.expanded=!t.expanded}}},[t.question.conclusions.length?n("span",[t._v(t._s(t.question.display_name))]):n("strong",[t._v(t._s(t.question.display_name))])]),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},[t.question.search_templates.length?n("div",{staticClass:"ma-2 mb-3"},[n("v-icon",{staticClass:"mr-1",attrs:{"x-small":""}},[t._v("mdi-magnify")]),n("strong",[n("small",[t._v("Query suggestions")])]),t._l(t.question.search_templates,(function(t){return n("div",{key:t.id,staticClass:"pa-1 mt-1"},[n("ts-search-template",{attrs:{searchtemplate:t}})],1)}))],2):t._e(),n("div",{staticClass:"mb-3 mx-4"},[n("v-icon",{staticClass:"mr-1",attrs:{"x-small":""}},[t._v("mdi-check-circle-outline")]),n("strong",[n("small",[t._v("Conclusions")])]),t._l(t.question.conclusions,(function(e){return n("v-sheet",{key:e.id,staticClass:"mt-2",attrs:{outlined:"",rounded:""}},[n("ts-question-conclusion",{attrs:{question:t.question,conclusion:e}})],1)}))],2),t.currentUserConclusion?t._e():n("div",{staticClass:"pa-4 pt-0",staticStyle:{"font-size":"0.9em"}},[n("v-textarea",{staticStyle:{"font-size":"0.9em"},attrs:{outlined:"",flat:"","hide-details":"","auto-grow":"",rows:"1",placeholder:"Add your conclusion..."},scopedSlots:t._u([{key:"prepend-inner",fn:function(){return[n("v-avatar",{staticClass:"mt-n2 mr-2",attrs:{color:"grey",size:"28"}},[n("span",{staticClass:"white--text"},[t._v(t._s(t._f("initialLetter")(t.currentUser)))])])]},proxy:!0}],null,!1,3203646345),model:{value:t.conclusionText,callback:function(e){t.conclusionText=e},expression:"conclusionText"}}),n("v-expand-transition",[t.conclusionText?n("div",[n("v-card-actions",{staticClass:"pr-0"},[n("v-spacer"),n("v-btn",{attrs:{small:"",text:""},on:{click:function(e){t.conclusionText=""}}},[t._v(" Cancel ")]),n("v-btn",{attrs:{small:"",text:"",color:"primary"},on:{click:function(e){return t.createConclusion()}}},[t._v(" Save ")])],1)],1):t._e()])],1)])])],1)},Jn=[],Xn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-row",{attrs:{"no-gutters":""}},[n("div",{staticClass:"px-2 mb-n1",class:[t.$vuetify.theme.dark?"dark-highlight":"light-highlight",t.$vuetify.theme.dark?"dark-hover-on-highlight":"light-hover-on-highlight"],staticStyle:{width:"100%","border-radius":"4px",cursor:"pointer"},on:{click:function(e){return t.search(t.searchtemplate.query_string)}}},[n("span",{staticStyle:{"font-size":"0.8em"}},[t._v(t._s(t.searchtemplate.name))])])]),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],staticClass:"pa-4 pt-0"},[n("div",{staticStyle:{"font-size":"0.9em"}},[n("v-simple-table",{attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[n("tbody",[n("tr",[n("td",[n("strong",[t._v("Author")])]),n("td",[t._v(t._s(t.searchTemplateSpec.author))])]),n("tr",[n("td",[n("strong",[t._v("Description")])]),n("td",[t._v(t._s(t.searchTemplateSpec.description))])]),n("tr",[n("td",[n("strong",[t._v("Date")])]),n("td",[t._v(t._s(t.searchTemplateSpec.date))])]),n("tr",[n("td",[n("strong",[t._v("ID")])]),n("td",[t._v(t._s(t.searchTemplateSpec.id))])]),t.searchTemplateSpec.references.length?n("tr",[n("td",[n("strong",[t._v("References")])]),n("td",t._l(t.searchTemplateSpec.references,(function(e){return n("div",{key:e},[n("a",{attrs:{href:e,target:"new"}},[t._v(t._s(e))])])})),0)]):t._e()])]},proxy:!0}])})],1),t.parameters.length?n("div",{staticClass:"pt-3"},[n("div",{staticClass:"mb-3"},[n("strong",{staticClass:"mb-3"},[t._v("Required input parameters")])]),t._l(t.parameters,(function(e){return n("div",{key:e.name,staticClass:"mb-4"},[n("v-text-field",{attrs:{hint:e.description,label:e.description,outlined:"",dense:"","hide-details":""},model:{value:t.params[e.name],callback:function(n){t.$set(t.params,e.name,n)},expression:"params[parameter.name]"}})],1)})),n("v-card-actions",{staticClass:"pl-0 mt-n3"},[n("v-btn",{attrs:{small:"",depressed:"",color:"primary",disabled:!t.filledOut},on:{click:function(e){return t.parseQueryAndSearch()}}},[t._v("\n            Search\n          ")])],1)],2):n("div",{staticClass:"mt-3"},[n("v-btn",{attrs:{small:"",depressed:"",color:"primary",disabled:!t.filledOut},on:{click:function(e){return t.search(t.searchtemplate.query_string)}}},[t._v("Search")])],1)])])],1)},Kn=[],Zn=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},ti={props:["searchtemplate"],data:function(){return{expanded:!1,params:{}}},computed:{sketch:function(){return this.$store.state.sketch},parameters:function(){return JSON.parse(this.searchtemplate.template_json).parameters},filledOut:function(){return Object.keys(this.params).length===this.parameters.length},searchTemplateSpec:function(){return JSON.parse(this.searchtemplate.template_json)}},methods:{search:function(t){var e={doSearch:!0};e.queryString=t,e.queryFilter=Zn(),ro.$emit("setQueryAndFilter",e)},parseQueryAndSearch:function(){var t,e=this;_.parseSearchTemplate(this.searchtemplate.id,this.params).then((function(n){t=n.data.objects[0].query_string,e.search(t)})).catch((function(t){}))}}},ei=ti,ni=Object(c["a"])(ei,Xn,Kn,!1,null,"8f007a88",null),ii=ni.exports,si=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.loading?n("v-progress-linear",{attrs:{color:"primary",indeterminate:"",height:"2"}}):t._e(),n("v-list",{attrs:{"three-line":""}},[n("v-list-item",{on:{mouseover:function(e){t.showControls=!0},mouseleave:function(e){t.showControls=!1}}},[n("v-list-item-content",[n("v-list-item-title",{staticStyle:{"font-size":"0.9em"}},[n("strong",[t._v(t._s(t.conclusion.user.username))])]),n("v-list-item-subtitle",[n("small",[t._v(t._s(t._f("shortDateTime")(t.conclusion.created_at))+" ("+t._s(t._f("timeSince")(t.conclusion.created_at))+")")])]),t.editable?n("div",[n("v-textarea",{staticStyle:{"font-size":"0.9em"},attrs:{"hide-details":"","auto-grow":"",outlined:"",value:t.conclusion.conclusion},model:{value:t.conclusionText,callback:function(e){t.conclusionText=e},expression:"conclusionText"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{small:"",text:""},on:{click:function(e){t.editable=!1}}},[t._v(" Cancel ")]),n("v-btn",{attrs:{small:"",text:"",color:"primary",disabled:!t.conclusionText},on:{click:function(e){return t.saveConclusion()}}},[t._v(" Save ")])],1)],1):n("div",{staticStyle:{"max-width":"90%","font-size":"0.9em"}},[t._v(t._s(t.conclusion.conclusion))])],1),t.showControls&&t.currentUser==t.conclusion.user.username?n("v-list-item-action",{staticStyle:{position:"absolute",right:"0"}},[n("v-chip",{staticStyle:{"margin-right":"10px"},attrs:{outlined:""}},[n("v-btn",{attrs:{icon:"",small:""}},[n("v-icon",{attrs:{small:""},on:{click:function(e){return t.editConclusion()}}},[t._v("mdi-square-edit-outline")])],1),n("v-btn",{attrs:{icon:"",small:""}},[n("v-icon",{attrs:{small:""},on:{click:function(e){return t.deleteConclusion()}}},[t._v("mdi-trash-can-outline")])],1)],1)],1):t._e()],1)],1)],1)},ri=[],ai={props:["question","conclusion"],data:function(){return{conclusionText:"",editable:!1,showControls:!1,loading:!1}},computed:{sketch:function(){return this.$store.state.sketch},currentUser:function(){return this.$store.state.currentUser}},methods:{saveConclusion:function(){var t=this;this.loading=!0,this.editable=!1,this.showControls=!1,_.editQuestionConclusion(this.sketch.id,this.question.id,this.conclusion.id,this.conclusionText).then((function(e){t.$store.dispatch("updateScenarios",t.sketch.id).then((function(){t.loading=!1}))})).catch((function(e){t.loading=!1,t.editable=!0,t.errorSnackBar(e),console.error(e)}))},editConclusion:function(){this.conclusionText=this.conclusion.conclusion,this.editable=!0},deleteConclusion:function(t){var e=this;this.loading=!0,confirm("Are you sure?")?_.deleteQuestionConclusion(this.sketch.id,this.question.id,this.conclusion.id).then((function(t){e.$store.dispatch("updateScenarios",e.sketch.id).then((function(){e.loading=!1}))})).catch((function(t){})):this.loading=!1}}},oi=ai,ci=Object(c["a"])(oi,si,ri,!1,null,"4c6d3a4c",null),li=ci.exports,ui={props:["question"],components:{TsSearchTemplate:ii,TsQuestionConclusion:li},data:function(){return{expanded:!1,fullDescription:!1,conclusionText:""}},computed:{sketch:function(){return this.$store.state.sketch},currentUser:function(){return this.$store.state.currentUser},currentUserConclusion:function(){var t=this;return this.question.conclusions.filter((function(e){return e.user.username===t.currentUser})).length}},methods:{createConclusion:function(){var t=this;_.createQuestionConclusion(this.sketch.id,this.question.id,this.conclusionText).then((function(e){t.conclusionText="",t.$store.dispatch("updateScenarios",t.sketch.id)})).catch((function(t){}))}},created:function(){}},di=ui,hi=(n("b035"),Object(c["a"])(di,Yn,Jn,!1,null,"11642c2c",null)),mi=hi.exports,vi={props:["scenario","facet"],components:{TsQuestion:mi},data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},questionsWithConclusion:function(){return this.facet.questions.filter((function(t){return t.conclusions.length}))},isActive:function(){return this.questionsWithConclusion.length>0&&this.questionsWithConclusion.length<this.facet.questions.length},isResolved:function(){return this.questionsWithConclusion.length===this.facet.questions.length},notStarted:function(){return 0===this.questionsWithConclusion.length}},methods:{toggleFacet:function(){this.expanded?null!=this.$store.state.activeContext.facet&&this.facet.id===this.$store.state.activeContext.facet.id&&this.$store.dispatch("clearActiveContext"):this.setActiveContext(),this.expanded=!this.expanded},setActiveContext:function(t){var e={scenario:this.scenario,facet:this.facet,question:t};this.$store.dispatch("setActiveContext",e)}},created:function(){}},pi=vi,fi=Object(c["a"])(pi,Un,Vn,!1,null,null,null),gi=fi.exports,_i={props:["scenario"],components:{TsFacet:gi},data:function(){return{activeQuestion:{},selectedItem:null,expanded:!1,renameDialog:!1,addScenarioDialog:!1,newName:this.scenario.display_name}},computed:{sketch:function(){return this.$store.state.sketch},activeQuestionSpec:function(){return JSON.parse(this.activeQuestion.spec_json)},is_hidden:function(){return!!this.scenario.status.length&&"hidden"===this.scenario.status[0].status}},methods:{renameScenario:function(){var t=this;this.renameDialog=!1,_.renameScenario(this.sketch.id,this.scenario.id,this.newName).then((function(e){t.$store.dispatch("updateScenarios",t.sketch.id)})).catch((function(t){}))},copyScenario:function(){var t=this,e="Copy of "+this.scenario.display_name;_.addScenario(this.sketch.id,"compromise_assessment",e).then((function(e){t.$store.dispatch("updateScenarios",t.sketch.id)})).catch((function(t){}))},setStatus:function(t){var e=this;_.setScenarioStatus(this.sketch.id,this.scenario.id,t).then((function(t){e.$store.dispatch("updateScenarios",e.sketch.id)})).catch((function(t){}))},setActiveQuestion:function(t){this.activeQuestion=t},resetActiveQuestion:function(){this.selectedItem=null,this.activeQuestion={}}}},yi=_i,bi=Object(c["a"])(yi,Gn,Bn,!1,null,"94f01a5c",null),ki=bi.exports,Si=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{flat:""}},[n("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){t.expanded=!t.expanded}}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-content-save-outline")]),t._v("Saved Searches\n    ")],1),n("span",{staticClass:"float-right mr-2"},[n("small",[n("strong",[t._v(t._s(t.meta.views.length))])])])]),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},t._l(t.meta.views,(function(e){return n("v-row",{key:e.name,staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[n("div",{staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(n){return t.setView(e)}}},[t._v(t._s(e.name))])])})),1)]),n("v-divider")],1)},wi=[],xi={props:[],data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{setView:function(t){ro.$emit("setActiveView",t)}},created:function(){}},Ci=xi,Ti=Object(c["a"])(Ci,Si,wi,!1,null,null,null),$i=Ti.exports,Ei=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{flat:""}},[n("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){t.expanded=!t.expanded}}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-database-outline")]),t._v(" Data Types\n    ")],1),n("span",{staticClass:"float-right mr-2"},[n("small",[n("strong",[t._v(t._s(t.dataTypes.length))])])])]),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},[t.dataTypes.length<=t.itemsPerPage?n("v-data-iterator",{attrs:{items:t.dataTypes,"hide-default-footer":""},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.items,(function(e){return n("v-row",{key:e.data_type,staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[n("div",{staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(n){return t.setQueryAndFilter(e.data_type)}}},[n("span",[t._v(t._s(e.data_type)+" ("),n("small",[n("strong",[t._v(t._s(t._f("compactNumber")(e.count)))])]),t._v(")")])])])}))}}],null,!1,2686482733)}):n("v-data-iterator",{attrs:{items:t.dataTypes,"items-per-page":t.itemsPerPage,search:t.search},on:{"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e}},scopedSlots:t._u([{key:"header",fn:function(){return[n("v-toolbar",{attrs:{flat:""}},[n("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for a data type.."},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]},proxy:!0},{key:"default",fn:function(e){return t._l(e.items,(function(e){return n("v-row",{key:e.data_type,staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[n("div",{staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(n){return t.setQueryAndFilter(e.data_type)}}},[n("span",[t._v(t._s(e.data_type)+" ("),n("small",[n("strong",[t._v(t._s(t._f("compactNumber")(e.count)))])]),t._v(")")])])])}))}}])})],1)]),n("v-divider")],1)},Fi=[],Pi=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},Ai={props:[],data:function(){return{expanded:!1,itemsPerPage:10,search:""}},computed:{sketch:function(){return this.$store.state.sketch},dataTypes:function(){return this.$store.state.dataTypes}},methods:{setQueryAndFilter:function(t){var e={doSearch:!0};e.queryString='data_type:"'+t+'"',e.queryFilter=Pi(),ro.$emit("setQueryAndFilter",e)}},created:function(){}},Oi=Ai,Di=(n("2b31"),Object(c["a"])(Oi,Ei,Fi,!1,null,"6f8c2e97",null)),Ni=Di.exports,Ii=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{flat:""}},[n("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){t.expanded=!t.expanded}}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-tag-multiple-outline")]),t._v(" Tags\n    ")],1),n("span",{staticClass:"float-right mr-2"},[n("small",[n("strong",[t._v(t._s(t.tags.length))])])])]),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded&&t.tags.length,expression:"expanded && tags.length"}]},[t._l(t.labels,(function(e){return n("v-row",{key:e.label,staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[n("div",{staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(n){return t.searchForLabel(e.label)}}},["__ts_star"===e.label?n("v-icon",{attrs:{left:"",small:"",color:"amber"}},[t._v("mdi-star")]):t._e(),"__ts_comment"===e.label?n("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-comment-multiple-outline")]):t._e(),n("span",[t._v(t._s(t._f("formatLabelText")(e.label))+" ("),n("small",[n("strong",[t._v(t._s(t._f("compactNumber")(e.count)))])]),t._v(")")])],1)])})),t._l(t.tags,(function(e){return n("v-row",{key:e.tag,staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[n("div",{staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(n){return t.searchForTag(e.tag)}}},[n("span",[t._v(t._s(e.tag)+" ("),n("small",[n("strong",[t._v(t._s(t._f("compactNumber")(e.count)))])]),t._v(")")])])])}))],2)]),n("v-divider")],1)},Ri=[],Li=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},ji={props:[],data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},tags:function(){return this.$store.state.tags},labels:function(){return this.meta.filter_labels}},methods:{searchForTag:function(t){var e={doSearch:!0};e.queryString='tag:"'+t+'"',e.queryFilter=Li(),ro.$emit("setQueryAndFilter",e)},searchForLabel:function(t){var e={doSearch:!0,queryString:"*"};e.queryFilter=Li();var n={field:"",value:t,type:"label",operator:"must",active:!0};e.queryFilter.chips.push(n),ro.$emit("setQueryAndFilter",e)}}},qi=ji,Qi=Object(c["a"])(qi,Ii,Ri,!1,null,null,null),Hi=Qi.exports,Mi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{flat:""}},[n("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){t.expanded=!t.expanded}}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-text-box-search-outline")]),t._v(" Search Templates\n    ")],1),n("span",{staticClass:"float-right mr-2"},[n("small",[n("strong",[t._v(t._s(t.searchtemplates.length))])])])]),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded&&t.searchtemplates.length,expression:"expanded && searchtemplates.length"}]},[n("v-data-iterator",{attrs:{items:t.searchtemplates,"items-per-page":t.itemsPerPage,search:t.search},on:{"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e}},scopedSlots:t._u([{key:"header",fn:function(){return[n("v-toolbar",{attrs:{flat:""}},[n("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for a template.."},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]},proxy:!0},{key:"default",fn:function(e){return t._l(e.items,(function(t){return n("ts-search-template",{key:t.id,attrs:{searchtemplate:t}})}))}}])})],1)]),n("v-divider")],1)},Wi=[],zi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-row",{staticClass:"pa-2",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[n("div",{staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(e){t.expanded=!t.expanded}}},[t.expanded?n("v-icon",[t._v("mdi-chevron-down")]):n("v-icon",[t._v("mdi-chevron-right")]),t._v("\n      "+t._s(t.searchtemplate.name)+"\n    ")],1),n("v-spacer")],1),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],staticClass:"pa-4 pt-0"},[n("div",{staticStyle:{"font-size":"0.9em"}},[n("v-simple-table",{attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[n("tbody",[n("tr",[n("td",[n("strong",[t._v("Author")])]),n("td",[t._v(t._s(t.searchTemplateSpec.author))])]),n("tr",[n("td",[n("strong",[t._v("Description")])]),n("td",[t._v(t._s(t.searchTemplateSpec.description))])]),n("tr",[n("td",[n("strong",[t._v("Date")])]),n("td",[t._v(t._s(t.searchTemplateSpec.date))])]),n("tr",[n("td",[n("strong",[t._v("ID")])]),n("td",[t._v(t._s(t.searchTemplateSpec.id))])]),t.searchTemplateSpec.references.length?n("tr",[n("td",[n("strong",[t._v("References")])]),n("td",t._l(t.searchTemplateSpec.references,(function(e){return n("div",{key:e},[n("a",{attrs:{href:e,target:"new"}},[t._v(t._s(e))])])})),0)]):t._e()])]},proxy:!0}])})],1),t.parameters.length?n("div",{staticClass:"pt-3"},[n("div",{staticClass:"mb-3"},[n("strong",{staticClass:"mb-3"},[t._v("Required input parameters")])]),t._l(t.parameters,(function(e){return n("div",{key:e.name,staticClass:"mb-4"},[n("v-text-field",{attrs:{hint:e.description,label:e.description,outlined:"",dense:"","hide-details":""},model:{value:t.params[e.name],callback:function(n){t.$set(t.params,e.name,n)},expression:"params[parameter.name]"}})],1)})),n("v-card-actions",{staticClass:"pl-0 mt-n3"},[n("v-btn",{attrs:{small:"",depressed:"",color:"primary",disabled:!t.filledOut},on:{click:function(e){return t.parseQueryAndSearch()}}},[t._v("\n            Search\n          ")])],1)],2):n("div",{staticClass:"mt-3"},[n("v-btn",{attrs:{small:"",depressed:"",color:"primary",disabled:!t.filledOut},on:{click:function(e){return t.search(t.searchtemplate.query_string)}}},[t._v("Search")])],1)])]),n("v-divider")],1)},Gi=[],Bi=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},Ui={props:["searchtemplate"],data:function(){return{expanded:!1,params:{}}},computed:{sketch:function(){return this.$store.state.sketch},parameters:function(){return JSON.parse(this.searchtemplate.template_json).parameters},filledOut:function(){return Object.keys(this.params).length===this.parameters.length},searchTemplateSpec:function(){return JSON.parse(this.searchtemplate.template_json)}},methods:{search:function(t){var e={doSearch:!0};e.queryString=t,e.queryFilter=Bi(),ro.$emit("setQueryAndFilter",e)},parseQueryAndSearch:function(){var t,e=this;_.parseSearchTemplate(this.searchtemplate.id,this.params).then((function(n){t=n.data.objects[0].query_string,e.search(t)})).catch((function(t){}))}}},Vi=Ui,Yi=Object(c["a"])(Vi,zi,Gi,!1,null,"6bfe3bbd",null),Ji=Yi.exports,Xi={props:[],components:{TsSearchTemplate:Ji},data:function(){return{searchtemplates:[],expanded:!1,itemsPerPage:10,search:""}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},created:function(){var t=this;_.getSearchTemplates().then((function(e){t.searchtemplates=e.data.objects[0],"undefined"===typeof t.searchtemplates&&(t.searchtemplates=[])})).catch((function(t){}))}},Ki=Xi,Zi=(n("1890"),Object(c["a"])(Ki,Mi,Wi,!1,null,"44cfccf4",null)),ts=Zi.exports,es=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",style:t.sigmaRules&&t.sigmaRules.length?"cursor: pointer":"",attrs:{"no-gutters":"",flat:""},on:{click:function(e){t.expanded=!t.expanded}}},[n("span",[n("v-icon",{attrs:{left:""}},[t._v("mdi-sigma-lower")]),t._v(" Sigma Rules ")],1),t.expanded||t.sigmaRules&&!t.sigmaRules.length?n("v-btn",{staticClass:"ml-1",attrs:{small:"",color:"primary",text:"",to:{name:"Studio",params:{id:"new",type:"sigma"}}},on:{click:function(t){t.stopPropagation()}}},[n("v-icon",{attrs:{small:"",left:""}},[t._v("mdi-plus")]),t._v("New Rule\n    ")],1):t._e(),n("span",{staticClass:"float-right mr-2"},[t.isLoading?n("v-progress-circular",{attrs:{size:12,width:1,indeterminate:""}}):n("small",[n("strong",[t._v(t._s(t.ruleCount))])])],1)],1),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},[t.sigmaRules&&t.sigmaRules.length?n("div",[t.ruleCount<=t.itemsPerPage?n("v-data-iterator",{attrs:{items:t.sigmaRules,"hide-default-footer":""},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.items,(function(t){return n("ts-sigma-rule",{key:t.rule_uuid,attrs:{"sigma-rule":t}})}))}}],null,!1,2506010555)}):n("v-data-iterator",{attrs:{items:t.sigmaRules,"items-per-page":t.itemsPerPage,search:t.search},on:{"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e}},scopedSlots:t._u([{key:"header",fn:function(){return[n("v-toolbar",{attrs:{flat:""}},[n("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for a rule.."},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]},proxy:!0},{key:"default",fn:function(e){return t._l(e.items,(function(t){return n("ts-sigma-rule",{key:t.rule_uuid,attrs:{"sigma-rule":t}})}))}}],null,!1,1881113905)})],1):t._e()])]),n("v-divider")],1)},ns=[],is=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-row",{staticClass:"pa-2 pr-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer","font-size":"0.9em"},attrs:{"no-gutters":""},on:{click:function(e){t.expanded=!t.expanded}}},[n("v-col",{attrs:{cols:"11"}},[t.expanded?n("v-icon",[t._v("mdi-chevron-down")]):n("v-icon",[t._v("mdi-chevron-right")]),t._v("\n      "+t._s(t.sigmaRule.title)),n("v-chip",{staticClass:"ml-2",attrs:{rounded:"","x-small":""}},[t._v(t._s(t.sigmaRule.status))])],1),n("v-col",{attrs:{cols:"1"}},[n("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-btn",t._g(t._b({attrs:{small:"",icon:""}},"v-btn",s,!1),i),[n("v-icon",[t._v("mdi-dots-vertical")])],1)]}}])},[n("v-card",[n("v-list",{attrs:{dense:""}},[n("v-list-item-group",[n("v-list-item",{attrs:{to:{name:"Studio",params:{type:"sigma",id:t.sigmaRule.rule_uuid}}}},[n("v-list-item-icon",[n("v-icon",{attrs:{small:""}},[t._v("mdi-pencil")])],1),n("v-list-item-title",[t._v("Edit Rule")])],1),n("v-list-item",{on:{click:function(e){return t.downloadSigmaRule(t.sigmaRule.rule_uuid)}}},[n("v-list-item-icon",[n("v-icon",{attrs:{small:""}},[t._v("mdi-download")])],1),n("v-list-item-title",[t._v("Download Rule")])],1),n("v-list-item",{on:{click:function(e){return t.deprecateSigmaRule(t.sigmaRule.rule_uuid)}}},[n("v-list-item-icon",[n("v-icon",{attrs:{small:""}},[t._v("mdi-flash-off-outline")])],1),n("v-list-item-title",[t._v("Disable from analyzer")])],1),n("v-list-item",{on:{click:function(e){return t.deleteRule(t.sigmaRule.rule_uuid)}}},[n("v-list-item-icon",[n("v-icon",{attrs:{small:""}},[t._v("mdi-delete")])],1),n("v-list-item-title",[t._v("Delete Rule")])],1)],1)],1)],1)],1)],1)],1),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],staticClass:"pa-4 pt-0"},[n("div",{staticClass:"mt-2"},[n("v-simple-table",{attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[n("tbody",t._l(t.sigmaRuleSummary,(function(e,i){return n("tr",{key:i},[n("td",[n("strong",[t._v(t._s(i))])]),n("td",["references"===i?n("span",t._l(e,(function(e){return n("div",{key:e},[n("a",{attrs:{href:e,target:"new"}},[t._v(t._s(e))])])})),0):"falsepositives"===i?n("span",t._l(e,(function(e){return n("v-chip",{key:e,staticClass:"mr-2",attrs:{rounded:"","x-small":""}},[t._v(t._s(e))])})),1):"tags"===i&&e?n("span",t._l(e,(function(e){return n("v-chip",{key:e,staticClass:"mr-2",attrs:{rounded:"","x-small":""}},[t._v(t._s(e))])})),1):n("span",[t._v("\n                    "+t._s(e)+"\n                  ")])])])})),0)]},proxy:!0}])})],1),n("div",{staticClass:"mt-3"},[void 0!==t.sketch.id?n("v-btn",{attrs:{small:"",depressed:"",color:"primary"},on:{click:function(e){return t.search(t.sigmaRule.search_query)}}},[t._v("Search")]):t._e()],1)])]),n("v-divider")],1)},ss=[],rs=n("768b"),as=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},os={components:{},props:["sigmaRule"],data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},sigmaRuleSummary:function(){var t=["author","description","references","status","date","modified","falsepositives","level","tags","rule_uuid","search_query"];return Object.fromEntries(Object.entries(this.sigmaRule).filter((function(e){var n=Object(rs["a"])(e,1),i=n[0];return t.includes(i)})))}},methods:{search:function(t){var e={doSearch:!0};e.queryString=t,e.queryFilter=as(),ro.$emit("setQueryAndFilter",e)},deleteRule:function(t){var e=this;confirm("Delete Rule?")&&_.deleteSigmaRule(t).then((function(t){e.$store.dispatch("updateSigmaList"),e.$router.push({name:"Studio",params:{id:"new",type:"sigma"}})})).catch((function(t){console.error(t)}))},deprecateSigmaRule:function(t){var e=this;confirm("Deprecate Rule?")&&_.getSigmaRuleResource(t).then((function(n){var i=n.data.objects[0],s=/status:\s*(experimental|testing|stable)/g,r=i.rule_yaml.replace(s,"status: deprecated");_.updateSigmaRule(t,r).then((function(){e.$store.dispatch("updateSigmaList"),ro.$emit("errorSnackBar","Rule deprecated: "+t)})).catch((function(t){console.error(t)}))})).catch((function(t){console.error(t)}))},downloadSigmaRule:function(t){_.getSigmaRuleResource(t).then((function(t){var e=t.data.objects[0],n=new Blob([e.rule_yaml],{type:"text/plain"}),i=document.createElement("a");i.href=window.URL.createObjectURL(n),i.download=e.title+".yml",i.click()})).catch((function(t){console.error(t)}))}}},cs=os,ls=(n("2736"),Object(c["a"])(cs,is,ss,!1,null,"72e044b8",null)),us=ls.exports,ds={props:{startExpanded:Boolean},components:{TsSigmaRule:us},data:function(){return{expanded:this.startExpanded,itemsPerPage:10,search:""}},methods:{},computed:{sigmaRules:function(){return this.$store.state.sigmaRuleList},ruleCount:function(){return this.$store.state.sigmaRuleList?this.$store.state.sigmaRuleList.length:0},sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},isLoading:function(){return!this.sigmaRules}},mounted:function(){this.$store.dispatch("updateSigmaList")}},hs=ds,ms=(n("808c"),Object(c["a"])(hs,es,ns,!1,null,"3ebf0597",null)),vs=ms.exports,ps=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer"},attrs:{"no-gutters":"",flat:""},on:{click:function(e){t.expanded=!t.expanded}}},[n("span",[n("v-icon",{attrs:{left:""}},[t._v("mdi-shield-search")]),t._v(" Threat Intelligence\n    ")],1),t.expanded?n("v-btn",{staticClass:"ml-1",attrs:{small:"",color:"primary",text:"",to:{name:"Intelligence",params:{sketchId:t.sketch.id}}},on:{click:function(t){t.stopPropagation()}}},[n("v-icon",{attrs:{small:"",left:""}},[t._v("mdi-pencil")]),t._v("Manage\n    ")],1):t._e(),n("span",{staticClass:"float-right mr-2"},[n("small",[n("strong",[t._v(t._s(t.intelligenceData.length))])])])],1),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},[n("v-divider"),n("v-tabs",{attrs:{grow:""},model:{value:t.tabs,callback:function(e){t.tabs=e},expression:"tabs"}},[n("v-tab",[t._v("\n          Indicators ("),n("small",[t._v(" "+t._s(t.intelligenceData.length)+" ")]),t._v(")\n        ")]),n("v-tab",[t._v("\n          Tags ("),n("small",[t._v(t._s(Object.keys(t.tagInfo).length)+" ")]),t._v(")\n        ")])],1),n("v-tabs-items",{model:{value:t.tabs,callback:function(e){t.tabs=e},expression:"tabs"}},[n("v-tab-item",{attrs:{transition:!1}},[t.intelligenceData.length>=10?n("v-data-table",{attrs:{dense:"",headers:t.indicatorHeaders,items:t.intelligenceData,"items-per-page":10},scopedSlots:t._u([{key:"item.ioc",fn:function(e){var i=e.item;return[n("span",{attrs:{title:i.ioc}},[n("div",{staticStyle:{"max-width":"200px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[t._v("\n                  "+t._s(i.ioc)+"\n                ")])])]}},{key:"item.type",fn:function(e){var i=e.item;return[n("small",[t._v(t._s(i.type))])]}},{key:"item.actions",fn:function(e){var i=e.item;return[n("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.generateSearchQuery(i.ioc)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-magnify")])],1)]}}],null,!1,643218530)}):n("v-data-table",{attrs:{dense:"",headers:t.indicatorHeaders,items:t.intelligenceData,"hide-default-footer":""},scopedSlots:t._u([{key:"item.ioc",fn:function(e){var i=e.item;return[n("span",{attrs:{title:i.ioc}},[n("div",{staticStyle:{"max-width":"200px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[t._v("\n                  "+t._s(i.ioc)+"\n                ")])])]}},{key:"item.type",fn:function(e){var i=e.item;return[n("small",[t._v(t._s(i.type))])]}},{key:"item.actions",fn:function(e){var i=e.item;return[n("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.generateSearchQuery(i.ioc)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-magnify")])],1)]}}])})],1),n("v-tab-item",{attrs:{transition:!1}},[n("v-data-table",{attrs:{dense:"",headers:t.tagHeaders,items:Object.values(t.tagInfo),"items-per-page":10},scopedSlots:t._u([{key:"item.tag",fn:function(e){var i=e.item;return[n("v-chip",{attrs:{"x-small":""},on:{click:function(e){return t.searchForIOC(i)}}},[t._v(t._s(i.tag.name))])]}},{key:"item.iocs",fn:function(e){var i=e.item;return[n("small",{attrs:{title:i.iocs}},[t._v(t._s(i.iocs.length))])]}},{key:"item.weight",fn:function(e){var i=e.item;return[n("small",[t._v(t._s(i.tag.weight))])]}},{key:"item.actions",fn:function(e){var i=e.item;return[n("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.searchForIOC(i)}}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-magnify")])],1)]}}])})],1)],1)],1)]),n("v-divider")],1)},fs=[];n("4917");function gs(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_s(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw r}}}}function _s(t,e){if(t){if("string"===typeof t)return ys(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ys(t,e):void 0}}function ys(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var bs=function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}},ks={props:[],data:function(){return{expanded:!1,tagInfo:{},tagMetadata:{},tabs:null,indicatorHeaders:[{text:"Indicator",value:"ioc",align:"start"},{text:"Type",value:"type"},{value:"actions"}],tagHeaders:[{text:"Tag",value:"tag",align:"start"},{text:"Indicators",value:"iocs"},{text:"Weight",value:"weight"},{value:"actions"}]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},intelligenceAttribute:function(){return void 0===this.meta.attributes.intelligence?{ontology:"intelligence",value:{data:[]},name:"intelligence"}:this.meta.attributes.intelligence},intelligenceData:function(){return this.intelligenceAttribute.value.data}},methods:{loadSketchAttributes:function(){var t=this;_.getTagMetadata().then((function(e){t.tagMetadata=e.data,t.buildTagInfo()}))},buildTagInfo:function(){this.tagInfo={};var t,e=gs(this.intelligenceData);try{for(e.s();!(t=e.n()).done;){var n,i=t.value,s=gs(i.tags);try{for(s.s();!(n=s.n()).done;){var r=n.value,a=null;a="object"===Object(R["a"])(r)?r.name:r,this.tagInfo[a]||(this.tagInfo[a]={count:0,iocs:[],tag:this.enrichTag(r)}),this.tagInfo[a].count++,this.tagInfo[a].iocs.push(i.ioc)}}catch(o){s.e(o)}finally{s.f()}}}catch(o){e.e(o)}finally{e.f()}},enrichTag:function(t){if("object"===Object(R["a"])(t))return t;var e={name:t};if(this.tagMetadata[t])return mt.a.extend(e,this.tagMetadata[t]);for(var n in this.tagMetadata["regexes"])if(t.match(n))return mt.a.extend(e,this.tagMetadata["regexes"][n]);return mt.a.extend(e,this.tagMetadata.default)},generateSearchQuery:function(t,e){var n='"'.concat(t,'"');n=n.replace(/[\\\s]/g,"\\$&"),void 0!==e&&(n="".concat(e,":").concat(n));var i={doSearch:!0};i.queryString=n,i.queryFilter=bs(),ro.$emit("setQueryAndFilter",i)},searchForIOC:function(t){var e=t.iocs.map((function(t){return'"'.concat(t,'"')})).reduce((function(t,e){return"".concat(t," OR ").concat(e)})),n={doSearch:!0};n.queryString=e,n.queryFilter=bs(),ro.$emit("setQueryAndFilter",n)}},mounted:function(){this.loadSketchAttributes()}},Ss=ks,ws=Object(c["a"])(Ss,ps,fs,!1,null,null,null),xs=ws.exports,Cs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-row",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer"},attrs:{"no-gutters":"",flat:""},on:{click:function(e){t.expanded=!t.expanded}}},[n("span",[n("v-icon",{attrs:{left:""}},[t._v("mdi-source-branch")]),t._v(" Graphs ")],1),n("v-spacer"),n("span",{staticClass:"mr-2"},[n("small",[n("strong",[t._v(t._s(t.graphs.length+t.savedGraphs.length))])])])],1),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},[t._l(t.savedGraphs,(function(e){return n("router-link",{key:e.id,staticStyle:{cursor:"pointer","font-size":"0.9em","text-decoration":"none"},attrs:{to:{name:"Graph",query:{graph:e.id}}}},[n("v-row",{staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""},on:{click:function(n){return t.setSavedGraph(e.id)}}},[n("span",{class:t.$vuetify.theme.dark?"dark-font":"light-font"},[t._v(t._s(e.name))])])],1)})),t._l(t.graphs,(function(e){return n("router-link",{key:e.name,staticStyle:{cursor:"pointer","font-size":"0.9em","text-decoration":"none"},attrs:{to:{name:"Graph",query:{plugin:e.name}}}},[n("v-row",{staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""},on:{click:function(n){return t.setGraphPlugin(e)}}},[n("span",{class:t.$vuetify.theme.dark?"dark-font":"light-font"},[t._v(t._s(e.display_name))])])],1)}))],2)]),n("v-divider")],1)},Ts=[],$s={props:[],data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},graphs:function(){return this.$store.state.graphPlugins},savedGraphs:function(){return this.$store.state.savedGraphs}},methods:{setGraphPlugin:function(t){ro.$emit("setGraphPlugin",t)},setSavedGraph:function(t){ro.$emit("setSavedGraph",t)}}},Es=$s,Fs=Object(c["a"])(Es,Cs,Ts,!1,null,null,null),Ps=Fs.exports,As=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-row",{staticClass:"pa-4",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",style:t.meta.stories&&t.meta.stories.length?"cursor: pointer":"",attrs:{"no-gutters":"",flat:""},on:{click:function(e){t.expanded=!t.expanded}}},[n("span",[n("v-icon",{attrs:{left:""}},[t._v("mdi-book-open-outline")]),t._v(" Stories ")],1),t.expanded||!t.meta.stories.length?n("v-btn",{staticClass:"ml-1",attrs:{small:"",color:"primary",text:""},on:{click:[function(e){return t.createStory()},function(t){t.stopPropagation()}]}},[n("v-icon",{attrs:{small:"",left:""}},[t._v("mdi-plus")]),t._v("New Story\n    ")],1):t._e(),n("v-spacer"),n("span",{staticClass:"mr-2"},[n("small",[n("strong",[t._v(t._s(t.meta.stories.length))])])])],1),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded&&t.meta.stories.length,expression:"expanded && meta.stories.length"}]},t._l(t.meta.stories,(function(e){return n("router-link",{key:e.id,staticStyle:{cursor:"pointer","font-size":"0.9em","text-decoration":"none"},attrs:{to:{name:"Story",params:{storyId:e.id}}}},[n("v-row",{staticClass:"pa-2 pl-5",class:t.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[n("span",{class:t.$vuetify.theme.dark?"dark-font":"light-font"},[t._v(t._s(e.title))])])],1)})),1)]),n("v-divider")],1)},Os=[],Ds={props:[],data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},methods:{createStory:function(){var t=this,e="Untitled story",n="";_.createStory(e,n,this.sketch.id).then((function(e){var n=e.data.objects[0].id;t.$router.push({name:"Story",params:{storyId:n}}),t.$store.dispatch("updateSketch",t.sketch.id)})).catch((function(t){}))}}},Ns=Ds,Is=Object(c["a"])(Ns,As,Os,!1,null,null,null),Rs=Is.exports,Ls=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{attrs:{loading:t.isLoading}},[n("div",{staticClass:"pa-4"},[n("h3",[t._v('Share "'+t._s(t.sketch.name)+'"')]),n("br"),n("v-autocomplete",{attrs:{items:t.usersAndGroups,outlined:"","single-line":"",chips:"","small-chips":"","hide-details":"",multiple:"","return-object":"","deletable-chips":"",label:"Add people and groups"},model:{value:t.usersAndGroupsToAdd,callback:function(e){t.usersAndGroupsToAdd=e},expression:"usersAndGroupsToAdd"}}),n("br"),t._v("\n    People with access\n    "),n("v-list",[n("v-list-item",[n("v-list-item-avatar",[n("v-avatar",{attrs:{color:"grey lighten-1",size:"32"}},[n("span",{staticClass:"white--text"},[t._v(t._s(t._f("initialLetter")(t.sketch.user.username)))])])],1),n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:t._s(t.sketch.user.username)}})],1),n("v-spacer"),n("small",[t._v("Owner")])],1),t._l(t.meta.collaborators.users,(function(e){return n("v-list-item",{key:e},[n("v-list-item-avatar",[n("v-avatar",{attrs:{color:"grey lighten-1",size:"32"}},[n("span",{staticClass:"white--text"},[t._v(t._s(t._f("initialLetter")(e)))])])],1),n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:t._s(e)}})],1),n("v-spacer"),n("v-icon",{on:{click:function(n){return t.revokeAccess(e,"")}}},[t._v("mdi-trash-can-outline")])],1)})),t._l(t.meta.collaborators.groups,(function(e){return n("v-list-item",{key:e},[n("v-list-item-avatar",[n("v-icon",[t._v("mdi-account-group-outline")])],1),n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:t._s(e)}})],1),n("v-spacer"),n("v-icon",{on:{click:function(n){return t.revokeAccess("",e)}}},[t._v("mdi-trash-can-outline")])],1)}))],2),n("br"),t._v("\n    General access\n    "),n("v-select",{staticStyle:{width:"150px"},attrs:{"hide-details":"","single-line":"",items:t.items,label:t.generalAccess,"prepend-icon":t.accessIcon},on:{change:function(e){return t.setPublicAccess()}},model:{value:t.isPublic,callback:function(e){t.isPublic=e},expression:"isPublic"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(e){return t.$emit("close-dialog")}}},[t._v("Cancel")]),n("v-btn",{attrs:{color:"primary",depressed:""},on:{click:function(e){return t.grantAccess()}}},[t._v("Done")])],1)],1)])},js=[],qs={data:function(){return{items:[{text:"Public",value:!0},{text:"Restricted",value:!1}],usersAndGroupsToAdd:[],usersToRemove:[],groupsToRemove:[],systemUsers:[],systemGroups:[],isPublic:!1,isLoading:!1}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},generalAccess:function(){return this.isPublic?"Public":"Restricted"},accessIcon:function(){return this.isPublic?"mdi-earth":"mdi-lock-outline"},usersAndGroups:function(){return this.systemUsers.concat(this.systemGroups)}},methods:{grantAccess:function(){var t=this;if(this.usersAndGroupsToAdd.length){this.isLoading=!0;var e=this.usersAndGroupsToAdd.filter((function(t){return"user"===t.type})).map((function(t){return t.value})),n=this.usersAndGroupsToAdd.filter((function(t){return"group"===t.type})).map((function(t){return t.value}));_.grantSketchAccess(this.sketch.id,e,n).then((function(e){t.$store.dispatch("updateSketch",t.sketch.id).then((function(){t.isLoading=!1,t.usersAndGroupsToAdd=[],t.$emit("close-dialog"),t.successSnackBar("Updated sharing")}))})).catch((function(e){t.errorSnackBar("Failed to share sketch "+e)}))}else this.$emit("close-dialog")},revokeAccess:function(t,e){var n=this;this.isLoading=!0;var i=[t],s=[e];_.revokeSketchAccess(this.sketch.id,i,s).then((function(t){n.$store.dispatch("updateSketch",n.sketch.id).then((function(){n.isLoading=!1}))})).catch((function(t){n.errorSnackBar("Failed to remove access "+t)}))},setPublicAccess:function(){var t=this;this.isLoading=!0,_.setSketchPublicAccess(this.sketch.id,this.isPublic).then((function(e){t.$store.dispatch("updateSketch",t.sketch.id).then((function(){t.isLoading=!1}))})).catch((function(e){t.errorSnackBar("Failed to share sketch "+e)}))}},mounted:function(){var t=this;this.isPublic=this.meta.permissions.public,_.getUsers().then((function(e){e.data.objects[0].forEach((function(e){var n={text:e.username,value:e.username,type:"user",disabled:!1};t.systemUsers.push(n)}))})).catch((function(t){})),_.getGroups().then((function(e){e.data.objects[0].forEach((function(e){var n={text:e.name,value:e.name,type:"group",disabled:!1};t.systemGroups.push(n)}))})).catch((function(t){}))}},Qs=qs,Hs=(n("bd11"),Object(c["a"])(Qs,Ls,js,!1,null,null,null)),Ms=Hs.exports,Ws=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h3",[t._v("Rename sketch")]),n("br"),n("v-text-field",{attrs:{outlined:"",dense:"",autofocus:""},on:{focus:function(t){return t.target.select()}},model:{value:t.newSketchName,callback:function(e){t.newSketchName=e},expression:"newSketchName"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){return t.closeDialog()}}},[t._v(" Cancel ")]),n("v-btn",{attrs:{color:"primary",depressed:""},on:{click:function(e){return t.renameSketch()}}},[t._v(" Save ")])],1)],1)},zs=[],Gs={data:function(){return{newSketchName:""}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{renameSketch:function(){var t=this;_.saveSketchSummary(this.sketch.id,this.newSketchName,"").then((function(e){t.$store.dispatch("updateSketch",t.sketch.id).then((function(){}))})).catch((function(t){console.error(t)})),this.$emit("close")},closeDialog:function(){this.newSketchName=this.sketch.name,this.$emit("close")}},created:function(){this.newSketchName=this.sketch.name}},Bs=Gs,Us=Object(c["a"])(Bs,Ws,zs,!1,null,"c56fe12a",null),Vs=Us.exports,Ys={props:["sketchId"],components:{TsScenario:ki,TsSavedSearches:$i,TsDataTypes:Ni,TsTags:Hi,TsSearchTemplates:ts,TsSigmaRules:vs,TsUploadTimelineForm:Lt,TsShareCard:Ms,TsRenameSketch:Vs,TsIntelligence:xs,TsGraphs:Ps,TsStories:Rs},data:function(){return{showSketchMetadata:!1,navigationDrawer:{width:400},selectedScenario:null,scenarioDialog:!1,showLeftPanel:!1,leftPanelTab:0,leftPanelTabItems:["Explore","Investigate"],renameSketchDialog:!1,showHidden:!1,shareDialog:!1,loadingSketch:!1}},mounted:function(){var t=this;this.loadingSketch=!0,this.showLeftPanel=!1,this.$store.dispatch("updateSketch",this.sketchId).then((function(){t.$store.dispatch("updateSearchHistory",t.sketchId),t.$store.dispatch("updateScenarios",t.sketchId),t.$store.dispatch("updateScenarioTemplates",t.sketchId),t.$store.dispatch("updateSavedGraphs",t.sketchId),t.$store.dispatch("updateGraphPlugins"),t.$store.dispatch("updateContextLinks"),t.loadingSketch=!1,t.showLeftPanel=!0,t.$nextTick((function(){this.setDrawerBorderStyle(),this.setDrawerResizeEvents()}))}))},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},scenarios:function(){return this.$store.state.scenarios},scenarioTemplates:function(){return this.$store.state.scenarioTemplates},currentUser:function(){return this.$store.state.currentUser},activeScenarios:function(){return this.scenarios?this.scenarios.filter((function(t){return!t.status.length||"active"===t.status[0].status})):[]},hiddenScenarios:function(){return this.scenarios?this.scenarios.filter((function(t){return t.status.length&&"hidden"===t.status[0].status})):[]},hasTimelines:function(){return this.sketch.timelines&&this.sketch.timelines.length},currentRouteName:function(){return this.$route.name}},methods:{toggleTheme:function(){this.$vuetify.theme.dark=!this.$vuetify.theme.dark,localStorage.setItem("isDarkTheme",this.$vuetify.theme.dark.toString());var t=document.body;t.dataset.theme=this.$vuetify.theme.dark?"dark":"light"},switchUI:function(){window.location.href=window.location.href.replace("/v2/","/")},addScenario:function(t){var e=this;this.scenarioDialog=!1,_.addScenario(this.sketch.id,t).then((function(t){e.$store.dispatch("updateScenarios",e.sketch.id)})).catch((function(t){}))},setDrawerBorderStyle:function(){var t=this.$refs.drawer.$el.querySelector(".v-navigation-drawer__border");t.style.cursor="ew-resize"},setDrawerResizeEvents:function(){var t=this,e=1,n=this.$refs.drawer.$el,i=n.querySelector(".v-navigation-drawer__border"),s=n.classList.contains("v-navigation-drawer--right")?"right":"left";function r(t){document.body.style.cursor="ew-resize";var e="right"===s?document.body.scrollWidth-t.clientX:t.clientX;n.style.width=e+"px"}i.addEventListener("mousedown",(function(t){t.offsetX<e&&(n.style.transition="initial",document.addEventListener("mousemove",r,!1))}),!1),document.addEventListener("mouseup",(function(){n.style.transition="",t.navigationDrawer.width=n.style.width,document.body.style.cursor="",document.removeEventListener("mousemove",r,!1)}),!1)},toggleLeftPanel:function(){this.showLeftPanel=!this.showLeftPanel,this.showLeftPanel?this.navigationDrawer.width=400:this.navigationDrawer.width=0}},watch:{sketch:function(t){"archived"===t.status[0].status&&this.$router.push({name:"Overview",params:{sketchId:this.sketch.id}}),document.title=this.sketch.name}}},Js=Ys,Xs=Object(c["a"])(Js,Wn,zn,!1,null,null,null),Ks=Xs.exports,Zs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-navigation-drawer",{ref:"drawer",attrs:{app:"",permanent:"",width:"370","hide-overlay":""}},[n("v-toolbar",{attrs:{flat:"",color:"transparent"}},[n("v-avatar",{staticClass:"ml-n1"},[n("router-link",{attrs:{to:"/"}},[n("v-img",{attrs:{src:"/dist/timesketch-color.png","max-height":"25","max-width":"25",contain:""}})],1)],1),n("span",{staticStyle:{"font-size":"1.1em"}},[t._v("Studio")]),n("v-spacer")],1),n("v-divider"),n("ts-sigma-rules",{attrs:{"start-expanded":""}})],1),n("v-toolbar",{attrs:{flat:"",color:"transparent"}},[n("v-spacer"),n("v-avatar",{staticClass:"ml-3",attrs:{color:"grey lighten-1",size:"25"}},[n("span",{staticClass:"white--text"},[t._v(t._s(t._f("initialLetter")(t.currentUser)))])]),n("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-avatar",[n("v-btn",t._g(t._b({attrs:{small:"",icon:""}},"v-btn",s,!1),i),[n("v-icon",[t._v("mdi-dots-vertical")])],1)],1)]}}])},[n("v-card",[n("v-list",[n("v-list-item-group",{attrs:{color:"primary"}},[n("v-list-item",{on:{click:t.toggleTheme}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-brightness-6")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Toggle theme")])],1)],1),n("a",{staticStyle:{"text-decoration":"none",color:"inherit"},attrs:{href:"/logout/"}},[n("v-list-item",[n("v-list-item-icon",[n("v-icon",[t._v("mdi-logout")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Logout")])],1)],1)],1)],1)],1)],1)],1)],1),"sigma"===t.type?n("ts-sigma-rule-modification",{attrs:{app:"",rule_uuid:t.id},on:{cancel:function(e){t.formatXMLString=!1}}}):t._e()],1)},tr=[],er=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("div",{staticStyle:{"margin-bottom":"20px","margin-top":"-55px"}},[n("strong",[t._v("\n      "+t._s(t.editingRule.title)+"\n      "),n("v-chip",{staticClass:"ml-2",attrs:{rounded:"","x-small":"",color:this.isParsingSuccesful?"success":"error"}},[t.isParsingSuccesful?n("v-icon",{attrs:{"x-small":"",left:""}},[t._v(" mdi-check ")]):n("v-icon",{attrs:{"x-small":"",left:""}},[t._v(" mdi-alert ")]),t._v("\n        "+t._s(t.isParsingSuccesful?"OK":"ERROR"))],1)],1)]),n("div",{staticStyle:{width:"250px"}},[n("v-autocomplete",{attrs:{align:"left",dense:"",outlined:"",items:t.SigmaTemplates,"item-text":"title",label:"Choose template"},on:{change:t.selectTemplate}})],1),t.isParsingSuccesful?t._e():n("div",{staticClass:"alertbox"},[n("v-alert",{attrs:{dense:"",type:"error",outlined:""}},[t._v("\n      "+t._s(t.status_text)+"\n    ")])],1),n("v-textarea",{staticClass:"editSigmaRule",attrs:{label:"Edit Sigma rule",outlined:"",color:this.isParsingSuccesful?"success":"error",autocomplete:"email",rows:"23","hide-details":""},on:{input:function(e){return t.parseSigma(t.ruleYamlTextArea)}},model:{value:t.ruleYamlTextArea,callback:function(e){t.ruleYamlTextArea=e},expression:"ruleYamlTextArea"}}),n("div",{staticClass:"mt-2"},[n("v-btn",{attrs:{disabled:!t.isParsingSuccesful,small:"",depressed:"",color:"primary"},on:{click:function(e){return t.addOrUpdateRule(t.ruleYamlTextArea)}}},[t._v("\n      "+t._s(t.isNewRule?"Create Rule":"Update Rule")+"\n    ")]),n("v-btn",{staticStyle:{"margin-left":"10px"},attrs:{color:"primary",text:""},on:{click:function(e){return t.$router.back()}}},[t._v(" Cancel ")]),n("v-btn",{directives:[{name:"show",rawName:"v-show",value:!t.isNewRule,expression:"!isNewRule"}],attrs:{small:"",text:"",color:"error darken-2"},on:{click:function(e){return t.deleteRule(t.rule_uuid)}}},[n("v-icon",[t._v("mdi-delete")])],1)],1),t.isParsingSuccesful?n("div",{staticClass:"mt-5"},[n("strong",[t._v("Preview opensearch query:")]),n("pre",[t._v(t._s(t.editingRule.search_query))])]):t._e()],1)},nr=[];try{var ir=crypto.randomUUID()}catch(ao){console.log("crypto.randomUUID() not supported, using a fixed value instead"),ir="10a4fb8c-29d5-4eb6-905f-13d6a553d470"}var sr="title: SigmaRuleTemplateTitle\nid: ".concat(ir,"\ndescription: Detects suspicious activity\nreferences:\n  - https://\nauthor: Timesketch\ndate: ").concat(new Date(Date.now()).toLocaleString("en-ZA").split(",")[0],"\nmodified: ").concat(new Date(Date.now()).toLocaleString("en-ZA").split(",")[0],"\nstatus: experimental\nfalsepositives: unknown\nlevel: informational\ntags:\n    - attack.defense_evasion"),rr="falsepositives:\n    - Unknown\nstatus: experimental\nlevel: medium\ndetection:\n    keywords:\n        - '*foobar*'\n    condition: keywords",ar="".concat(sr,"\nlogsource:\n    product: aws\n    service: cloudtrail\n").concat(rr,"\n"),or="".concat(sr,"\nlogsource:\n    product: azure\n    service: activitylogs\n").concat(rr,"\n"),cr="".concat(sr,"\nlogsource:\n    product: azure\n    service: signinlogs\n").concat(rr,"\n"),lr="".concat(sr,"\nlogsource:\n    product: gcp\n    service: gcp.audit\n").concat(rr,"\n"),ur="".concat(sr,"\nlogsource:\n    product: google_workspace\n    service: google_workspace.admin\n").concat(rr,"\n"),dr="".concat(sr,"\nlogsource:\n    product: m365\n    service: threat_management\n").concat(rr,"\n"),hr="".concat(sr,"\nlogsource:\n    product: okta\n    service: okta\n").concat(rr,"\n"),mr="".concat(sr,"\nlogsource:\n    category: file_create\n    product: linux\n").concat(rr,"\n"),vr="".concat(sr,"\nlogsource:\n    category: network_connection\n    product: linux\n").concat(rr,"\n"),pr="".concat(sr,"\nlogsource:\n    category: process_creation\n    product: linux\n").concat(rr,"\n"),fr="".concat(sr,"\nlogsource:\n    product: linux\n").concat(rr,"\n"),gr="".concat(sr,"\nlogsource:\n    category: auditd\n    product: linux\n").concat(rr,"\n"),_r="".concat(sr,"\nlogsource:\n    category: clamav\n    product: linux\n").concat(rr,"\n"),yr="".concat(sr,"\nlogsource:\n    category: cron\n    product: linux\n").concat(rr,"\n"),br="".concat(sr,"\nlogsource:\n    category: guacamole\n    product: linux\n").concat(rr,"\n"),kr="".concat(sr,"\nlogsource:\n    category: modsecurity\n    product: linux\n").concat(rr,"\n"),Sr="".concat(sr,"\nlogsource:\n    category: sudo\n    product: linux\n").concat(rr,"\n"),wr="".concat(sr,"\nlogsource:\n    category: sshd\n    product: linux\n").concat(rr,"\n"),xr="".concat(sr,"\nlogsource:\n    category: syslog\n    product: linux\n").concat(rr,"\n"),Cr="".concat(sr,"\nlogsource:\n    category: vsftpd\n    product: linux\n").concat(rr,"\n"),Tr="".concat(sr,"\nlogsource:\n    category: file_event\n    product: macos\n").concat(rr,"\n"),$r="".concat(sr,"\nlogsource:\n    category: process_creation\n    product: macos\n").concat(rr,"\n"),Er="".concat(sr,"\nlogsource:\n    category: clipboard_capture\n    product: windows\n").concat(rr,"\n"),Fr="".concat(sr,"\nlogsource:\n    category: create_remote_thread\n    product: windows\n").concat(rr,"\n"),Pr="".concat(sr,"\nlogsource:\n    category: create_stream_hash\n    product: windows\n").concat(rr,"\n"),Ar="".concat(sr,"\nlogsource:\n    category: dns_query\n    product: windows\n").concat(rr,"\n"),Or="".concat(sr,"\nlogsource:\n    category: driver_load\n    product: windows\n").concat(rr,"\n"),Dr="".concat(sr,"\nlogsource:\n    category: file_change\n    product: windows\n").concat(rr,"\n"),Nr="".concat(sr,"\nlogsource:\n    category: file_delete\n    product: windows\n").concat(rr,"\n"),Ir="".concat(sr,"\nlogsource:\n    category: file_event\n    product: windows\n").concat(rr,"\n"),Rr="".concat(sr,"\nlogsource:\n    category: image_load\n    product: windows\n").concat(rr,"\n"),Lr="".concat(sr,"\nlogsource:\n    category: network_connection\n    product: windows\n").concat(rr,"\n"),jr="".concat(sr,"\nlogsource:\n    category: pipe_created\n    product: windows\n").concat(rr,"\n"),qr="".concat(sr,"\nlogsource:\n    category: process_access\n    product: windows\n").concat(rr,"\n"),Qr="".concat(sr,"\nlogsource:\n    category: process_creation\n    product: windows\n").concat(rr,"\n"),Hr="".concat(sr,"\nlogsource:\n    category: process_tampering\n    product: windows\n").concat(rr,"\n"),Mr="".concat(sr,"\nlogsource:\n    category: process_termination\n    product: windows\n").concat(rr,"\n"),Wr="".concat(sr,"\nlogsource:\n    category: ps_classic_provider_start\n    product: windows\n").concat(rr,"\n"),zr="".concat(sr,"\nlogsource:\n    category: ps_classic_script\n    product: windows\n").concat(rr,"\n"),Gr="".concat(sr,"\nlogsource:\n    category: ps_classic_start\n    product: windows\n").concat(rr,"\n"),Br="".concat(sr,"\nlogsource:\n    category: ps_module\n    product: windows\n").concat(rr,"\n"),Ur="".concat(sr,"\nlogsource:\n    category: ps_script\n    product: windows\n").concat(rr,"\n"),Vr="".concat(sr,"\nlogsource:\n    category: raw_access_thread\n    product: windows\n").concat(rr,"\n"),Yr="".concat(sr,"\nlogsource:\n    category: registry_add\n    product: windows\n").concat(rr,"\n"),Jr="".concat(sr,"\nlogsource:\n    category: registry_delete\n    product: windows\n").concat(rr,"\n"),Xr="".concat(sr,"\nlogsource:\n    category: registry_event\n    product: windows\n").concat(rr,"\n"),Kr="".concat(sr,"\nlogsource:\n    category: registry_rename\n    product: windows\n").concat(rr,"\n"),Zr="".concat(sr,"\nlogsource:\n    category: registry_set\n    product: windows\n").concat(rr,"\n"),ta="".concat(sr,"\nlogsource:\n    category: sysmon_error\n    product: windows\n").concat(rr,"\n"),ea="".concat(sr,"\nlogsource:\n    category: sysmon_status\n    product: windows\n").concat(rr,"\n"),na="".concat(sr,"\nlogsource:\n    category: wmi_event\n    product: windows\n").concat(rr,"\n"),ia="".concat(sr,"\nlogsource:\n    service: application\n    product: windows\n").concat(rr,"\n"),sa="".concat(sr,"\nlogsource:\n    service: applocker\n    product: windows\n").concat(rr,"\n"),ra="".concat(sr,"\nlogsource:\n    service: bits-client\n    product: windows\n").concat(rr,"\n"),aa="".concat(sr,"\nlogsource:\n    service: codeintegrity-operational\n    product: windows\n").concat(rr,"\n"),oa="".concat(sr,"\nlogsource:\n    service: dhcp\n    product: windows\n").concat(rr,"\n"),ca="".concat(sr,"\nlogsource:\n    service:  dns-server\n    product: windows\n").concat(rr,"\n"),la="".concat(sr,"\nlogsource:\n    service: driver-framework\n    product: windows\n").concat(rr,"\n"),ua="".concat(sr,"\nlogsource:\n    service: firewall-as\n    product: windows\n").concat(rr,"\n"),da="".concat(sr,"\nlogsource:\n    service:  ldap_debug\n    product: windows\n").concat(rr,"\n"),ha="".concat(sr,"\nlogsource:\n    service: microsoft-servicebus-client\n    product: windows\n").concat(rr,"\n"),ma="".concat(sr,"\nlogsource:\n    service: msexchange-management\n    product: windows\n").concat(rr,"\n"),va="".concat(sr,"\nlogsource:\n    service: ntlm\n    product: windows\n").concat(rr,"\n"),pa="".concat(sr,"\nlogsource:\n    service: powershell\n    product: windows\n").concat(rr,"\n"),fa="".concat(sr,"\nlogsource:\n    service: powershell-classic\n    product: windows\n").concat(rr,"\n"),ga="".concat(sr,"\nlogsource:\n    service: printservice-admin\n    product: windows\n").concat(rr,"\n"),_a="".concat(sr,"\nlogsource:\n    service: printservice-operational\n    product: windows\n").concat(rr,"\n"),ya="".concat(sr,"\nlogsource:\n    service: security\n    product: windows\n").concat(rr,"\n"),ba="".concat(sr,"\nlogsource:\n    service: security-mitigations\n    product: windows\n").concat(rr,"\n"),ka="".concat(sr,"\nlogsource:\n    service: smbclient-security\n    product: windows\n").concat(rr,"\n"),Sa="".concat(sr,"\nlogsource:\n    service: sysmon\n    product: windows\n").concat(rr,"\n"),wa="".concat(sr,"\nlogsource:\n    service: system\n    product: windows\n").concat(rr,"\n"),xa="".concat(sr,"\nlogsource:\n    service: taskscheduler\n    product: windows\n").concat(rr,"\n"),Ca="".concat(sr,"\nlogsource:\n    service: terminalservices\n    product: windows\n").concat(rr,"\n"),Ta="".concat(sr,"\nlogsource:\n    service: windefend\n    product: windows\n").concat(rr,"\n"),$a="".concat(sr,"\nlogsource:\n    service: wmi\n    product: windows\n").concat(rr,"\n"),Ea="".concat(sr,"\n").concat(rr,"\n"),Fa=[{os:"General",title:"Default template",text:Ea},{os:"Cloud",title:"Cloud: AWS",text:ar},{os:"Cloud",title:"Cloud: Azure_activitylogs",text:or},{os:"Cloud",title:"Cloud: Azure_signinlogs",text:cr},{os:"Cloud",title:"Cloud: GCP Audit logs",text:lr},{os:"Cloud",title:"Cloud: GWorkspace",text:ur},{os:"Cloud",title:"Cloud: Microsoft 365",text:dr},{os:"Cloud",title:"Cloud: Okta",text:hr},{os:"Linux",title:"Linux: File create",text:mr},{os:"Linux",title:"Linux: Network connection",text:vr},{os:"Linux",title:"Linux: Process creation",text:pr},{os:"Linux",title:"Linux: Any logs",text:fr},{os:"Linux",title:"Linux: AuditD",text:gr},{os:"Linux",title:"Linux: ClamAV",text:_r},{os:"Linux",title:"Linux: CRON",text:yr},{os:"Linux",title:"Linux: Guacamole",text:br},{os:"Linux",title:"Linux: Modseurity",text:kr},{os:"Linux",title:"Linux: sudo",text:Sr},{os:"Linux",title:"Linux: sshd",text:wr},{os:"Linux",title:"Linux: syslog",text:xr},{os:"Linux",title:"Linux: VSFTPD",text:Cr},{os:"MacOS",title:"MacOS: file_event",text:Tr},{os:"MacOS",title:"MacOS: process_creation",text:$r},{os:"Windows",title:"Windows: clipboard_capture",text:Er},{os:"Windows",title:"Windows: create_remote_thread",text:Fr},{os:"Windows",title:"Windows: create_stream_hash",text:Pr},{os:"Windows",title:"Windows: dns_query",text:Ar},{os:"Windows",title:"Windows: driver_load",text:Or},{os:"Windows",title:"Windows: file_change",text:Dr},{os:"Windows",title:"Windows: file_delete",text:Nr},{os:"Windows",title:"Windows: file_event",text:Ir},{os:"Windows",title:"Windows: image_load",text:Rr},{os:"Windows",title:"Windows: network_connection",text:Lr},{os:"Windows",title:"Windows: pipe_created",text:jr},{os:"Windows",title:"Windows: process_access",text:qr},{os:"Windows",title:"Windows: process_creation",text:Qr},{os:"Windows",title:"Windows: process_tampering",text:Hr},{os:"Windows",title:"Windows: process_termination",text:Mr},{os:"Windows",title:"Windows: ps_classic_provider_start",text:Wr},{os:"Windows",title:"Windows: ps_classic_script",text:zr},{os:"Windows",title:"Windows: ps_classic_start",text:Gr},{os:"Windows",title:"Windows: ps_module",text:Br},{os:"Windows",title:"Windows: ps_script",text:Ur},{os:"Windows",title:"Windows: raw_access_thread",text:Vr},{os:"Windows",title:"Windows: registry_add",text:Yr},{os:"Windows",title:"Windows: registry_delete",text:Jr},{os:"Windows",title:"Windows: registry_event",text:Xr},{os:"Windows",title:"Windows: registry_rename",text:Kr},{os:"Windows",title:"Windows: registry_set",text:Zr},{os:"Windows",title:"Windows: sysmon_error",text:ta},{os:"Windows",title:"Windows: sysmon_status",text:ea},{os:"Windows",title:"Windows: wmi_event",text:na},{os:"Windows",title:"Windows: application",text:ia},{os:"Windows",title:"Windows: applocker",text:sa},{os:"Windows",title:"Windows: bits-client",text:ra},{os:"Windows",title:"Windows: codeintegrity-operational",text:aa},{os:"Windows",title:"Windows: dhcp",text:oa},{os:"Windows",title:"Windows: dns-server",text:ca},{os:"Windows",title:"Windows: driver-framework",text:la},{os:"Windows",title:"Windows: firewall-as",text:ua},{os:"Windows",title:"Windows: ldap_debug",text:da},{os:"Windows",title:"Windows: microsoft-servicebus-client",text:ha},{os:"Windows",title:"Windows: msexchange-management",text:ma},{os:"Windows",title:"Windows: ntlm",text:va},{os:"Windows",title:"Windows: powershell",text:pa},{os:"Windows",title:"Windows: powershell-classic",text:fa},{os:"Windows",title:"Windows: printservice-admin",text:ga},{os:"Windows",title:"Windows: printservice-operational",text:_a},{os:"Windows",title:"Windows: security",text:ya},{os:"Windows",title:"Windows: security-mitigations",text:ba},{os:"Windows",title:"Windows: smbclient-security",text:ka},{os:"Windows",title:"Windows: sysmon",text:Sa},{os:"Windows",title:"Windows: system",text:wa},{os:"Windows",title:"Windows: taskscheduler",text:xa},{os:"Windows",title:"Windows: terminalservices",text:Ca},{os:"Windows",title:"Windows: windefend",text:Ta},{os:"Windows",title:"Windows: wmi",text:$a}],Pa={props:["rule_uuid","sigmaRule","event"],data:function(){return{editingRule:{ruleYaml:Ea},status_text:"",ruleYamlTextArea:{},SigmaTemplates:Fa,search:"",isNewRule:!1,isUpdatingRule:!1,isParsingSuccesful:!1}},watch:{rule_uuid:function(t,e){"new"===t?(this.editingRule={title:"New Sigma Rule"},this.resetComponent()):this.getRuleByUUID(t)}},loaded:function(){this.parseSigma(this.editingRule.rule_yaml)},mounted:function(){"new"===this.rule_uuid?this.resetComponent():this.getRuleByUUID(this.rule_uuid)},methods:{resetComponent:function(){this.editingRule={title:"New Sigma Rule"},this.isNewRule=!0,this.isUpdatingRule=!1,this.isParsingSuccesful=!0,this.ruleYamlTextArea=Ea,this.editingRule.rule_yaml=Ea,this.parseSigma(this.editingRule.rule_yaml)},selectTemplate:function(t){var e=this.SigmaTemplates.find((function(e){return e.title===t}));this.ruleYamlTextArea=e.text,this.parseSigma(e.text)},parseSigma:mt.a.debounce((function(t){var e=this;_.getSigmaRuleByText(t).then((function(t){var n=t.data.objects[0];n.tags.length>0&&null==n.tags[0]?(e.status_text="Please specify at least one tag if you use the tags field",e.isParsingSuccesful=!1):n.author?(e.editingRule=n,e.isParsingSuccesful=!0,e.status_text=""):(e.status_text="No author specified",e.isParsingSuccesful=!1)})).catch((function(t){e.status_text=t.response.data.message,e.isParsingSuccesful=!1}))}),300),getRuleByUUID:function(t){var e=this;"new"!==t&&void 0!==t&&_.getSigmaRuleResource(t).then((function(t){e.editingRule=t.data.objects[0],e.ruleYamlTextArea=e.editingRule.rule_yaml,e.isNewRule=!1,e.isUpdatingRule=!0,e.isParsingSuccesful=!0})).catch((function(t){console.error(t),e.isParsingSuccesful=!1,e.isNewRule=!0,e.isUpdatingRule=!1,e.ruleYamlTextArea=Ea,e.parseSigma(e.ruleYamlTextArea)}))},deleteRule:function(t){var e=this;confirm("Delete Rule?")&&_.deleteSigmaRule(t).then((function(t){e.$store.dispatch("updateSigmaList"),e.successSnackBar("Rule deleted!")})).catch((function(n){e.errorSnackBar("Error deleting rule: "+t),console.error(n)}))},addOrUpdateRule:function(t){var e=this;this.isNewRule&&_.createSigmaRule(this.ruleYamlTextArea).then((function(t){e.$store.dispatch("updateSigmaList"),e.successSnackBar("Rule created: "+e.editingRule.title)})).catch((function(t){e.errorSnackBar("Error creating rule: "+e.editingRule.title),console.error(t)})),this.isUpdatingRule&&_.updateSigmaRule(this.editingRule.id,this.ruleYamlTextArea).then((function(t){e.$store.dispatch("updateSigmaList"),e.successSnackBar("Rule updated: "+e.editingRule.title)})).catch((function(t){e.errorSnackBar("Error updating rule: "+e.editingRule.title),console.error(t)}))}}},Aa=Pa,Oa=(n("6b22"),Object(c["a"])(Aa,er,nr,!1,null,"5cf94003",null)),Da=Oa.exports,Na={props:["id","type"],components:{TsSigmaRules:vs,TsSigmaRuleModification:Da},methods:{toggleTheme:function(){this.$vuetify.theme.dark=!this.$vuetify.theme.dark}},computed:{currentUser:function(){return this.$store.state.currentUser}},created:function(){this.$store.dispatch("updateSigmaList"),document.title="Timesketch Studio"}},Ia=Na,Ra=Object(c["a"])(Ia,Zs,tr,!1,null,null,null),La=Ra.exports;i["default"].use(d["a"]);var ja=[{name:"Home",path:"/",component:E},{path:"/sketch/:sketchId",component:Ks,props:!0,children:[{path:"",name:"Overview",redirect:{name:"Explore"}},{path:"explore",name:"Explore",component:Mn,props:!0},{path:"intelligence",name:"Intelligence",component:Mn,props:!0},{path:"graph",name:"Graph",component:Mn,props:!0},{path:"story/:storyId",name:"Story",component:Mn,props:!0}]},{name:"Studio",path:"/studio/:type/:id",component:La,props:!0}],qa=new d["a"]({mode:"history",base:"/v2/",routes:ja}),Qa=n("2f62");i["default"].use(Qa["a"]);var Ha=function(t){return{sketch:{},meta:{},searchHistory:{},scenarios:[],hiddenScenarios:[],scenarioTemplates:[],graphPlugins:[],savedGraphs:[],tags:[],dataTypes:[],count:0,currentSearchNode:null,currentUser:t,activeContext:{scenario:null,facet:null,question:null},snackbar:{active:!1,color:"",message:"",timeout:-1},contextLinkConf:{}}},Ma=Ha(),Wa=new Qa["a"].Store({state:Ma,mutations:{SET_SKETCH:function(t,e){i["default"].set(t,"sketch",e.objects[0]),i["default"].set(t,"meta",e.meta)},SET_SEARCH_HISTORY:function(t,e){i["default"].set(t,"searchHistory",e.objects)},SET_SCENARIOS:function(t,e){i["default"].set(t,"scenarios",e.objects[0])},SET_SCENARIO_TEMPLATES:function(t,e){i["default"].set(t,"scenarioTemplates",e.objects)},SET_TIMELINE_TAGS:function(t,e){i["default"].set(t,"tags",e)},SET_DATA_TYPES:function(t,e){var n=e.objects[0]["field_bucket"]["buckets"];i["default"].set(t,"dataTypes",n)},SET_COUNT:function(t,e){i["default"].set(t,"count",e)},SET_SEARCH_NODE:function(t,e){i["default"].set(t,"currentSearchNode",e)},SET_SIGMA_LIST:function(t,e){i["default"].set(t,"sigmaRuleList",e["objects"]),i["default"].set(t,"sigmaRuleList_count",e["meta"]["rules_count"])},SET_ACTIVE_USER:function(t,e){_.getLoggedInUser().then((function(e){var n=e.data.objects[0].username;i["default"].set(t,"currentUser",n)}))},SET_ACTIVE_CONTEXT:function(t,e){i["default"].set(t,"activeContext",e)},CLEAR_ACTIVE_CONTEXT:function(t){var e={scenario:null,facet:null,question:null};i["default"].set(t,"activeContext",e)},SET_GRAPH_PLUGINS:function(t,e){i["default"].set(t,"graphPlugins",e)},SET_SAVED_GRAPHS:function(t,e){i["default"].set(t,"savedGraphs",e.objects[0]||[])},SET_SNACKBAR:function(t,e){i["default"].set(t,"snackbar",e)},RESET_STATE:function(t,e){_.getLoggedInUser().then((function(e){var n=e.data.objects[0].username;Object.assign(t,Ha(n))}))},SET_CONTEXT_LINKS:function(t,e){i["default"].set(t,"contextLinkConf",e)}},actions:{updateSketch:function(t,e){return _.getSketch(e).then((function(n){t.commit("SET_SKETCH",n.data),t.commit("SET_ACTIVE_USER",n.data),t.dispatch("updateTimelineTags",{sketchId:e}),t.dispatch("updateDataTypes",e)})).catch((function(t){}))},updateCount:function(t,e){return _.countSketchEvents(e).then((function(e){t.commit("SET_COUNT",e.data.meta.count)})).catch((function(t){}))},resetState:function(t){t.commit("RESET_STATE")},updateSearchNode:function(t,e){t.commit("SET_SEARCH_NODE",e)},updateSearchHistory:function(t,e){return e||(e=t.state.sketch.id),_.getSearchHistory(e).then((function(e){t.commit("SET_SEARCH_HISTORY",e.data)})).catch((function(t){}))},updateScenarios:function(t,e){return e||(e=t.state.sketch.id),_.getSketchScenarios(e).then((function(e){t.commit("SET_SCENARIOS",e.data)})).catch((function(t){}))},updateScenarioTemplates:function(t,e){return _.getScenarioTemplates(e).then((function(e){t.commit("SET_SCENARIO_TEMPLATES",e.data)})).catch((function(t){}))},updateTimelineTags:function(t,e){if(t.state.sketch.active_timelines.length){var n={aggregator_name:"field_bucket",aggregator_parameters:{field:"tag",limit:"1000"}};return _.runAggregator(e.sketchId,n).then((function(n){var i=n.data.objects[0]["field_bucket"]["buckets"];if(e.tag&&e.num){var s=void 0===i.find((function(t){return t.tag===e.tag}));if(s)i.push({tag:e.tag,count:e.num});else{var r=i.findIndex((function(t){return t.tag===e.tag}));i[r].count+=e.num}}t.commit("SET_TIMELINE_TAGS",i)})).catch((function(t){}))}},updateDataTypes:function(t,e){if(t.state.sketch.active_timelines.length){var n={aggregator_name:"field_bucket",aggregator_parameters:{field:"data_type",limit:"1000"}};return _.runAggregator(e,n).then((function(e){t.commit("SET_DATA_TYPES",e.data)})).catch((function(t){}))}},updateSigmaList:function(t){_.getSigmaRuleList().then((function(e){t.commit("SET_SIGMA_LIST",e.data)})).catch((function(t){}))},setActiveContext:function(t,e){t.commit("SET_ACTIVE_CONTEXT",e)},clearActiveContext:function(t){t.commit("CLEAR_ACTIVE_CONTEXT")},setSnackBar:function(t,e){t.commit("SET_SNACKBAR",{active:!0,color:e.color,message:e.message,timeout:e.timeout})},updateContextLinks:function(t){_.getContextLinkConfig().then((function(e){t.commit("SET_CONTEXT_LINKS",e.data)})).catch((function(t){}))},updateGraphPlugins:function(t){_.getGraphPluginList().then((function(e){t.commit("SET_GRAPH_PLUGINS",e.data)})).catch((function(t){}))},updateSavedGraphs:function(t,e){e||(e=t.state.sketch.id),_.getSavedGraphList(e).then((function(e){t.commit("SET_SAVED_GRAPHS",e.data)})).catch((function(t){console.error(t)}))}}}),za=5e3,Ga={message:"",color:"info",timeout:za};i["default"].mixin({methods:{successSnackBar:function(t){var e=Ga;e.message=t,e.color="success",this.$store.dispatch("setSnackBar",e)},errorSnackBar:function(t){var e=Ga;e.message=t,e.color="error",this.$store.dispatch("setSnackBar",e)},infoSnackBar:function(t){var e=Ga;e.message=t,e.color="info",e.timeout=2e3,this.$store.dispatch("setSnackBar",e)}}});var Ba=n("f13c"),Ua=n.n(Ba),Va=n("8e5f"),Ya=n.n(Va),Ja=n("3a6f"),Xa=n.n(Ja),Ka=n("4eb5"),Za=n.n(Ka),to=(n("5363"),n("ce5b")),eo=n.n(to);n("bf40");i["default"].use(eo.a,{options:{customProperties:!0}});var no={theme:{dark:!1},icons:{iconfont:"mdi"}},io=new eo.a(no);n("b383"),n("165b"),n("2d27"),n("56eb");var so=new i["default"],ro=e["default"]=so;i["default"].use(n("2ead")),i["default"].use(Xa.a),i["default"].use(Za.a),i["default"].use(Ua.a),i["default"].component("multiselect",Ya.a),i["default"].config.productionTip=!1,new i["default"]({router:qa,store:Wa,vuetify:io,render:function(t){return t(u)}}).$mount("#app")},"56eb":function(t,e,n){"use strict";n.r(e);n("7f7f"),n("ac6a");var i=n("2b0e"),s=n("6dde");s.keys().forEach((function(t){var e=s(t);i["default"].filter(e.default.name,e.default.filter)}))},6107:function(t,e,n){"use strict";n.r(e);var i=n("707c");e["default"]={name:"timeSince",filter:function(t){return t?i["a"].utc(t).fromNow():""}}},"6b22":function(t,e,n){"use strict";n("8103")},"6dde":function(t,e,n){var i={"./Capitalize.js":"76f9","./CompactBytes.js":"3d1d","./CompactNumber.js":"d3b7","./FilterChip.js":"05a2","./FormatLabelText.js":"16f1","./FormatTimestamp.js":"09ff","./Initital.js":"43f8","./ToISO8601.js":"84cc","./shortDateTime.js":"481e","./timeSince.js":"6107"};function s(t){var e=r(t);return n(e)}function r(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}s.keys=function(){return Object.keys(i)},s.resolve=r,t.exports=s,s.id="6dde"},"707c":function(t,e,n){"use strict";var i=n("5a0c"),s=n.n(i),r=n("0ecf"),a=n.n(r),o=n("4208"),c=n.n(o);s.a.extend(a.a),s.a.extend(c.a),e["a"]=s.a},"71d3":function(t,e,n){},"75a6":function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="75a6"},"76f9":function(t,e,n){"use strict";n.r(e);n("6b54");e["default"]={name:"capitalize",filter:function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""}}},8089:function(t,e,n){"use strict";n("d8b2")},"808c":function(t,e,n){"use strict";n("9a2a")},8103:function(t,e,n){},"84cc":function(t,e,n){"use strict";n.r(e);var i=n("707c");e["default"]={name:"toISO8601",filter:function(t){return t<0?"No timestamp":Object(i["a"])(t).toISOString()}}},"97be":function(t,e,n){},"9a2a":function(t,e,n){},b035:function(t,e,n){"use strict";n("0062")},b383:function(t,e,n){},bd11:function(t,e,n){"use strict";n("e076")},c3ca:function(t,e,n){"use strict";n("09ae")},c7b3:function(t,e,n){},d3b7:function(t,e,n){"use strict";n.r(e),e["default"]={name:"compactNumber",filter:function(t){t||(t=0);var e="";if(t>999999999)t=Math.round(t/1e9*10)/10,e="B";else if(t>999999)t=Math.round(t/1e6*10)/10,e="M";else{if(!(t>999))return t;t=Math.round(t/1e3*10)/10,e="K"}return t+e}}},d8b2:function(t,e,n){},dc60:function(t,e,n){"use strict";n("3788")},e076:function(t,e,n){},f921:function(t,e,n){}}]);
//# sourceMappingURL=chunk-common.921edcb1.js.map