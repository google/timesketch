(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-common"],{0:function(t,e,i){t.exports=i("56d7")},"05a2":function(t,e,i){"use strict";i.r(e),e["default"]={name:"filterChip",filter:function(t){return"label"===t.type?"__ts_star"===t.value?"Starred":"__ts_comment"===t.value?"Commented":t.value:t.field+":"+t.value}}},"09ae":function(t,e,i){},"09ff":function(t,e,i){"use strict";i.r(e);i("6b54");e["default"]={name:"formatTimestamp",filter:function(t){var e=parseInt(t).toString().length;return 13===e?t:(15===e||16===e?t/=1e3:10===e&&(t*=1e6),parseInt(t))}}},"16f1":function(t,e,i){"use strict";i.r(e);i("a481");e["default"]={name:"formatLabelText",filter:function(t){return t.replace("__ts_","")}}},"1a74":function(t,e,i){"use strict";i("4211")},"21bb":function(t,e,i){"use strict";i("7a98")},"2d27":function(t,e,i){"use strict";i.r(e);i("7f7f"),i("ac6a");var n=i("2b0e"),s=i("75a6");s.keys().forEach((function(t){var e=s(t),i=e.default.name;n["default"].component(i,e.default||e)}))},"2d9e":function(t,e,i){"use strict";i("71d3")},"32d8":function(t,e,i){"use strict";i("b0b9")},"35fd":function(t,e,i){"use strict";i("97be")},3884:function(t,e,i){"use strict";i("c7b3")},"3d1d":function(t,e,i){"use strict";i.r(e),e["default"]={name:"compactBytes",filter:function(t){t||(t=0);var e=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.min(Math.floor(Math.log(t)/Math.log(1e3)),e.length-1),n=1*(t/Math.pow(1e3,i)).toFixed(2);return n+e[i]}}},4211:function(t,e,i){},"481e":function(t,e,i){"use strict";i.r(e);var n=i("707c");e["default"]={name:"shortDateTime",filter:function(t){return n["a"].utc(t).format("YYYY-MM-DD HH:mm")}}},"56d7":function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("f751"),i("097d");var n=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-app",{attrs:{id:"app"}},[t.isRootPage?t._e():i("v-navigation-drawer",{staticClass:"pl-1",attrs:{permanent:"",app:"","mini-variant":""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[i("v-avatar",{staticClass:"mb-2 mt-3"},[i("router-link",{attrs:{to:"/"}},[i("v-img",{attrs:{src:"/dist/timesketch-color.png","max-height":"30","max-width":"30",contain:""}})],1)],1),i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("v-avatar",[i("v-btn",t._g(t._b({attrs:{to:{name:"Overview"},"exact-path":"",icon:""}},"v-btn",s,!1),n),[i("v-icon",[t._v("mdi-home-outline")])],1)],1)]}}],null,!1,1071709935)},[i("span",[t._v("Overview")])]),i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("v-avatar",[i("v-btn",t._g(t._b({attrs:{to:{name:"Explore"},icon:""}},"v-btn",s,!1),n),[i("v-icon",[t._v("mdi-magnify")])],1)],1)]}}],null,!1,3151434681)},[i("span",[t._v("Search")])]),i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("v-avatar",[i("v-btn",t._g(t._b({attrs:{disabled:"",icon:""}},"v-btn",s,!1),n),[i("v-icon",[t._v("mdi-graph-outline")])],1)],1)]}}],null,!1,3932961442)},[i("span",[t._v("Graph")])]),i("v-avatar",[i("v-btn",{attrs:{disabled:"",icon:""}},[i("v-icon",[t._v("mdi-auto-fix")])],1)],1),i("v-avatar",[i("v-btn",{attrs:{disabled:"",icon:""}},[i("v-icon",[t._v("mdi-head-lightbulb-outline")])],1)],1)],1),i("v-main",[i("v-toolbar",{staticClass:"ml-2",staticStyle:{background:"transparent"},attrs:{flat:""}},[t.isRootPage?i("div",[i("v-avatar",[i("v-img",{attrs:{src:"/dist/timesketch-color.png","max-height":"40","max-width":"40",contain:""}})],1),i("span",{staticStyle:{"font-size":"1.4em"}},[t._v("timesketch")])],1):t._e(),i("span",{staticStyle:{"font-size":"1.2em"}},[t._v(t._s(t.sketch.name))]),i("v-spacer"),i("v-btn",{attrs:{small:"",depressed:""},on:{click:t.switchUI}},[t._v(" Use the old UI ")]),i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("v-avatar",[i("v-btn",t._g(t._b({attrs:{icon:""},on:{click:t.toggleTheme}},"v-btn",s,!1),n),[i("v-icon",[t._v("mdi-brightness-6")])],1)],1)]}}])},[i("span",[t._v("Switch between light and dark theme")])])],1),i("div",{staticClass:"mx-3 mt-n3"},[i("router-view")],1)],1)],1)},r=[],a=(i("a481"),i("6b54"),i("ac6a"),i("456d"),{name:"app",data:function(){return{drawer:!0,mini:!1}},computed:{sketch:function(){return this.$store.state.sketch},currentUser:function(){return this.$store.state.currentUser},isRootPage:function(){return 0===Object.keys(this.sketch).length}},methods:{toggleTheme:function(){this.$vuetify.theme.dark=!this.$vuetify.theme.dark,localStorage.setItem("isDarkTheme",this.$vuetify.theme.dark.toString())},switchUI:function(){window.location.href=window.location.href.replace("/v2/","/")}},mounted:function(){var t=localStorage.getItem("isDarkTheme");t&&(this.$vuetify.theme.dark="true"===t)}}),o=a,c=(i("60bc"),i("5c64"),i("2877")),l=Object(c["a"])(o,s,r,!1,null,null,null),u=l.exports,d=i("8c4f"),h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",{attrs:{fluid:"","pa-0":""}},[i("div",{staticClass:"pa-5"},[i("ts-sketch-list")],1)])},m=[],v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("v-toolbar",{staticStyle:{background:"transparent"},attrs:{dense:"",flat:""}},[i("v-btn-toggle",{staticClass:"ml-n4",model:{value:t.toggleStateButton,callback:function(e){t.toggleStateButton=e},expression:"toggleStateButton"}},[i("v-btn",{attrs:{text:"",small:"",color:"primary"},on:{click:function(e){return t.switchScope("user")}}},[t._v(" My sketches ")]),i("v-btn",{attrs:{text:"",small:"",color:"primary"},on:{click:function(e){return t.switchScope("shared")}}},[t._v(" Shared with me ")]),i("v-btn",{attrs:{text:"",small:"",color:"primary"},on:{click:function(e){return t.switchScope("recent")}}},[t._v(" Recent ")])],1),i("v-btn",{staticClass:"ml-3",attrs:{depressed:"",small:"",color:"success"}},[t._v(" New sketch ")]),i("v-spacer"),i("v-text-field",{staticClass:"mr-n4",attrs:{solo:"","hide-details":"","single-line":"",label:"Search","prepend-inner-icon":"mdi-magnify"},on:{change:t.search}})],1),i("br"),i("v-data-table",{attrs:{headers:t.headers,items:t.sketches,"items-per-page":15,options:t.options,"server-items-length":t.numSketches,"footer-props":{"items-per-page-options":[15,30,40,50,100]},"disable-filtering":"","disable-sort":"",loading:t.loading},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.name",fn:function(e){var n=e.item;return[i("router-link",{staticStyle:{"text-decoration":"none"},attrs:{to:{name:"Overview",params:{sketchId:n.id}}}},[t._v(t._s(n.name))])]}},{key:"item.created_at",fn:function(e){var n=e.item;return[t._v("\n      "+t._s(t._f("shortDateTime")(n.created_at))+" "),i("small",[t._v("("+t._s(t._f("timeSince")(n.created_at))+")")])]}},{key:"item.last_activity",fn:function(e){var i=e.item;return[t._v("\n      "+t._s(t._f("timeSince")(i.last_activity))+"\n    ")]}}])})],1)},f=[],p=(i("7f7f"),i("bc3a")),g=i.n(p),_=i("2c4e"),y=g.a.create({baseURL:"/v2/api/v1",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}}),b=g.a.create({baseURL:"/v2/api/v1",responseType:"blob",headers:{common:{"X-CSRFToken":document.getElementsByTagName("meta")[0]["content"]}}});y.interceptors.response.use((function(t){return t}),(function(t){return"The CSRF token has expired."===t.response.data.message?_["a"].open({message:t.response.data.message,type:"is-white",position:"is-top",actionText:"Refresh",indefinite:!0,onAction:function(){location.reload()}}):_["a"].open({message:t.response.data.message,type:"is-white",position:"is-top",actionText:"Close",duration:7e3}),Promise.reject(t)}));var S={getSketchList:function(t,e,i,n){var s={params:{scope:t,page:e,per_page:i,search_query:n}};return y.get("/sketches/",s)},getSketch:function(t){return y.get("/sketches/"+t+"/")},createSketch:function(t){return y.post("/sketches/",t)},deleteSketch:function(t){return y.delete("/sketches/"+t+"/")},archiveSketch:function(t){var e={action:"archive"};return y.post("/sketches/"+t+"/archive/",e)},unArchiveSketch:function(t){var e={action:"unarchive"};return y.post("/sketches/"+t+"/archive/",e)},exportSketch:function(t){var e={action:"export"};return b.post("/sketches/"+t+"/archive/",e)},getSketchAttributes:function(t){return y.get("/sketches/"+t+"/attribute/")},addSketchAttribute:function(t,e,i,n){var s={name:e,values:[i],ontology:n,action:"post"};return y.post("/sketches/"+t+"/attribute/",s)},getSketchTimeline:function(t,e){return y.get("/sketches/"+t+"/timelines/"+e+"/")},getSketchTimelineAnalysis:function(t,e){return y.get("/sketches/"+t+"/timelines/"+e+"/analysis/")},saveSketchTimeline:function(t,e,i,n,s){var r={name:i,description:n,color:s};return y.post("/sketches/"+t+/timelines/+e+"/",r)},saveSketchSummary:function(t,e,i){var n={name:e,description:i};return y.post("/sketches/"+t+"/",n)},deleteSketchTimeline:function(t,e){return y.delete("/sketches/"+t+/timelines/+e+"/")},getEvent:function(t,e,i){var n={params:{searchindex_id:e,event_id:i}};return y.get("/sketches/"+t+"/event/",n)},saveEventAnnotation:function(t,e,i,n,s){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a={annotation:i,annotation_type:e,events:n,current_search_node_id:s.id,remove:r};return y.post("/sketches/"+t+"/event/annotate/",a)},updateEventAnnotation:function(t,e,i,n,s){var r={annotation:i,annotation_type:e,events:n,current_search_node_id:s.id};return y.put("/sketches/"+t+"/event/annotate/",r)},deleteEventAnnotation:function(t,e,i,n,s){var r={params:{annotation_id:i,annotation_type:e,event_id:n._id,searchindex_id:n._index,current_search_node_id:s.id}};return y.delete("/sketches/"+t+"/event/annotate/",r)},getStoryList:function(t){return y.get("sketches/"+t+"/stories/")},getStory:function(t,e){return y.get("/sketches/"+t+"/stories/"+e+"/")},createStory:function(t,e,i){var n={title:t,content:e};return y.post("/sketches/"+i+/stories/,n)},updateStory:function(t,e,i,n){var s={title:t,content:e};return y.post("/sketches/"+i+/stories/+n+"/",s)},deleteStory:function(t,e){return y.delete("/sketches/"+t+/stories/+e+"/")},getView:function(t,e){return y.get("/sketches/"+t+"/views/"+e+"/")},createView:function(t,e,i,n){var s={name:e,query:i,filter:n,dsl:""};return y.post("/sketches/"+t+/views/,s)},updateView:function(t,e,i,n){var s={query:i,filter:n};return y.post("/sketches/"+t+/views/+e+"/",s)},deleteView:function(t,e){return y.delete("/sketches/"+t+"/views/"+e+"/")},search:function(t,e){return y.post("/sketches/"+t+"/explore/",e)},exportSearchResult:function(t,e){return b.post("/sketches/"+t+"/explore/",e)},getAggregations:function(t){return y.get("/sketches/"+t+"/aggregation/")},getAggregationGroups:function(t){return y.get("/sketches/"+t+"/aggregation/group/")},runAggregator:function(t,e){return y.post("/sketches/"+t+"/aggregation/explore/",e)},runAggregatorGroup:function(t,e){return y.get("/sketches/"+t+"/aggregation/group/"+e+"/")},saveAggregation:function(t,e,i,n){var s={name:i,description:e.description,agg_type:e.name,chart_type:n["supported_charts"],parameters:n};return y.post("/sketches/"+t+"/aggregation/",s)},countSketchEvents:function(t){return y.get("/sketches/"+t+"/count/")},uploadTimeline:function(t,e){return y.post("/upload/",t,e)},getSessions:function(t,e){return y.get("/sketches/"+t+"/explore/sessions/"+e+"/")},getUsers:function(){return y.get("/users/")},getGroups:function(){return y.get("/groups/")},editCollaborators:function(t,e,i,n,s,r){var a={public:e,users:i,groups:n,remove_users:s,remove_groups:r};return y.post("/sketches/"+t+/collaborators/,a)},getAnalyzers:function(t){return y.get("/sketches/"+t+"/analyzer/")},runAnalyzers:function(t,e,i){var n={timeline_ids:e,analyzer_names:i};return y.post("/sketches/"+t+/analyzer/,n)},getAnalyzerSession:function(t,e){return y.get("/sketches/"+t+"/analyzer/sessions/"+e+"/")},getActiveAnalyzerSessions:function(t){return y.get("/sketches/"+t+"/analyzer/sessions/active/")},getLoggedInUser:function(){return y.get("/users/me/")},generateGraphFromPlugin:function(t,e,i,n,s){var r={plugin:e,config:{filter:{indices:i,timelineIds:n}},refresh:s};return n.length&&(r["timeline_ids"]=n),y.post("/sketches/"+t+/graph/,r)},getGraphPluginList:function(){return y.get("/graphs/")},saveGraph:function(t,e,i){var n={name:e,elements:i};return y.post("/sketches/"+t+/graphs/,n)},getSavedGraphList:function(t){return y.get("/sketches/"+t+/graphs/)},getSavedGraph:function(t,e){var i={params:{format:"cytoscape"}};return y.get("/sketches/"+t+/graphs/+e+"/",i)},getSearchHistory:function(t){return y.get("/sketches/"+t+/searchhistory/)},getSearchHistoryTree:function(t){return y.get("/sketches/"+t+/searchhistorytree/)},getSigmaList:function(){return y.get("/sigma/")},getSigmaResource:function(t){return y.get("/sigma/rule/"+t+"/")},getSigmaByText:function(t){var e={content:t};return y.post("/sigma/text/",e)},getScenarios:function(){return y.get("/scenarios/")},getSketchScenarios:function(t){return y.get("/sketches/"+t+"/scenarios/")},addScenario:function(t,e){var i={scenario_name:e};return y.post("/sketches/"+t+"/scenarios/",i)}},k={data:function(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Creator",value:"user"},{text:"Created at",value:"created_at"},{text:"Last active",value:"last_activity"}],sketches:[],numSketches:0,options:{},loading:!1,toggleStateButton:0,scope:"user",searchQuery:null}},watch:{options:{handler:function(){this.getSketches()},deep:!0}},methods:{search:function(t){this.scope="search",this.searchQuery=t,this.getSketches()},switchScope:function(t){this.scope=t,this.getSketches()},getSketches:function(){var t=this;this.loading=!0,S.getSketchList(this.scope,this.options.page,this.options.itemsPerPage,this.searchQuery).then((function(e){t.sketches=e.data.objects,t.numSketches=e.data.meta.total_items,t.loading=!1})).catch((function(e){t.loading=!1,console.error(e)}))}}},w=k,x=Object(c["a"])(w,v,f,!1,null,"0a5f2dd4",null),T=x.exports,C={components:{TsSketchList:T},created:function(){this.$store.dispatch("resetState"),document.title="Timesketch"}},E=C,$=(i("21bb"),Object(c["a"])(E,h,m,!1,null,null,null)),F=$.exports,O=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",{attrs:{fluid:""}},[i("v-navigation-drawer",{staticStyle:{"box-shadow":"0 10px 15px -3px #888"},attrs:{fixed:"",right:"",width:"600"},scopedSlots:t._u([{key:"prepend",fn:function(){return[i("v-toolbar",{attrs:{flat:""}},[i("v-toolbar-title",[t._v(t._s(t.selectedEvents.length)+" events selected")]),i("v-spacer"),i("v-btn",{attrs:{icon:""},on:{click:function(e){t.selectedEvents=[]}}},[i("v-icon",[t._v("mdi-close")])],1)],1)]},proxy:!0}]),model:{value:t.selectedEvents.length,callback:function(e){t.$set(t.selectedEvents,"length",e)},expression:"selectedEvents.length"}},[i("v-container",[i("v-list",t._l(t.selectedEvents,(function(e,n){return i("v-list-item",{key:n},[i("v-list-item-content",[i("v-list-item-title",[t._v(t._s(e._source.message))])],1)],1)})),1)],1)],1),t.scenario.facets.length?i("v-navigation-drawer",{staticClass:"ml-14",attrs:{app:"",permanent:"",width:t.rightSidePanelWidth,"hide-overlay":""}},[i("ts-scenario",{attrs:{scenario:t.scenario,"minimize-panel":t.minimizeRightSidePanel},on:{togglePanel:function(e){t.minimizeRightSidePanel=!t.minimizeRightSidePanel}}})],1):t._e(),i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-card",{staticClass:"pa-md-3 pb-3",attrs:{outlined:""}},[i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-card",{staticClass:"d-flex align-start",attrs:{flat:""}},[i("v-sheet",{staticClass:"mt-1"},[i("ts-search-history-buttons",{on:{toggleSearchHistory:function(e){return t.toggleSearchHistory()}}})],1),i("v-divider",{staticClass:"mx-2",attrs:{vertical:""}}),i("v-menu",{attrs:{"offset-y":"",attach:"","close-on-content-click":!1,"close-on-click":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("v-text-field",t._g(t._b({ref:"searchInput",attrs:{"hide-details":"",label:"Search",placeholder:"Search","single-line":"",dense:"",filled:"",flat:"",solo:"","append-icon":"mdi-magnify",id:"tsSearchInput"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},click:function(e){t.showSearchDropdown=!0}},model:{value:t.currentQueryString,callback:function(e){t.currentQueryString=e},expression:"currentQueryString"}},"v-text-field",s,!1),n))]}}]),model:{value:t.showSearchDropdown,callback:function(e){t.showSearchDropdown=e},expression:"showSearchDropdown"}},[i("ts-search-dropdown",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onClickOutside,expression:"onClickOutside"}],attrs:{"selected-labels":t.selectedLabels,"query-string":t.currentQueryString},on:{setActiveView:t.searchView,addChip:t.addChip,updateLabelChips:function(e){return t.updateLabelChips()},"close-on-click":function(e){t.showSearchDropdown=!1},"node-click":t.jumpInHistory,setQueryAndFilter:t.setQueryAndFilter}})],1)],1)],1)],1),i("v-divider",{staticClass:"mt-2 mb-3"}),i("v-row",{attrs:{dense:""}},[i("v-col",{attrs:{cols:"12"}},[i("ts-timeline-picker",{attrs:{"current-query-filter":t.currentQueryFilter,"count-per-index":t.eventList.meta.count_per_index,"count-per-timeline":t.eventList.meta.count_per_timeline},on:{updateSelectedTimelines:function(e){return t.updateSelectedTimelines(e)}}})],1)],1),i("v-row",{attrs:{dense:""}},[i("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[i("v-chip-group",[t._l(t.timeFilterChips,(function(e,n){return i("span",{key:n+e.value},[i("v-menu",{attrs:{"offset-y":"","content-class":"menu-with-gap"},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on;return[i("v-chip",t._g({attrs:{outlined:""}},s),[i("v-icon",{attrs:{left:"",small:""}},[t._v(" mdi-clock-outline ")]),i("span",{style:[e.active?"":{"text-decoration":"line-through",opacity:"50%"}]},[i("span",[t._v(t._s(e.value.split(",")[0]))]),"datetime_range"===e.type&&e.value.split(",")[0]!==e.value.split(",")[1]?i("span",[t._v("\n                          → "+t._s(e.value.split(",")[1]))]):t._e()])],1)]}}],null,!0)},[i("v-card",[i("v-list",[i("v-list-item",[i("v-list-item-action",[i("v-icon",[t._v("mdi-square-edit-outline")])],1),i("v-list-item-subtitle",[t._v("Edit filter")])],1),i("v-list-item",{on:{click:function(i){return t.toggleChip(e)}}},[i("v-list-item-action",[e.active?i("v-icon",[t._v("mdi-eye-off")]):i("v-icon",[t._v("mdi-eye")])],1),i("v-list-item-subtitle",[e.active?i("span",[t._v("Temporarily disable")]):i("span",[t._v("Re-enable")])])],1),i("v-list-item",{on:{click:function(i){return t.removeChip(e)}}},[i("v-list-item-action",[i("v-icon",[t._v("mdi-delete")])],1),i("v-list-item-subtitle",[t._v("Remove filter")])],1)],1)],1)],1),n+1<t.timeFilterChips.length?i("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"2px"},attrs:{icon:"",small:""}},[t._v("OR")]):t._e()],1)})),i("span",[i("v-menu",{staticStyle:{overflow:"visible"},attrs:{"offset-y":"","close-on-content-click":!1,"close-on-click":!0,"content-class":"menu-with-gap","allow-overflow":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("v-chip",t._g(t._b({attrs:{outlined:""}},"v-chip",s,!1),n),[i("v-icon",{attrs:{left:"",small:""}},[t._v(" mdi-clock-plus-outline ")]),t._v("\n                      Add timefilter\n                    ")],1)]}}]),model:{value:t.timeFilterMenu,callback:function(e){t.timeFilterMenu=e},expression:"timeFilterMenu"}},[i("ts-filter-menu",{attrs:{app:""},on:{cancel:function(e){t.timeFilterMenu=!1},addChip:t.addChip}})],1)],1)],2)],1)],1),t.filterChips.length?i("v-row",{attrs:{dense:""}},[i("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[i("v-chip-group",t._l(t.filterChips,(function(e,n){return i("span",{key:n+e.value},[i("v-chip",[t._v("\n                  "+t._s(t._f("formatLabelText")(e.value))+"\n                ")]),n+1<t.timeFilterChips.length?i("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"2px"},attrs:{icon:"",small:""}},[t._v("AND")]):t._e()],1)})),0)],1)],1):t._e()],1)],1)],1),i("v-row",[i("v-col",{directives:[{name:"show",rawName:"v-show",value:t.showSearchHistory,expression:"showSearchHistory"}],attrs:{cols:"12"}},[i("v-card",{attrs:{outlined:""}},[i("v-toolbar",{attrs:{elevation:"0",dense:""}},[i("v-toolbar-title",[t._v("Search history")]),i("v-spacer"),i("v-slider",{staticClass:"mt-6",attrs:{"thumb-label":"",ticks:"","append-icon":"mdi-magnify-plus-outline","prepend-icon":"mdi-magnify-minus-outline",min:"0.1",max:"1",step:"0.1"},scopedSlots:t._u([{key:"thumb-label",fn:function(e){var i=e.value;return[t._v(" "+t._s(100*i)+"% ")]}}]),model:{value:t.zoomLevel,callback:function(e){t.zoomLevel=e},expression:"zoomLevel"}}),i("v-btn",{staticClass:"ml-4",attrs:{icon:""},on:{click:function(e){t.showSearchHistory=!1}}},[i("v-icon",[t._v("mdi-close")])],1)],1),i("div",{directives:[{name:"dragscroll",rawName:"v-dragscroll"}],staticClass:"pa-md-4 no-scrollbars",staticStyle:{overflow:"scroll","white-space":"nowrap","max-height":"500px","min-height":"500px"}},[i("ts-search-history-tree",{staticStyle:{"transform-origin":"top left"},style:{transform:"scale("+t.zoomLevel+")"},attrs:{"show-history":t.showSearchHistory},on:{"node-click":t.jumpInHistory}})],1)],1)],1)],1),i("v-row",[(t.eventList.objects.length||t.searchInProgress)&&this.currentQueryFilter.indices.length?t._e():i("v-col",{attrs:{cols:"12"}},[i("v-card",{staticClass:"pa-4",attrs:{outlined:""}},[i("p",[t._v("\n          Your search "),t.currentQueryString?i("span",[t._v('"'+t._s(t.currentQueryString)+'"')]):t._e(),t._v(" did not match any events.\n        ")]),i("p",[t._v("Suggestions:")]),i("li",[t._v("Try different keywords.")]),i("li",[t._v("Try more general keywords.")]),i("li",[t._v("Try fewer keywords.")])])],1),t.eventList.objects.length||t.searchInProgress&&this.currentQueryFilter.indices.length?i("v-col",{attrs:{cols:"12"}},[i("v-card",{attrs:{flat:""}},[i("v-toolbar",{attrs:{flat:""}},[i("v-card-text",[t._v("\n            "+t._s(t.fromEvent)+"-"+t._s(t.toEvent)+" of "+t._s(t.totalHits)+" events ("+t._s(t.totalTime)+"s)\n\n            "),i("v-dialog",{attrs:{width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",s,!1),n),[i("v-icon",[t._v("mdi-content-save-outline")])],1)]}}],null,!1,3527758861),model:{value:t.saveSearchMenu,callback:function(e){t.saveSearchMenu=e},expression:"saveSearchMenu"}},[i("v-card",[i("v-card-title",[t._v(" Save Search ")]),i("v-card-text",[i("v-text-field",{attrs:{required:"",placeholder:"Name your saved search"},model:{value:t.saveSearchFormName,callback:function(e){t.saveSearchFormName=e},expression:"saveSearchFormName"}})],1),i("v-divider"),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.saveSearchMenu=!1}}},[t._v(" Cancel ")]),i("v-btn",{attrs:{color:"primary",text:"",disabled:!t.saveSearchFormName},on:{click:t.saveSearch}},[t._v(" Save ")])],1)],1)],1)],1),i("v-spacer"),i("v-btn",{attrs:{icon:""},on:{click:function(e){t.showHistogram=!t.showHistogram}}},[i("v-icon",[t._v("mdi-chart-bar")])],1),i("v-btn",{attrs:{icon:""}},[i("v-icon",[t._v("mdi-view-column-outline")])],1),i("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",s,!1),n),[i("v-icon",[t._v("mdi-dots-vertical")])],1)]}}],null,!1,3221905750)},[i("v-card",{staticClass:"mx-auto",attrs:{outlined:"","max-width":"475"}},[i("v-list",{attrs:{subheader:"","two-line":"",flat:"",dense:""}},[i("v-subheader",[t._v("Density")]),i("v-list-item-group",[i("v-list-item",{attrs:{ripple:!1}},[[i("v-list-item-action",[i("v-radio-group",{model:{value:t.displayOptions.isCompact,callback:function(e){t.$set(t.displayOptions,"isCompact",e)},expression:"displayOptions.isCompact"}},[i("v-radio",{attrs:{value:!1}})],1)],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Comfortable")]),i("v-list-item-subtitle",[t._v("More space between rows")])],1)]],2),i("v-list-item",{attrs:{ripple:!1}},[[i("v-list-item-action",[i("v-radio-group",{model:{value:t.displayOptions.isCompact,callback:function(e){t.$set(t.displayOptions,"isCompact",e)},expression:"displayOptions.isCompact"}},[i("v-radio",{attrs:{value:!0}})],1)],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Compact")]),i("v-list-item-subtitle",[t._v("Less space between rows")])],1)]],2)],1),i("v-divider"),i("v-list",{attrs:{subheader:"","two-line":"",flat:""}},[i("v-subheader",[t._v("Misc")]),i("v-list-item-group",[i("v-list-item",{attrs:{ripple:!1}},[i("v-list-item-action",[i("v-switch",{attrs:{dense:"",color:""},model:{value:t.displayOptions.showTags,callback:function(e){t.$set(t.displayOptions,"showTags",e)},expression:"displayOptions.showTags"}})],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Tags")]),i("v-list-item-subtitle",[t._v("Show tags")])],1)],1)],1),i("v-list-item-group",[i("v-list-item",{attrs:{ripple:!1}},[i("v-list-item-action",[i("v-switch",{attrs:{dense:""},model:{value:t.displayOptions.showEmojis,callback:function(e){t.$set(t.displayOptions,"showEmojis",e)},expression:"displayOptions.showEmojis"}})],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Emojis")]),i("v-list-item-subtitle",[t._v("Show emojis")])],1)],1)],1)],1)],1)],1)],1)],1),i("v-sheet",{staticClass:"pa-4"},[t.showHistogram?i("v-card",{staticClass:"pa-2",attrs:{outlined:""}},[i("ts-bar-chart",{attrs:{"chart-data":t.eventList.meta.count_over_time},on:{addChip:function(e){return t.addChipFromHistogram(e)}}})],1):t._e()],1),i("v-data-table",{attrs:{headers:t.headers,items:t.eventList.objects,"footer-props":{"items-per-page-options":[10,40,80,100,200,500],"show-current-page":!0},loading:t.searchInProgress,options:t.tableOptions,"server-items-length":t.totalHits,"item-key":"_id","loading-text":"Searching... Please wait","show-select":"","disable-filtering":"","disable-sort":"",expanded:t.expandedRows,dense:t.displayOptions.isCompact},on:{"update:options":function(e){t.tableOptions=e}},scopedSlots:t._u([{key:"top",fn:function(t){var e=t.pagination,n=t.options,s=t.updateOptions;return[i("v-data-footer",{attrs:{pagination:e,options:n,"show-current-page":!0,"items-per-page-options":[10,40,80,100,200,500]},on:{"update:options":s}})]}},{key:"expanded-item",fn:function(e){var n=e.headers,s=e.item;return[i("td",{attrs:{colspan:n.length}},[s.showDetails?i("v-container",{staticClass:"mt-4",attrs:{fluid:""}},[i("ts-event-detail",{attrs:{event:s}})],1):t._e(),s.showDetails&&s.deltaDays?i("v-divider"):t._e(),s.deltaDays>0?i("div",{staticClass:"ml-16"},[i("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color",style:t.getTimeBubbleColor(s)}),i("div",{staticClass:"ts-time-bubble ts-time-bubble-color",style:t.getTimeBubbleColor(s)},[i("h5",[i("b",[t._v(t._s(t._f("compactNumber")(s.deltaDays)))]),i("br"),t._v("days\n                  ")])]),i("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color",style:t.getTimeBubbleColor(s)})]):t._e()],1)]}},{key:"item._source.timestamp",fn:function(e){var n=e.item;return[i("div",{staticClass:"datetime-table-cell",style:t.getTimelineColor(n)},[t._v("\n              "+t._s(t._f("toISO8601")(t._f("formatTimestamp")(n._source.timestamp)))+"\n            ")])]}},{key:"item.actions",fn:function(e){e.item;return[i("v-btn",{attrs:{small:"",icon:""}},[i("v-icon",[t._v("mdi-star-outline")])],1),i("v-btn",{attrs:{small:"",icon:""}},[i("v-icon",[t._v("mdi-tag-plus-outline")])],1)]}},{key:"item._source.message",fn:function(e){var n=e.item;return[i("span",{staticClass:"ts-event-field-container",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.toggleDetailedEvent(n)}}},[i("span",{staticClass:"ts-event-field-ellipsis"},[t.displayOptions.showTags?i("span",t._l(n._source.tag,(function(e){return i("v-chip",{key:e,staticClass:"mr-2",attrs:{small:"",label:"",outlined:""}},[t._v(t._s(e))])})),1):t._e(),t.displayOptions.showEmojis?i("span",t._l(n._source.__ts_emojis,(function(e){return i("span",{key:e,staticClass:"mr-2",attrs:{title:t.meta.emojis[e]},domProps:{innerHTML:t._s(e)}},[t._v(t._s(e)+"\n                  ")])})),0):t._e(),i("span",[t._v(t._s(n._source.message))])])])]}},{key:"item.timeline_name",fn:function(e){var n=e.item;return[i("v-chip",{staticStyle:{"margin-top":"1px","margin-bottom":"1px","font-size":"0.9em"},attrs:{label:""}},[t._v(t._s(t.getTimeline(n).name))])]}},{key:"item._source.comment",fn:function(e){var n=e.item;return[n._source.comment.length?i("v-badge",{attrs:{"offset-y":16,bordered:"",content:n._source.comment.length}},[i("v-icon",{on:{click:function(e){return t.toggleDetailedEvent(n)}}},[t._v(" mdi-comment-text-multiple-outline ")])],1):t._e()]}}],null,!1,621870778),model:{value:t.selectedEvents,callback:function(e){t.selectedEvents=e},expression:"selectedEvents"}})],1)],1):t._e()],1)],1)},D=[],Q=(i("7514"),i("386d"),i("20d6"),i("f559"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return Object.keys(t.treeData).length>0?i("ul",{staticClass:"tree"},[i("tree-node",{attrs:{node:t.treeData,"handle-click":t.handleClick,"selected-node":t.selectedNode}})],1):t._e()}),N=[],L=(i("6762"),i("2fdb"),i("7618")),P=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",[i("span",{class:[{active:t.isSelected},{star:t.hasStar&&!t.isSelected},{dimmed:0===t.count&&!t.isSelected}],staticStyle:{"min-width":"205px"},attrs:{id:t.node.id},on:{click:function(e){return t.handleClick(t.node)}}},[t.hasStar?i("i",{staticClass:"fas fa-star",staticStyle:{float:"left",color:"#ffd700","-webkit-text-stroke-width":"1px","-webkit-text-stroke-color":"#777777","margin-right":"10px","margin-top":"3px"}}):t._e(),t.hasStar?i("v-icon",{staticStyle:{float:"left",color:"#333","margin-right":"10px"}},[t._v(" mdi-star ")]):t._e(),t.hasComment?i("v-icon",{staticStyle:{float:"left","margin-right":"10px"}},[t._v("mdi-comment")]):t._e(),t.hasLabel?i("v-icon",{staticClass:"fas fa-tag",staticStyle:{float:"left","margin-right":"10px"}},[t._v("mdi-label")]):t._e(),i("div",{staticClass:"query-string",class:[{"query-string-active":t.isSelected}],staticStyle:{float:"left"}},[t._v("\n      "+t._s(t.node.query_string)+"\n    ")]),i("div",{staticClass:"tag is-light",staticStyle:{"margin-left":"10px","margin-right":"-5px",float:"right"}},[t._v("\n      "+t._s(t._f("compactNumber")(t.count))+"\n    ")])],1),t.node.children&&t.node.children.length?i("ul",t._l(t.node.children,(function(e){return i("node",{key:e.id,attrs:{node:e,"handle-click":t.handleClick,"selected-node":t.selectedNode}})})),1):t._e()])},I=[],j={name:"node",props:{node:Object,handleClick:Function,selectedNode:Object},computed:{hasStar:function(){return this.node.labels.includes("__ts_star")},hasLabel:function(){return this.node.labels.includes("__ts_label")},hasComment:function(){return this.node.labels.includes("__ts_comment")},isSelected:function(){return this.selectedNode.id===this.node.id},count:function(){return this.node.query_result_count||0}}},A=j,q=(i("3884"),Object(c["a"])(A,P,I,!1,null,"1623aa42",null)),R=q.exports;function H(t,e,i){if(t.hasOwnProperty(e)&&!0===i(e,t[e]))return t;for(var n=0;n<Object.keys(t).length;n++){var s=t[Object.keys(t)[n]];if("object"===Object(L["a"])(s)&&null!=s){var r=H(s,e,i);if(null!=r)return r}}return null}var z={components:{TreeNode:R},data:function(){return{treeData:{},selectedNode:null,initialNode:null}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{handleClick:function(t){this.$emit("node-click",t),this.selectedNode=t},handleClickFromDropdown:function(t){var e;e="number"===typeof t?t:t.id;var i=H(this.treeData,"id",(function(t,i){return i===e}));this.$emit("node-click",i),this.selectedNode=i},createBranch:function(t){if(this.selectedNode){if(this.selectedNode.id===t.id)return;return this.selectedNode.children.push(t),void(this.selectedNode=t)}this.fetchHistory();var e=H(this.treeData,"id",(function(e,i){return i===t.parent}));if(e){if(e.children.some((function(e){return e.id===t.id})))return;return e.children.push(t),void(this.selectedNode=t)}var i=H(this.treeData,"id",(function(e,i){return i===t.id}));i&&(this.selectedNode=i)},annotateNode:function(t){t.searchNode.labels.includes(t.type)||t.searchNode.labels.push(t.type)},scrollTo:function(){this.$nextTick((function(){document.getElementById(this.selectedNode.id.toString()).scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}))},fetchHistory:function(){var t=this;S.getSearchHistoryTree(this.sketch.id).then((function(e){if(t.treeData=e.data.objects[0],!t.selectedNode){var i=e.data.meta["last_node_id"];t.selectedNode=H(t.treeData,"id",(function(t,e){return e===i}))}})).catch((function(t){}))}},beforeDestroy:function(){ki.$off("createBranch"),ki.$off("eventAnnotated"),ki.$off("triggerScrollTo"),ki.$off("selected-node-from-dropdown")},created:function(){ki.$on("createBranch",this.createBranch),ki.$on("eventAnnotated",this.annotateNode),ki.$on("triggerScrollTo",this.scrollTo),ki.$on("selected-node-from-dropdown",this.handleClickFromDropdown),this.fetchHistory()},watch:{selectedNode:function(){this.$store.dispatch("updateSearchNode",this.selectedNode),this.scrollTo()}}},M=z,B=Object(c["a"])(M,Q,N,!1,null,null,null),U=B.exports,Y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",[i("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("v-btn",t._g(t._b({attrs:{icon:"",disabled:!t.hasParent},on:{click:t.searchHistoryBack}},"v-btn",s,!1),n),[i("v-icon",[t._v("mdi-arrow-left")])],1)]}}])},[i("span",[t._v("Click to go back")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("v-btn",t._g(t._b({attrs:{icon:"",disabled:!t.hasChild},on:{click:t.searchHistoryForward}},"v-btn",s,!1),n),[i("v-icon",[t._v("mdi-arrow-right")])],1)]}}])},[i("span",[t._v("Click to go forward")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("v-btn",t._g(t._b({attrs:{icon:""},on:{click:function(e){return t.$emit("toggleSearchHistory")}}},"v-btn",s,!1),n),[i("v-icon",[t._v("mdi-history")])],1)]}}])},[i("span",[t._v("Click to see your search history")])])],1)},V=[],G={computed:{currentSearchNode:function(){return this.$store.state.currentSearchNode},hasParent:function(){return!!this.currentSearchNode&&"number"===typeof this.currentSearchNode.parent},hasChild:function(){return!!this.currentSearchNode&&this.currentSearchNode.children.length}},methods:{searchHistoryBack:function(){ki.$emit("selected-node-from-dropdown",this.currentSearchNode.parent)},searchHistoryForward:function(){if(this.currentSearchNode.children.length){var t=this.currentSearchNode.children.slice(-1).pop();ki.$emit("selected-node-from-dropdown",t)}}}},J=G,W=(i("35fd"),Object(c["a"])(J,Y,V,!1,null,"6d090d22",null)),K=W.exports,X=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",{staticStyle:{overflow:"hidden"},attrs:{outlined:"",height:"550"}},[i("v-toolbar",{attrs:{flat:""}},[i("v-tabs",{attrs:{grow:"",left:""},model:{value:t.searchDropdownTab,callback:function(e){t.searchDropdownTab=e},expression:"searchDropdownTab"}},[i("v-tab",[t._v(" Quick ")]),i("v-tab",[t._v(" Search Templates ")]),i("v-tab",[t._v(" Sigma ")])],1)],1),i("v-tabs-items",{model:{value:t.searchDropdownTab,callback:function(e){t.searchDropdownTab=e},expression:"searchDropdownTab"}},[i("v-tab-item",{attrs:{transition:!1}},[i("v-container",{staticClass:"ma-0",attrs:{fluid:""}},[i("v-row",[i("v-col",{attrs:{cols:"4"}},[i("h5",{staticClass:"mt-3 ml-4"},[t._v("Data types")]),i("v-list",{staticClass:"overflow-y-auto",class:t.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},t._l(t.matches.dataTypes,(function(e){return i("v-list-item",{key:e.data_type,staticStyle:{"font-size":"0.9em"},on:{click:function(i){return t.searchForDataType(e.data_type)}}},[i("v-list-item-content",[i("span",[t._v(t._s(e.data_type)+"\n                    "),i("span",{staticClass:"font-weight-bold",staticStyle:{"font-size":"0.8em"}},[t._v("("+t._s(t._f("compactNumber")(e.count))+")")])])])],1)})),1)],1),i("v-divider",{attrs:{vertical:""}}),i("v-col",{attrs:{cols:"4"}},[i("h5",{staticClass:"mt-3 ml-5"},[t._v("Tags")]),i("v-list",{staticClass:"overflow-y-auto",class:t.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},[t._l(t.matches.labels,(function(e){return i("v-list-item",{key:e.label,staticStyle:{"font-size":"0.9em"},on:{click:function(i){return t.searchForLabel(e.label)}}},["__ts_star"===e.label?i("v-icon",{attrs:{left:"",small:"",color:"#FFC300"}},[t._v("mdi-star")]):t._e(),"__ts_comment"===e.label?i("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-comment-multiple-outline")]):t._e(),i("v-list-item-content",[i("span",[t._v(t._s(t._f("formatLabelText")(e.label))+"\n                    "),i("span",{staticClass:"font-weight-bold",staticStyle:{"font-size":"0.8em"}},[t._v("("+t._s(t._f("compactNumber")(e.count))+")")])])])],1)})),t._l(t.matches.tags,(function(e){return i("v-list-item",{key:e.tag,staticStyle:{"font-size":"0.9em"},on:{click:function(i){return t.searchForTag(e.tag)}}},[i("v-list-item-content",[i("span",[t._v(t._s(e.tag)+"\n                    "),i("span",{staticClass:"font-weight-bold",staticStyle:{"font-size":"0.8em"}},[t._v("("+t._s(t._f("compactNumber")(e.count))+")")])])])],1)}))],2)],1),i("v-divider",{attrs:{vertical:""}}),t.matches.savedSearches.length?i("v-col",{attrs:{cols:"4"}},[i("h5",{staticClass:"mt-3 ml-4"},[t._v("Saved searches")]),i("v-list",{staticClass:"overflow-y-auto",class:t.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},t._l(t.matches.savedSearches,(function(e){return i("v-list-item",{key:e.id,staticStyle:{"font-size":"0.9em"},on:{click:function(i){return t.$emit("setActiveView",e)}}},[i("v-list-item-content",[t._v("\n                  "+t._s(e.name)+"\n                ")])],1)})),1)],1):t._e()],1)],1)],1)],1)],1)},Z=[],tt=(i("8615"),function(){return{from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]}}),et={props:["selectedLabels","queryString"],data:function(){return{searchDropdownTab:null}},computed:{meta:function(){return this.$store.state.meta},searchHistory:function(){return this.$store.state.searchHistory},tags:function(){return this.$store.state.tags},dataTypes:function(){return this.$store.state.dataTypes},all:function(){return{fields:this.meta.mappings,tags:this.tags,labels:this.meta.filter_labels,dataTypes:this.dataTypes,savedSearches:this.meta.views}},scrollbarTheme:function(){return this.$vuetify.theme.dark?"dark":"light"},matches:function(){var t=this,e={};return this.queryString?(e["fields"]=this.meta.mappings.filter((function(e){return e.field.toLowerCase().includes(t.queryString.toLowerCase())})),e["tags"]=this.tags.filter((function(e){return e.tag.toLowerCase().includes(t.queryString.toLowerCase())})),e["labels"]=this.meta.filter_labels.filter((function(e){return e.label.toLowerCase().includes(t.queryString.toLowerCase())})),e["dataTypes"]=this.dataTypes.filter((function(e){return e.data_type.toLowerCase().includes(t.queryString.toLowerCase())})),e["savedSearches"]=this.meta.views.filter((function(e){return e.name.toLowerCase().includes(t.queryString.toLowerCase())})),Object.values(e).filter((function(t){return t.length})).length?e:this.all):this.all}},methods:{searchForLabel:function(t){var e={doSearch:!0,queryString:"*"};e.queryFilter=tt();var i={field:"",value:t,type:"label",operator:"must",active:!0};e.queryFilter.chips.push(i),this.$emit("setQueryAndFilter",e)},searchForTag:function(t){var e={doSearch:!0};e.queryString="tag:"+t,e.queryFilter=tt(),this.$emit("setQueryAndFilter",e)},searchForDataType:function(t){var e={doSearch:!0};e.queryString='data_type:"'+t+'"',e.queryFilter=tt(),this.$emit("setQueryAndFilter",e)},searchForField:function(t){var e={},i="";""!==this.queryString&&(i=this.queryString+" "),this.queryString.includes(" ")||(i=""),e.doSearch=!1,e.queryString=i+t+":",e.queryFilter=tt(),this.$emit("setQueryAndFilter",e)}}},it=et,nt=(i("32d8"),Object(c["a"])(it,X,Z,!1,null,"00606c8e",null)),st=nt.exports,rt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("apexchart",{attrs:{height:"250",options:t.options,series:t.series}})],1)},at=[],ot=(i("28a5"),i("ffc1"),i("1321")),ct=i.n(ot),lt={props:["chartData"],components:{Apexchart:ct.a},data:function(){var t=this;return{options:{chart:{type:"bar",zoom:{enabled:!0,type:"x",autoScaleYaxis:!0},foreColor:"#fff",animations:{enabled:!0,easing:"easeinout",speed:50,animateGradually:{enabled:!0,delay:50},dynamicAnimation:{enabled:!0,speed:50}},colors:["#4285f"],toolbar:{show:!0,tools:{download:!1,selection:!0,zoom:!0,zoomin:!0,zoomout:!0}},events:{dataPointSelection:function(e,i,n){t.emitFilterRequest(n)}}},tooltip:{enabled:!0,followCursor:!1,theme:"dark",x:{formatter:function(e){var i=t.getBucketDateTimeRange(e),n=t.$moment.duration(i.start.diff(i.end));return"".concat(i.start.format("YYYY-MM-DD HH:mm:ss")," + ").concat(n.humanize())}}},plotOptions:{bar:{columnWidth:"95%",borderRadius:4}},dataLabels:{enabled:!1},grid:{xaxis:{lines:{show:!1}},yaxis:{lines:{show:!1}}},xaxis:{type:"datetime",tickPlacement:"on"}}}},computed:{series:function(){var t={name:"Events",data:[]};return this.chartData?(t.data=Object.entries(this.chartData.data).map((function(t){return[parseInt(t[0]),t[1]]})),[t]):[t]}},methods:{getBucketDateTimeRange:function(t){var e=this.$moment.utc(t),i=this.chartData.interval.split(/(\d+)/),n=i[1],s=i[2],r=this.$moment.utc(t).add(parseInt(n),s);return{start:e,end:r}},emitFilterRequest:function(t){var e=t.selectedDataPoints[0][0],i=t.w.config.series[0]["data"];if(1!==i.length){var n=i[e][0],s=this.getBucketDateTimeRange(n),r={field:"",type:"datetime_range",value:s.start.toISOString()+","+s.end.toISOString(),operator:"must",active:!0};this.$emit("addChip",r)}},setTheme:function(){"dark"===localStorage.theme?this.options={chart:{foreColor:"#fff"},tooltip:{theme:"dark"}}:this.options={chart:{foreColor:"#333"},tooltip:{theme:"light"}}}},created:function(){ki.$on("isDarkTheme",this.setTheme)},mounted:function(){this.setTheme()}},ut=lt,dt=Object(c["a"])(ut,rt,at,!1,null,null,null),ht=dt.exports,mt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-chip-group",t._l(t.activeTimelines,(function(e){return i("ts-timeline-chip",{key:e.id+e.name,attrs:{timeline:e,"is-selected":t.isSelected(e),"is-empty-state":t.isEmptyState,"events-count":t.getCount(e)},on:{remove:t.remove,save:t.save,toggle:t.toggleTimeline}})})),1)},vt=[],ft=(i("55dd"),i("75fc")),pt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-menu",{attrs:{"offset-y":"","content-class":"menu-with-gap"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[i("v-chip",t._g({style:t.getTimelineStyle(t.timeline)},n),[t._v("\n      "+t._s(t.timeline.name)+"\n      "),i("v-avatar",{staticStyle:{"background-color":"rgba(0, 0, 0, 0.1)","font-size":"0.55em"},attrs:{right:""}},[t._v("\n        "+t._s(t._f("compactNumber")(t.eventsCount))+"\n      ")])],1)]}}])},[i("v-card",{attrs:{width:"300"}},[i("v-list",[i("v-list-item",[i("v-list-item-action",[i("v-icon",[t._v("mdi-square-edit-outline")])],1),i("v-list-item-subtitle",[t._v("Rename timeline")])],1),i("v-list-item",{on:{click:function(e){return t.toggleTimeline(t.timeline)}}},[i("v-list-item-action",[t.isSelected?i("v-icon",[t._v("mdi-eye-off")]):i("v-icon",[t._v("mdi-eye")])],1),t.isSelected?i("v-list-item-subtitle",[t._v("Temporarily disabled")]):i("v-list-item-subtitle",[t._v("Re-enable")])],1)],1)],1)],1)},gt=[],_t=i("2ef0"),yt=i.n(_t),bt={props:["timeline","eventsCount","isSelected","isEmptyState"],data:function(){return{initialColor:{},newColor:"",newTimelineName:"",timelineStatus:"",colorPickerActive:!1,showInfoModal:!1,showEditModal:!1,showAnalyzerModal:!1,isDarkTheme:!1}},computed:{meta:function(){return this.$store.state.meta},datasourceErrors:function(){return this.timeline.datasources.filter((function(t){return t.error_message}))}},methods:{showColorPicker:function(){this.$refs.colorPicker.click()},rename:function(){this.showEditModal=!1,this.$emit("save",this.timeline,this.newTimelineName)},remove:function(){confirm("Delete the timeline?")&&this.$emit("remove",this.timeline)},updateColor:yt.a.debounce((function(t){this.newColor=t.hex,this.newColor.startsWith("#")&&(this.newColor=this.newColor.substring(1)),n["default"].set(this.timeline,"color",this.newColor),this.$emit("save",this.timeline)}),0),toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme},getTimelineStyle:function(t){var e=t.color,i="none",n="100%";return e.startsWith("#")||(e="#"+e),this.isSelected||(e="#d2d2d2",i="line-through",n="50%"),this.$vuetify.theme.dark?{"background-color":e,filter:"grayscale(25%)",color:"#333"}:{"background-color":e,"text-decoration":i,opacity:n}},toggleTimeline:function(t){this.$emit("toggle",t)}},mounted:function(){var t=this;window.addEventListener("click",(function(e){t.$el.contains(e.target)||(t.colorPickerActive=!1)}))},created:function(){this.isDarkTheme="dark"===localStorage.theme,ki.$on("isDarkTheme",this.toggleTheme),this.initialColor={hex:this.timeline.color},this.timelineStatus=this.timeline.status[0].status,this.newTimelineName=this.timeline.name},beforeDestroy:function(){clearInterval(this.t),this.t=!1}},St=bt,kt=Object(c["a"])(St,pt,gt,!1,null,"1c36dfc4",null),wt=kt.exports,xt={components:{TsTimelineChip:wt},props:["currentQueryFilter","countPerIndex","countPerTimeline"],computed:{sketch:function(){return this.$store.state.sketch},activeTimelines:function(){var t=Object(ft["a"])(this.sketch.active_timelines);return t.sort((function(t,e){return t.name.localeCompare(e.name)}))},isEmptyState:function(){return void 0===this.countPerTimeline}},data:function(){return{isDarkTheme:!1,isLoading:!1,selectedTimelines:[]}},methods:{isSelected:function(t){return this.selectedTimelines.includes(t)},getCount:function(t){var e=0;return this.countPerTimeline&&(e=this.countPerTimeline[t.id],"number"===typeof e)||!e&&this.countPerIndex&&(e=this.countPerIndex[t.searchindex.index_name]),e},remove:function(t){var e=this;this.isLoading=!0,S.deleteSketchTimeline(this.sketch.id,t.id).then((function(){e.$store.dispatch("updateSketch",e.sketch.id).then((function(){e.syncSelectedTimelines(),e.isLoading=!1}))})).catch((function(t){console.error(t),e.isLoading=!1}))},save:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i&&(this.isLoading=!0),S.saveSketchTimeline(this.sketch.id,t.id,i||t.name,t.description,t.color).then((function(){e.$store.dispatch("updateSketch",e.sketch.id).then((function(){e.syncSelectedTimelines(),e.isLoading=!1}))})).catch((function(t){console.error(t),e.isLoading=!1}))},enableAllTimelines:function(){this.selectedTimelines=this.activeTimelines,this.$emit("updateSelectedTimelines",this.selectedTimelines)},disableAllTimelines:function(){this.selectedTimelines=[],this.$emit("updateSelectedTimelines",this.selectedTimelines)},toggleTimeline:function(t){var e=this.selectedTimelines.slice(),i=e.indexOf(t);-1===i?e.push(t):e.splice(i,1),this.selectedTimelines=e,this.$emit("updateSelectedTimelines",this.selectedTimelines)},toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme},syncSelectedTimelines:function(){var t=this;if(this.currentQueryFilter.indices.includes("_all"))this.selectedTimelines=this.activeTimelines;else{var e=[];this.currentQueryFilter.indices.forEach((function(i){if("string"===typeof i){var n=t.activeTimelines.find((function(t){return t.searchindex.index_name===i}));e.push(n)}else if("number"===typeof i){var s=t.activeTimelines.find((function(t){return t.id===i}));e.push(s)}})),this.selectedTimelines=e}}},created:function(){ki.$on("isDarkTheme",this.toggleTheme),ki.$on("clearSearch",this.enableAllTimelines),this.currentQueryFilter.indices.includes("_all")?this.selectedTimelines=this.activeTimelines:this.syncSelectedTimelines()},watch:{"currentQueryFilter.indices":function(t){this.syncSelectedTimelines()},deep:!0}},Tt=xt,Ct=Object(c["a"])(Tt,mt,vt,!1,null,null,null),Et=Ct.exports,$t=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",{staticStyle:{overflow:"visible"},attrs:{width:"700"}},[i("v-container",{staticClass:"px-8"},[i("br"),i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(0,"days")}}},[t._v("Today")]),i("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(7,"days")}}},[t._v("Last 7 days")]),i("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(30,"days")}}},[t._v("Last 30 days")]),i("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(90,"days")}}},[t._v("Last 90 days")]),i("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(e){return t.getDateRange(1,"year")}}},[t._v("Last 1 year")])],1)],1),i("v-row",[i("v-col",{attrs:{cols:"6"}},[i("v-text-field",{attrs:{value:t.formatStartTime,label:"From",outlined:"","hide-details":""},on:{click:function(e){t.showPicker=!0},change:t.setStartTime}})],1),i("v-col",{attrs:{cols:"6"}},[i("v-text-field",{attrs:{value:t.formatEndTime,label:"To (optional)",outlined:"","hide-details":"","append-outer-icon":t.showPicker?"mdi-calendar-remove":"mdi-calendar"},on:{click:function(e){t.showPicker=!0},change:t.setEndTime,"click:append-outer":function(e){t.showPicker=!t.showPicker}}})],1)],1),t.showPicker?i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("date-picker",{ref:"picker",attrs:{mode:"dateTime",timezone:"UTC","is-dark":t.$vuetify.theme.dark,is24hr:"","is-range":"","is-expanded":""},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)],1):t._e(),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{text:"",color:"primary"},on:{click:t.clearAndCancel}},[t._v(" Cancel ")]),i("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.submit()}}},[t._v(" Add filter ")])],1)],1)],1)},Ft=[],Ot=i("707c"),Dt=i("404b"),Qt=i.n(Dt),Nt={components:{DatePicker:Qt.a},data:function(){return{range:{start:"",end:""},filterTab:null,showPicker:!1}},computed:{dateRange:{set:function(t){this.range.start=Ot["a"].utc(t.start).millisecond(0).toISOString(),this.range.end=Ot["a"].utc(t.end).millisecond(0).toISOString()},get:function(){var t={start:this.range.start,end:this.range.end};return t}},formatStartTime:function(){return this.range.start},formatEndTime:function(){return this.range.start!==this.range.end&&this.range.start?this.range.end:""}},methods:{getDateRange:function(t,e){var i=Ot["a"].utc(),n=i.subtract(t,e),s="datetime_range",r=n.format("YYYY-MM-DD")+","+i.format("YYYY-MM-DD");return this.chip={field:"",type:s,value:r,operator:"must",active:!0},this.$emit("addChip",this.chip),this.$emit("cancel"),{start:i,end:n}},setStartTime:function(t){t?(this.range.start=Ot["a"].utc(t).toISOString(),this.range.end||this.range.start&&(this.range.end=this.range.start||""),this.$refs.picker.focusDate(this.range.start)):this.range.start=""},setEndTime:function(t){t?(this.range.end=Ot["a"].utc(t).toISOString(),this.$refs.picker.focusDate(this.range.start)):this.range.end=""},addDateTimeChip:function(t){var e="datetime_range",i={field:"",type:e,value:t,operator:"must",active:!0};this.$emit("addChip",i),this.range={start:null,end:null}},clearAndCancel:function(){this.range={start:"",end:""},this.$emit("cancel")},submit:function(){if(this.range.start){if(this.range.start===this.range.end){var t=this.range.start.split("T"),e=t[0],i=e+","+e;this.addDateTimeChip(i)}if(this.range.start,this.range.end,this.range.start!==this.range.end){var n="datetime_range",s=this.range.start+","+this.range.end;this.chip={field:"",type:n,value:s,operator:"must",active:!0},this.$emit("addChip",this.chip),this.range={start:"",end:""}}this.$emit("cancel")}}}},Lt=Nt,Pt=Object(c["a"])(Lt,$t,Ft,!1,null,"6a06fd4e",null),It=Pt.exports,jt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("v-toolbar",{attrs:{flat:""}},[i("v-toolbar-title",{staticStyle:{"font-size":"1em"}},[t._v(t._s(t.scenario.display_name))]),i("v-spacer"),t.minimizePanel?i("v-icon",{staticStyle:{"margin-left":"-5px"},on:{click:function(e){return t.$emit("togglePanel")}}},[t._v("mdi-chevron-right")]):i("v-icon",{on:{click:function(e){return t.$emit("togglePanel")}}},[t._v("mdi-chevron-left")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.minimizePanel,expression:"!minimizePanel"}],staticClass:"mt-3"},[t._l(t.scenario.facets,(function(t){return i("div",{key:t.id},[i("ts-facet",{staticClass:"mt-3",attrs:{facet:t}})],1)})),i("v-btn",{staticClass:"ml-1 mt-3",attrs:{disabled:"",small:"",text:"",color:"primary"}},[t._v("+ Facet")])],2)],1)},At=[],qt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("v-row",{class:t.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer"},on:{click:function(e){t.expanded=!t.expanded}}},[i("v-col",{attrs:{cols:"1"}},[t.expanded?i("v-icon",{staticClass:"ml-2"},[t._v("mdi-chevron-down")]):i("v-icon",{staticClass:"ml-2"},[t._v("mdi-chevron-right")])],1),i("v-col",{attrs:{cols:"9"}},[i("span",{staticStyle:{"font-size":"0.9em"}},[t._v(t._s(t.facet.display_name))])]),i("v-col",{attrs:{cols:"2"}},[i("v-chip",{attrs:{outlined:"",small:""}},[t._v(" 0/"+t._s(t.facet.questions.length)+" ")])],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},[i("v-divider",{staticClass:"mt-3"}),t._l(t.facet.questions,(function(t){return i("span",{key:t.id,staticStyle:{"font-size":"0.9em"}},[i("ts-question",{attrs:{question:t}})],1)}))],2),i("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],staticClass:"ml-1 mt-3 mb-2",attrs:{disabled:"",small:"",text:"",color:"primary"}},[t._v("+ Question")]),i("v-divider",{staticClass:"mt-3"})],1)},Rt=[],Ht=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{class:t.highlightColor},[i("div",{staticClass:"pa-2 pl-4",staticStyle:{cursor:"pointer"},on:{click:function(e){t.expanded=!t.expanded}}},[i("v-menu",{attrs:{"open-on-hover":"","offset-y":"","open-delay":1e3,"close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("span",t._g(t._b({staticStyle:{"font-size":"0.9em"}},"span",s,!1),n),[t._v(t._s(t.question.display_name))])]}}])},[i("v-card",{staticClass:"pa-3",staticStyle:{"font-size":"0.9em"},attrs:{width:"400"}},[t._v("\n          "+t._s(t.question.description)+"\n        ")])],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}]},[i("div",{staticClass:"pa-4",staticStyle:{"font-size":"0.9em"}},[i("v-textarea",{attrs:{disabled:"",outlined:"",flat:"","hide-details":"","auto-grow":"",rows:"3"},scopedSlots:t._u([{key:"prepend-inner",fn:function(){return[i("v-avatar",{staticClass:"mt-n1",attrs:{color:"grey",size:"28"}})]},proxy:!0}])}),i("v-card-actions",{staticClass:"pl-0"},[i("v-btn",{attrs:{disabled:"","x-small":"",outlined:"",color:"primary"}},[t._v(" Yes ")]),i("v-btn",{attrs:{disabled:"","x-small":"",outlined:"",color:"primary"}},[t._v(" No ")]),i("v-btn",{attrs:{disabled:"","x-small":"",outlined:"",color:"primary"}},[t._v(" Inconclusive ")])],1)],1)]),i("v-divider")],1)])},zt=[],Mt={props:["question"],data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch},highlightColor:function(){if(this.expanded)return this.$vuetify.theme.dark?"dark-highlight":"light-highlight"}},methods:{},created:function(){}},Bt=Mt,Ut=(i("1a74"),Object(c["a"])(Bt,Ht,zt,!1,null,"03174f32",null)),Yt=Ut.exports,Vt={props:["facet"],components:{TsQuestion:Yt},data:function(){return{expanded:!1}},computed:{sketch:function(){return this.$store.state.sketch}},methods:{},created:function(){}},Gt=Vt,Jt=Object(c["a"])(Gt,qt,Rt,!1,null,null,null),Wt=Jt.exports,Kt={props:["scenario","minimizePanel"],components:{TsFacet:Wt},data:function(){return{activeQuestion:{},selectedItem:null}},computed:{sketch:function(){return this.$store.state.sketch},activeQuestionSpec:function(){return JSON.parse(this.activeQuestion.spec_json)}},methods:{addScenario:function(){S.addScenario(this.sketch.id,"compromise_assessment").then((function(t){})).catch((function(t){}))},setActiveQuestion:function(t){this.activeQuestion=t},resetActiveQuestion:function(){this.selectedItem=null,this.activeQuestion={}}}},Xt=Kt,Zt=Object(c["a"])(Xt,jt,At,!1,null,"2b3415b8",null),te=Zt.exports,ee=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("v-row",[i("v-col",{attrs:{cols:"8"}},[i("v-card",{attrs:{outlined:"",height:"100%"}},[i("v-simple-table",{attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[i("thead",[i("tr",[i("th",{staticClass:"text-left"},[t._v("Attribute")]),i("th",{staticClass:"text-left"},[t._v("Value")])])]),i("tbody",t._l(t.fullEventFiltered,(function(e,n){return i("tr",{key:n},[i("td",[t._v(t._s(n))]),i("td",[t._v(t._s(e))])])})),0)]},proxy:!0}])})],1)],1),i("v-col",{attrs:{cols:"4"}},[i("v-card",{attrs:{outlined:""}},[i("v-toolbar",{attrs:{dense:"",flat:""}},[i("v-toolbar-title",{staticStyle:{"font-size":"1.2em"}},[t._v("Comments")])],1),i("v-list",{attrs:{"three-line":""}},t._l(t.comments,(function(e,n){return i("v-list-item",{key:e.id,on:{mouseover:function(i){return t.selectComment(e)},mouseleave:function(e){return t.unSelectComment()}}},[i("v-list-item-avatar",[i("v-avatar",{attrs:{color:"orange"}},[i("span",{staticClass:"white--text"},[t._v(t._s(e.user.username.charAt(0).toUpperCase()))])])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("\n                "+t._s(e.user.username)+"\n              ")]),i("v-list-item-subtitle",[t._v("\n                "+t._s(t._f("shortDateTime")(e.created_at))+" ("+t._s(t._f("timeSince")(e.created_at))+")\n              ")]),e.editable?i("v-card",{staticClass:"mt-5",attrs:{flat:""}},[i("v-textarea",{attrs:{"hide-details":"","auto-grow":"",filled:""},model:{value:t.comments[n].comment,callback:function(e){t.$set(t.comments[n],"comment",e)},expression:"comments[index].comment"}}),e.editable?i("v-card-actions",[i("v-spacer"),e.editable?i("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.editComment(n,!1)}}},[t._v("\n                    Cancel\n                  ")]):t._e(),i("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(i){return t.updateComment(e,n)}}},[t._v(" Save ")])],1):t._e()],1):i("p",{staticClass:"body-2",staticStyle:{"max-width":"90%"}},[t._v(t._s(e.comment))])],1),e===t.selectedComment&&t.meta.permissions.write&&t.currentUser==e.user.username?i("v-list-item-action",{staticStyle:{position:"absolute",right:"0"}},[i("v-chip",{staticStyle:{"margin-right":"10px"},attrs:{outlined:""}},[i("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){return t.editComment(n)}}},[i("v-icon",{attrs:{small:""}},[t._v("mdi-square-edit-outline")])],1),i("v-btn",{attrs:{icon:"",small:""},on:{click:function(i){return t.deleteComment(e.id,n)}}},[i("v-icon",{attrs:{small:""}},[t._v("mdi-trash-can-outline")])],1)],1)],1):t._e()],1)})),1),t.meta.permissions.write?i("v-card-actions",[i("v-textarea",{staticClass:"mx-2 mb-2",attrs:{"hide-details":"","auto-grow":"",filled:"",label:"Add comment",rows:"1"},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),i("v-btn",{attrs:{icon:""},on:{click:t.postComment}},[i("v-icon",[t._v("mdi-send")])],1)],1):t._e()],1)],1)],1),i("br")],1)},ie=[],ne={props:["event"],data:function(){return{fullEvent:{},comment:"",comments:[],selectedComment:null}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},currentUser:function(){return this.$store.state.currentUser},currentSearchNode:function(){return this.$store.state.currentSearchNode},fullEventFiltered:function(){var t=this;return Object.getOwnPropertyNames(this.fullEvent).forEach((function(e){e.startsWith("__ts")&&delete t.fullEvent[e]})),this.fullEvent}},methods:{getEvent:function(){var t=this,e=this.event._index,i=this.event._id;S.getEvent(this.sketch.id,e,i).then((function(e){t.fullEvent=e.data.objects,t.comments=e.data.meta.comments})).catch((function(t){}))},postComment:function(){var t=this;ki.$emit("eventAnnotated",{type:"__ts_comment",event:this.event,searchNode:this.currentSearchNode}),S.saveEventAnnotation(this.sketch.id,"comment",this.comment,[this.event],this.currentSearchNode).then((function(e){t.comments.push(e.data.objects[0][0]),t.comment=""})).catch((function(t){}))},updateComment:function(t,e){var i=this;S.updateEventAnnotation(this.sketch.id,"comment",t,[this.event],this.currentSearchNode).then((function(n){i.comments.splice(e,1,t),t.editable=!1})).catch((function(t){console.error(t)}))},deleteComment:function(t,e){var i=this;confirm("Are you sure?")&&S.deleteEventAnnotation(this.sketch.id,"comment",t,this.event,this.currentSearchNode).then((function(t){i.comments.splice(e,1)})).catch((function(t){console.error(t)}))},editComment:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.comments[t];i.editable=e,this.comments.splice(t,1,i)},selectComment:function(t){this.selectedComment=t},unSelectComment:function(){this.selectedComment=!1}},created:function(){this.getEvent()}},se=ne,re=(i("c3ca"),Object(c["a"])(se,ee,ie,!1,null,null,null)),ae=re.exports,oe=i("e1a1"),ce=i("34f3"),le=function(){return{from:0,terminate_after:40,size:40,indices:[],order:"asc",chips:[]}},ue=function(){return{meta:{count_per_index:{}},objects:[]}},de={directives:{dragscroll:ce["a"]},components:{TsSearchHistoryTree:U,TsSearchHistoryButtons:K,TsSearchDropdown:st,TsBarChart:ht,TsTimelinePicker:Et,TsFilterMenu:It,TsScenario:te,TsEventDetail:ae},props:["sketchId"],data:function(){return{headers:[{text:"",value:"data-table-select"},{text:"Datetime (UTC)",align:"start",value:"_source.timestamp",width:"230"},{value:"actions",width:"90"},{text:"Message",align:"start",value:"_source.message",width:"100%"},{value:"_source.comment",align:"end"},{value:"timeline_name",align:"end"}],tableOptions:{itemsPerPage:40},currentItemsPerPage:40,drawer:!1,leftDrawer:!0,expandedRows:[],timeFilterMenu:!1,saveSearchMenu:!1,saveSearchFormName:"",fromSavedSearch:!1,params:{},showCreateViewModal:!1,showFilterCard:!0,showSearch:!0,searchInProgress:!1,currentPage:1,contextEvent:!1,originalContext:!1,isFullPage:!0,loadingComponent:null,showSearchDropdown:!1,eventList:{meta:{},objects:[]},currentQueryString:"",currentQueryFilter:le(),selectedFields:[{field:"message",type:"text"}],selectedFieldsProxy:[],expandFieldDropdown:!1,selectedEvents:[],displayOptions:{isCompact:!1,showTags:!0,showEmojis:!0,showMillis:!1},selectedLabels:[],showSearchHistory:!1,showHistogram:!1,branchParent:oe["a"],zoomLevel:.7,zoomOrigin:{x:0,y:0},minimizeRightSidePanel:!1,sidePanelTab:null}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},scenario:function(){return this.$store.state.scenario},totalHits:function(){return this.eventList.meta.es_total_count_complete||0},totalTime:function(){return this.eventList.meta.es_time/1e3||0},fromEvent:function(){return this.currentQueryFilter.from||1},toEvent:function(){if(!(this.totalHits<this.currentQueryFilter.size))return parseInt(this.currentQueryFilter.from)+parseInt(this.currentQueryFilter.size)},numSelectedEvents:function(){return this.selectedEvents.length},filterChips:function(){return this.currentQueryFilter.chips.filter((function(t){return"label"===t.type||"term"===t.type}))},timeFilterChips:function(){return this.currentQueryFilter.chips.filter((function(t){return t.type.startsWith("datetime")}))},filteredLabels:function(){return this.$store.state.meta.filter_labels.filter((function(t){return!t.label.startsWith("__")}))},currentSearchNode:function(){return this.$store.state.currentSearchNode},rightSidePanelWidth:function(){var t="430";return this.minimizeRightSidePanel&&(t="50"),t}},methods:{toggleSearchHistory:function(){this.showSearchHistory=!this.showSearchHistory,this.showSearchHistory&&this.triggerScrollTo()},toggleDetailedEvent:function(t){var e=this.expandedRows.findIndex((function(e){return e._id===t._id}));if(this.expandedRows.some((function(e){return e._id===t._id}))){if(!t.showDetails)return t["showDetails"]=!0,this.expandedRows.splice(e,1),void this.expandedRows.push(t);t["showDetails"]=!1,this.expandedRows.splice(e,1),t.deltaDays&&(this.expandedRows.splice(e,1),this.expandedRows.push(t))}else t["showDetails"]=!0,this.expandedRows.push(t)},addTimeBubbles:function(){var t=this;this.expandedRows=[],this.eventList.objects.forEach((function(e,i){if(!(i<1)){var n=t.eventList.objects[i-1],s=t.$options.filters.formatTimestamp(e._source.timestamp),r=t.$options.filters.formatTimestamp(n._source.timestamp),a=Math.floor(s/1e3),o=Math.floor(r/1e3),c=Math.floor(a-o);"desc"===t.order&&(c=Math.floor(o-a));var l=Math.floor(c/60/60/24);l>0&&(n["deltaDays"]=l,t.expandedRows.push(n))}}))},getTimeline:function(t){var e,i=this.meta.indices_metadata[t._index].is_legacy;return e=i?this.sketch.active_timelines.filter((function(e){return e.searchindex.index_name===t._index}))[0]:this.sketch.active_timelines.filter((function(e){return e.id===t._source.__ts_timeline_id}))[0],e},getTimelineColor:function(t){var e=this.getTimeline(t),i=e.color;return i.startsWith("#")||(i="#"+i),this.$vuetify.theme.dark?{"background-color":i,filter:"grayscale(25%)",color:"#333"}:{"background-color":i}},getTimeBubbleColor:function(){var t="#f5f5f5";return this.$vuetify.theme.dark&&(t="#333"),{"background-color":t}},search:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.fromSavedSearch?this.fromSavedSearch=!1:this.$router.push(this.$route.path),this.currentQueryString){this.searchInProgress=!0,this.contextEvent&&this.$scrollTo("#context",200,{offset:-300}),this.selectedEvents=[],this.eventList=ue(),i&&(this.currentQueryFilter.from=0),this.currentQueryFilter.fields=this.selectedFields;var r={query:this.currentQueryString,filter:this.currentQueryFilter};n&&(r["incognito"]=!0),s&&(r["parent"]=s),s&&n&&(this.branchParent=s),this.branchParent&&(r["parent"]=this.branchParent),e&&(ki.$emit("newSearch"),this.showSearchDropdown=!1),S.search(this.sketchId,r).then((function(e){t.eventList.objects=e.data.objects,t.eventList.meta=e.data.meta,t.searchInProgress=!1,t.addTimeBubbles(),n||(ki.$emit("createBranch",t.eventList.meta.search_node),t.$store.dispatch("updateSearchHistory"),t.branchParent=t.eventList.meta.search_node.id)})).catch((function(t){}))}},setQueryAndFilter:function(t){this.currentQueryString=t.queryString,this.currentQueryFilter=t.queryFilter,this.currentQueryFilter.size=this.currentItemsPerPage,this.currentQueryFilter.terminate_after=this.currentItemsPerPage,t.doSearch&&this.search()},exportSearchResult:function(){var t=this,e={query:this.currentQueryString,filter:this.currentQueryFilter,file_name:"export.zip"};S.exportSearchResult(this.sketchId,e).then((function(e){var i=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a"),s="export.zip";n.href=i,n.setAttribute("download",s),document.body.appendChild(n),n.click(),t.loadingClose()})).catch((function(t){console.error(t)}))},searchView:function(t){var e=this;this.selectedEvents=[],this.showSearchDropdown=!1,this.fromSavedSearch=!0,t!==parseInt(t,10)&&"string"!==typeof t&&(t=t.id,this.$router.push({name:"Explore",query:{view:t}})),S.getView(this.sketchId,t).then((function(t){var i=t.data.objects[0];if(e.currentQueryString=i.query_string,e.currentQueryFilter=JSON.parse(i.query_filter),e.currentQueryFilter.fields&&e.currentQueryFilter.fields.length||(e.currentQueryFilter.fields=[{field:"message",type:"text"}]),e.selectedFields=e.currentQueryFilter.fields,"_all"===e.currentQueryFilter.indices[0]||"_all"===e.currentQueryFilter.indices){var n=[];e.sketch.active_timelines.forEach((function(t){var i=e.meta.indices_metadata[t.searchindex.index_name].is_legacy;i?n.push(t.searchindex.index_name):n.push(t.id)})),e.currentQueryFilter.indices=n}var s=e.currentQueryFilter.chips;if(s)for(var r=0;r<s.length;r++)"label"===s[r].type&&e.selectedLabels.push(s[r].value);e.contextEvent=!1,e.search(!1)})).catch((function(t){}))},searchContext:function(t){var e=300,i=500;if(this.contextEvent=t,!this.originalContext){var n=JSON.parse(JSON.stringify(this.currentQueryString)),s=JSON.parse(JSON.stringify(this.currentQueryFilter));this.originalContext={queryString:n,queryFilter:s}}var r="YYYY-MM-DDTHH:mm:ss",a=this.$moment.utc(this.contextEvent._source.datetime),o=a.clone().subtract(e,"s").format(r),c=a.clone().add(e,"s").format(r),l={field:"",value:o+","+a.format(r),type:"datetime_range",operator:"must",active:!0},u={field:"",value:a.format(r)+","+c,type:"datetime_range",operator:"must",active:!0};this.currentQueryString="* OR _id:"+this.contextEvent._id,this.currentQueryFilter.chips=[l,u];var d=this.meta.indices_metadata[this.contextEvent._index].is_legacy;this.currentQueryFilter.indices=d?[this.contextEvent._index]:[this.contextEvent._source.__ts_timeline_id],this.currentQueryFilter.size=i,this.search()},removeContext:function(){this.contextEvent=!1,this.currentQueryString=JSON.parse(JSON.stringify(this.originalContext.queryString)),this.currentQueryFilter=JSON.parse(JSON.stringify(this.originalContext.queryFilter)),this.search()},updateSelectedTimelines:function(t){var e=this,i=[];t.forEach((function(t){var n=e.meta.indices_metadata[t.searchindex.index_name].is_legacy;n?i.push(t.searchindex.index_name):i.push(t.id)})),this.currentQueryFilter.indices=i,this.search()},clearSearch:function(){this.currentQueryString="",this.currentQueryFilter=le(),this.currentQueryFilter.indices="_all",this.eventList=ue(),this.$router.replace({query:null})},toggleChip:function(t){void 0===t.active&&(t.active=!0),t.active=!t.active,this.search()},removeChip:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.currentQueryFilter.chips.findIndex((function(e){return e.value===t.value}));this.currentQueryFilter.chips.splice(i,1),"label"===t.type&&(this.selectedLabels=this.selectedLabels.filter((function(e){return e!==t.value}))),e&&this.search()},updateChip:function(t,e){var i=this.currentQueryFilter.chips.findIndex((function(t){return t.value===e.value&&t.type===e.type}));this.currentQueryFilter.chips.splice(i,1,t),this.search()},addChip:function(t){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.push(t),this.search()},addChipFromHistogram:function(t){var e=this;this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.forEach((function(t){"datetime_range"===t.type&&e.removeChip(t,!1)})),this.addChip(t)},toggleLabelChip:function(t){var e={field:"",value:t,type:"label",operator:"must",active:!0},i=this.currentQueryFilter.chips;if(i)for(var n=0;n<i.length;n++)if(i[n].value===t)return void this.removeChip(n);this.addChip(e)},updateLabelChips:function(){var t=this;this.currentQueryFilter.chips=this.currentQueryFilter.chips.filter((function(t){return"label"!==t.type})),this.selectedLabels.forEach((function(e){var i={field:"",value:e,type:"label",operator:"must",active:!0};t.addChip(i),t.showSearchDropdown=!1}))},updateLabelList:function(t){-1===this.meta.filter_labels.indexOf(t)&&this.meta.filter_labels.push(t)},paginate:function(){if(this.tableOptions.itemsPerPage!==this.currentItemsPerPage)return this.tableOptions.page=1,this.currentPage=1,this.currentItemsPerPage=this.tableOptions.itemsPerPage,this.currentQueryFilter.size=this.tableOptions.itemsPerPage,void this.search(!0,!0,!0);this.currentPage!==this.tableOptions.page&&(this.currentQueryFilter.from=this.tableOptions.page*this.currentQueryFilter.size-this.currentQueryFilter.size,this.currentPage=this.tableOptions.page,this.search(!0,!1,!0))},updateSelectedFields:function(t){var e=this;t.forEach((function(t){!e.selectedFields.filter((function(e){return e.field===t.field})).length>0&&e.search(!0,!0,!0)})),t.forEach((function(t){e.selectedFields.push(t)})),this.selectedFieldsProxy=[]},removeField:function(t){this.selectedFields.splice(t,1)},toggleStar:function(){var t=this,e=[];Object.keys(this.selectedEvents).forEach((function(i,n){e.push(t.selectedEvents[i])})),S.saveEventAnnotation(this.sketch.id,"label","__ts_star",e,this.currentSearchNode).then((function(t){})).catch((function(t){})),ki.$emit("toggleStar",this.selectedEvents)},changeSortOrder:function(){"asc"===this.currentQueryFilter.order?this.currentQueryFilter.order="desc":this.currentQueryFilter.order="asc",this.search(!0,!0,!0)},loadingOpen:function(){this.loadingComponent=this.$buefy.loading.open({container:this.isFullPage?null:this.$refs.element.$el})},loadingClose:function(){this.loadingComponent.close()},jumpInHistory:function(t){var e=this;if(this.currentQueryString=t.query_string,this.currentQueryFilter=JSON.parse(t.query_filter),this.currentQueryFilter.fields&&this.currentQueryFilter.fields.length||(this.currentQueryFilter.fields=[{field:"message",type:"text"}]),this.selectedFields=this.currentQueryFilter.fields,"_all"===this.currentQueryFilter.indices[0]||"_all"===this.currentQueryFilter.indices){var i=[];this.sketch.active_timelines.forEach((function(t){var n=e.meta.indices_metadata[t.searchindex.index_name].is_legacy;n?i.push(t.searchindex.index_name):i.push(t.id)})),this.currentQueryFilter.indices=i}var n=this.currentQueryFilter.chips;if(n)for(var s=0;s<n.length;s++)"label"===n[s].type&&this.selectedLabels.push(n[s].value);this.contextEvent=!1,this.search(!1,!0,!0,t.id)},triggerScrollTo:function(){ki.$emit("triggerScrollTo")},zoomWithMouse:function(t){this.zoomOrigin.x=t.pageX,this.zoomOrigin.y=t.pageY,t.deltaY<0?this.zoomLevel+=.07:t.deltaY>0&&(this.zoomLevel-=.07)},closeSearchDropdown:function(t){t!==this.$refs.searchInput&&null===t.getAttribute("data-explore-element")&&(this.showSearchDropdown=!1)},onClickOutside:function(t){"tsSearchInput"!==t.target.id&&(this.showSearchDropdown=!1)},saveSearch:function(){var t=this;S.createView(this.sketchId,this.saveSearchFormName,this.currentQueryString,this.currentQueryFilter).then((function(e){t.saveSearchFormName="",t.saveSearchMenu=!1;var i=e.data.objects[0];t.$store.state.meta.views.push(i),t.$router.push({name:"Explore",query:{view:i.id}})})).catch((function(t){}))}},watch:{tableOptions:{handler:function(){this.paginate()},deep:!0}},mounted:function(){this.$refs.searchInput.focus()},created:function(){var t=this,e=!1;if(this.params={viewId:this.$route.query.view,indexName:this.$route.query.timeline,resultLimit:this.$route.query.limit,queryString:this.$route.query.q},this.params.viewId)this.searchView(this.params.viewId);else{if(this.params.queryString&&(this.currentQueryString=this.params.queryString,e=!0),this.params.indexName){this.params.queryString||(this.currentQueryString="*");var i=this.sketch.active_timelines.find((function(e){return e.id===parseInt(t.params.indexName,10)})),n=this.meta.indices_metadata[i.searchindex.index_name].is_legacy;this.currentQueryFilter.indices=n?[i.searchindex.index_name]:[i.id],e=!0}this.currentQueryString||(this.currentQueryFilter.indices=["_all"]),e&&(this.currentQueryFilter.indices.length||(this.currentQueryFilter.indices=["_all"]),this.search())}}},he=de,me=(i("2d9e"),Object(c["a"])(he,O,D,!1,null,null,null)),ve=me.exports,fe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.sketch.status?i("router-view"):t._e()},pe=[],ge={props:["sketchId"],created:function(){this.$store.dispatch("updateSketch",this.sketchId),this.$store.dispatch("updateSearchHistory",this.sketchId),this.$store.dispatch("updateScenario",this.sketchId),this.$store.dispatch("updateSigmaList",this.sketchId)},computed:{sketch:function(){return this.$store.state.sketch}},watch:{sketch:function(t){"archived"===t.status[0].status&&this.$router.push({name:"Overview",params:{sketchId:this.sketch.id}}),document.title=this.sketch.name}}},_e=ge,ye=Object(c["a"])(_e,fe,pe,!1,null,null,null),be=ye.exports,Se=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",{attrs:{fluid:""}},[i("v-row",[i("v-col",{attrs:{cols:"9"}},[i("v-row",[i("v-col",[i("v-card",{attrs:{outlined:""}},[i("v-app-bar",{attrs:{flat:"",dense:""}},[t._v(" Timelines ")]),i("ts-timelines-table"),i("v-divider"),i("v-card-actions",[i("v-btn",{attrs:{small:"",text:""}},[i("v-icon",[t._v("mdi-plus")]),t._v(" Upload timeline ")],1)],1)],1)],1)],1),t.searchHistory.length?i("v-row",[i("v-col",[i("v-card",{attrs:{outlined:""}},[i("v-app-bar",{attrs:{flat:"",dense:""}},[t._v(" Search History ")]),i("ts-search-history-table")],1)],1)],1):t._e(),t.meta.views.length?i("v-row",[i("v-col",[i("v-card",{attrs:{outlined:""}},[i("v-app-bar",{attrs:{flat:"",dense:""}},[t._v(" Saved Searches ")]),i("ts-saved-searches-table")],1)],1)],1):t._e(),t.dataTypes.length?i("v-row",[i("v-col",[i("v-card",{attrs:{outlined:""}},[i("v-app-bar",{attrs:{flat:"",dense:""}},[t._v(" Data Types ")]),i("ts-data-types-table")],1)],1)],1):t._e(),t.tags.length?i("v-row",[i("v-col",[i("v-card",{attrs:{outlined:""}},[i("v-app-bar",{attrs:{flat:"",dense:""}},[t._v(" Tags ")]),i("ts-tags-table")],1)],1)],1):t._e()],1),i("v-col",{attrs:{cols:"3"}},[i("v-sheet",[i("v-list",{attrs:{"two-line":""}},[i("v-subheader",[t._v("SKETCH DETAILS")]),i("v-list-item",[i("v-list-item-content",[i("v-list-item-title",[i("strong",[t._v("Created:")]),t._v(" "+t._s(t._f("shortDateTime")(t.sketch.created_at))+"\n              ")]),i("v-list-item-subtitle",[i("small",[t._v(t._s(t._f("timeSince")(t.sketch.created_at))+" by "+t._s(t.sketch.user.username))])])],1)],1),i("v-list-item",[i("v-list-item-content",[i("v-list-item-title",[i("strong",[t._v("Access: ")]),t.meta.permissions.public?i("span",[t._v("Public")]):i("span",[t._v("Restricted")])]),i("v-list-item-subtitle",[t.meta.permissions.public?i("small",[t._v("Visibly to all users on this server")]):i("small",[t._v("Only people with access can open")])])],1)],1),i("v-list-item",[i("v-list-item-content",[i("v-list-item-title",[i("strong",[t._v("Shared with")])]),i("v-list-item-subtitle",[i("small",[t._v("People and groups with access")])])],1)],1)],1),i("v-divider"),i("v-list",[i("v-list-item-group",{attrs:{color:"primary"}},[i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-square-edit-outline")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Rename sketch")])],1)],1),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-account-multiple-plus")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Access control")])],1)],1),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-archive")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Archive sketch")])],1)],1),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-export")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Export sketch")])],1)],1)],1)],1)],1)],1)],1)],1)},ke=[],we=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[i("thead",[i("tr",[i("th",{staticClass:"text-left"},[t._v("Name")]),i("th",{staticClass:"text-left"},[t._v("Import method")]),i("th",{staticClass:"text-left"},[t._v("Events")]),i("th",{staticClass:"text-left"},[t._v("Uploaded by")]),i("th",{staticClass:"text-left"},[t._v("Created")])])]),i("tbody",t._l(t.activeTimelines,(function(e){return i("tr",{key:e.id},[i("td",[i("v-menu",{attrs:{"offset-y":"","content-class":"menu-with-gap"},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on;return[i("span",t._g({staticStyle:{cursor:"pointer"}},s),[i("v-avatar",{staticClass:"mr-2",attrs:{rounded:"",color:"#"+e.color,size:"24"}}),t._v("\n                "+t._s(e.name)+"\n              ")],1)]}}],null,!0)},[i("v-card",{attrs:{width:"300"}},[i("v-list",[i("v-list-item",[i("v-list-item-action",[i("v-icon",[t._v("mdi-square-edit-outline")])],1),i("v-list-item-subtitle",[t._v("Rename timeline")])],1),i("v-list-item",[i("v-list-item-action",[i("v-icon",[t._v("mdi-magnify")])],1),i("v-list-item-subtitle",[i("router-link",{staticStyle:{"text-decoration":"none"},attrs:{to:{name:"Explore",query:{timeline:e.id}}}},[t._v("\n                      Explore this timeline\n                    ")])],1)],1),i("v-list-item",{on:{click:function(e){return t.removeChip(t.chip)}}},[i("v-list-item-action",[i("v-icon",[t._v("mdi-delete")])],1),i("v-list-item-subtitle",[t._v("Remove from sketch")])],1)],1)],1)],1)],1),i("td",[t._v("\n          "+t._s(e.datasources[0].provider)+"\n          "),i("v-dialog",{attrs:{width:"600"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[i("small",t._g(t._b({},"small",s,!1),n),[t._v("(details)")])]}}],null,!0),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("v-card",[i("v-app-bar",{attrs:{flat:"",dense:""}},[t._v("Detailed information for: "+t._s(e.name))]),i("v-card-text",{staticClass:"pa-5"},[i("ul",{staticStyle:{"list-style-type":"none"}},[i("li",[i("strong",[t._v("Opensearch index: ")]),t._v(t._s(e.searchindex.index_name))]),i("li",[i("strong",[t._v("Number of events: ")]),t._v("\n                    "+t._s(t._f("compactNumber")(t.meta.stats_per_timeline[e.id]["count"]))+" ("+t._s(t.meta.stats_per_timeline[e.id]["count"])+")\n                  ")]),i("li",[i("strong",[t._v("Created by: ")]),t._v(t._s(e.user.username))]),i("li",[i("strong",[t._v("Created at: ")]),t._v(t._s(t._f("shortDateTime")(e.created_at))+"\n                    "),i("small",[t._v("("+t._s(t._f("timeSince")(e.created_at))+")")])])]),i("br"),i("br"),t._l(e.datasources,(function(e){return i("v-alert",{key:e.id,attrs:{"colored-border":"",color:e.error_message?"error":"success",border:"left",elevation:"1"}},[i("ul",{staticStyle:{"list-style-type":"none"}},[i("li",[i("strong",[t._v("Provider:")]),t._v(" "+t._s(e.provider))]),i("li",[i("strong",[t._v("Context:")]),t._v(" "+t._s(e.context))]),i("li",[i("strong",[t._v("User:")]),t._v(" "+t._s(e.user.username))]),i("li",[i("strong",[t._v("File on disk:")]),t._v(" "+t._s(e.file_on_disk))]),i("li",[i("strong",[t._v("File size:")]),t._v(" "+t._s(t._f("compactBytes")(e.file_size)))]),i("li",[i("strong",[t._v("Original filename:")]),t._v(" "+t._s(e.original_filename))]),i("li",[i("strong",[t._v("Data label:")]),t._v(" "+t._s(e.data_label))])])])}))],2),i("v-divider"),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialog=!1}}},[t._v(" Close ")])],1)],1)],1)],1),i("td",[t._v(t._s(t._f("compactNumber")(t.meta.stats_per_timeline[e.id]["count"])))]),i("td",[t._v(t._s(e.user.username))]),i("td",[t._v("\n          "+t._s(t._f("shortDateTime")(e.created_at))+" "),i("small",[t._v("("+t._s(t._f("timeSince")(e.created_at))+")")])])])})),0)]},proxy:!0}])})},xe=[],Te={props:[],computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},activeTimelines:function(){var t=Object(ft["a"])(this.sketch.active_timelines);return t.sort((function(t,e){return t.name.localeCompare(e.name)}))}},data:function(){return{dialog:!1}},methods:{}},Ce=Te,Ee=Object(c["a"])(Ce,we,xe,!1,null,null,null),$e=Ee.exports,Fe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[i("thead",[i("tr",[i("th",{staticClass:"text-left"},[t._v("Type")]),i("th",{staticClass:"text-left"},[t._v("Events")])])]),i("tbody",t._l(t.dataTypes,(function(e){return i("tr",{key:e.data_type},[i("td",[i("router-link",{staticStyle:{"text-decoration":"none"},attrs:{to:{name:"Explore",query:{q:'data_type:"'+e.data_type+'"'}}}},[t._v("\n            "+t._s(e.data_type)+"\n          ")])],1),i("td",[t._v(t._s(t._f("compactNumber")(e.count)))])])})),0)]},proxy:!0}])})},Oe=[],De={props:[],computed:{sketch:function(){return this.$store.state.sketch},dataTypes:function(){return this.$store.state.dataTypes}},data:function(){return{}},methods:{}},Qe=De,Ne=Object(c["a"])(Qe,Fe,Oe,!1,null,null,null),Le=Ne.exports,Pe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[i("thead",[i("tr",[i("th",{staticClass:"text-left"},[t._v("Tag")]),i("th",{staticClass:"text-left"},[t._v("Events")])])]),i("tbody",t._l(t.tags,(function(e){return i("tr",{key:e.tag},[i("td",[i("router-link",{staticStyle:{"text-decoration":"none"},attrs:{to:{name:"Explore",query:{q:"tag:"+e.tag}}}},[t._v("\n            "+t._s(e.tag)+"\n          ")])],1),i("td",[t._v(t._s(t._f("compactNumber")(e.count)))])])})),0)]},proxy:!0}])})},Ie=[],je={props:[],computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},tags:function(){return this.$store.state.tags}},data:function(){return{}},methods:{}},Ae=je,qe=Object(c["a"])(Ae,Pe,Ie,!1,null,null,null),Re=qe.exports,He=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[i("thead",[i("tr",[i("th",{staticClass:"text-left"},[t._v("Query")]),i("th",{staticClass:"text-left"},[t._v("Count")]),i("th",{staticClass:"text-left"},[t._v("Query time")]),i("th",{staticClass:"text-left"},[t._v("Date")])])]),i("tbody",t._l(t.searchHistory,(function(e){return i("tr",{key:e},[i("td",[i("router-link",{staticStyle:{"text-decoration":"none"},attrs:{to:{name:"Explore",query:{q:e.query_string}}}},[t._v("\n            "+t._s(e.query_string)+"\n          ")])],1),i("td",[t._v(t._s(t._f("compactNumber")(e.query_result_count)))]),i("td",[t._v(t._s(e.query_time)+"ms")]),i("td",[t._v("\n          "+t._s(t._f("shortDateTime")(e.created_at))+" "),i("small",[t._v("("+t._s(t._f("timeSince")(e.created_at))+")")])])])})),0)]},proxy:!0}])})},ze=[],Me={props:[],computed:{sketch:function(){return this.$store.state.sketch}},data:function(){return{searchHistory:[]}},methods:{fetchHistory:function(){var t=this;S.getSearchHistory(this.sketch.id).then((function(e){t.searchHistory=e.data.objects})).catch((function(t){}))}},created:function(){this.fetchHistory()}},Be=Me,Ue=Object(c["a"])(Be,He,ze,!1,null,null,null),Ye=Ue.exports,Ve=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[i("thead",[i("tr",[i("th",{staticClass:"text-left"},[t._v("Saved search")]),i("th",{staticClass:"text-left"},[t._v("Created by")]),i("th",{staticClass:"text-left"},[t._v("Created at")])])]),i("tbody",t._l(t.meta.views,(function(e){return i("tr",{key:e.name},[i("td",[i("router-link",{staticStyle:{"text-decoration":"none"},attrs:{to:{name:"Explore",query:{view:e.id}}}},[t._v("\n            "+t._s(e.name)+"\n          ")])],1),i("td",[t._v(t._s(e.user))]),i("td",[t._v("\n          "+t._s(t._f("shortDateTime")(e.created_at))+" "),i("small",[t._v("("+t._s(t._f("timeSince")(e.created_at))+")")])])])})),0)]},proxy:!0}])})},Ge=[],Je={props:[],computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta}},data:function(){return{}},methods:{}},We=Je,Ke=Object(c["a"])(We,Ve,Ge,!1,null,null,null),Xe=Ke.exports,Ze={components:{TsTimelinesTable:$e,TsDataTypesTable:Le,TsTagsTable:Re,TsSearchHistoryTable:Ye,TsSavedSearchesTable:Xe},data:function(){return{showUploadTimelineModal:!1,showDeleteSketchModal:!1,showShareModal:!1,isFullPage:!0,loadingComponent:null,isArchived:!1,selectedItem:1,items:[{text:"Real-Time",icon:"mdi-clock"},{text:"Audience",icon:"mdi-account"},{text:"Conversions",icon:"mdi-flag"}]}},computed:{sketch:function(){return this.$store.state.sketch},meta:function(){return this.$store.state.meta},count:function(){return this.$store.state.count},dataTypes:function(){return this.$store.state.dataTypes},tags:function(){return this.$store.state.tags},searchHistory:function(){return this.$store.state.searchHistory},shareTooltip:function(){var t="",e="Shared with ";return this.meta.collaborators.users.length&&(t=e+this.meta.collaborators.users.length+" users",this.meta.collaborators.groups.length&&(t=t+" and "+this.meta.collaborators.groups.length+" groups")),!t&&this.meta.collaborators.groups.length&&(t=e+this.meta.collaborators.groups.length+" groups"),t}},methods:{deleteSketch:function(){var t=this;S.deleteSketch(this.sketch.id).then((function(e){t.$router.push({name:"Home"})})).catch((function(t){console.error(t)}))},archiveSketch:function(){var t=this;this.isArchived=!0,S.archiveSketch(this.sketch.id).then((function(e){t.$store.dispatch("updateSketch",t.sketch.id),t.$router.push({name:"Overview",params:{sketchId:t.sketch.id}})})).catch((function(t){console.error(t)}))},unArchiveSketch:function(){var t=this;this.isArchived=!1,S.unArchiveSketch(this.sketch.id).then((function(e){t.$store.dispatch("updateSketch",t.sketch.id),t.$router.push({name:"Overview",params:{sketchId:t.sketch.id}})})).catch((function(t){console.error(t)}))},exportSketch:function(){var t=this;this.loadingOpen(),S.exportSketch(this.sketch.id).then((function(e){var i=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a"),s="sketch-"+t.sketch.id+"-export.zip";n.href=i,n.setAttribute("download",s),document.body.appendChild(n),n.click(),t.loadingClose()})).catch((function(e){console.error(e),t.loadingClose()}))},sortedUserList:function(){var t=Object(ft["a"])(this.$store.state.meta.collaborators.users);return t.sort()},sortedGroupList:function(){var t=Object(ft["a"])(this.$store.state.meta.collaborators.groups);return t.sort()},closeShareModal:function(){this.showShareModal=!1,this.$buefy.snackbar.open({duration:3500,message:"Sharing settings have been saved",type:"is-white",position:"is-top",queue:!1}),this.$store.dispatch("updateSketch",this.sketch.id)},loadingOpen:function(){this.loadingComponent=this.$buefy.loading.open({container:this.isFullPage?null:this.$refs.element.$el})},loadingClose:function(){this.loadingComponent.close()}},created:function(){"archived"===this.sketch.status[0].status&&(this.isArchived=!0)}},ti=Ze,ei=(i("c4a3"),Object(c["a"])(ti,Se,ke,!1,null,null,null)),ii=ei.exports;n["default"].use(d["a"]);var ni=[{name:"Home",path:"/",component:F},{path:"/sketch/:sketchId",component:be,props:!0,children:[{path:"",name:"Overview",component:ii},{path:"explore",name:"Explore",component:ve,props:!0}]}],si=new d["a"]({mode:"history",base:"/v2/",routes:ni}),ri=i("2f62");n["default"].use(ri["a"]);var ai=function(t){return{sketch:{},meta:{},searchHistory:{},scenario:{facets:[]},tags:[],dataTypes:[],count:0,currentSearchNode:null,currentUser:t}},oi=ai(),ci=new ri["a"].Store({state:oi,mutations:{SET_SKETCH:function(t,e){n["default"].set(t,"sketch",e.objects[0]),n["default"].set(t,"meta",e.meta)},SET_SEARCH_HISTORY:function(t,e){n["default"].set(t,"searchHistory",e.objects)},SET_SCENARIO:function(t,e){n["default"].set(t,"scenario",e.objects[0][0])},SET_TIMELINE_TAGS:function(t,e){var i=e.objects[0]["field_bucket"]["buckets"];n["default"].set(t,"tags",i)},SET_DATA_TYPES:function(t,e){var i=e.objects[0]["field_bucket"]["buckets"];n["default"].set(t,"dataTypes",i)},SET_COUNT:function(t,e){n["default"].set(t,"count",e)},SET_SEARCH_NODE:function(t,e){n["default"].set(t,"currentSearchNode",e)},SET_SIGMA_LIST:function(t,e){n["default"].set(t,"sigmaRuleList",e["objects"]),n["default"].set(t,"sigmaRuleList_count",e["meta"]["rules_count"])},SET_ACTIVE_USER:function(t,e){S.getLoggedInUser().then((function(e){var i=e.data.objects[0].username;n["default"].set(t,"currentUser",i)}))},RESET_STATE:function(t,e){S.getLoggedInUser().then((function(e){var i=e.data.objects[0].username;Object.assign(t,ai(i))}))}},actions:{updateSketch:function(t,e){return S.getSketch(e).then((function(i){t.commit("SET_SKETCH",i.data),t.commit("SET_ACTIVE_USER",i.data),t.dispatch("updateTimelineTags",e),t.dispatch("updateDataTypes",e)})).catch((function(t){}))},updateCount:function(t,e){return S.countSketchEvents(e).then((function(e){t.commit("SET_COUNT",e.data.meta.count)})).catch((function(t){}))},resetState:function(t){t.commit("RESET_STATE")},updateSearchNode:function(t,e){t.commit("SET_SEARCH_NODE",e)},updateSearchHistory:function(t,e){return e||(e=t.state.sketch.id),S.getSearchHistory(e).then((function(e){t.commit("SET_SEARCH_HISTORY",e.data)})).catch((function(t){}))},updateScenario:function(t,e){return e||(e=t.state.sketch.id),S.getSketchScenarios(e).then((function(e){t.commit("SET_SCENARIO",e.data)})).catch((function(t){}))},updateTimelineTags:function(t,e){if(t.state.sketch.active_timelines.length){var i={aggregator_name:"field_bucket",aggregator_parameters:{field:"tag"}};return S.runAggregator(e,i).then((function(e){t.commit("SET_TIMELINE_TAGS",e.data)})).catch((function(t){}))}},updateDataTypes:function(t,e){if(t.state.sketch.active_timelines.length){var i={aggregator_name:"field_bucket",aggregator_parameters:{field:"data_type"}};return S.runAggregator(e,i).then((function(e){t.commit("SET_DATA_TYPES",e.data)})).catch((function(t){}))}},updateSigmaList:function(t){S.getSigmaList().then((function(e){t.commit("SET_SIGMA_LIST",e.data)})).catch((function(t){}))}}}),li=i("f13c"),ui=i.n(li),di=i("8e5f"),hi=i.n(di),mi=i("3a6f"),vi=i.n(mi),fi=i("4eb5"),pi=i.n(fi),gi=i("ce5b"),_i=i.n(gi);i("bf40");n["default"].use(_i.a,{options:{customProperties:!0}});var yi={theme:{dark:!1}},bi=new _i.a(yi);i("b383"),i("2d27"),i("56eb");var Si=new n["default"],ki=e["default"]=Si;n["default"].use(i("2ead")),n["default"].use(vi.a),n["default"].use(pi.a),n["default"].use(ui.a),n["default"].component("multiselect",hi.a),n["default"].config.productionTip=!1,new n["default"]({router:si,store:ci,vuetify:bi,render:function(t){return t(u)}}).$mount("#app")},"56eb":function(t,e,i){"use strict";i.r(e);i("7f7f"),i("ac6a");var n=i("2b0e"),s=i("6dde");s.keys().forEach((function(t){var e=s(t);n["default"].filter(e.default.name,e.default.filter)}))},"5c64":function(t,e,i){"use strict";i("6ee5")},6107:function(t,e,i){"use strict";i.r(e);var n=i("707c");e["default"]={name:"timeSince",filter:function(t){return t?n["a"].utc(t).fromNow():""}}},"6dde":function(t,e,i){var n={"./Capitalize.js":"76f9","./CompactBytes.js":"3d1d","./CompactNumber.js":"d3b7","./FilterChip.js":"05a2","./FormatLabelText.js":"16f1","./FormatTimestamp.js":"09ff","./ToISO8601.js":"84cc","./shortDateTime.js":"481e","./timeSince.js":"6107"};function s(t){var e=r(t);return i(e)}function r(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}s.keys=function(){return Object.keys(n)},s.resolve=r,t.exports=s,s.id="6dde"},"6ee5":function(t,e,i){},"707c":function(t,e,i){"use strict";var n=i("5a0c"),s=i.n(n),r=i("0ecf"),a=i.n(r),o=i("4208"),c=i.n(o);s.a.extend(a.a),s.a.extend(c.a),e["a"]=s.a},"71d3":function(t,e,i){},"75a6":function(t,e){function i(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}i.keys=function(){return[]},i.resolve=i,t.exports=i,i.id="75a6"},"76f9":function(t,e,i){"use strict";i.r(e);i("6b54");e["default"]={name:"capitalize",filter:function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""}}},"7a98":function(t,e,i){},"84cc":function(t,e,i){"use strict";i.r(e);var n=i("707c");e["default"]={name:"toISO8601",filter:function(t){return Object(n["a"])(t).toISOString()}}},"97be":function(t,e,i){},b0b9:function(t,e,i){},b383:function(t,e,i){},c3ca:function(t,e,i){"use strict";i("09ae")},c4a3:function(t,e,i){"use strict";i("c74b")},c74b:function(t,e,i){},c7b3:function(t,e,i){},d3b7:function(t,e,i){"use strict";i.r(e),e["default"]={name:"compactNumber",filter:function(t){t||(t=0);var e="";if(t>999999999)t=Math.round(t/1e9*10)/10,e="B";else if(t>999999)t=Math.round(t/1e6*10)/10,e="M";else{if(!(t>999))return t;t=Math.round(t/1e3*10)/10,e="K"}return t+e}}}}]);
//# sourceMappingURL=chunk-common.8769575e.js.map