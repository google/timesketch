Theme: Support psort filters when ingesting into Timesketch
Some hosts produce very large plaso data sets. As an example, a domain controller produced nearly 18 million parsed events when processed with log2timeline. Many of them are from a timeframe that is irrelevent. Also, the majority of parsed events from the DC are Windows event logs. The way log2timeline parses Windows event logs results in duplicate events: one for Creation Time and one for Last Modification Time. Most of the time we only care about the Creation Time events. And the author of the issue have a psort filter he can use that will output just the Windows event log Creation events and also filter to a time range of interest. This works great for psort output to CSV. 
However, he doesn't know of a way to do an equivalent filter when importing into Timesketch. So, Our purpose is to make use of the psort filter in the timesketch_importer.
Here is an example of a psort filter that will narrow down those 18 million events to under 2 million. This is what I'd like to replicate with timesketch_importer or a similar option.
psort.py --output-time-zone 'UTC' -o dynamic -w dc-triage.csv dc-triage.plaso "(((parser == 'winevtx') and (timestamp_desc == 'Creation Time')) or (parser != 'winevtx')) and ( date > datetime('2021-02-01T00:00:00'))"
In this regard, we can call psort in the background worker, and we can pass in arguments to the command. We can add a filter argument and let the user (timesketch_importer for example) set that. This should replicate exactly what you do with normal CSV output.
